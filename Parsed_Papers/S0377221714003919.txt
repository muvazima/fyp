@&#MAIN-TITLE@&#Optimal cost sharing for capacitated facility location games

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider cost sharing in capacitated facility location games.


                        
                        
                           
                           Optimal cost sharing protocols (w.r.t. price of anarchy and price of stability) are introduced.


                        
                        
                           
                           Computational hardness and inapproximability of optimal cost shares are shown.


                        
                        
                           
                           We give a tractable protocol with performance matching the inapproximability bound.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Game theory

Complexity theory

@&#ABSTRACT@&#


               
               
                  We consider cost sharing for a class of facility location games, where the strategy space of each player consists of the bases of a player-specific matroid defined on the set of resources. We assume that resources have nondecreasing load-dependent costs and player-specific delays. Our model includes the important special case of capacitated facility location problems, where players have to jointly pay for opened facilities. The goal is to design cost sharing protocols so as to minimize the resulting price of anarchy and price of stability. We investigate two classes of protocols: basic protocols guarantee the existence of at least one pure Nash equilibrium and separable protocols additionally require that the resulting cost shares only depend on the set of players on a resource. We find optimal basic and separable protocols that guarantee the price of stability/price of anarchy to grow logarithmically/linearly in the number of players. These results extend our previous results (cf. von Falkenhausen & Harks, 2013), where optimal basic and separable protocols were given for the case of symmetric matroid games without delays.
                  We finally study the complexity of computing optimal cost shares. We derive several hardness results showing that optimal cost shares cannot be approximated in polynomial time within a logarithmic factor in the number of players, unless 
                        
                           P
                           =
                           NP
                        
                     . For a restricted class of problems that include the above hard instances, we devise an approximation algorithm matching the logarithmic bound.
               
            

@&#INTRODUCTION@&#

Consider a setting where players jointly use resources that have load-dependent monetary costs and player-specific delays. The monetary cost of each resource must be shared by its users while the player-specific delays are unavoidable physical quantities. This setting arises in facility location models, where users share the monetary cost of opened facilities and additionally experience delays measured by the distance to the closest open facility. As players might value the delay and monetary cost differently, these delays depend on both, the player and the facility the player is assigned to. Another example appears in distributed network design, where players jointly install capacities on a subgraph satisfying user-specific connectivity requirements. Besides the monetary cost for installing enough capacity, each player experiences player-specific delays on the resources used.

Given the resource cost functions, delays and user’s requirements, in an ideal world resources are allocated optimally, that is, an allocation minimizes the social costs. In distributed systems, however, players will selfishly select resources for their demands based on the cost shares they have to pay and delays they experience. While physical delays (such as switching times or travel times) are unavoidable, the ways the monetary cost of a resource is shared among its users determine the equilibrium states of the strategic game induced.

In this article, we study the design of cost sharing protocols as a means to induce efficient equilibria of the strategic game played. We consider cost sharing protocols axiomatized by the following three properties:
                        
                           1.
                           
                              Budget-balance: The cost of each resource is exactly covered by the collected cost shares of the players using the resource.


                              Stability: There is at least one pure strategy Nash equilibrium in each game induced by the cost sharing protocol.


                              Separability: When assigning the cost shares on a given resource, the protocol has no information about the load on other resources.

We call a cost sharing protocol basic if it satisfies 1–2 and separable if it satisfies 1–3. These properties have been used first by Chen, Roughgarden, and Valiant (2010) in the context of network design games. While condition 1 is straightforward, the stability condition 2 requires the existence of at least one Nash equilibrium in pure strategies (abbreviated PNE; see Osborne & Rubinstein (1994, Section 3.2) for several drawbacks of using mixed Nash equilibria instead). Condition 3 is for instance crucial for practical applications in which cost sharing protocols must be distributed because each resource has only local information about its own usage.

We study the design of cost sharing protocols for games in which every player wants to use resources that together form a basis of a player-specific matroid defined on the set of resources. We demonstrate that the aforementioned class of facility location games can be represented by player-specific matroids. As we assume general nondecreasing cost functions on the resources, our model also includes the case of facility location with hard capacities. Our setting has further applications in network design games, where each player wants to allocate a spanning tree in a graph.

The main objective of this paper is to design basic or separable cost sharing protocols so as to minimize the efficiency loss of the equilibria induced. We consider the price of anarchy and the price of stability as the two prevailing performance metrics used in the literature. The price of anarchy (PoA) is defined as the worst-case ratio of the cost of a Nash equilibrium over the cost of a system optimum (see Koutsoupias & Papadimitriou (1999)), while the price of stability (PoS) captures the ratio of the best possible Nash equilibrium over a system optimum (see Anshelevich et al. (2008) and Correa, Schulz, & Stier-Moses (2004)).

The first main result presented in Section 3 is a characterization of Nash equilibria in games with general cost functions and strategy spaces defined by player-specific matroids, showing that only a subclass of strategy profiles (called decharged) are candidates for being a pure Nash equilibrium. This allows to give lower bounds by constructing instances where all decharged profiles are expensive. Our characterization of Nash equilibria using the notion of decharged profiles strictly generalizes a characterization introduced in our previous paper (von Falkenhausen & Harks, 2013). While in von Falkenhausen and Harks (2013) we assumed symmetric strategy spaces, i.e., the same strategies are available to each player, we allow in this work player-specific strategy spaces and, additionally, individual delay for each player and resource.

As a second contribution, we give in Section 4 an algorithm that constructs decharged profiles establishing an optimal protocol with PoS matching our lower bounds. In Section 5, we further prove that this protocol is also optimal with respect to the PoA. Note that our protocol used for the positive results also fulfill the stricter separability requirement from Chen et al. (2010), i.e., when assigning the cost shares on a given facility, the protocol has no information about the load on other facilities. When the class of cost functions is restricted to be either concave or convex, we show in Section 6 a drastic improvement of the PoS and PoA. The results in comparison to those obtained in von Falkenhausen and Harks (2013) are summarized in Table 1
                           .

In Section 7, we study the computational complexity of computing optimal cost shares that minimize the cost of the best/worst induced Nash equilibrium. We prove that both problems are strongly NP-hard and there are no polynomial time 
                              
                                 c
                                 log
                                 (
                                 n
                                 )
                              
                            approximations for any 
                              
                                 0
                                 <
                                 c
                                 <
                                 1
                              
                           , unless 
                              
                                 P
                                 =
                                 NP
                              
                           . These hardness results even hold for instances with unweighted players, zero delays, singleton strategies and unit fixed costs. In light of the hardness even for this restricted class of problems, we study approximation algorithms for the case of unweighted players, zero delays and singleton strategies, still assuming general nondecreasing costs. This setting includes several interesting classes of problems such as scheduling applications, where each player is associated with a job of unit weight. The job can be processed on a job-specific set of machines, and the monetary cost on a resource (for instance energy costs as in Yao, Demers, & Shenker (1995)) is a non-decreasing function of its total load. Another application arises in capacitated facility location with delays in 
                              
                                 {
                                 0
                                 ,
                                 ∞
                                 }
                              
                           . We devise a polynomial time algorithm computing cost shares with an approximation guarantee of 
                              
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                              
                            and n for the problem of minimizing the cost of the best/worst Nash equilibrium, respectively.

@&#RELATED WORK@&#

Cost sharing approaches to facility location problems and network design problems were analyzed in Könemann, Leonardi, Schäfer, and van Zwam (2008); Pál and Tardos (2003). In these works it is only required that total cost shares cover (approximately) total cost as the players play for the service of being connected. In contrast in our work, we require the stricter notion that the cost of every individual resource is paid for by the players using it. Our model also includes the case of the congested facility location problem considered by Desrochers, Marcotte, and Stan (1995), where players have to jointly pay for the congestion related costs and the opening costs of the facilities. Instead of a game-theoretic problem formulation, they consider a centralized approach using mixed-integer programming techniques for minimizing total cost.

The existence of pure Nash equilibria and their price of anarchy and price of stability in congestion games has been studied by several researchers, (Ackermann, Röglin, & Vöcking, 2009; Even-Dar, Kesselman, & Mansour, 2007; Fotakis, Kontogiannis, Koutsoupias, Mavronicolas, & Spirakis, 2002; Gairing, Monien, & Tiemann, 2006; Harks & Klimm, 2012; Ieong, McGrew, Nudelman, Shoham, & Sun, 2005; Milchtaich, 1996). The fundamental difference from our work is the ways cost shares are assigned. In congestion games, every player pays the average total cost, while in our setting we follow a design perspective of cost sharing protocols. Kollias and Roughgarden (2011) considered weighted congestion games and proposed a cost sharing protocol based on the Shapley value for which they are able to prove existence of PNE and corresponding bounds on the price of anarchy/stability. They focus on polynomial cost per unit functions with nonnegative coefficients but it is not known that this protocol is optimal. For further work on congestion games with average cost sharing assuming nonincreasing marginal cost functions modeling economies of scale or buy-at-bulk we refer to Albers (2009); Anshelevich et al. (2008); Epstein, Feldman, and Mansour (2009); Hoefer (2011); Rozenfeld and Tennenholtz (2006). There is also a large body of papers studying cost sharing protocols for continuous and convex strategy spaces assuming convex cost sharing functions, cf. (Chen & Zhang, 2012; Harks & Miller, 2011; Johari & Tsitsiklis, 2006; Johari & Tsitsiklis, 2009; Moulin & serial, 2008; Moulin, 2010).


                        Christodoulou, Koutsoupias, and Nanavati (2004) and follow-up papers such as Caragiannis (2009); Cole, Correa, Gkatzelis, Mirrokni, and Olver (2011); Immorlica, Li, Mirrokni, and Schulz (2009) study scheduling policies and their price of anarchy in scheduling games in which each player assigns a job to machine with the goal to minimize its completion time. Since the completion time of a job depends on the order in which jobs are processed the design of scheduling policies is fundamentally different to the design of cost sharing protocols.

Cost sharing is a central topic in the area of cooperative game theory, cf. (Archer, Feigenbaum, Krishnamurthy, Sami, & Shenker, 2004; Bogomolnaia, Holzman, & Moulin, 2010; Moulin & Shenker, 2001) or the survey of Moulin (2002, chap. 06) with a pointer to further references.

In a facility location model, there is a set 
                        
                           N
                           =
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                      of players that choose facilities (also called resources) from a set 
                        
                           R
                           =
                           {
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 r
                              
                              
                                 m
                              
                           
                           }
                        
                     . For each player 
                        
                           i
                           ∈
                           N
                        
                     , there is a set 
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                      of feasible resource choices, where a strategy 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                      is a set of resources, i.e. 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ⊆
                           R
                        
                     , and there is a matroid 
                        
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                           =
                           (
                           R
                           ,
                           I
                           )
                        
                      such that 
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                      equals the set of bases of 
                        
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                        
                     . As a set of matroid bases, 
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                      has the basis exchange property: given a strategy from 
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                     , one can alter it resource by resource towards another strategy from 
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                      such that all intermediate strategies are also contained in 
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                     . In other words, for any strategies 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                      and any 
                        
                           r
                           ∈
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      there is some 
                        
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           ∈
                           
                              
                                 Y
                              
                              
                                 i
                              
                           
                           ⧹
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ,
                           r
                           
                           ≠
                           
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                        
                     , such that 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           ⧹
                           {
                           r
                           }
                           ∪
                           {
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           }
                           ∈
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                      (cf. Schrijver (2003) for a comprehensive introduction into matroid theory). Given strategies 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      for all players 
                        
                           i
                           ∈
                           N
                        
                     , we denote by 
                        
                           X
                           ≔
                           (
                           
                              
                                 X
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 X
                              
                              
                                 n
                              
                           
                           )
                        
                      the joint strategy profile and correspondingly 
                        
                           Σ
                           ≔
                           
                              
                                 ∏
                              
                              
                                 i
                                 ∈
                                 N
                              
                           
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                     .

Furthermore, a vector 
                        
                           d
                           =
                           
                              
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 ∈
                                 N
                              
                           
                        
                      specifies the player’s weights, which in a strategy profile X sum up on each resource 
                        
                           r
                           ∈
                           R
                        
                      to the load 
                        
                           
                              
                                 ℓ
                              
                              
                                 r
                              
                           
                           (
                           X
                           )
                           ≔
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 X
                                 )
                              
                           
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                        
                     , where 
                        
                           
                              
                                 N
                              
                              
                                 r
                              
                           
                           (
                           X
                           )
                           ≔
                           {
                           i
                           :
                           r
                           ∈
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           }
                        
                      is the set of players using r. The resources’ cost functions are given by a vector 
                        
                           c
                           =
                           
                              
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                              
                                 r
                                 ∈
                                 R
                              
                           
                        
                     , they are non-decreasing in the load. Each player i incurs a player-specific delay 
                        
                           
                              
                                 t
                              
                              
                                 i
                                 ,
                                 r
                              
                           
                           ⩾
                           0
                        
                      when using resource r. Altogether, a facility location model is represented by a tuple 
                        
                           I
                           =
                           (
                           N
                           ,
                           R
                           ,
                           Σ
                           ,
                           d
                           ,
                           c
                           ,
                           t
                           )
                        
                     .

To measure the social cost of a profile X, we use utilitarian welfare, i.e. the sum of the individual players’ costs and delays, and we denote 
                        
                           C
                           (
                           X
                           )
                           ≔
                           
                              
                                 ∑
                              
                              
                                 r
                                 ∈
                                 R
                              
                           
                           
                              
                                 c
                              
                              
                                 r
                              
                           
                           (
                           
                              
                                 ℓ
                              
                              
                                 r
                              
                           
                           (
                           X
                           )
                           )
                           +
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 N
                                 :
                                 r
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              
                                 t
                              
                              
                                 i
                                 ,
                                 r
                              
                           
                        
                     . Abusing notation, we often refer to the cost on resource r by 
                        
                           
                              
                                 c
                              
                              
                                 r
                              
                           
                           (
                           X
                           )
                        
                      instead of 
                        
                           
                              
                                 c
                              
                              
                                 r
                              
                           
                           (
                           
                              
                                 ℓ
                              
                              
                                 r
                              
                           
                           (
                           X
                           )
                           )
                        
                     . We now give two examples of such models.
                        Example 2.1
                        Capacitated facility location games


                        In a capacitated facility location game, motivated by the classic Facility Location problem, every player i chooses exactly one resource, that is 
                              
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 =
                                 1
                              
                            for all 
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       Σ
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 i
                                 ∈
                                 N
                              
                            and hence 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            corresponds to a uniform matroid of rank one. Hard capacities on the facilities can be modeled by cost functions that sharply increase at the corresponding capacity.

We are given an undirected graph 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                            with non-negative and non-decreasing edge cost functions 
                              
                                 
                                    
                                       c
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 ℓ
                                 )
                                 ,
                                 e
                                 ∈
                                 E
                              
                           . In a minimum spanning tree (MST) game, every player i is associated with demand of size 
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 >
                                 0
                              
                            and a subgraph 
                              
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                              
                            of G. A strategy for player is then to route its demand along a spanning tree for 
                              
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                              
                           . Formally, we set 
                              
                                 R
                                 =
                                 E
                              
                            and the sets 
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 i
                                 ∈
                                 N
                              
                           , are the spanning trees of 
                              
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                              
                           , hence 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            corresponds to the graphical matroid.

We study how different ways of sharing the costs of a resource affect the resulting pure Nash equilibria of the induced game. To model this, we introduce cost sharing protocols 
                        
                           Ξ
                        
                      that assign cost share functions 
                        
                           
                              
                                 ξ
                              
                              
                                 i
                                 ,
                                 r
                              
                           
                           :
                           Σ
                           →
                           R
                        
                      for all 
                        
                           i
                           ∈
                           N
                        
                      and 
                        
                           r
                           ∈
                           R
                        
                      to the facility location model I and thus induce the strategic game 
                        
                           (
                           N
                           ,
                           Σ
                           ,
                           ξ
                           )
                        
                     . For a player i, her total private cost is 
                        
                           
                              
                                 ξ
                              
                              
                                 i
                              
                           
                           (
                           X
                           )
                           ≔
                           
                              
                                 ∑
                              
                              
                                 r
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              
                                 ξ
                              
                              
                                 i
                                 ,
                                 r
                              
                           
                           (
                           X
                           )
                           +
                           
                              
                                 t
                              
                              
                                 i
                                 ,
                                 r
                              
                           
                        
                      and we assume that every player strives to minimize her private cost. An important solution concept in non-cooperative game theory are pure Nash equilibria. Using standard notation in game theory, for a strategy profile 
                        
                           X
                           ∈
                           Σ
                        
                      we denote by
                        
                           
                              (
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    -
                                    i
                                 
                              
                              )
                              ≔
                              (
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    X
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    X
                                 
                                 
                                    n
                                 
                              
                              )
                              ∈
                              Σ
                           
                        
                     the profile that arises if only player i deviates to strategy 
                        
                           
                              
                                 Z
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                        
                     .
                        Definition 2.3
                        Pure Nash equilibrium (PNE)


                        Let 
                              
                                 (
                                 N
                                 ,
                                 Σ
                                 ,
                                 ξ
                                 )
                              
                            be a strategic game. The profile X is a pure Nash equilibrium if no player i can strictly reduce her private cost by unilaterally moving to a different strategy, that is, for all 
                              
                                 i
                                 ∈
                                 N
                              
                           
                           
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    X
                                    )
                                    ⩽
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    
                                    for
                                    
                                    all
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          Σ
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           For facility location games with cost sharing protocol 
                              
                                 ξ
                              
                           , this translates to: a strategy profile X is a Nash equilibrium if
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   Z
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    strategies
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          Σ
                                       
                                       
                                          i
                                       
                                    
                                    
                                    and
                                    
                                    players
                                    
                                    i
                                    ∈
                                    N
                                    .
                                 
                              
                           
                        

Two well established concepts that quantify the efficiency of Nash equilibria are the price of anarchy and the price of stability. The price of anarchy measures the largest possible ratio of the cost of a Nash equilibrium and the cost of an optimal profile. The price of stability measures the smallest ratio of the cost of a Nash equilibrium and the cost of an optimal profile. For a cost sharing protocol 
                        
                           Ξ
                        
                     , we define by 
                        
                           PoA
                           (
                           Ξ
                           )
                        
                      and 
                        
                           PoS
                           (
                           Ξ
                           )
                        
                      the corresponding worst case price of anarchy and price of stability across games induced by protocol 
                        
                           Ξ
                        
                     . The main goal of this paper is to design cost sharing protocols that minimize the price of anarchy and price of stability, respectively. Of course, the attainable objective values crucially depend on the design space that we permit. The following properties have been first proposed by Chen et al. (2010) in the context of designing cost sharing protocols for network design games.
                        Definition 2.4
                        Properties of cost sharing protocols


                        A cost sharing protocol 
                              
                                 Ξ
                              
                            is
                              
                                 1.
                                 
                                    stable if it induces only games that admit at least one pure Nash equilibrium.


                                    basic if it is stable and additionally budget balanced, i.e. if it assigns all facility location models 
                                       
                                          (
                                          N
                                          ,
                                          R
                                          ,
                                          Σ
                                          ,
                                          d
                                          ,
                                          c
                                          ,
                                          t
                                          )
                                       
                                     with cost share functions 
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                     such that for all 
                                       
                                          r
                                          ∈
                                          R
                                       
                                     and 
                                       
                                          X
                                          ∈
                                          Σ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             
                                             and
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             =
                                             0
                                             
                                             for
                                             
                                             all
                                             
                                             i
                                             
                                             ∉
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             .
                                          
                                       
                                    This property requires 
                                       
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          0
                                          )
                                          =
                                          0
                                       
                                     for unused resources, which we will assume in the paper.


                                    separable if it is basic and if it induces only games for which in any two profiles 
                                       
                                          X
                                          ,
                                          
                                             
                                                X
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          Σ
                                       
                                     for every resource 
                                       
                                          r
                                          ∈
                                          R
                                       
                                    ,
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             =
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             ⇒
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             =
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             
                                             for
                                             
                                             all
                                             
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             .
                                          
                                       
                                    
                                 

Informally, separability means that in a profile X the values 
                        
                           
                              
                                 ξ
                              
                              
                                 i
                                 ,
                                 r
                              
                           
                           (
                           X
                           )
                           ,
                           
                           i
                           ∈
                           N
                        
                      depend only on the set 
                        
                           
                              
                                 N
                              
                              
                                 r
                              
                           
                           (
                           X
                           )
                        
                      of players sharing resource r and disregard all other information contained in X. Still, separable protocols can assign cost share functions that are specifically tailored to the given facility location model, for example based on an optimal profile. We denote by 
                        
                           
                              
                                 B
                              
                              
                                 n
                              
                           
                        
                      and 
                        
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                        
                      the set of basic and separable protocols for facility location games with n players, respectively. We obtain the following optimization problems that we address in this paper.
                        
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       Ξ
                                       ∈
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              PoA
                              (
                              Ξ
                              )
                              ,
                              
                              
                                 
                                    
                                       min
                                    
                                    
                                       Ξ
                                       ∈
                                       
                                          
                                             B
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              PoS
                              (
                              Ξ
                              )
                              ,
                              
                              
                                 
                                    
                                       min
                                    
                                    
                                       Ξ
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              PoA
                              (
                              Ξ
                              )
                              ,
                              
                              
                                 
                                    
                                       min
                                    
                                    
                                       Ξ
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                              PoS
                              (
                              Ξ
                              )
                              .
                           
                        
                     
                  

Before we analyze the cost of Nash equilibria, we reveal two structural properties of PNE in the context of facility location games. For this, denote the cost of the cheapest alternative of player i to resource r in a profile 
                        
                           Z
                           ∈
                           Σ
                        
                      by
                        
                           
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              (
                              Z
                              )
                              ≔
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                s
                                                ∈
                                                R
                                             
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                s
                                                -
                                                r
                                                ∈
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             Z
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       s
                                       -
                                       r
                                       ,
                                       
                                          
                                             Z
                                          
                                          
                                             -
                                             i
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             ,
                                             s
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                     
                        Lemma 3.1
                        
                           A PNE X in a facility location game with a separable protocol fulfills the following two properties:
                           
                              
                                 1.
                                 
                                    Each player i is willing to pay the delay 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                     
                                    for each chosen resource 
                                    
                                       
                                          r
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                       
                                    :
                                       
                                          (D1)
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             ⩽
                                             
                                                
                                                   Δ
                                                
                                                
                                                   i
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             .
                                          
                                       
                                    
                                 


                                    The users 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                     
                                    of each resource r, after having paid their delays, are willing to share the cost of the resource:
                                    
                                       
                                          (D2)
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             ⩽
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      -
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            ,
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 

We call a strategy profile X that fulfills (D1) and (D2) 
                     decharged, regardless of the cost shares. Profiles that are not decharged are called charged, similarly resources are called decharged or charged depending on whether both (D1) and (D2) are fulfilled for all players using the resource.
                        Proof
                        We first show (D1). Let X be a Nash equilibrium under a separable protocol 
                              
                                 ξ
                                 ,
                                 i
                                 ∈
                                 N
                              
                            and 
                              
                                 r
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                              
                           . Let 
                              
                                 s
                                 ≔
                                 
                                    
                                       argmin
                                    
                                    
                                       s
                                       ∈
                                       R
                                       :
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       s
                                       -
                                       r
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 s
                                 -
                                 r
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       -
                                       i
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       ,
                                       s
                                    
                                 
                              
                            be the cheapest alternative for i to r and let 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 ≔
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 s
                                 -
                                 r
                              
                           . Then the Nash inequality for player i can be restated as
                              
                                 (1)
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    ⩽
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∗
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                   ∗
                                                
                                             
                                             (
                                             
                                                
                                                   Z
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                   ∗
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∗
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                   ∗
                                                
                                             
                                             (
                                             X
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                   ∗
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          s
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    ⩽
                                    
                                       
                                          c
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    .
                                 
                              
                           For (1) observe that going from 
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                              
                            only r and s are exchanged and since 
                              
                                 ξ
                              
                            is separable the cost shares for all other resources remain the same, i.e. 
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       -
                                       i
                                    
                                 
                                 )
                              
                            for 
                              
                                 
                                    
                                       r
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ∩
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                              
                           .

We now show (D2), again using the Nash inequality for player i,
                              
                                 (2)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                               ∈
                                                               R
                                                            
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               s
                                                               -
                                                               r
                                                               ∈
                                                               
                                                                  
                                                                     Σ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            i
                                                            ,
                                                            s
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      s
                                                      -
                                                      r
                                                      ,
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            -
                                                            i
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                               ∈
                                                               R
                                                            
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               +
                                                               s
                                                               -
                                                               r
                                                               ∈
                                                               
                                                                  
                                                                     Σ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            s
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      s
                                                      -
                                                      r
                                                      ,
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            -
                                                            i
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            ,
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   i
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Here, (2) comes from budget-balance.□

Not only are all PNE decharged, but we can also find cost shares for any decharged strategy profile such that it is a PNE.
                        Definition 3.2
                        
                           X-enforcing cost shares


                        Given a facility location model and a decharged strategy profile X, cost shares 
                              
                                 ξ
                              
                            are called X-enforcing if
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      -
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            ,
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            X
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            Δ
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      -
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                            ,
                                                            r
                                                         
                                                      
                                                   
                                                
                                                ·
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      -
                                                      i
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      -
                                                      i
                                                   
                                                
                                                )
                                                
                                                ifr
                                                ∈
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ⧹
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                for
                                                
                                                any
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      Σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           That is, in X the cost of each resource is shared among the users proportional to their cheapest alternatives minus the delay and a unilaterally deviating player pays the entire cost.

There always exists a separable protocol with such cost shares as we show in Section 4.
                        Lemma 3.3
                        
                           Given a decharged profile X and X-enforcing cost shares 
                           
                              
                                 ξ
                                 ,
                                 X
                              
                            
                           is a PNE.

To establish that X is a PNE, we first show that no player can improve by unilaterally exchanging a single resource in his strategy.
                              
                                 (3)
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Δ
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          -
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                          
                                             
                                                Δ
                                             
                                             
                                                j
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          -
                                          
                                             
                                                t
                                             
                                             
                                                j
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                    ·
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    ⩽
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              
                           where (3) holds because for decharged profiles we have (D2) and hence the denominator of the cost share is not smaller than 
                              
                                 
                                    
                                       c
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 X
                                 )
                              
                           . Using the basis exchange property of matroids as introduced at the beginning of Section 2, we now conclude that no player can improve by changing his strategy to an arbitrary 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       Σ
                                    
                                    
                                       i
                                    
                                 
                              
                            and thus that X is a PNE. To this end, fix such a 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       Σ
                                    
                                    
                                       i
                                    
                                 
                              
                            and denote by 
                              
                                 G
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ▵
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            the bipartite graph 
                              
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                            with 
                              
                                 V
                                 ≔
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ⧹
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ∪
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 ⧹
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            and 
                              
                                 E
                                 ≔
                                 {
                                 (
                                 r
                                 ,
                                 s
                                 )
                                 :
                                 r
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ⧹
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 s
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 ⧹
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 s
                                 -
                                 r
                                 )
                                 ∈
                                 
                                    
                                       Σ
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           .
                              Proposition 3.4
                              Schrijver ’03 Schrijver (2003)
                              


                              
                                 There exists a perfect matching in the graph 
                                 
                                    
                                       G
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       ▵
                                       
                                          
                                             Z
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 .

Consider such a matching and observe that, as shown above, no player can improve unilaterally by exchanging a single resource across a matching edge 
                              
                                 (
                                 r
                                 ,
                                 s
                                 )
                              
                            with 
                              
                                 r
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 s
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                              
                           ,
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    ⩽
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    s
                                    -
                                    r
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          s
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          s
                                       
                                    
                                    ,
                                 
                              
                           where in the last step we use that player i’s cost share on s is independent of the other resources. Summing this up across all matching edges yields the desired
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    X
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   s
                                                
                                             
                                             (
                                             
                                                
                                                   Z
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             
                                                
                                                   Z
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    .
                                    
                                    □
                                 
                              
                           
                        


                           A profile 
                           
                              
                                 X
                                 ∈
                                 Σ
                              
                            
                           is a pure Nash equilibrium in the game induced by some separable protocol if and only if it is decharged.

Follows from Lemmas 3.1 and 3.3, the existence of the separable protocol is the content of Section 4.□

In this section, we deal with the existence and cost of decharged strategy profiles, which by Theorem 3.5 correspond to the (possible) PNE of a facility location game. We present an algorithm that ‘decharges’ any strategy profile of a facility location model, increasing the cost in the process by at most a factor 
                        
                           
                              
                                 H
                              
                              
                                 n
                              
                           
                        
                     . We then give a separable protocol that is X-enforcing for the output of the algorithm. Using this protocol and starting the algorithm at the optimal strategy profile of a facility location model gives an upper bound on the Price of Stability. The proof techniques used here resemble at a high level those used in von Falkenhausen and Harks (2013). However, player-specific strategy spaces and the existence of delays in addition to the facility costs require extra care. While in the setting of von Falkenhausen and Harks (2013) decharged profiles are characterized by (D2), in this setting the algorithm needs ensure that also (D1) is satisfied. We start the section with a known lower bound.
                        Lemma 4.1
                        
                           von Falkenhausen and Harks (2013)
                        


                        
                           There price of stability for symmetric singleton games without transport induced by basic or separable protocols is at least 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                              
                           .

These games are facility location games with the restrictions that 
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 Σ
                              
                              
                                 j
                              
                           
                           =
                           R
                        
                     , i.e. the strategies of the players are single resources, and 
                        
                           
                              
                                 t
                              
                              
                                 i
                                 ,
                                 r
                              
                           
                           =
                           0
                        
                      for all 
                        
                           i
                           ,
                           j
                           ∈
                           N
                        
                      and 
                        
                           r
                           ∈
                           R
                        
                     . Consequently, the Price of Stability for facility location games induced by basic or separable protocols is at least 
                        
                           
                              
                                 H
                              
                              
                                 n
                              
                           
                        
                     .

We now introduce Algorithm 1. The algorithm returns for every instance 
                        
                           (
                           N
                           ,
                           R
                           ,
                           Σ
                           ,
                           d
                           ,
                           c
                           ,
                           t
                           )
                        
                      and input profile Y a decharged profile X that costs no more than 
                        
                           
                              
                                 H
                              
                              
                                 n
                              
                           
                           ·
                           C
                           (
                           Y
                           )
                        
                     , as shown in the upcoming lemmas.
                        Algorithm 1
                        Find decharged profile X. 
                              
                                 
                                    
                                    
                                       
                                          
                                             Input: Facility location model 
                                                
                                                   (
                                                   N
                                                   ,
                                                   R
                                                   ,
                                                   Σ
                                                   ,
                                                   d
                                                   ,
                                                   c
                                                   ,
                                                   t
                                                   )
                                                
                                             , profile Y
                                          
                                       
                                       
                                          
                                             Output: Decharged profile X
                                          
                                       
                                       
                                          
                                             1: 
                                                
                                                   k
                                                   ←
                                                   1
                                                
                                              
                                             {step number}
                                       
                                       
                                          
                                             2: 
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ←
                                                   Y
                                                
                                              
                                             {starts with profile Y}
                                       
                                       
                                          
                                             3: while
                                             there are charged resources do
                                          
                                       
                                       
                                          
                                             4: select the most expensive charged resource 
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ←
                                                   arg
                                                   max
                                                   {
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   :
                                                   r
                                                   ∈
                                                   R
                                                   
                                                   is
                                                   
                                                   charged
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                             5: 
                                             if 
                                             (D1) not fulfilled by all players on 
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                              
                                             then 
                                             {case called Transp}
                                       
                                       
                                          
                                             6: select such a player 
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                              with 
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             7: 
                                             else if some player on 
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                              was moved before then 
                                             {case called Shuffle}
                                       
                                       
                                          
                                             8: select player 
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                              that was moved last
                                          
                                       
                                       
                                          
                                             9: 
                                             else
                                             {case called Kickoff}
                                       
                                       
                                          10: select player who is willing to pay the least
                                       
                                       
                                          11: 
                                             
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ←
                                                   arg
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                         ,
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          12: 
                                             end if
                                          
                                       
                                       
                                          13: select cheapest (1,1)-exchange 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ←
                                                   arg
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  +
                                                                  s
                                                                  -
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  ∈
                                                                  
                                                                     
                                                                        Σ
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              i
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   s
                                                   -
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         -
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         i
                                                         ,
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          14: execute (1,1)-exchange 
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   ←
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         -
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          15: iterate 
                                                
                                                   k
                                                   ←
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          16: end
                                             
                                             while
                                          
                                       
                                       
                                          17: Return 
                                             
                                                
                                                   X
                                                   ←
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The algorithm iteratively moves players away from charged resources. If there is a player that is not even willing to pay her delay (case called Transp, lines 5–6), this player is immediately moved away. Otherwise, if there are players that have been moved before (case called Shuffle, lines 7–8) these players are moved in a last-in-first-out order. Finally, if all players are willing to pay a non-negative cost share and non of them have been moved before (case called Kickoff, lines 9–11), the one who is willing to pay the least is moved. Each time, the selected player is moved to the best available (1,1)-exchange (line 14). To show that the algorithm works as desired, we prove two lemmas: First, we show that the algorithm terminates, then we deal with the cost of profile X.
                        Lemma 4.2
                        
                           Algorithm 
                           1 
                           terminates.

For the proof, we adhere to the interpretation of each player i scheduling 
                              
                                 |
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                    
                                 
                                 |
                              
                            jobs on the resources. We fix a player and follow one of his jobs over the course of the algorithm. The job can be moved at most once by a Kickoff, afterwards multiple times by Transp and Shuffle moves. We show that these moves strictly decrease the cost of the job independent of what happens in between the moves. More precisely, if a job of player i is moved in iteration k of the algorithm to resource 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                              
                            and stays there until iteration l (i.e., 
                              
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       r
                                    
                                    
                                       l
                                    
                                 
                              
                           ) when it is moved to resource 
                              
                                 
                                    
                                       s
                                    
                                    
                                       l
                                    
                                 
                              
                           , we show that 
                              
                                 
                                    
                                       c
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 >
                                 
                                    
                                       c
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       l
                                       +
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                              
                           . Since there are only finitely many values for the cost of the job, this proves that the algorithm terminates.

If the move in iteration l is a Transp move, then the cost of the delay 
                              
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                              
                            is greater than the cheapest (1,1)-exchange and we have
                              
                                 (4)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    >
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          l
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          l
                                          +
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           If on the other hand the move in iteration l is a Shuffle move, the last-in-first-out scheme of Shuffles ensures that 
                              
                                 
                                    
                                       N
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                                 ⊇
                                 
                                    
                                       N
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       l
                                    
                                 
                                 )
                              
                            and hence
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                                ⩾
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      l
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                >
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Δ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               l
                                                            
                                                         
                                                         )
                                                         -
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               j
                                                               ,
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     l
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    ⩾
                                    
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          l
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          l
                                          +
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                l
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           When the algorithm does a Shuffle on resource 
                              
                                 
                                    
                                       r
                                    
                                    
                                       l
                                    
                                 
                              
                           , all users of the resource fulfill (D1) (otherwise a Transp would be done), but the resource does not fulfill (D2) (otherwise it would be decharged and hence be disregarded by the algorithm). Not fulfilling (D2) leads to (5) and since every user fulfills (D1) all summands in (5) are nonnegative, which leads to (6).□


                           Profile X returned by Algorithm 
                           1 
                           has at most 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                              
                            
                           times the cost of the input profile Y.

Throughout the proof of this claim, we regard the set 
                              
                                 Q
                                 ≔
                                 {
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 }
                              
                            of all jobs instead of the players they belong to. We denote the player to which a job q belongs by 
                              
                                 i
                                 (
                                 q
                                 )
                              
                            and the resource on which job q is scheduled in profile Y by 
                              
                                 y
                                 (
                                 q
                                 )
                              
                           . For ease of exposition, we often use jobs q interchangeably with 
                              
                                 i
                                 (
                                 q
                                 )
                              
                           , e.g. 
                              
                                 
                                    
                                       t
                                    
                                    
                                       q
                                       ,
                                       r
                                    
                                 
                              
                            as a shorthand for 
                              
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       (
                                       q
                                       )
                                       ,
                                       r
                                    
                                 
                              
                           . If k is the iteration of the algorithm in which q is first moved by the algorithm, we define 
                              
                                 p
                                 (
                                 q
                                 )
                                 ≔
                                 |
                                 
                                    
                                       N
                                    
                                    
                                       y
                                       (
                                       q
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 |
                              
                            to be the number of players on 
                              
                                 y
                                 (
                                 q
                                 )
                              
                            in 
                              
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                              
                           . This first move can either be a Transp or a Kickoff. For a Transp, we have already seen in (4) that 
                              
                                 
                                    
                                       c
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       q
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 <
                                 
                                    
                                       t
                                    
                                    
                                       q
                                       ,
                                       y
                                       (
                                       q
                                       )
                                    
                                 
                              
                           . If the first move is a Kickoff, then there are no foreign players on 
                              
                                 y
                                 (
                                 q
                                 )
                              
                           , hence 
                              
                                 
                                    
                                       N
                                    
                                    
                                       y
                                       (
                                       q
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ⊆
                                 
                                    
                                       N
                                    
                                    
                                       y
                                       (
                                       q
                                       )
                                    
                                 
                                 (
                                 Y
                                 )
                              
                            and we have
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                      (
                                                      q
                                                      )
                                                   
                                                
                                                (
                                                Y
                                                )
                                                ⩾
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      y
                                                      (
                                                      q
                                                      )
                                                   
                                                
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                >
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               y
                                                               (
                                                               q
                                                               )
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Δ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               y
                                                               (
                                                               q
                                                               )
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                         -
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               j
                                                               ,
                                                               y
                                                               (
                                                               q
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    ⩾
                                    
                                    p
                                    (
                                    q
                                    )
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   q
                                                
                                                
                                                   y
                                                   (
                                                   q
                                                   )
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   q
                                                   ,
                                                   y
                                                   (
                                                   q
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    =
                                    p
                                    (
                                    q
                                    )
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   q
                                                   ,
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   q
                                                   ,
                                                   y
                                                   (
                                                   q
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        


                           (7) stems like (5) from the fact that in a Kickoff, the resource 
                              
                                 y
                                 (
                                 q
                                 )
                              
                            does not fulfill (D2). Since all summands are positive (like in (5)) and the summand corresponding to job q is the smallest of the 
                              
                                 p
                                 (
                                 q
                                 )
                              
                            summands (see line 11 of the algorithm), we have inequality (8).

Altogether, the first time a job is moved by the algorithm, we have
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          1
                                       
                                       
                                          p
                                          (
                                          q
                                          )
                                       
                                    
                                    ·
                                    
                                       
                                          c
                                       
                                       
                                          y
                                          (
                                          q
                                          )
                                       
                                    
                                    (
                                    Y
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          y
                                          (
                                          q
                                          )
                                       
                                    
                                 
                              
                           regardless of whether this move is a Kickoff or a Transp. Further Transp and Shuffle moves only reduce this quantity, hence for every further iteration 
                              
                                 
                                    
                                       k
                                    
                                    
                                       ¯
                                    
                                 
                              
                            of the algorithm where job q is on resource 
                              
                                 
                                    
                                       r
                                    
                                    
                                       ¯
                                    
                                 
                              
                            and no job has been moved there after him, we have
                              
                                 (9)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          1
                                       
                                       
                                          p
                                          (
                                          q
                                          )
                                       
                                    
                                    ·
                                    
                                       
                                          c
                                       
                                       
                                          y
                                          (
                                          q
                                          )
                                       
                                    
                                    (
                                    Y
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          y
                                          (
                                          q
                                          )
                                       
                                    
                                    .
                                 
                              
                           Particularly, for resources where jobs have been moved by the algorithm, the cost in the final profile X returned by the algorithm is determined by the last job that was moved to the resource in the sense of (9). In the following, we estimate the cost of such resources by summing up (9) over all jobs on the resource X. For resources where no job was moved, the cost is no greater than in the original profile Y. Thus,
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                C
                                                (
                                                X
                                                )
                                                =
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  jobs moved to
                                                                  
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                         +
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  q
                                                                  ∈
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  X
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               q
                                                               ,
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  no jobs moved to
                                                                  
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                         +
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  q
                                                                  ∈
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  X
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               q
                                                               ,
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ⩽
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  jobs moved to
                                                               
                                                            
                                                         
                                                         
                                                         r
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               p
                                                               (
                                                               q
                                                               )
                                                            
                                                         
                                                         ·
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               y
                                                               (
                                                               q
                                                               )
                                                            
                                                         
                                                         (
                                                         Y
                                                         )
                                                         +
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               q
                                                               ,
                                                               y
                                                               (
                                                               q
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  no jobs moved to
                                                                  
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         Y
                                                         )
                                                         +
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  q
                                                                  ∈
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  X
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               q
                                                               ,
                                                               y
                                                               (
                                                               q
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ⩽
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         r
                                                         ∈
                                                         R
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                                  ∈
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  Y
                                                                  )
                                                               
                                                               
                                                                  q
                                                                  
                                                                  moved
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      p
                                                      (
                                                      q
                                                      )
                                                   
                                                
                                                ·
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                Y
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  jobs remained on
                                                                  
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                Y
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         all
                                                         jobs
                                                         
                                                         q
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      q
                                                      ,
                                                      y
                                                      (
                                                      q
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    ⩽
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          n
                                       
                                    
                                    ·
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Y
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             all jobs
                                             
                                             q
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          y
                                          (
                                          q
                                          )
                                       
                                    
                                    ⩽
                                    
                                       
                                          H
                                       
                                       
                                          n
                                       
                                    
                                    ·
                                    C
                                    (
                                    Y
                                    )
                                    .
                                 
                              
                           In (10) we change the order of summation: before we grouped the jobs by the resource they are on in X, in (10) they are grouped by the resource they are on in Y. For each resource r the 
                              
                                 
                                    
                                       1
                                    
                                    
                                       p
                                       (
                                       q
                                       )
                                    
                                 
                              
                            fractions sum up to at most 
                              
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                              
                            or, if jobs remained on r, to at most 
                              
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                                 -
                                 1
                              
                            by definition of 
                              
                                 p
                                 (
                                 q
                                 )
                              
                           , hence (11).□


                           Every facility location model has a decharged strategy profile X at cost 
                           
                              
                                 C
                                 (
                                 X
                                 )
                                 ⩽
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                                 ·
                                 C
                                 (
                                 Y
                                 )
                              
                            
                           where Y is the cost-optimal strategy profile.

Follows from Lemmas 4.2 and 4.3
                           □

We now use the algorithm together with our insights about X-enforcing cost shares to construct a protocol that matches our lower bound for the Price of Anarchy. For this, we assume without loss of generality that players are indexed by non-increasing weights 
                        
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ⩾
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ⩾
                           …
                           ⩾
                           
                              
                                 d
                              
                              
                                 n
                              
                           
                        
                     .
                        Definition 4.5
                        Enforcing protocol


                        For any facility location model 
                              
                                 (
                                 N
                                 ,
                                 R
                                 ,
                                 Σ
                                 ,
                                 d
                                 ,
                                 t
                                 ,
                                 c
                                 )
                              
                           , the Enforcing Protocol runs Algorithm 1 with a cost-optimal profile Y as input to obtain a decharged profile X with cost 
                              
                                 C
                                 (
                                 X
                                 )
                                 ⩽
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                                 ·
                                 C
                                 (
                                 Y
                                 )
                              
                           . Then, define for any profile Z and resource r the set of foreign players 
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Z
                                 )
                                 ≔
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Z
                                 )
                                 ⧹
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 X
                                 )
                              
                            and assign the cost share functions
                              
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    ≔
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Δ
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            X
                                                            )
                                                            -
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  r
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  ∈
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  X
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  Δ
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            X
                                                            )
                                                            -
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  j
                                                                  ,
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      =
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      
                                                      and
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      >
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                      
                                                      and
                                                      
                                                      i
                                                      =
                                                      
                                                         min
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      =
                                                      ∅
                                                      ,
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      ⊂
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      
                                                      and
                                                      
                                                      i
                                                      =
                                                      
                                                         min
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      else
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

One can easily verify that the protocol is budget-balanced and separable. The cost shares are X-enforcing and hence the Price of Stability for the Enforcing Protocol is 
                        
                           
                              
                                 H
                              
                              
                                 n
                              
                           
                        
                     .
                        Theorem 4.6
                        
                           The Price of Stability for facility location games induced by basic and separable protocols is 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                              
                           .

The lower bound is given by Lemma 4.1. One can easily verify that the Enforcing Protocol is budget-balanced and separable. Furthermore, it is X-enforcing for a decharged profile X returned by Algorithm 1 with 
                              
                                 C
                                 (
                                 X
                                 )
                                 ⩽
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                                 ·
                                 C
                                 (
                                 Y
                                 )
                              
                            and hence the Price of Stability for the Enforcing Protocol is 
                              
                                 
                                    
                                       H
                                    
                                    
                                       n
                                    
                                 
                              
                           . □

We now turn to the case of finding an optimal protocol for minimizing the resulting price of anarchy. We will prove that the Enforcing Protocol induces a price of anarchy of at most n. We further show that no basic protocol can have a price of anarchy below n, thus, the Enforcing Protocol is optimal.
                        Lemma 5.1
                        
                           The Price of Anarchy for facility location games with basic or separable cost sharing protocols is at least n.

Consider the facility location model 
                              
                                 (
                                 N
                                 ,
                                 R
                                 ,
                                 Σ
                                 ,
                                 d
                                 ,
                                 c
                                 ,
                                 t
                                 )
                              
                            with n players 
                              
                                 i
                                 ∈
                                 N
                              
                           , resource set 
                              
                                 R
                                 =
                                 {
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                           , strategy spaces 
                              
                                 
                                    
                                       Σ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 {
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 }
                              
                           , weights 
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                              
                            for all 
                              
                                 i
                                 ∈
                                 N
                              
                           , delays 
                              
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       ,
                                       r
                                    
                                 
                                 =
                                 0
                              
                            for all 
                              
                                 i
                                 ∈
                                 N
                                 ,
                                 r
                                 ∈
                                 R
                              
                            and constant resource cost 
                              
                                 
                                    
                                       c
                                    
                                    
                                       r
                                    
                                 
                                 ≡
                                 1
                              
                            independent of the load for all 
                              
                                 r
                                 ∈
                                 R
                              
                           . Here, the optimal profile 
                              
                                 Y
                                 =
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                            hast cost 
                              
                                 C
                                 (
                                 Y
                                 )
                                 =
                                 1
                              
                           . However, the profile 
                              
                                 X
                                 =
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       r
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            with cost 
                              
                                 C
                                 (
                                 X
                                 )
                                 =
                                 n
                              
                            is a Nash equilibrium under any protocol that satisfies budget-balance.□

Note that for this lower bound a singleton model without delays is sufficient. It can equivalently be constructed with a symmetric singleton model (
                        
                           
                              
                                 Σ
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 Σ
                              
                              
                                 j
                              
                           
                        
                      for all 
                        
                           i
                           ,
                           j
                           ∈
                           N
                        
                     ) with delays. However, for symmetric singleton games without delays the Price of Anarchy has been shown to be 
                        
                           
                              
                                 H
                              
                              
                                 n
                              
                           
                        
                      (von Falkenhausen & Harks, 2013).
                        Lemma 5.2
                        
                           The Price of Anarchy for facility location games with basic or separable protocols is at most n.

We only give a sketch of the proof as it is largely similar to the one found in von Falkenhausen and Harks (2013). A complete version can be found in the appendix.

Let 
                              
                                 (
                                 N
                                 ,
                                 R
                                 ,
                                 Σ
                                 ,
                                 d
                                 ,
                                 c
                                 ,
                                 t
                                 )
                              
                            be a facility location model. Let 
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       r
                                    
                                 
                              
                            for 
                              
                                 i
                                 ∈
                                 N
                                 ,
                                 r
                                 ∈
                                 R
                              
                            be the cost share functions assigned by the Enforcing Protocol and let X be the decharged profile returned by Algorithm 1 for the protocol, using some optimal profile Y as input. We show 
                              
                                 C
                                 (
                                 Z
                                 )
                                 ⩽
                                 n
                                 ·
                                 C
                                 (
                                 Y
                                 )
                              
                            for any pure Nash equilibrium Z. In a first step, we link the cost in Z to the cost in profiles 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       -
                                       i
                                    
                                 
                                 )
                              
                            via the Nash property. The major challenge of the proof is then to estimate the cost of these profiles in relation to the cost of Y. To this end we employ properties of X found in the analysis of the algorithm in the previous section.□

We now restrict the set of cost functions to be either concave or convex. Concave functions are frequently used to model economies of scale, that is, situations in which marginal costs are decreasing. Examples include network design games, where cost functions are modeled by fixed or concave costs, cf. (Anshelevich et al., 2008; Bilò, Fanelli, Flammini, Melideo, & Moscardelli, 2010; Chekuri, Chuzhoy, Lewin-Eytan, Naor, & Orda, 2006; Chen & Roughgarden, 2009). On the other hand, convex costs are used to model the sharp increase of costs if resources are scarce or if there are hard capacities on the amount of resources available. For instance in telecommunication networks, relevant cost functions are the so-called 
                        
                           M
                           /
                           M
                           /
                           1
                        
                     -delay functions (see Bertsekas & Gallagher, 1992; Orda, Rom, & Shimkin, 1993). These are convex functions of the form 
                        
                           
                              
                                 c
                              
                              
                                 a
                              
                           
                           (
                           x
                           )
                           =
                           1
                           /
                           (
                           
                              
                                 u
                              
                              
                                 a
                              
                           
                           -
                           x
                           )
                        
                     , where 
                        
                           
                              
                                 u
                              
                              
                                 a
                              
                           
                        
                      represents the physical capacity of arc a.

For concave cost functions, we now show that for facility location games, an optimal strategy profile is decharged, thus, the price of stability is one in this case.
                           Theorem 6.1
                           
                              The price of stability of facility location games with concave costs is one.

We prove that any socially optimal configuration profile 
                                 
                                    X
                                    ∈
                                    Σ
                                 
                               satisfies (D1) and (D2) and, thus, by Theorem 3.5 the enforcing protocol induces X as a pure Nash equilibrium. Assume that X does not satisfy (D1). Then we can simply reassign player i to her cheapest alternative and strictly reduce the total cost, which is a contradiction to our assumption that X is socially optimal.

Assume that X does not satisfy (D2). Hence, there is a resource 
                                 
                                    r
                                    ∈
                                    R
                                 
                               with
                                 
                                    (12)
                                    
                                       
                                          
                                             c
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       >
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                       
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       -
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             ,
                                             r
                                          
                                       
                                       .
                                    
                                 
                              We now construct a strategy profile Z with 
                                 
                                    C
                                    (
                                    Z
                                    )
                                    <
                                    C
                                    (
                                    X
                                    )
                                 
                              , showing a contradiction. To this end, for each player 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              , let
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       ≔
                                       
                                          
                                             argmin
                                          
                                          
                                             
                                                
                                                   
                                                      s
                                                      ∈
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      s
                                                      -
                                                      r
                                                      ∈
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                s
                                                -
                                                r
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      -
                                                      i
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              be the cheapest alternative to r in X. Let 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ≔
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    r
                                 
                               be the strategy where i switches from r to 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                 
                              , such that 
                                 
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              . For 
                                 
                                    i
                                    
                                    ∉
                                    
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              , let 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                       
                                    
                                    ≔
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                 
                              .

Inequality (12) implies that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    
                                    ≠
                                    
                                    r
                                 
                               for all 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                               and hence that 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    ∅
                                 
                              , i.e. 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    0
                                 
                              . Resources 
                                 
                                    s
                                    
                                    ≠
                                    
                                    r
                                 
                               either have the same users in Z as in X, i.e. 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              , or they have users 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    Z
                                    )
                                    ⧹
                                    
                                       
                                          N
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                 
                               that have switched from r to s. In the latter case, as the cost functions are concave,
                                 
                                    (13)
                                    
                                       
                                          
                                             c
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       Z
                                       )
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                Z
                                                )
                                                ⧹
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             s
                                          
                                       
                                       (
                                       
                                          
                                             Z
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             -
                                             i
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                Z
                                                )
                                                ⧹
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                                -
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              Combining these observations, we conclude
                                 
                                    
                                       C
                                       (
                                       Z
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                         ∈
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         =
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                Z
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                         ∈
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         ⊃
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                Z
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ⩽
                                             
                                             
                                                (
                                                13
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                         ∈
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         =
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                X
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                       
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                         ∈
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         ⊃
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             ,
                                             s
                                          
                                       
                                       
                                          
                                             
                                                <
                                             
                                             
                                                
                                                   (12)
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                         ∈
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         ⊇
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      s
                                                   
                                                
                                                (
                                                X
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               s
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             ,
                                             r
                                          
                                       
                                       =
                                       C
                                       (
                                       X
                                       )
                                       .
                                    
                                 
                              This implies that X is not an optimal strategy profile, a contradiction.□

When cost functions are convex, there is a universally optimal protocol with a price of anarchy equal to one. We only require that the cost functions are non-negative, non-decreasing and the per-unit costs 
                           
                              
                                 
                                    c
                                    (
                                    ℓ
                                    (
                                    Z
                                    )
                                    )
                                 
                                 
                                    ℓ
                                    (
                                    Z
                                    )
                                 
                              
                           
                         are non-decreasing with respect to the load 
                           
                              ℓ
                              (
                              Z
                              )
                           
                        . Such functions are quite rich and contain non-negative, non-decreasing and convex functions.

We introduce the opt-enforcing protocol for which we prove a price of anarchy of 1. The intuition behind this protocol is similar to the enforcing protocols presented before: make all undesired outcomes unstable by charging some player a very high price.
                           Definition 6.2
                           opt-enforcing protocol


                           For a given model 
                                 
                                    (
                                    N
                                    ,
                                    R
                                    ,
                                    Σ
                                    ,
                                    d
                                    ,
                                    c
                                    ,
                                    t
                                    )
                                 
                               the opt-enforcing protocol takes as input an optimal outcome Y. We again denote for any outcome z and resource r the set of foreign players on r by 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    {
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    ⧹
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Y
                                    )
                                    }
                                 
                              . Then, the opt-enforcing protocol assigns the cost sharing methods
                                 
                                    (14)
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             ,
                                             r
                                          
                                       
                                       (
                                       Z
                                       )
                                       ≔
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ·
                                                         
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               (
                                                               Z
                                                               )
                                                            
                                                            
                                                               
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               (
                                                               Z
                                                               )
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         r
                                                         ∈
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         =
                                                         ∅
                                                         ,
                                                      
                                                      
                                                         (
                                                         a
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         r
                                                         ∈
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         
                                                         ≠
                                                         
                                                         ∅
                                                         
                                                         and
                                                         
                                                         i
                                                         =
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         ,
                                                      
                                                      
                                                         (
                                                         b
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                      
                                                         else
                                                         .
                                                      
                                                      
                                                         (
                                                         c
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Under the opt-enforcing protocol, the players share the cost proportional to their demands on all resources without foreign players. On resources with foreign players, the foreign player with the smallest index pays the entire cost of the resource.
                           Theorem 6.3
                           
                              The opt-enforcing protocol is separable and has a price of anarchy of 1.
                           

Budget balance and separability are clear from the definition of the protocol. For stability it can easily be verified that for an instance 
                                 
                                    (
                                    N
                                    ,
                                    R
                                    ,
                                    Σ
                                    ,
                                    d
                                    ,
                                    c
                                    ,
                                    t
                                    )
                                 
                               the optimal outcome Y is a Nash equilibrium. We only prove the bound on the price of anarchy, showing that all Nash equilibria X have the same cost as a socially optimal profile Y, i.e. for every player i
                              
                                 
                                    (15)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                Y
                                                )
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              By definition of Nash equilibria,
                                 
                                    (16)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      -
                                                      i
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              Two cases are to be considered for every resource 
                                 
                                    r
                                    ∈
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                 
                              : either it hosts a nonempty set 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    X
                                    )
                                 
                               of foreign players or 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    X
                                    )
                                    =
                                    ∅
                                 
                              . If there are foreign players on r, then one of them will pay for the entire cost there and hence(14c) gives 
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    =
                                    0
                                 
                               (note that by Definition 6.2 
                              
                                 
                                    i
                                    
                                    ∉
                                    
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                 
                              ). If there are no foreign players on r, then 
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          ℓ
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Y
                                    )
                                 
                               yields
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   X
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                          
                                       
                                       ,
                                    
                                 
                              because the cost per unit is non-decreasing. Plugging this into (14a) we have 
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    Y
                                    )
                                 
                              . With 
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          X
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    (
                                    Y
                                    )
                                 
                               in both cases for all resources 
                                 
                                    r
                                    ∈
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                 
                              ,
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      -
                                                      i
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                ∈
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                                (
                                                Y
                                                )
                                                +
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              which combined with (16) yields (15).□

Our protocols introduced in the previous sections involve decharged profiles which in turn rely on the computation of optimal profiles which are generally NP-hard to compute. A natural question is whether there are different approaches that allow to compute optimal cost shares or cost shares with good approximation guarantees in polynomial time (see also the open question in von Falkenhausen & Harks (2013)[Section 5.1]). We will answer this question negatively by showing that the problem of computing optimal cost shares is strongly NP-hard and not approximable by any constant factor even for instances with unweighted players, zero delays and singleton strategies. In light of this hardness we restrict our model to unweighted players, zero delays and singleton strategies, and switch our objective: previously we looked for cost shares such that the best/worst Nash equilibrium is a good approximation of the social optimum, now we ask for polynomial time computable cost shares that approximate the optimal cost shares in terms of cost of the best/worst Nash equilibrium.

Let I be an instance of a matroid facility location game and 
                           
                              Ξ
                              (
                              I
                              )
                           
                         the set of possible cost shares for I. We investigate the computational complexity of the following two optimization problems
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          ξ
                                          ∈
                                          Ξ
                                          (
                                          I
                                          )
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          min
                                       
                                       
                                          X
                                          ∈
                                          P
                                          (
                                          I
                                          ,
                                          ξ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       C
                                       (
                                       X
                                       )
                                    
                                    
                                       C
                                       (
                                       Y
                                       )
                                    
                                 
                                 
                                 (
                                 Best
                                 
                                 
                                 Nash
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          ξ
                                          ∈
                                          Ξ
                                          (
                                          I
                                          )
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          X
                                          ∈
                                          P
                                          (
                                          I
                                          ,
                                          ξ
                                          )
                                       
                                    
                                 
                                 
                                    
                                       C
                                       (
                                       X
                                       )
                                    
                                    
                                       C
                                       (
                                       Y
                                       )
                                    
                                 
                                 ,
                                 
                                 (
                                 Worst
                                 
                                 
                                 Nash
                                 
                                 )
                              
                           
                        where 
                           
                              P
                              (
                              I
                              ,
                              ξ
                              )
                           
                         denotes the set of Nash equilibria of the game induced by I and 
                           
                              ξ
                              ,
                              Y
                           
                         is some optimal strategy profile.
                           Theorem 7.1
                           
                              Problem Best Nash 
                              is strongly NP-complete and there are no 
                              
                                 
                                    c
                                    log
                                    n
                                 
                               
                              approximation algorithms for any 
                              
                                 
                                    c
                                    <
                                    1
                                 
                              , unless 
                              
                                 
                                    P
                                    =
                                    NP
                                 
                              . This holds even for instances with unweighted players, zero delays, singleton strategies and unit fixed costs.

By Corollary 3.5, Problem Best Nash can be reformulated as
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                X
                                                ∈
                                                Σ
                                             
                                          
                                       
                                       C
                                       (
                                       X
                                       )
                                       
                                       s
                                       .
                                       t
                                       .
                                       
                                       X
                                       
                                       is decharged.
                                    
                                 
                              Now, given any 
                                 
                                    X
                                    ∈
                                    Σ
                                 
                              , we can check in polynomial time whether X is feasible (i.e., it fulfills (D1) and (D2)) and whether 
                                 
                                    C
                                    (
                                    X
                                    )
                                    =
                                    k
                                 
                               for some given k, thus, Best Nash is in NP.

We prove inapproximability by providing an approximation preserving reduction from Hitting Set. An instance of Hitting Set consists of a collection 
                                 
                                    C
                                 
                               of subsets of a finite set of elements E. A hitting set for 
                                 
                                    C
                                 
                               is a subset 
                                 
                                    S
                                    ⊆
                                    E
                                 
                               such that S contains at least one element from each subset in 
                                 
                                    C
                                 
                              . The goal is to minimize the cardinality of the hitting set.

Given an instance of Hitting Set, we create an instance of Best Nash by identifying 
                                 
                                    C
                                 
                               with 
                                 
                                    Σ
                                    ,
                                    E
                                 
                               with R and assuming fixed unit costs on the resources and no delays.
                                 Claim 7.2
                                 
                                    There is a hitting set of cardinality less or equal to k if and only if there is a decharged profile with cost less or equal k.
                                 

In the constructed cost sharing instance, every strategy profile is decharged: with no delays (D1) is always fulfilled, and with fixed unit resource costs (D2), too. Given a strategy profile, the used resources form a hitting set and the cost of the profile is equal to the cardinality of the set. Given a hitting set, a strategy profile can be constructed by assigning each player i to one of the resources in 
                                       
                                          
                                             
                                                Σ
                                             
                                             
                                                i
                                             
                                          
                                       
                                     that is in the hitting set.□

The proof follows now from the above claim and the fact that Hitting Set is equivalent to the Set Cover problem Ausiello, D’Atri, and Protasi (1980) which is known not to be approximable within 
                                 
                                    c
                                    log
                                    n
                                 
                               for any 
                                 
                                    c
                                    <
                                    1
                                 
                               unless 
                                 
                                    P
                                    =
                                    NP
                                 
                               
                              Raz and Safra (1997).□

We now prove an inapproximability result for computing cost shares minimizing the cost of the worst Nash equilibrium.
                           Theorem 7.3
                           
                              Problem Worst Nash 
                              is strongly NP-hard and there are no 
                              
                                 
                                    c
                                    log
                                    n
                                 
                               
                              approximation algorithms for any 
                              
                                 
                                    c
                                    <
                                    1
                                 
                               
                              unless 
                              
                                 
                                    P
                                    =
                                    NP
                                 
                              . This holds even for instances with unweighted players, zero delays, singleton strategies and unit fixed costs.

We again reduce from Hitting Set. Given an instance of Hitting Set, we construct a cost sharing game like above and add two more players denoted player a and player b. We set 
                                 
                                    
                                       
                                          Σ
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       
                                          Σ
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    R
                                 
                              .□


                              There is a hitting set of cardinality less or equal to k if and only if
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                ξ
                                                ∈
                                                Ξ
                                                (
                                                I
                                                )
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                max
                                             
                                             
                                                X
                                                ∈
                                                P
                                                (
                                                I
                                                ,
                                                ξ
                                                )
                                             
                                          
                                       
                                       
                                       C
                                       (
                                       X
                                       )
                                       ⩽
                                       k
                                       .
                                    
                                 
                              
                           

For the direction 
                                 
                                    ⇐
                                 
                              , observe that if there are cost shares 
                                 
                                    ξ
                                 
                               such that the most expensive PNE X has 
                                 
                                    C
                                    (
                                    X
                                    )
                                    ⩽
                                    k
                                 
                              , then the resources used in X form a hitting set of cardinality less than or equal to k. For the 
                                 
                                    ⇒
                                 
                               direction, given a hitting set of size at most k, we construct an assignment of players to resources that costs at most k and in which both a and b share a resource with other players. We call this profile X. We assign the following cost shares for all 
                                 
                                    r
                                    ∈
                                    R
                                 
                               and 
                                 
                                    Z
                                    ∈
                                    Σ
                                 
                              :
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         a
                                                         ,
                                                         r
                                                      
                                                   
                                                   (
                                                   Z
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     =
                                                                     {
                                                                     a
                                                                     }
                                                                     or
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     =
                                                                     {
                                                                     a
                                                                     ,
                                                                     b
                                                                     }
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           1
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     a
                                                                     ∈
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     
                                                                     and
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ⊆
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     X
                                                                     )
                                                                     ∪
                                                                     {
                                                                     a
                                                                     ,
                                                                     b
                                                                     }
                                                                     
                                                                     and
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ¬
                                                                     ⊆
                                                                     {
                                                                     a
                                                                     ,
                                                                     b
                                                                     }
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     a
                                                                     ∈
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     
                                                                     and
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ¬
                                                                     ⊆
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     X
                                                                     )
                                                                     ∪
                                                                     {
                                                                     a
                                                                     ,
                                                                     b
                                                                     }
                                                                     
                                                                     and
                                                                     
                                                                     b
                                                                     
                                                                     ∉
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     1
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     a
                                                                     ∈
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     
                                                                     and
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ¬
                                                                     ⊆
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     X
                                                                     )
                                                                     ∪
                                                                     {
                                                                     a
                                                                     ,
                                                                     b
                                                                     }
                                                                     
                                                                     and
                                                                     
                                                                     b
                                                                     ∈
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     a
                                                                     
                                                                     ∉
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ,
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         b
                                                         ,
                                                         r
                                                      
                                                   
                                                   (
                                                   Z
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     b
                                                                     ∈
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     
                                                                     and
                                                                     
                                                                     a
                                                                     
                                                                     ∉
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                     ,
                                                                  
                                                                  
                                                                     else
                                                                     ,
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   and
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   i
                                                   
                                                   ≠
                                                   
                                                   a
                                                   ,
                                                   b
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         i
                                                         ,
                                                         r
                                                      
                                                   
                                                   (
                                                   Z
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     -
                                                                     
                                                                        
                                                                           ξ
                                                                        
                                                                        
                                                                           a
                                                                           ,
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     -
                                                                     
                                                                        
                                                                           ξ
                                                                        
                                                                        
                                                                           b
                                                                           ,
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     i
                                                                     =
                                                                     
                                                                        min
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ⧹
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     X
                                                                     )
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     1
                                                                     -
                                                                     
                                                                        
                                                                           ξ
                                                                        
                                                                        
                                                                           a
                                                                           ,
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     -
                                                                     
                                                                        
                                                                           ξ
                                                                        
                                                                        
                                                                           b
                                                                           ,
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ,
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ⧹
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     X
                                                                     )
                                                                     =
                                                                     ∅
                                                                     
                                                                     and
                                                                     
                                                                     i
                                                                     =
                                                                     
                                                                        min
                                                                     
                                                                     
                                                                        
                                                                           N
                                                                        
                                                                        
                                                                           r
                                                                        
                                                                     
                                                                     (
                                                                     Z
                                                                     )
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     0
                                                                     ,
                                                                  
                                                                  
                                                                     else
                                                                     .
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              The profile X is a PNE under these cost shares, as player a pays 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                               and would pay either 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                               or 1 on any other resource, player b pays 0 and all other players pay 1 or less and would pay 1 if they switched.

For any profile 
                                 
                                    Z
                                    
                                    ≠
                                    
                                    X
                                 
                               with 
                                 
                                    C
                                    (
                                    Z
                                    )
                                    >
                                    C
                                    (
                                    X
                                    )
                                 
                              , there is some resource r with 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    =
                                    ∅
                                 
                               and 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    
                                    ≠
                                    
                                    ∅
                                 
                              . We show that such a profile cannot be an equilibrium. For an equilibrium, the definition of the cost shares for player b implies that 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          Z
                                       
                                       
                                          a
                                       
                                    
                                 
                              , as otherwise player b could immediately reduce her cost by switching to 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          a
                                       
                                    
                                 
                              . We, hence, assume from now on 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          Z
                                       
                                       
                                          a
                                       
                                    
                                 
                              . If 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    {
                                    a
                                    ,
                                    b
                                    }
                                 
                              , then player a has cost 1 and, if 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                a
                                             
                                          
                                       
                                    
                                    (
                                    Z
                                    )
                                    
                                    ≠
                                    
                                    ∅
                                 
                               could reduce her cost to 
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                               by switching to 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          a
                                       
                                    
                                 
                               or, in case 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                a
                                             
                                          
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    ∅
                                 
                              , could reduce her cost to 0 by switching to some other resource s with 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    Z
                                    )
                                    ¬
                                    ⊆
                                    
                                       
                                          N
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              . If 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    
                                    ≠
                                    
                                    {
                                    a
                                    ,
                                    b
                                    }
                                 
                              , then there are other players than a and b using r as 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    
                                    ≠
                                    
                                    ∅
                                 
                               and 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          Z
                                       
                                       
                                          a
                                       
                                    
                                 
                              . Hence, either 
                                 
                                    {
                                    a
                                    ,
                                    b
                                    }
                                    ∩
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    ∅
                                 
                               and player a could reduce her cost by switching to r, or 
                                 
                                    {
                                    a
                                    ,
                                    b
                                    }
                                    ⊂
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                 
                               and player a could reduce her cost by switching somewhere else as above – unless 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    ∅
                                 
                               for all 
                                 
                                    s
                                    
                                    ≠
                                    
                                    r
                                 
                              , in which case 
                                 
                                    C
                                    (
                                    Z
                                    )
                                    =
                                    1
                                 
                              , a contradiction to 
                                 
                                    C
                                    (
                                    Z
                                    )
                                    >
                                    C
                                    (
                                    X
                                    )
                                 
                              . Consequently, X with 
                                 
                                    C
                                    (
                                    X
                                    )
                                    ⩽
                                    k
                                 
                               is the most expensive PNE of the game.□

We have shown that it is computationally hard to find cost shares that approximate the cost of the optimal cost shares within a logarithmic factor in n. This hardness result even holds for instances with unweighted players, zero delays, singleton strategies and unit fixed costs. In light of this hardness even for this restricted class of problems, we study approximation algorithms for the case of unweighted players, zero delays and singleton strategies, still assuming general nondecreasing costs. Such instances are given as 
                           
                              I
                              =
                              (
                              N
                              ,
                              R
                              ,
                              Σ
                              ,
                              c
                              )
                           
                        , with 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                         and 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                    ,
                                    r
                                 
                              
                              =
                              0
                           
                         for all 
                           
                              i
                              ∈
                              N
                           
                         and 
                           
                              r
                              ∈
                              R
                           
                        . We present in the following an approximation algorithm that computes in polynomial time a decharged profile whose cost is bounded from above by 
                           
                              
                                 
                                    H
                                 
                                 
                                    n
                                 
                              
                           
                         times the cost of an optimal profile - matching the performance bound presented in Section 4.

For a given instance 
                           
                              I
                              =
                              (
                              N
                              ,
                              R
                              ,
                              Σ
                              ,
                              c
                              )
                           
                        , the algorithm starts with an empty strategy profile X and updates X as it iteratively assigns the n players to the resources in R. While the algorithm runs, let 
                           
                              
                                 
                                    n
                                 
                                 
                                    ¯
                                 
                              
                              (
                              X
                              )
                           
                         be the number of players not yet assigned to a resource and let 
                           
                              G
                              (
                              X
                              )
                           
                         be a directed graph representing the current allocation X. The graph has vertices for all players, all resources and additional source and sink vertices s and t. 
                           
                              G
                              (
                              X
                              )
                           
                         is bipartite with arcs according to the following rules:
                           
                              •
                              arc 
                                    
                                       (
                                       i
                                       ,
                                       r
                                       )
                                    
                                  from player i to resource r if 
                                    
                                       r
                                       ∈
                                       
                                          
                                             Σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              

arc 
                                    
                                       (
                                       r
                                       ,
                                       i
                                       )
                                    
                                  from resource r to player i if 
                                    
                                       r
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                    
                                 , i.e., i is assigned to r in X
                              

arc 
                                    
                                       (
                                       s
                                       ,
                                       i
                                       )
                                    
                                  if player i is not assigned to any resource in X.

All above arcs have cost 0 and capacity 1.
                           Algorithm 2
                           Compute semi-proportional cost shares 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: instance 
                                                   
                                                      I
                                                      =
                                                      (
                                                      N
                                                      ,
                                                      R
                                                      ,
                                                      Σ
                                                      ,
                                                      c
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Output: cost shares 
                                                   
                                                      ξ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1: start with empty profile X, no players assigned to resources
                                          
                                          
                                             
                                                2: while not all players N assigned to resources R 
                                                do
                                             
                                          
                                          
                                             
                                                3: compute 
                                                   
                                                      G
                                                      (
                                                      X
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                4: 
                                                for
                                                
                                                all combinations 
                                                   
                                                      r
                                                      ∈
                                                      R
                                                   
                                                 and 
                                                   
                                                      1
                                                      ⩽
                                                      v
                                                      ⩽
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                5: compute, if existent, an integer 
                                                   
                                                      s
                                                      ,
                                                      r
                                                   
                                                 flow f with flow value 
                                                   
                                                      v
                                                      (
                                                      f
                                                      )
                                                      =
                                                      v
                                                   
                                                .
                                          
                                          
                                             
                                                6: 
                                                end
                                                
                                                for
                                             
                                          
                                          
                                             
                                                7: from all combinations of r and 
                                                   
                                                      v
                                                      (
                                                      f
                                                      )
                                                   
                                                 for which a flow was found, choose the one with the lowest resulting cost-per-unit 
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            v
                                                            (
                                                            f
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               (
                                                               |
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               (
                                                               X
                                                               )
                                                               |
                                                               +
                                                               v
                                                               (
                                                               f
                                                               )
                                                               )
                                                               -
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               (
                                                               X
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                . For each 
                                                   
                                                      (
                                                      i
                                                      ,
                                                      r
                                                      )
                                                   
                                                 arc used in this flow, update X such that player i is assigned to resource r.
                                          
                                          
                                             
                                                8: end
                                                
                                                while
                                             
                                          
                                          
                                             
                                                9: assign cost shares for all 
                                                   
                                                      i
                                                      ∈
                                                      N
                                                   
                                                 and 
                                                   
                                                      Z
                                                      ∈
                                                      Σ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         (
                                                         Z
                                                         )
                                                         ≔
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             Z
                                                                                          
                                                                                          
                                                                                             i
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 (
                                                                                 Z
                                                                                 )
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       N
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             Z
                                                                                          
                                                                                          
                                                                                             i
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 (
                                                                                 Z
                                                                                 )
                                                                                 |
                                                                              
                                                                           
                                                                           
                                                                        
                                                                        
                                                                           ,
                                                                           if
                                                                           
                                                                              
                                                                                 N
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       Z
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           (
                                                                           Z
                                                                           )
                                                                           ⊆
                                                                           
                                                                              
                                                                                 N
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       Z
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           (
                                                                           X
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       c
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             Z
                                                                                          
                                                                                          
                                                                                             i
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 (
                                                                                 Z
                                                                                 )
                                                                              
                                                                              
                                                                                 |
                                                                                 
                                                                                    
                                                                                       N
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             Z
                                                                                          
                                                                                          
                                                                                             i
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 (
                                                                                 Z
                                                                                 )
                                                                                 ⧹
                                                                                 
                                                                                    
                                                                                       N
                                                                                    
                                                                                    
                                                                                       
                                                                                          
                                                                                             Z
                                                                                          
                                                                                          
                                                                                             i
                                                                                          
                                                                                       
                                                                                    
                                                                                 
                                                                                 (
                                                                                 X
                                                                                 )
                                                                                 |
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           ,
                                                                           if
                                                                           
                                                                           
                                                                              
                                                                                 N
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       Z
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           (
                                                                           Z
                                                                           )
                                                                           ¬
                                                                           ⊆
                                                                           
                                                                              
                                                                                 N
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       Z
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           (
                                                                           X
                                                                           )
                                                                           
                                                                           and
                                                                           
                                                                           i
                                                                           ∈
                                                                           
                                                                              
                                                                                 N
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       Z
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           (
                                                                           Z
                                                                           )
                                                                           ⧹
                                                                           
                                                                              
                                                                                 N
                                                                              
                                                                              
                                                                                 
                                                                                    
                                                                                       Z
                                                                                    
                                                                                    
                                                                                       i
                                                                                    
                                                                                 
                                                                              
                                                                           
                                                                           (
                                                                           X
                                                                           )
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           0
                                                                        
                                                                        
                                                                           ,
                                                                           otherwise
                                                                           .
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             10: Return 
                                                
                                                   
                                                      ξ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              Algorithm 
                              2 
                              computes in polynomial time cost shares that guarantee a price of stability of at most 
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          n
                                       
                                    
                                 
                               
                              and a price of anarchy of at most n.

We prove the theorem in four lemmas.□


                              The profile X used in the definition of the cost shares is a PNE.

We use a counter k to enumerate the iterations of the algorithm’s main while loop. Denote by 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                 
                               the profile at the beginning of iteration k and denote by 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                 
                               the selected flow. We observe that on each resource r, the sequence of the per-unit costs of the load increments is nondecreasing, that is, if in iteration k the load on r is increased and the next load increase on r is in iteration l, then
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                             |
                                             -
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             |
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   l
                                                   +
                                                   1
                                                
                                             
                                             )
                                             |
                                             -
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                             |
                                          
                                       
                                    
                                 
                              because otherwise Algorithm 2 had increased the load on r in iteration k directly to 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          l
                                          +
                                          1
                                       
                                    
                                    )
                                 
                               instead of 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              . Thus, if on resource r the last load increment was in iteration 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              , then the per unit cost of r in X, which is the average over all such increments, is no greater then the per unit cost of the increment in 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              . This in turn is no greater than the cost of adding one player to any other resource 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               in 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                               because otherwise the algorithm had increased the load on 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               instead of increasing it on r. Hence, for all 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                    ∈
                                    
                                       
                                          Σ
                                       
                                       
                                          i
                                       
                                    
                                 
                              ,
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       X
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             |
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             |
                                             -
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             )
                                             |
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             )
                                             |
                                             +
                                             1
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             )
                                             |
                                             )
                                          
                                          
                                             1
                                          
                                       
                                       ⩽
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       (
                                       |
                                       
                                          
                                             N
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                       )
                                       |
                                       +
                                       1
                                       )
                                       ⩽
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       (
                                       |
                                       
                                          
                                             N
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       (
                                       X
                                       )
                                       |
                                       +
                                       1
                                       )
                                       =
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             ¯
                                          
                                       
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             -
                                             i
                                          
                                       
                                       )
                                       .
                                       
                                       □
                                    
                                 
                              
                           


                              Let Y be some optimal strategy profile. Then, the profile X used to define the cost shares has cost 
                              
                                 
                                    C
                                    (
                                    X
                                    )
                                    ⩽
                                    
                                       
                                          H
                                       
                                       
                                          n
                                       
                                    
                                    ·
                                    C
                                    (
                                    Y
                                    )
                                 
                              .

We first check that updating 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                 
                               corresponding to the flow 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                 
                               as done in line 7 works as desired. Clearly, updating 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                 
                               this way is feasible with regard to the strategy space 
                                 
                                    Σ
                                 
                              . Moreover, when we add 
                                 
                                    v
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                               players going from 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                 
                               to 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              , the load only changes on one resource r and the cost difference of 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                               is 
                                 
                                    C
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    C
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              .

To bound the per-unit cost increase in a given iteration k, note that for each resource 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               with less users than in the optimal profile 
                                 
                                    Y
                                    ,
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    |
                                    <
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    (
                                    Y
                                    )
                                    |
                                 
                              , there is an integer 
                                 
                                    s
                                    ,
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               flow with flow value 
                                 
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    (
                                    Y
                                    )
                                    |
                                    -
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    |
                                 
                              . As the algorithm does not choose this flow, the corresponding per-unit cost is greater than that on the resource r,
                                 
                                    (17)
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             v
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             Y
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             |
                                             -
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             Y
                                             )
                                             |
                                          
                                       
                                       .
                                    
                                 
                              Noting that the number of players missing on such resources is in total at least 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    k
                                    )
                                 
                              , i.e.,
                                 
                                    
                                       
                                          
                                             n
                                          
                                          
                                             ¯
                                          
                                       
                                       (
                                       k
                                       )
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         ∈
                                                         R
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                         |
                                                         <
                                                         |
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         Y
                                                         )
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       (
                                       |
                                       
                                          
                                             N
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       |
                                       -
                                       |
                                       
                                          
                                             N
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                       
                                       (
                                       Y
                                       )
                                       |
                                       )
                                       ,
                                    
                                 
                              we sum up (17) over all such resources,
                                 
                                    (18)
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             v
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         ∈
                                                         R
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                         |
                                                         <
                                                         |
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         Y
                                                         )
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             Y
                                             )
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ¯
                                                
                                             
                                             (
                                             k
                                             )
                                          
                                       
                                       ⩽
                                       
                                          
                                             C
                                             (
                                             Y
                                             )
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ¯
                                                
                                             
                                             (
                                             k
                                             )
                                          
                                       
                                       .
                                    
                                 
                              Then,
                                 
                                    
                                       C
                                       (
                                       X
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                C
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                                -
                                                C
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             v
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ¯
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                       
                                       ·
                                       C
                                       (
                                       Y
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             v
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ⩾
                                                   k
                                                
                                             
                                             v
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                       ·
                                       C
                                       (
                                       Y
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                v
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ⩾
                                                   k
                                                
                                             
                                             v
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                       ·
                                       C
                                       (
                                       Y
                                       )
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                v
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ⩾
                                                   k
                                                
                                             
                                             v
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             -
                                             i
                                             +
                                             1
                                          
                                       
                                       ·
                                       C
                                       (
                                       Y
                                       )
                                       =
                                       
                                          
                                             H
                                          
                                          
                                             n
                                          
                                       
                                       ·
                                       C
                                       (
                                       Y
                                       )
                                       .
                                       
                                       □
                                    
                                 
                              
                           


                              Let Y be some optimal strategy profile and 
                              
                                 
                                    Z
                                    ∈
                                    P
                                    (
                                    I
                                    ,
                                    ξ
                                    )
                                 
                               
                              a PNE. Then, 
                                 
                                    C
                                    (
                                    Z
                                    )
                                    ⩽
                                    n
                                    ·
                                    C
                                    (
                                    Y
                                    )
                                 
                              .

First observe that from (18) we can derive 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          l
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          l
                                       
                                    
                                    )
                                    ⩽
                                    C
                                    (
                                    Y
                                    )
                                 
                               for every iteration l where the load on a resource r is increased. Particularly, 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    ⩽
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                    
                                    C
                                    (
                                    Y
                                    )
                                 
                              . We estimate the cost of Z by estimating the cost shares of groups of players in Z.

For players that are in X on resources r with 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                 
                              , by the above observation 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                    
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    Z
                                    )
                                    =
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                    ⩽
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                    
                                    C
                                    (
                                    Y
                                    )
                                 
                              .

For players that are in X on resources r with 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    ⊂
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              , we choose the smallest k such that 
                                 
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    |
                                    +
                                    1
                                    ⩽
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    |
                                 
                               and let q be the number of times the algorithm has increased the load on r up to iteration k. Then, 
                                 
                                    q
                                    ⩽
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    |
                                    +
                                    1
                                 
                               and by our above observation the q load increases will increase the cost by up to 
                                 
                                    q
                                    ·
                                    C
                                    (
                                    Y
                                    )
                                 
                              . Then, for all 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              ,
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       Z
                                       )
                                       ⩽
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       r
                                       ,
                                       
                                          
                                             Z
                                          
                                          
                                             -
                                             i
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Z
                                             )
                                             |
                                             +
                                             1
                                             )
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Z
                                             )
                                             |
                                             +
                                             1
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             q
                                          
                                       
                                       ⩽
                                       
                                          
                                             q
                                             ·
                                             C
                                             (
                                             Y
                                             )
                                          
                                          
                                             q
                                          
                                       
                                       =
                                       C
                                       (
                                       Y
                                       )
                                       ,
                                    
                                 
                              The first inequality holds because Z is a Nash equilibrium, the second inequality follows from our previous observations 
                                 
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    |
                                    +
                                    1
                                    ⩽
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    |
                                 
                               and 
                                 
                                    q
                                    ⩽
                                    |
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    |
                                    +
                                    1
                                 
                              . For the last inequality observe that 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                               is the sum of the costs of the q load increases up to iteration k.

For players that are in X on resources r with 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    Z
                                    )
                                    ¬
                                    ⊆
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                              , we have 
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    Z
                                    )
                                    ⩽
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          Z
                                       
                                       
                                          -
                                          i
                                       
                                    
                                    )
                                    =
                                    0
                                 
                               for all players 
                                 
                                    i
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    X
                                    )
                                 
                               because Z is a PNE. Summing up across all player gives the desired
                                 
                                    
                                       C
                                       (
                                       Z
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                N
                                             
                                          
                                       
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       Z
                                       )
                                       ⩽
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                N
                                             
                                          
                                       
                                       C
                                       (
                                       Y
                                       )
                                       =
                                       n
                                       ·
                                       C
                                       (
                                       Y
                                       )
                                       .
                                       
                                       □
                                    
                                 
                              
                           


                              The runtime of Algorithm 
                              2 
                              is polynomial in the size of the input instance.
                           

For an instance I with n players and m resources, the algorithm’s main while loop (lines 2 to 8) can run at most n times. Computing 
                                 
                                    G
                                    (
                                    X
                                    )
                                 
                               can be done in 
                                 
                                    O
                                    (
                                    mn
                                    )
                                 
                               time, the 
                                 
                                    O
                                    (
                                    mn
                                    )
                                 
                               flows of an iteration can each be computed in 
                                 
                                    O
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                               with the Edmonds–Karp algorithm (Edmonds & Karp, 1972), updating X can be done in 
                                 
                                    O
                                    (
                                    n
                                    )
                                 
                               time. Hence, the algorithm’s runtime is bounded by 
                                 
                                    O
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          n
                                       
                                       
                                          5
                                       
                                    
                                    )
                                 
                              .□

@&#CONCLUSIONS@&#

We considered in this paper facility location games where facilities have nondecreasing load-dependent costs and players experience player-specific delays when connecting to an open facility. We designed several cost sharing protocols for this setting and proved that they induce the smallest possible price of anarchy and price of stability, respectively. The following problems remain open and deserve further research. We assumed that the player’s strategy space is described by the set of bases of a player-specific matroid. While matroids contain many interesting classes (such as the facility location games), other classes such as general multi-commodity networks are not covered. The problem of designing optimal cost sharing protocols for general strategy spaces still eludes us. Our results regarding the computational complexity of cost sharing protocols show that optimal cost shares cannot be approximated by logarithmic factor in the number of players. While we devised the best possible approximation algorithm for singleton strategies and delays in 
                        
                           {
                           0
                           ,
                           ∞
                           }
                        
                     , the case of general matroids with arbitrary delays remains unresolved.

@&#ACKNOWLEDGMENT@&#

We thank two anonymous referees for their extraordinary effort in providing helpful and detailed comments for this paper.


                     
                        Lemma A.1
                        
                           The Price of Anarchy for facility location games with basic or separable protocols is at most n.

Let 
                              
                                 (
                                 N
                                 ,
                                 R
                                 ,
                                 Σ
                                 ,
                                 d
                                 ,
                                 c
                                 ,
                                 t
                                 )
                              
                            be a facility location model. Let 
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       ,
                                       r
                                    
                                 
                              
                            for 
                              
                                 i
                                 ∈
                                 N
                                 ,
                                 r
                                 ∈
                                 R
                              
                            be the cost share functions assigned by the Enforcing Protocol and let X be the decharged profile returned by Algorithm 1 for the protocol with intermediate profiles 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 X
                              
                           . We use notation for players and jobs interchangeably, denoting jobs by the letter q, for example 
                              
                                 q
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 X
                                 )
                              
                            for the jobs on a resource. For each job q, define 
                              
                                 y
                                 (
                                 q
                                 )
                              
                            and 
                              
                                 p
                                 (
                                 q
                                 )
                              
                            as in the analysis of the algorithm and denote additionally by 
                              
                                 x
                                 (
                                 q
                                 )
                              
                            the resource job q is on in profile X and by 
                              
                                 
                                    
                                       X
                                    
                                    
                                       q
                                    
                                 
                              
                            the algorithm’s intermediate profile in which q is first on 
                              
                                 x
                                 (
                                 q
                                 )
                              
                           . From the analysis of the algorithm, we know
                              
                                 (19)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          x
                                          (
                                          q
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          q
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          x
                                          (
                                          q
                                          )
                                       
                                    
                                    ⩽
                                    
                                       
                                          1
                                       
                                       
                                          p
                                          (
                                          q
                                          )
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          y
                                          (
                                          q
                                          )
                                       
                                    
                                    (
                                    Y
                                    )
                                    +
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          y
                                          (
                                          q
                                          )
                                       
                                    
                                 
                              
                           for all jobs q that were moved by the algorithm. For jobs q that were not moved by the algorithm, we set 
                              
                                 
                                    
                                       X
                                    
                                    
                                       q
                                    
                                 
                                 ≔
                                 Y
                              
                           .

To prove the lemma, we show 
                              
                                 C
                                 (
                                 Z
                                 )
                                 ⩽
                                 n
                                 ·
                                 C
                                 (
                                 Y
                                 )
                              
                            for any pure Nash equilibrium Z. To this end, we fix such a profile Z and link it to the profiles 
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       -
                                       i
                                    
                                 
                                 )
                              
                            via the Nash property,
                              
                                 (20)
                                 
                                    C
                                    (
                                    Z
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             Z
                                             )
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      ∈
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   r
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Z
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      ∈
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   r
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               r
                                                               ∈
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               (
                                                               Z
                                                               )
                                                               =
                                                               ∅
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Z
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      ∈
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                      ∈
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      =
                                                      ∅
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Z
                                                
                                                
                                                   -
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                      ∈
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      ≠
                                                      ∅
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          ,
                                          r
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                      ∈
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      =
                                                      ∅
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      ∩
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                      +
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            q
                                                            ,
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             2
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      ⧹
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            p
                                                            (
                                                            q
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            y
                                                            (
                                                            q
                                                            )
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                      +
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            q
                                                            ,
                                                            y
                                                            (
                                                            q
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                      ∈
                                                      R
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      (
                                                      Z
                                                      )
                                                      ≠
                                                      ∅
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                    
                                       
                                          t
                                       
                                       
                                          q
                                          ,
                                          r
                                       
                                    
                                 
                              
                           Proving (20) is a major challenge of this proof and beforehand we give a brief intuition for this inequality: for jobs that are moved by the algorithm we have an at most logarithmic cost-increase going from profile Y to profile Z, represented by the second term, while for jobs not moved by the algorithm, the cost-increase can even be linear as represented by the first term. In our worst-case example in Lemma 5.1, this linear cost-increase dominates the logarithmic cost-increase: no jobs are moved by the algorithm.

To prove (20), we partition the resources without foreign players into two sets,
                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                1
                                             
                                          
                                          ≔
                                          {
                                          r
                                          ∈
                                          R
                                          :
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Z
                                          )
                                          =
                                          ∅
                                          
                                          and
                                          
                                          |
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          ⧹
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Z
                                          )
                                          |
                                          ≤
                                          1
                                          }
                                       
                                     - resources where at most one job is missing,


                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          ≔
                                          {
                                          r
                                          ∈
                                          R
                                          :
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          Z
                                          )
                                          =
                                          ∅
                                          
                                          and
                                          
                                          |
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          ⧹
                                          
                                             
                                                N
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Z
                                          )
                                          |
                                          >
                                          1
                                          }
                                       
                                     - resources, where multiple jobs are missing.

For 
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                    
                                 ,
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                -
                                                i
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ∩
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         q
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          2
                                          ·
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ⧹
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         p
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         q
                                                         ,
                                                         y
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Recall that for all 
                                    
                                       r
                                       ∈
                                       R
                                    
                                 
                                 
                                    
                                       (21)
                                       
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          ⩽
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            Y
                                                            )
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            X
                                                            )
                                                            ⧹
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            Y
                                                            )
                                                            =
                                                            ∅
                                                            ,
                                                         
                                                         
                                                            (
                                                            a
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                            ⩽
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  p
                                                                  (
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  y
                                                                  (
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            (
                                                            Y
                                                            )
                                                            +
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  ,
                                                                  y
                                                                  (
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  ,
                                                                  r
                                                               
                                                            
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            X
                                                            )
                                                            ⧹
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            Y
                                                            )
                                                            
                                                            ≠
                                                            
                                                            ∅
                                                            ,
                                                         
                                                         
                                                            (
                                                            b
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where job 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             r
                                          
                                       
                                    
                                  denotes the last job moved to r by the algorithm. The second inequality (21b) follows from (19). To prove the claim, we have for 
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                    
                                 ,
                                    
                                       (22)
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                -
                                                i
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                Z
                                                )
                                                ≠
                                                ∅
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Z
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          (
                                          Z
                                          )
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                                ⧹
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                Z
                                                )
                                                =
                                                {
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ,
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                -
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (23)
                                       
                                          ⩽
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                Z
                                                )
                                                ≠
                                                ∅
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                X
                                                )
                                                ⧹
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                Z
                                                )
                                                =
                                                {
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (24)
                                       
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ∩
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Y
                                          )
                                          +
                                          2
                                          ·
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ⧹
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         p
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         q
                                                         ,
                                                         y
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         q
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                q
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ∩
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         q
                                                         ,
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          2
                                          ·
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ⧹
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         p
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         y
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         q
                                                         ,
                                                         y
                                                         (
                                                         q
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 where 
                                    
                                       1
                                    
                                  denotes the indicator function tied to the condition in subscript and, if applicable, 
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  is the single player using resource r in X but not in Z. Eq. (22) is due to the nature of 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                    
                                  and for (23) we use that there are no foreign players on machines 
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             1
                                          
                                       
                                    
                                 . In inequality (24), we estimate using both (21a) and (21b). For the case where both indicator functions are true, we multiply the term from (21b) by 2. For the term from (21a) this is not necessary because, if both indicator functions are true and 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       ⧹
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                       =
                                       ∅
                                    
                                 , then there are multiple jobs 
                                    
                                       q
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       ∩
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                    
                                  and, hence, 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             ∩
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                       ⩾
                                       2
                                       ·
                                       
                                          
                                             c
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                    
                                 .□


                                 For 
                                 
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                    
                                 ,
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                -
                                                i
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ∩
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Y
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ⧹
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                p
                                                (
                                                q
                                                )
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                y
                                                (
                                                q
                                                )
                                             
                                          
                                          (
                                          Y
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                q
                                                ,
                                                y
                                                (
                                                q
                                                )
                                             
                                          
                                          .
                                       
                                    
                                 
                              

We denote the jobs on 
                                    
                                       r
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                    
                                  in profile X by 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             |
                                          
                                          
                                             r
                                          
                                       
                                    
                                  such that they are indexed with non-increasing weights 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                       ⩾
                                       …
                                       ⩾
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   |
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   |
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                    
                                 . Let 
                                    
                                       s
                                       (
                                       r
                                       )
                                       ≔
                                       min
                                       {
                                       i
                                       :
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                          
                                             r
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Z
                                       )
                                       }
                                    
                                 . Since the jobs are indexed in the same order as their players, the protocol assigns for 
                                    
                                       i
                                       ⩽
                                       |
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       |
                                    
                                 
                                 
                                    
                                       (25)
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ,
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                -
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            Z
                                                            )
                                                            +
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            if
                                                            
                                                            i
                                                            <
                                                            s
                                                            (
                                                            r
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            (
                                                            Z
                                                            )
                                                            )
                                                         
                                                         
                                                            if
                                                            
                                                            i
                                                            =
                                                            s
                                                            (
                                                            r
                                                            )
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            if
                                                            
                                                            i
                                                            >
                                                            s
                                                            (
                                                            r
                                                            )
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 We now define an automorphism 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       :
                                       {
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             |
                                          
                                          
                                             r
                                          
                                       
                                       }
                                       →
                                       {
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             |
                                          
                                          
                                             r
                                          
                                       
                                       }
                                    
                                  that maps the first 
                                    
                                       t
                                       (
                                       r
                                       )
                                       ≔
                                       |
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       ⧹
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                       |
                                    
                                  jobs (by index) to 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       ⧹
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                    
                                 , such that
                                    
                                       •
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                           is the last job that was moved to r by the algorithm,


                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                           is the second-last job that was moved to r by the algorithm,

…


                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      t
                                                      (
                                                      r
                                                      )
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                           is the first job that was moved to r by the algorithm.

The remaining jobs are mapped arbitrarily to 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                       ∩
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                    
                                 , keeping 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                    
                                  bijective. Then,
                                    
                                       (27a)
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Z
                                          )
                                          ⩽
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   (
                                                   r
                                                   )
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (27b)
                                       
                                          ⩽
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   (
                                                   r
                                                   )
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (27c)
                                       
                                          ⩽
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      s
                                                      (
                                                      r
                                                      )
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 where (27a) holds because 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Z
                                       )
                                       ⊂
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             s
                                             (
                                             r
                                             )
                                             -
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       
                                       ∉
                                       
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Z
                                       )
                                    
                                  by definition of 
                                    
                                       s
                                       (
                                       r
                                       )
                                    
                                 . Inequality (27b) holds because we indexed the jobs from big to small and hence the first 
                                    
                                       s
                                       (
                                       r
                                       )
                                       -
                                       1
                                    
                                  jobs are the ‘biggest’ jobs on resource r. For (27c), if 
                                    
                                       s
                                       (
                                       r
                                       )
                                       ⩽
                                       t
                                       (
                                       r
                                       )
                                    
                                 , that is, if 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             s
                                             (
                                             r
                                             )
                                          
                                          
                                             r
                                          
                                       
                                       )
                                    
                                  was moved to resource r, then in profile 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   s
                                                   (
                                                   r
                                                   )
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                          
                                       
                                    
                                  none of the jobs 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             s
                                             (
                                             r
                                             )
                                             -
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       )
                                    
                                  moved to r after job 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             s
                                             (
                                             r
                                             )
                                          
                                          
                                             r
                                          
                                       
                                       )
                                    
                                  are on resource r, and consequently (27c) follows. Otherwise, if 
                                    
                                       s
                                       (
                                       r
                                       )
                                       >
                                       t
                                       (
                                       r
                                       )
                                    
                                 , that is, if 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             s
                                             (
                                             r
                                             )
                                          
                                          
                                             r
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Y
                                       )
                                    
                                 , then 
                                    
                                       Y
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   s
                                                   (
                                                   r
                                                   )
                                                
                                                
                                                   r
                                                
                                             
                                             )
                                          
                                       
                                    
                                  and in this profile none of the jobs 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             t
                                             (
                                             r
                                             )
                                          
                                          
                                             r
                                          
                                       
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             r
                                          
                                       
                                       )
                                    
                                  that were moved to resource r are on resource r and hence (27c) follows. We find likewise for 
                                    
                                       i
                                       <
                                       s
                                       (
                                       r
                                       )
                                    
                                 ,
                                    
                                       (28)
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Z
                                          )
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   i
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                          ⩽
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 where the above inequalities hold for similar reasons as (27). We complete the proof of the claim by
                                    
                                       (29)
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Z
                                             
                                             
                                                -
                                                i
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          =
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Z
                                          )
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   (
                                                   r
                                                   )
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Z
                                          )
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (30)
                                       
                                          ⩽
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   s
                                                   (
                                                   r
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                ℓ
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                q
                                                )
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (31)
                                       
                                          =
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                q
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (32)
                                       
                                          ⩽
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ∩
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          Y
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                ,
                                                r
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   X
                                                   )
                                                   ⧹
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Y
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                p
                                                (
                                                q
                                                )
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                y
                                                (
                                                q
                                                )
                                             
                                          
                                          (
                                          Y
                                          )
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                q
                                                ,
                                                y
                                                (
                                                q
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 where Eq. (29) follows from (25) and inequality (30) follows from (27) and (28). Eq. (31) holds because 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                       
                                    
                                  is an automorphism on 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       X
                                       )
                                    
                                  and finally inequality (32) follows from our definition of the intermediate profiles 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             q
                                          
                                       
                                    
                                  and our results regarding these profiles as in (19).□

We now continue the proof of Lemma 5.2 where we left off with (20) and conclude across both sets,
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             
                                                C
                                                (
                                                Z
                                                )
                                                ⩽
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  (
                                                                  Z
                                                                  )
                                                                  =
                                                                  ∅
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               i
                                                               ,
                                                               r
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               -
                                                               i
                                                            
                                                         
                                                         )
                                                         +
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                               ,
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  (
                                                                  Z
                                                                  )
                                                                  ≠
                                                                  ∅
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ⩽
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  (
                                                                  Z
                                                                  )
                                                                  =
                                                                  ∅
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  q
                                                                  ∈
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  X
                                                                  )
                                                                  ∩
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  Y
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  Y
                                                                  )
                                                                  +
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        q
                                                                        ,
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         +
                                                         2
                                                         ·
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  q
                                                                  ∈
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  X
                                                                  )
                                                                  ⧹
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  (
                                                                  Y
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        p
                                                                        (
                                                                        q
                                                                        )
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        y
                                                                        (
                                                                        q
                                                                        )
                                                                     
                                                                  
                                                                  (
                                                                  Y
                                                                  )
                                                                  +
                                                                  
                                                                     
                                                                        t
                                                                     
                                                                     
                                                                        q
                                                                        ,
                                                                        y
                                                                        (
                                                                        q
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                +
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  r
                                                                  ∈
                                                                  R
                                                               
                                                               
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  (
                                                                  Z
                                                                  )
                                                                  ≠
                                                                  ∅
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         (
                                                         X
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      q
                                                      ,
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (34)
                                 
                                    ⩽
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      ∩
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                      +
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            q
                                                            ,
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                      ⧹
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            p
                                                            (
                                                            q
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                      +
                                                      2
                                                      ·
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            q
                                                            ,
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (35)
                                 
                                    ⩽
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                             ∩
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             X
                                             )
                                             |
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      =
                                                      |
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                      ∩
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      X
                                                      )
                                                      |
                                                      +
                                                      1
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                      |
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                
                                                
                                                   p
                                                
                                             
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                             +
                                             2
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   q
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    ⩽
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             ∈
                                             R
                                          
                                       
                                    
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   N
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                             |
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             Y
                                             )
                                             +
                                             2
                                             ·
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      (
                                                      Y
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   q
                                                   ,
                                                   r
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    n
                                    ·
                                    C
                                    (
                                    Y
                                    )
                                    .
                                 
                              
                           Here, (33) follows from Claims A.2 and 8.1. In (34), we change the order of summation: instead summing up the 
                              
                                 q
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 X
                                 )
                                 ⧹
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Y
                                 )
                              
                            that were moved from other resources by the algorithm, we sum up the 
                              
                                 q
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Y
                                 )
                                 ⧹
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 X
                                 )
                              
                            that were moved to other resources by the algorithm. At the same time we extend summation across all resources 
                              
                                 r
                                 ∈
                                 R
                              
                            where before we only summed up across resources with 
                              
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Z
                                 )
                                 =
                                 ∅
                              
                           . For (35), recall how we introduced 
                              
                                 p
                                 (
                                 q
                                 )
                              
                           : the first job that is moved away has 
                              
                                 p
                                 (
                                 q
                                 )
                                 =
                                 |
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Y
                                 )
                                 |
                              
                           , the next has 
                              
                                 p
                                 (
                                 q
                                 )
                                 =
                                 |
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Y
                                 )
                                 -
                                 1
                                 |
                              
                            until the last job that is moved away has 
                              
                                 p
                                 (
                                 q
                                 )
                                 =
                                 |
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Y
                                 )
                                 ∩
                                 
                                    
                                       N
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 X
                                 )
                                 |
                                 +
                                 1
                              
                           .□

@&#REFERENCES@&#

