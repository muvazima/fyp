@&#MAIN-TITLE@&#Lower and upper bounds for a two-stage capacitated facility location problem with handling costs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider a two-stage capacitated facility location problem with handling costs.


                        
                        
                           
                           Handling costs are modeled by associating with each depot a set of handling modules.


                        
                        
                           
                           A hybrid approach is proposed to obtain good lower and upper bounds of the problem.


                        
                        
                           
                           Computational results show our approach provides good solutions with gaps below 2%.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Facility location

Heuristic

Dantzig–Wolfe decomposition

Path relinking

@&#ABSTRACT@&#


               
               
                  We study in this paper multi-product facility location problem in a two-stage supply chain in which plants have production limitation, potential depots have limited storage capacity and customer demands must be satisfied by plants via depots. In the paper, handling cost for batch process in depots is considered in a realistic way by a set of capacitated handling modules. Each module can be regards as alliance of equipment and manpower. The problem is to locate depots, choose appropriate handling modules and to determine the product flows from the plants, opened depots to customers with the objective to minimize total location, handling and transportation costs. For the problem, we developed a hybrid method. The initial lower and upper bounds are provided by applying a Lagrangean based on local search heuristic. Then a weighted Dantzig–Wolfe decomposition and path-relinking combined method are proposed to improve obtained bounds. Numerical experiments on 350 randomly generated instances demonstrate our method can provide high quality solution with gaps below 2%.
               
            

@&#INTRODUCTION@&#

As a key topic in the design of transportation systems (Brandeau & Chiu, 1989), facility location problems (FLPs) have appealed to both researchers and practitioners for more than 40years. A basic FLP, already NP-hard, is the uncapacitated FLP (UFLP), which consists in locating uncapacitated facilities, such as plants, depots or warehouses, and defining the amount shipped by open facilities to customers, in order to minimize the sum of the set-up costs of the open facilities and of the distribution costs. A natural extension is to take into account the maximum demand of each facility could supply, giving the capacitated facility location problem (CFLP) (Cornuejols, Sridharan, & Thizy, 1991; Klose & Görtz, 2007). A special case of CFLP met in distribution networks is the single source CFLP (Ahuja, Orlin, Pallottino, Scaparra, & Scutellà, 2004; Contreras & Díaz, 2008) or concentrator problem, in which each customer must be served by only one facility. More complicated versions of the CFLP include the dynamic CFLP, defined on a multiperiod horizon (Dias, Captivo, & Clímaco, 2007; Melo, Nickel, & Saldanha da Gama, 2006), and the stochastic CFLP in which demands and supplies can be random variables (Lin, 2009; Wang, Batta, & Rump, 2002).

All problems cited above consider one product and a simple network with two layers of nodes (also called levels) or, equivalently, one distribution step (also called stage or echelon). Although such networks exist, most supply chains are more complex and involve several products, more than two levels (e.g., plants, depots and customers), and inter-level products. The development of operations research and computers have made possible the study of facility location problems in supply chains, called hierarchical facility location problems, see for instance the recent review of Şahin and Süral (2007).

Hierarchical facility location problems (HFLPs) is an extension of the CFLP by taking into account more than one echelons in the distribution network. A set of customers are usually laid at the last echelon, while various type of facilities are modeled for other echelons. The product flow traverses all echelons successively. The two-stage facility location problem (TSFLP) (Keskin & Üster, 2007a, 2007b; Klose, 1999, 2000; Martí & Pelegrín, 1999; Tragantalerngsak, Holt, & Rönnqvist, 1997), with two types of facilities, is a basic model of HFLP. Products supplied by plants are delivered to capacitated depots, and then distributed to customers aiming at minimizing both shipment costs and the fixed opening costs of depots. Several variants were derived from the TSFLP, for instance by locating plants and depots (Elhedhli & Gzara, 2008; Pirkul & Jayaraman, 1996, 1998) and by considering four layers composed of suppliers, plants, depots and customers (Jayaraman & Pirkul, 2001). In this paper, our attention focuses on the TSFLP.

The objective function of the TSFLP comprises both shipment costs and investment costs induced by opening depots. Investment costs, regarded as the strategic decision level, are much more important than shipment costs in practice. Therefore it is common to consider a reference period (e.g., quarter of a year), and let both shipment costs and investment costs including the overhead and amortization costs be modeled over this period. Besides the investment costs incurred by location decision and the operational shipment costs, the costs on handling products at depots cannot be negligible, specially in the food supply chain. The cargo must be unloaded, sorted, packaged, reloaded and dispatched after entering into depots. As this treatment of cargo involves tasks accomplished by both workers and machines, such as palletizers, forklifts and conveyors, it is common to regard it as capital and labor intensive process (Newton, Barnhart, & Vance, 1998). Efficiently using handling costs can save costs and bring profits for companies. Thus, the handling costs are significant parts of overall costs in the distribution system, and introducing them into the TSFLP seems reasonable and realistic.

Two types of handling costs are considered in this paper: the cost for handling one unit of product and the bulk cost for processing a batch of products. Considering the first type of cost is not hard in the classical model of facility location problems, since it can be incorporated into the unit shipment cost on arcs starting from the depot. The bulk cost under special working situations is however not easy to integrate into the shipment cost, due to the facts that the number of workers assigned to the batch, their qualifications, the equipment used, etc. To describe handling costs in a understandable and realistic way, we retake the concept of handling modules proposed by Li et al. (2011). In the paper, a pre-given alliance of workers and equipment (e.g., a set of palletizers with their drivers), having both handling capacity and handling cost during a reference period, is modeled as one handling module. The handling capacity represents the maximum amount of cargo which can be treated over the reference period. The handling cost consists of the normal depreciation of equipment, employment costs of workers, etc. The handling cost per handling module and per cross-docking task is totally charged once the module is used to handle cargo, even for a small portion of its capacity. Thus, efficiently using module capacity leads to a smaller handling cost per product unit.


                     Li et al. (2011) considered a two stage capacity location problem with handling cost (TSCFLP-HC) and cross-docking tasks. In our preliminary work (Li et al., 2011) of the TSCFLP-HC, a limited set of different types of handling module are equipped at each depot. The decision on depot location, product flow and the number of handling modules per type and per cross-docking task must be made, with the goal of minimizing the total depot opening, transportation and handling cost. The problem was formulated by a linear mathematical programming. However, the problem proposed by Li et al. (2011) takes into account cross-docking tasks, which pertain basically to detailed operational tasks, and unrealistic to be considered in the strategic level of facility location problem. The work in this paper is the extension of our precedent work. We proposed in this paper a mathematical model making a slight difference in comparison with the one of Li et al. (2011), since the facility location problem considered in this paper takes into account handling module in the strategic and tactical level decision, without the detailed operational level decision–cross-docking tasks. Therefore the work is a variant of TSCFLP-HC (Li et al., 2011).

To derive an initial lower bound, Li et al. (2011) proposed a subgradient optimization procedure based on Lagrangean relaxation, and use a simple heuristic to provide an initial upper bound from each lower bound obtained. The heuristic repaired each lower bound by opening depots where handling modules are used, or randomly closing DCs iteratively until the minimum number is reached. In this paper, we proposed a local search heuristic based on the information provided by subgradient optimization, which concerns ADD/DROP/SWAP moves. The advantage of the local search heuristic is to avoid local optimum and provide good initial upper bound for further improvement with subsequent advanced approach.

The paper brings two academic contributions. The first contribution is to provide initial upper bound with a local search heuristic algorithm based on the lower bound provided by subgradient optimization procedure. The second one consists in improving lower and upper bounds by using a weighted Dantzig–Wolfe decomposition, and reinforced by a path-relinking. To evaluate the performance of the proposed method, 350 randomly generated instances are tested.

The remainder of the article is organized as follows. In Section 2, the TSCFLP-HC is defined in details and formulated as a mixed linear program. Section 3 describes the main blocks of the hybrid solution method: the Lagrangean relaxation with its subgradient optimization procedure, the column generation process and the post-optimization based on path-relinking. A set of instances and computational results are presented in Section 4. Some conclusions are drawn and future research is discussed in Section 5.

The proposed TSCFLP-HC is defined on a three layers with a set I of plants, a set J of potential depots, a set K of customers and a set P of different products. Each plant 
                        
                           i
                           ∈
                           I
                        
                      has a production limitation 
                        
                           
                              
                                 s
                              
                              
                                 i
                              
                              
                                 p
                              
                           
                        
                      of each product 
                        
                           p
                           ∈
                           P
                        
                     . Each potential depot 
                        
                           j
                           ∈
                           J
                        
                      has an opening cost 
                        
                           
                              
                                 g
                              
                              
                                 j
                              
                           
                        
                      and a limited capacity 
                        
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                        
                     . Each product 
                        
                           p
                           ∈
                           P
                        
                      occupies a volume per unit denoted as 
                        
                           
                              
                                 v
                              
                              
                                 p
                              
                           
                        
                     .

When products arrive at a depot, they are processed by handling modules. Let 
                        
                           
                              
                                 M
                              
                              
                                 j
                              
                           
                        
                      represent the set of module types available at each depot 
                        
                           j
                           ∈
                           J
                        
                     . It is worth noting that the set of modules are different for each depot. Each type 
                        
                           m
                           ∈
                           
                              
                                 M
                              
                              
                                 j
                              
                           
                        
                      of handling module at depot 
                        
                           j
                           ∈
                           J
                        
                      is characterized by a handling capacity 
                        
                           
                              
                                 q
                              
                              
                                 j
                              
                              
                                 m
                              
                           
                        
                      and a cost 
                        
                           
                              
                                 b
                              
                              
                                 j
                              
                              
                                 m
                              
                           
                        
                     . 
                        
                           
                              
                                 u
                              
                              
                                 j
                              
                              
                                 m
                              
                           
                        
                      corresponds to the number of modules available at each potential depot 
                        
                           j
                           ∈
                           J
                        
                     . The cost of a module is counted as soon as it is used, even for a fraction of its capacity.

The non-negative demand of each product 
                        
                           p
                           ∈
                           P
                        
                      for each customer 
                        
                           k
                           ∈
                           K
                        
                      is denoted by 
                        
                           
                              
                                 d
                              
                              
                                 p
                              
                              
                                 k
                              
                           
                        
                     . The total volume of all demands is represented by 
                        
                           d
                           (
                           K
                           )
                           =
                           
                              
                                 ∑
                              
                              
                                 p
                                 ∈
                                 P
                              
                           
                           
                           
                              
                                 ∑
                              
                              
                                 k
                                 ∈
                                 K
                              
                           
                           
                           
                              
                                 v
                              
                              
                                 p
                              
                           
                           
                              
                                 d
                              
                              
                                 k
                              
                              
                                 p
                              
                           
                        
                     . The unit transportation cost of product 
                        
                           p
                           ∈
                           P
                        
                      from depot 
                        
                           j
                           ∈
                           J
                        
                      to customer 
                        
                           k
                           ∈
                           K
                        
                      is denoted by 
                        
                           
                              
                                 h
                              
                              
                                 jk
                              
                              
                                 p
                              
                           
                        
                     . Similarly, 
                        
                           
                              
                                 h
                              
                              
                                 ij
                              
                              
                                 p
                              
                           
                        
                      represents the cost of shipping one unit of product 
                        
                           p
                           ∈
                           P
                        
                      from plant 
                        
                           i
                           ∈
                           I
                        
                      to depot 
                        
                           j
                           ∈
                           J
                        
                     . Three sets of variables are considered: binary variables 
                        
                           
                              
                                 Y
                              
                              
                                 j
                              
                           
                        
                      are equal to 1 if depot j is opened, non-negative integer variables 
                        
                           
                              
                                 Z
                              
                              
                                 j
                              
                              
                                 m
                              
                           
                        
                      represent the number of handling modules of type 
                        
                           m
                           ∈
                           M
                        
                      used at depot 
                        
                           j
                           ∈
                           J
                        
                     , and real variables 
                        
                           
                              
                                 X
                              
                              
                                 ij
                              
                              
                                 p
                              
                           
                        
                      and 
                        
                           
                              
                                 X
                              
                              
                                 jk
                              
                              
                                 p
                              
                           
                        
                      defining the flow of products from plants to customers via depots. Using the above notations, the TSCFLP-HC can be formulated as the following mixed integer program (P).
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          (
                                          P
                                          )
                                          :
                                          
                                          
                                             min
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                          
                                             
                                                g
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                Y
                                             
                                             
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   ∈
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                j
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                Z
                                             
                                             
                                                j
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   p
                                                   ∈
                                                   P
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                ij
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   p
                                                   ∈
                                                   P
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   K
                                                
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                jk
                                             
                                             
                                                p
                                             
                                          
                                          
                                             
                                                X
                                             
                                             
                                                jk
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              s.t.
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                                 
                                    p
                                 
                              
                              
                              ∀
                              i
                              ∈
                              I
                              ,
                              
                              ∀
                              p
                              ∈
                              P
                           
                        
                     
                     
                        
                           (3)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    jk
                                 
                                 
                                    p
                                 
                              
                              
                              ∀
                              j
                              ∈
                              J
                              ,
                              
                              ∀
                              p
                              ∈
                              P
                           
                        
                     
                     
                        
                           (4)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    jk
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                                 
                                    p
                                 
                              
                              
                              ∀
                              k
                              ∈
                              K
                              ,
                              
                              ∀
                              p
                              ∈
                              P
                           
                        
                     
                     
                        
                           (5)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       P
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              
                              ∀
                              j
                              ∈
                              J
                           
                        
                     
                     
                        
                           (6)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       ∈
                                       P
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       ∈
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              
                              ∀
                              j
                              ∈
                              J
                           
                        
                     
                     
                        
                           (7)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       ∈
                                       
                                          
                                             M
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             
                                                max
                                             
                                             
                                                m
                                                ∈
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             q
                                          
                                          
                                             j
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    j
                                 
                              
                              
                              ∀
                              j
                              ∈
                              J
                           
                        
                     
                     
                        
                           (8)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    Y
                                 
                                 
                                    j
                                 
                              
                              ⩾
                              d
                              (
                              K
                              )
                           
                        
                     
                     
                        
                           (9)
                           
                              
                              
                                 
                                    X
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                              ⩾
                              0
                              
                              ∀
                              i
                              ∈
                              I
                              ,
                              
                              ∀
                              j
                              ∈
                              J
                              ,
                              
                              ∀
                              p
                              ∈
                              P
                           
                        
                     
                     
                        
                           (10)
                           
                              
                              
                                 
                                    X
                                 
                                 
                                    jk
                                 
                                 
                                    p
                                 
                              
                              ⩾
                              0
                              
                              ∀
                              j
                              ∈
                              J
                              ,
                              
                              ∀
                              k
                              ∈
                              K
                              ,
                              
                              ∀
                              p
                              ∈
                              P
                           
                        
                     
                     
                        
                           (11)
                           
                              
                              
                                 
                                    Y
                                 
                                 
                                    j
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              j
                              ∈
                              J
                           
                        
                     
                     
                        
                           (12)
                           
                              
                              0
                              ⩽
                              
                                 
                                    Z
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              ⩽
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              
                              integer
                              
                              ∀
                              j
                              ∈
                              J
                              ,
                              
                              ∀
                              m
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                           
                        
                     
                  

The objective function (1), to be minimized, includes the opening costs of depots, the costs of handling modules used and the transportation costs in the two stages. Constraints (2) restrict for each plant the amount supplied for each product. Eq. (3) are flow conservation constraints for the depots. All customer demands are met according to Constraints (4). Constraints (5) ensure that the volume of products handled at DC j does not exceed the total handling capacity of modules used at this DC. Constraints (6) ensure that the volume of products traversed at depot cannot be greater than the capacity of used handling module at this depot. Constraints (7) play two roles. If 
                        
                           
                              
                                 Y
                              
                              
                                 j
                              
                           
                           =
                           0
                        
                      (DC j is closed) no inbound product flow are moved into DC j; otherwise, if 
                        
                           
                              
                                 Y
                              
                              
                                 j
                              
                           
                           =
                           1
                        
                      (DC j is opened), the inbound product flow must be restricted by the capacity of DC j. Constraints (7) need further explanation. It seems unlikely that the total handling capacity for all used modules per depot is exactly equal to the depot capacity. Therefore we use a simple upper bound indicating that the capacity of minimum subset of modules can be larger, in the worst case, than 
                        
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                        
                      by the maximum module capacity: 
                        
                           
                              
                                 max
                              
                              
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          j
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        
                     . Constraint (8) denotes that the total demand of customers are covered by the total capacity of open depots to ensure the feasibility of solutions. Constraint (8) are redundant to sharpen the lower bounds of model, which will be shown in the following section. Finally, constraints (9)–(12) define the variables used in the model.

Based on the fact that the CFLP, in which products are shipped from depots, to be located, to customers, is equivalent to the second stage of our TSCFLP-HC, the CFLP is therefore a special case of the TSCFLP-HC. The TSCFLP-HC is NP-hard since the CFLP is known as a classical NP-hard problem. Based on our preliminary data experimentation, a well-known software engine CPLEX (CPLEX 11.0, 2010) is not able to solve large instances, even not for small ones, in reasonable computation times. Therefore a solution method based on a local search heuristic and a weighted Dantzig–Wolfe decomposition is proposed in this paper to tackle larger instances.

Our solution method, sketched in Fig. 1
                     , includes two main blocks. In the first block, a Lagrangean relaxation of the TSCFLP-HC is solved by using subgradient optimization. Each iteration of the subgradient procedure computes a lower bound LB, derives an upper bound UB by using a Lagrangean heuristic, and updates the global best bounds LB
                     ∗ and UB
                     ∗. The second block involves a weighted Dantzig–Wolfe decomposition to improve the bounds using column generation. Finally, a post-optimization phase based on path-relinking is applied for a last improvement. All these steps are detailed in the rest of this section.

Widely applied to facility location problems (Li, Chu, & Prins, 2009; Zhu, Chu, & Sun, 2010), Lagrangean relaxation adds a subset of hard constraints, with weighted Lagrangean multipliers, to the objective function. If the relaxed problem can be quickly solved for fixed values of multipliers, a subgradient procedure can be used to adjust multipliers and yield a sequence of improved lower bounds. Our preliminary work in paper (Li et al., 2011) showed that Lagrangean relaxation is a good method to break down TSCFLP-HC into three sub-problems: (1) minimum-cost flow subproblem, (2) 0–1 knapsack problem and (3) bounded knapsack problem; and each subproblem can be solved by current techniques. By using the classical subgradient optimization procedure based on Lagrangean relaxation, initial lower bounds of the TSCFLP-HC can be derived. More details concerning on Lagrangean relaxation of constraints (6) and subgradient optimization procedure are referred to the paper (Li et al., 2011). As the three sub-problems will be useful for weighted Dantzig–Wolfe decomposition, we simply list them below.
                           
                              One minimum-cost flow subproblem (FSP):
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      FSP
                                                      )
                                                      :
                                                      
                                                      U
                                                      =
                                                      
                                                         min
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               p
                                                               ∈
                                                               P
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               p
                                                               ∈
                                                               P
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               k
                                                               ∈
                                                               K
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            jk
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            jk
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s.t.
                                                   
                                                
                                                
                                                   
                                                      
                                                      constraints
                                                      
                                                      (
                                                      2
                                                      )
                                                      –
                                                      (
                                                      5
                                                      )
                                                      ,
                                                      
                                                      (
                                                      9
                                                      )
                                                      
                                                      and
                                                      
                                                      (
                                                      10
                                                      )
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       |
                                       J
                                       |
                                    
                                  integer knapsack problems 
                                    
                                       (
                                       
                                          
                                             BKP
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                 :
                                    
                                       (13)
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            BKP
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      :
                                                      
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      
                                                         max
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               ∈
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               
                                                                  
                                                                     q
                                                                  
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     b
                                                                  
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s.t.
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               ∈
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ⩽
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               max
                                                            
                                                            
                                                               m
                                                               ∈
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14)
                                       
                                          
                                          0
                                          ⩽
                                          
                                             
                                                Z
                                             
                                             
                                                j
                                             
                                             
                                                m
                                             
                                          
                                          ⩽
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                Z
                                             
                                             
                                                j
                                             
                                             
                                                m
                                             
                                          
                                          
                                          integer
                                          
                                          ∀
                                          m
                                          ∈
                                          
                                             
                                                M
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              

And one 0–1 knapsack problem (0–1 KP):
                                    
                                       (15)
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      0
                                                      –
                                                      1
                                                      KP
                                                      )
                                                      :
                                                      
                                                      V
                                                      =
                                                      
                                                         min
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s.t.
                                                   
                                                
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ⩾
                                                      d
                                                      (
                                                      K
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (16)
                                       
                                          
                                          
                                             
                                                Y
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                              


                        Note on the initial upper bound. Depots are opened at random until their total capacity covers the total demand. Without taking the handling modules into account, a min-cost flow problem defined by the plants, the open depots, the customers and variables 
                           
                              X
                           
                         is solved using CPLEX. Finally, a bounded knapsack problem 
                           
                              
                                 
                                    KNAP
                                 
                                 
                                    j
                                 
                              
                           
                         (also used in Section 3.2, where it is explained) is solved to determine the number of modules required for each open depot j. In this way, one initial feasible solution is obtained.

As constraints (6) are dualized into the objective function, the solution corresponding to a lower bound may be infeasible for the TSCFLP-HC. To acquire an upper bound based on each lower bound provided by subgradient optimization procedure, we should repair the violated constraints. Note that the constraint (6) for depot 
                           
                              j
                              ∈
                              J
                           
                         is violated if the handling capacity is smaller than the amount 
                           
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                           
                         of products distributed into depot 
                           
                              j
                              ∈
                              J
                           
                        , i.e., if 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    m
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              <
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    p
                                    ∈
                                    P
                                 
                              
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    I
                                 
                              
                              
                              
                                 
                                    v
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ij
                                 
                                 
                                    p
                                 
                              
                           
                        . By solving the following bounded knapsack problem 
                           
                              (
                              
                                 
                                    KNAP
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        , we can derive the minimum amount of modules to treat inbound product flow 
                           
                              
                                 
                                    A
                                 
                                 
                                    j
                                 
                              
                           
                        , and therefore all constraints (6) can be met. However, these tentative rectifications do not prohibit using modules at some closed depots. To derive a feasible solution, each depot 
                           
                              j
                              ∈
                              J
                           
                         in this situation needs to be opened by setting 
                           
                              
                                 
                                    Y
                                 
                                 
                                    j
                                 
                              
                           
                         to 1.
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   KNAP
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             :
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                      ∈
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   b
                                                
                                                
                                                   j
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   Z
                                                
                                                
                                                   j
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                      ∈
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   q
                                                
                                                
                                                   j
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   Z
                                                
                                                
                                                   j
                                                
                                                
                                                   m
                                                
                                             
                                             ⩾
                                             
                                                
                                                   A
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             0
                                             ⩽
                                             
                                                
                                                   Z
                                                
                                                
                                                   j
                                                
                                                
                                                   m
                                                
                                             
                                             ⩽
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   Z
                                                
                                                
                                                   j
                                                
                                                
                                                   m
                                                
                                             
                                             
                                             integer
                                             ,
                                             
                                             ∀
                                             m
                                             ∈
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Two local search procedures are then applied to the resulting feasible solution. The first one closes one depot at a time and transfers its flows of products to other depots. A criterion inspired by Gendron, Potvin, and Soriano (2003) and Li et al. (2009) is employed to evaluate the gain 
                           
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           
                         when a depot 
                           
                              
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                           
                         is closed, see Algorithm 2. A positive gain means the opening cost saved exceeds the increase in shipment cost. Each iteration computes the gains for each open depot and closes the one with maximum positive saving. The second local search is based on a swap move which closes one depot 
                           
                              
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                           
                         while opening another one 
                           
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                           
                        . The gain of each swap move is estimated by subtracting the fixed cost of 
                           
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                           
                         from the saving 
                           
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           
                         and the move with the largest positive gain is executed. Both procedures terminate when no improving move is detected.
                           Algorithm 1
                           Computation of gain 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                               if depot 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                 
                               is closed
                                 
                                    
                                       
                                       
                                          
                                             1: let 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                 be the remaining set of open depots if 
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                 is closed
                                          
                                          
                                             2: if 
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      <
                                                      d
                                                      (
                                                      K
                                                      )
                                                   
                                                
                                                then return (0) endif
                                             
                                          
                                          
                                             3: initialize the gain: 
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            ∈
                                                            
                                                               
                                                                  M
                                                               
                                                               
                                                                  
                                                                     
                                                                        j
                                                                     
                                                                     
                                                                        0
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             4: compute for each depot 
                                                   
                                                      j
                                                      ∈
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                 the residual capacity: 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            p
                                                            ∈
                                                            P
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             5: for each each product 
                                                   
                                                      p
                                                      ∈
                                                      P
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             6: sort plants i with 
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      >
                                                      0
                                                   
                                                 into nonincreasing order of transportation costs 
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                 in a list 
                                                   
                                                      S
                                                      (
                                                      I
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             7: sort customers k with 
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            k
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      >
                                                      0
                                                   
                                                 into nonincreasing order of 
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            k
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                 in a list 
                                                   
                                                      S
                                                      (
                                                      K
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             8: 
                                                for each 
                                                
                                                   
                                                      i
                                                      ∈
                                                      S
                                                      (
                                                      I
                                                      )
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             9: 
                                                for each 
                                                
                                                   
                                                      k
                                                      ∈
                                                      S
                                                      (
                                                      K
                                                      )
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             10: 
                                                sort the depots j of 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                 with 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      >
                                                      0
                                                   
                                                 in nondecreasing order of 
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            jk
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                 in a list 
                                                   
                                                      S
                                                      (
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             11: 
                                                
                                                for each 
                                                
                                                   
                                                      j
                                                      ∈
                                                      S
                                                      (
                                                      J
                                                      )
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             12: 
                                                set 
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                      =
                                                      min
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ij
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           j
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     k
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        
                                                                           c
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               /
                                                               
                                                                  
                                                                     v
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            k
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            k
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             13: 
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            jk
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            jk
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     jk
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ij
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     h
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           j
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     k
                                                                  
                                                                  
                                                                     p
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ×
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             14: 
                                                
                                                end for
                                             
                                          
                                          
                                             15: 
                                                end for
                                             
                                          
                                          
                                             16: 
                                                end for
                                             
                                          
                                          
                                             17: end for
                                             
                                          
                                          
                                             18: for each 
                                                
                                                   
                                                      j
                                                      ∈
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             19: update 
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            p
                                                            ∈
                                                            P
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             20: solve problem 
                                                   
                                                      
                                                         
                                                            knap
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                 to update the amount of handling modules 
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ,
                                                      ∀
                                                      m
                                                      ∈
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             21: end for
                                             
                                          
                                          
                                             22: let H be the total cost of additional handling modules in the depots of 
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                   
                                                : update 
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      H
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Notes on 
                        Algorithm 1. The test in line 2 is used to stop the evaluation if the remaining open depots cannot handle the total demand. The purpose of the three nested loops lines 5–17 is to route the flows of products traversing depot 
                           
                              
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                           
                         via another open depot. The innermost loop line 11 transfers the amount of product p on arcs 
                           
                              (
                              i
                              ,
                              
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    j
                                 
                                 
                                    0
                                 
                              
                              ,
                              k
                              )
                           
                         towards arcs 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         and 
                           
                              (
                              j
                              ,
                              k
                              )
                           
                        : the flows, the residual capacity of depot j and the gain 
                           
                              
                                 
                                    G
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           
                         are updated. Line 22, the definitive gain must take into account the possible increase in handling cost incurred by additional modules in the depots of 
                           
                              
                                 
                                    J
                                 
                                 
                                    ∼
                                 
                              
                           
                        .

A known alternative to subgradient optimization is to solve the Lagrangean dual problem (LDP) of a linear mixed-integer problem (MIP) by using linear programming. The associated linear program captures more information about the MIP but its number of constraints can be huge. However, the dual (MP) of (LDP) can be solved using Dantzig–Wolfe decomposition (DWD) and column generation. The master problem (MP) has too many columns to be solved directly. Starting from a restricted master problem (RMP) with a small number of columns, DWD consists in solving iteratively subproblems, which generate new columns for (RMP), and the (RMP) itself, which produce new Lagrangean multipliers for the subproblems.

In this paper, we prefer to use a variant of DWD called weighted Dantzig–Wolfe decomposition (WDWD), proposed by Wentges (1997). The modified version does not use the optimal solution of (RMP) as Lagrangean multipliers for the next subproblem to be solved, but a specially weighted average of the best multipliers constructed so far. Wentges (1997) showed that WDWD is faster on average than DWD, when is applied to the capacitated facility location problem. For the TSFLP-HC, we keep the preliminary phase based on subgradient optimization to provide good bounds and multipliers that can be reused during WDWD.

Before applying WDWD, we define the Lagrangean dual problem (LDP) using three sets 
                              
                                 
                                    
                                       S
                                    
                                    
                                       X
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       Y
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                    
                                       Z
                                    
                                 
                                 (
                                 j
                                 ∈
                                 J
                                 )
                              
                            which correspond to the Lagrangean subproblems already described in Section 3.1. 
                              
                                 
                                    
                                       S
                                    
                                    
                                       X
                                    
                                 
                              
                            is the set of feasible solutions for the minimum-cost flow subproblem (FSP), 
                              
                                 
                                    
                                       S
                                    
                                    
                                       Y
                                    
                                 
                              
                            denotes the feasible solutions of (0–1KP), and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                    
                                       Z
                                    
                                 
                                 (
                                 j
                                 ∈
                                 J
                                 )
                              
                            is the set of solutions of 
                              
                                 (
                                 
                                    
                                       BKP
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ,
                                 j
                                 ∈
                                 J
                              
                           . A superscript is added to variables 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                              
                            when we refer to one solution s in 
                              
                                 
                                    
                                       S
                                    
                                    
                                       X
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       Y
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                    
                                       Z
                                    
                                 
                              
                           , respectively, i.e.: 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                       ,
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       j
                                    
                                    
                                       s
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       j
                                    
                                    
                                       m
                                       ,
                                       s
                                    
                                 
                              
                           .

The Lagrangean dual can be formulated as follows:
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                (
                                                LDP
                                                )
                                                :
                                                
                                                
                                                   max
                                                
                                             
                                          
                                          
                                             
                                                
                                                U
                                                +
                                                V
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                      ,
                                                      s
                                                   
                                                
                                                
                                                ∀
                                                s
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      Z
                                                   
                                                
                                                ,
                                                
                                                ∀
                                                j
                                                ∈
                                                J
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    
                                    V
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    (
                                    
                                       
                                          g
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    
                                       
                                          W
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    
                                       
                                          Y
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    
                                    ∀
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          Y
                                       
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                    U
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             P
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          ij
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          p
                                       
                                    
                                    )
                                    
                                       
                                          X
                                       
                                       
                                          ij
                                       
                                       
                                          p
                                          ,
                                          s
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             P
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             K
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                          ,
                                          s
                                       
                                    
                                    
                                    ∀
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                    V
                                    ∈
                                    R
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    
                                    U
                                    ∈
                                    R
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    
                                    
                                       
                                          W
                                       
                                       
                                          j
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                       
                                    
                                    ⩾
                                    0
                                 
                              
                           
                        

As problem (LDP) contains a huge number of constraints, we consider its dual (MP) which is going to be used as master problem in the weighted Dantzig–Wolfe decomposition. Let 
                              
                                 
                                    
                                       α
                                    
                                    
                                       j
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       s
                                    
                                 
                              
                            be the dual variables for constraints (17)–(19), respectively. The dual (MP) of (LDP) is given below. The dual variables of constraints (24)–(27) correspond respectively to the variables 
                              
                                 U
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                              
                            and V of the Lagrangean dual problem.
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                (
                                                MP
                                                )
                                                :
                                                
                                                
                                                   min
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         s
                                                         ∈
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               Z
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                      ,
                                                      s
                                                   
                                                
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      s
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         s
                                                         ∈
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               Y
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      s
                                                   
                                                
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  p
                                                                  ∈
                                                                  P
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  i
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  ∈
                                                                  J
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        X
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ij
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               ij
                                                            
                                                            
                                                               p
                                                               ,
                                                               s
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  p
                                                                  ∈
                                                                  P
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  ∈
                                                                  J
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  k
                                                                  ∈
                                                                  K
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     
                                                                        S
                                                                     
                                                                     
                                                                        X
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               jk
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               jk
                                                            
                                                            
                                                               p
                                                               ,
                                                               s
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         s
                                                         ∈
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               X
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      s
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   Y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          s
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   j
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   j
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             ∈
                                             
                                                
                                                   M
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          Z
                                       
                                       
                                          j
                                       
                                       
                                          m
                                          ,
                                          s
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          j
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   X
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             ∈
                                             P
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          X
                                       
                                       
                                          ij
                                       
                                       
                                          p
                                          ,
                                          s
                                       
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          s
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   Y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          β
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    1
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                       
                                          s
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                       
                                          Z
                                       
                                    
                                    ,
                                    
                                    ∀
                                    j
                                    ∈
                                    J
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                    
                                       
                                          β
                                       
                                       
                                          s
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          Y
                                       
                                    
                                 
                              
                           
                           
                              
                                 (30)
                                 
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          s
                                       
                                    
                                    ⩾
                                    0
                                    
                                    ∀
                                    s
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          X
                                       
                                    
                                 
                              
                           
                        

In order to implement column generation, we construct a restricted master problem by replacing the sets 
                              
                                 
                                    
                                       S
                                    
                                    
                                       X
                                    
                                 
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       Y
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                    
                                       Z
                                    
                                 
                                 
                                 (
                                 j
                                 ∈
                                 J
                                 )
                              
                            of the master problem by subsets 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       X
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       Y
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       Z
                                    
                                 
                                 
                                 (
                                 j
                                 ∈
                                 J
                                 )
                              
                           . These subsets are respectively initialized with solutions from the pools 
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       y
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       z
                                    
                                 
                              
                           , gathered during the subgradient procedure (Algorithm 1). By solving the restricted master problem optimally, we obtain the values of its dual variables, denoted as 
                              
                                 
                                    
                                       U
                                    
                                    
                                       ∼
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ̃
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       V
                                    
                                    
                                       ∼
                                    
                                 
                              
                           . Using the values of these variables, we attempt to price out new columns (variables) whose reduced costs are negative.

Firstly, for each depot 
                              
                                 j
                                 ∈
                                 J
                              
                           , we solve a bounded knapsack problem with fixed values 
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       ̃
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              
                           :
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      RC
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                -
                                                
                                                   max
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                -
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      Z
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

If reduced cost 
                              
                                 
                                    
                                       RC
                                    
                                    
                                       1
                                    
                                    
                                       j
                                    
                                 
                              
                            is negative, we price out the corresponding columns 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       j
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 m
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       j
                                    
                                 
                              
                           . Next, the following 0–1 knapsack problem is solved with 
                              
                                 
                                    
                                       V
                                    
                                    
                                       ∼
                                    
                                 
                              
                           :
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      RC
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            W
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                )
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      Y
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Columns 
                              
                                 
                                    
                                       Y
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 j
                                 ∈
                                 J
                              
                           , are priced out when reduced cost 
                              
                                 
                                    
                                       RC
                                    
                                    
                                       2
                                    
                                 
                              
                            is negative. Finally, we turn to a minimum-cost flow subproblem with fixed values for 
                              
                                 
                                    
                                       U
                                    
                                    
                                       ∼
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 ∀
                                 j
                                 ∈
                                 J
                              
                           . Similarly, all columns 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                    
                                    
                                       p
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       X
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                              
                            are priced out if reduced cost 
                              
                                 
                                    
                                       RC
                                    
                                    
                                       3
                                    
                                 
                              
                            is negative.
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      RC
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   min
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         ∈
                                                         P
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ij
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  
                                                                     λ
                                                                  
                                                                  
                                                                     ̃
                                                                  
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      p
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         ∈
                                                         P
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      p
                                                   
                                                
                                                -
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      X
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The WDWD procedure is composed of two parts: one concerns the restricted master problem while the other deals with the Lagrangean subproblems. The first part iteratively solves the restricted master problem by the column generation technique to insert at each iteration high-quality columns into the problem, while improving Lagrangean multipliers. The second part aims to further improve the best lower bound by solving the Lagrangean subproblems, using multipliers provided by the first part. It is worth noting that the second part also prices out good columns into the restricted master problem, which accelerate convergence. Therefore, these two parts are interdependent.

According to preliminary tests, we observed that the restricted master problem becomes harder to solve as columns are repeatedly added. However, many columns in the restricted master problem do not correspond to basic variables in the optimal solution. We adopt the method proposed by Klose and Görtz (2007) in order to accelerate the weighted Dantzig–Wolfe decomposition procedure by eliminating the columns which are non-basic during a certain number of iterations.

The WDWD procedure in this paper extends the traditional WDWD procedure proposed by Wentges (1997), which is an overall solution architecture, by including the method of updating subsets of MP, the approach of updating Lagrangean multipliers and iterative multipliers, the criterion of adding new columns into MP, and stopping condition of WDWD procedure.


                           Algorithm 2 depicts the WDWD procedure. 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       RMP
                                    
                                 
                              
                            denotes the objective value of the restricted master problem. 
                              
                                 
                                    
                                       UB
                                    
                                    
                                       ∗
                                    
                                 
                              
                            is the best upper bound found and 
                              
                                 
                                    
                                       LB
                                    
                                    
                                       ∗
                                    
                                 
                              
                            the best lower bound. 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       DW
                                    
                                 
                              
                            is the chosen tolerance, h the iteration number and 
                              
                                 
                                    
                                       H
                                    
                                    
                                       DW
                                    
                                 
                              
                            the maximum number of iterations. 
                              
                                 
                                    
                                       N
                                    
                                    
                                       b
                                    
                                 
                              
                            is the number of iterations before removing a non-basic column. 
                              
                                 
                                    
                                       N
                                    
                                    
                                       imp
                                    
                                 
                              
                            is the number of improvements of the lower bound since the beginning of the algorithm. 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ∗
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ̃
                                    
                                 
                              
                            respectively denote the best and current multipliers. A weighted average 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ¯
                                    
                                 
                              
                            is deduced in line 8, using a weight 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       h
                                    
                                 
                              
                            and a constant 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . The formula used gives more importance to the best multipliers as the number of iterations grows, to better exploit the information they represent.

Path-relinking strategy was initially proposed as post-optimization procedure within a tabu search algorithm by Glover and Laguna (1997) but it can be applied to most metaheuristics. It consists in exploring trajectories (paths) that link elite solutions collected during the metaheuristic. To build a path between two elite solutions, one of them (the initiating solution) is progressively transformed into the other one (the guiding solution), which generates a sequence of intermediate solutions. The transformation is often based on a kind of move that introduces in the incumbent solution attributes of the guiding solution.

Our path-relinking for the TSFLP-HC is depicted in Algorithm 3. It works in the space of 0–1 vectors 
                           
                              Y
                           
                         which define the status open/closed for each depot. A path is generated between the two best vectors found during the previous phases. The best of the two, 
                           
                              Y
                              
                                 
                                 
                                    I
                                 
                              
                           
                        , is used as initiating solution, the other 
                           
                              Y
                              
                                 
                                 
                                    G
                                 
                              
                           
                         being the guiding solution. Starting from 
                           
                              Y
                              =
                              Y
                              
                                 
                                 
                                    I
                                 
                              
                           
                        , we set 
                           
                              
                                 
                                    Y
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    Y
                                 
                                 
                                    j
                                 
                                 
                                    G
                                 
                              
                           
                         for 
                           
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              |
                              J
                              |
                           
                        , i.e., the 0–1 vector 
                           
                              Y
                           
                         is progressively transformed into 
                           
                              Y
                              
                                 
                                 
                                    G
                                 
                              
                           
                        , from left to right. A slope scaling heuristic is executed to deduce a feasible TSFLP-HC solution from each new vector 
                           
                              Y
                           
                        . 
                           
                              Z
                              (
                              Y
                              )
                           
                         denotes the cost of this solution.
                           Algorithm 2
                           Weighted Dantzig–Wolfe decomposition
                                 
                                    
                                       
                                       
                                          
                                             1: let 
                                                   
                                                      
                                                         
                                                            UB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            LB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 be the best upper bound and the best lower bound obtained by Algorithm 1 and Lagrangean relaxation
                                          
                                          
                                             2: initialize: 
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            DW
                                                         
                                                      
                                                      =
                                                      0.01
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            DW
                                                         
                                                      
                                                      =
                                                      50
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                      =
                                                      5
                                                   
                                                , 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            imp
                                                         
                                                      
                                                      =
                                                      0
                                                      ,
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      2
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            UB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             3: for 
                                                
                                                   
                                                      h
                                                      =
                                                      1
                                                   
                                                 
                                                to 
                                                
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            DW
                                                         
                                                      
                                                   
                                                 
                                                while 
                                                
                                                   
                                                      min
                                                      {
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            RMP
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            UB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      }
                                                      /
                                                      
                                                         
                                                            LB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      >
                                                      1
                                                      +
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            DW
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             4: 
                                                //Restricted master problem
                                             
                                          
                                          
                                             5: 
                                                solve the RMP with subsets 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            Y
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      (
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             6: 
                                                record the objective value 
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            RMP
                                                         
                                                      
                                                   
                                                 and the current dual variables 
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  W
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             7: 
                                                remove all columns in 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            Y
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      
                                                      j
                                                      ∈
                                                      J
                                                   
                                                 which have been non-basic for the last 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                 iterations
                                          
                                          
                                             8: 
                                                compute the weight 
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      =
                                                      min
                                                      {
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      ,
                                                      (
                                                      h
                                                      +
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            imp
                                                         
                                                      
                                                      )
                                                      /
                                                      2
                                                      }
                                                   
                                                 and the new multipliers 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ϕ
                                                                        
                                                                        
                                                                           h
                                                                        
                                                                     
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ϕ
                                                                        
                                                                        
                                                                           h
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             9: 
                                                column generation: add all variables 
                                                   
                                                      X
                                                      ,
                                                      Y
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      (
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                 priced out into 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            Y
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      (
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             10: //Lagrangean subproblems
                                             
                                          
                                          
                                             11: set 
                                                   
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            h
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             12: 
                                                loop
                                             
                                          
                                          
                                             13: using 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                , solve problems FSP and 0–1KP with problems 
                                                   
                                                      BKP
                                                      (
                                                      j
                                                      )
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                          
                                          
                                             14: new objective values U and V and a new solution 
                                                   
                                                      (
                                                      X
                                                      ,
                                                      Y
                                                      ,
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                 are obtained
                                          
                                          
                                             15: 
                                                if 
                                                
                                                   
                                                      U
                                                      +
                                                      V
                                                      >
                                                      
                                                         
                                                            LB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 
                                                then 
                                                
                                                   
                                                      
                                                         
                                                            LB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      U
                                                      +
                                                      V
                                                      ,
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            imp
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            imp
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                endif
                                             
                                          
                                          
                                             16: deduce reduced costs of variables in 
                                                   
                                                      (
                                                      X
                                                      ,
                                                      Y
                                                      ,
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                 from dual variables 
                                                   
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            ∼
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  W
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                          
                                          
                                             17: 
                                                exit when there exist variables with negative reduced costs in 
                                                   
                                                      (
                                                      X
                                                      ,
                                                      Y
                                                      ,
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             18: set 
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  h
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  h
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      0.05
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  ϕ
                                                               
                                                               
                                                                  h
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ϕ
                                                                        
                                                                        
                                                                           h
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                     -
                                                                     1
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           ϕ
                                                                        
                                                                        
                                                                           h
                                                                        
                                                                        
                                                                           ′
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             19: 
                                                end loop
                                             
                                          
                                          
                                             20: add variables with negative reduced costs to 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            X
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            Y
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                   
                                                , respectively
                                          
                                          
                                             21: apply the Lagrangean heuristic of Section 3.2 to repair solution 
                                                   
                                                      (
                                                      X
                                                      ,
                                                      Y
                                                      ,
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      j
                                                      ∈
                                                      J
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             22: let 
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            fea
                                                         
                                                      
                                                   
                                                 be the objective value of the resulting feasible solution
                                          
                                          
                                             23: 
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            fea
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            UB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 
                                                then 
                                                
                                                   
                                                      
                                                         
                                                            UB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            fea
                                                         
                                                      
                                                   
                                                 
                                                endif
                                             
                                          
                                          
                                             24: end for
                                             
                                          
                                       
                                    
                                 
                              
                           

Path-relinking procedure
                                 
                                    
                                       
                                       
                                          
                                             1: 
                                                   
                                                      Y
                                                      =
                                                      Y
                                                      
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2: for 
                                                
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                 
                                                to 
                                                
                                                   
                                                      |
                                                      J
                                                      |
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             3:  
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            G
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             4:  
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             5: 
                                                 close depot j (
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                ) and open the nearest closed depot 
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                 in 
                                                   
                                                      {
                                                      j
                                                      +
                                                      1
                                                      ,
                                                      j
                                                      +
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      |
                                                      J
                                                      |
                                                      }
                                                      
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             6:  
                                                else
                                             
                                          
                                          
                                             7: 
                                                 open depot j 
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      1
                                                      )
                                                   
                                                 and close the nearest depot 
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                 in 
                                                   
                                                      {
                                                      j
                                                      +
                                                      1
                                                      ,
                                                      j
                                                      +
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      |
                                                      J
                                                      |
                                                      }
                                                      
                                                      (
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      0
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             8:  
                                                end if
                                             
                                          
                                          
                                             9:  apply the slope scaling heuristic (see text) to derive a feasible TSCFLP-HC from 
                                                   
                                                      Y
                                                   
                                                
                                             
                                          
                                          
                                             10: 
                                                
                                                if 
                                                
                                                   
                                                      Z
                                                      (
                                                      Y
                                                      )
                                                      <
                                                      Z
                                                      (
                                                      Y
                                                      
                                                         
                                                         
                                                            G
                                                         
                                                      
                                                      )
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             11: 
                                                 record the solution 
                                                   
                                                      Y
                                                   
                                                 and update the best upper bound 
                                                   
                                                      
                                                         
                                                            UB
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             12: 
                                                
                                                end if
                                             
                                          
                                          
                                             13:  
                                                end if
                                             
                                          
                                          
                                             14: end for
                                             
                                          
                                       
                                    
                                 
                              
                           

Slope scaling is an efficient heuristic successfully applied to facility location problems (Gendron et al., 2003), network design (Crainic, Gendron, & Hernu, 2004) and special minimum-cost flow problems (Kim & Pardalos, 2000). It is applied here to each vector 
                              
                                 Y
                              
                            generated in Algorithm 3. Each iteration begins by solving the following minimum-cost flow problem 
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            for the set 
                              
                                 
                                    
                                       J
                                    
                                    
                                       ‾
                                    
                                 
                              
                            of open depots defined by 
                              
                                 Y
                              
                           :
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                :
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                Y
                                                )
                                                =
                                                
                                                   min
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         ∈
                                                         P
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      p
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         ∈
                                                         P
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                             
                                          
                                          
                                             
                                                
                                                Constraints
                                                
                                                (
                                                2
                                                )
                                                –
                                                (
                                                4
                                                )
                                                ,
                                                
                                                (
                                                9
                                                )
                                                
                                                and
                                                
                                                (
                                                10
                                                )
                                                .
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         ∈
                                                         P
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                ∀
                                                j
                                                ∈
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The transportation costs 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                              
                            are initialized with the original costs 
                              
                                 h
                              
                           . Let 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ‾
                                    
                                 
                              
                            be the resulting solution.

Next, using 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ‾
                                    
                                 
                              
                           , we solve one problem 
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                            for each open depot of 
                              
                                 
                                    
                                       J
                                    
                                    
                                       ‾
                                    
                                 
                              
                            to find the number of handling modules required for each type. 
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              
                            denotes the solution obtained for problem 
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       ‾
                                    
                                 
                              
                           .
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               2
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                :
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                                )
                                                =
                                                
                                                   min
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                         ∈
                                                         P
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            ‾
                                                         
                                                      
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                0
                                                ⩽
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                integer
                                                
                                                ∀
                                                m
                                                ∈
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Until now, we got a feasible solution defined by 
                              
                                 Y
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       ‾
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                                 
                                 (
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       ‾
                                    
                                 
                                 )
                              
                           . We can observe that problem 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            and problems 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                    
                                       j
                                    
                                 
                              
                            (
                              
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       ‾
                                    
                                 
                              
                           ) are solved separately, i.e., variables 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ‾
                                    
                                 
                              
                            are determined without considering handling costs. We apply the slope scaling technique proposed by Crainic et al. (2004) to improve solution quality. It consists in incorporating the handling costs into the transportation costs for each arc incident with depot 
                              
                                 j
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       ‾
                                    
                                 
                              
                           .
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ij
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          ij
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ‾
                                             
                                          
                                          )
                                       
                                       
                                          2
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ∈
                                                P
                                             
                                          
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                ij
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    p
                                    ∈
                                    P
                                    ,
                                    
                                    ∀
                                    i
                                    ∈
                                    I
                                 
                              
                           
                           
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          h
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          p
                                       
                                    
                                    
                                       
                                          
                                             
                                                Z
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ‾
                                             
                                          
                                          )
                                       
                                       
                                          2
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ∈
                                                P
                                             
                                          
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                          
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                jk
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    p
                                    ∈
                                    P
                                    ,
                                    
                                    ∀
                                    k
                                    ∈
                                    K
                                 
                              
                           
                        

This completes one iteration. The process is repeated with the new costs 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                              
                           . If the denominator of Eq. (31) or (32) becomes null for a depot 
                              
                                 j
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       ‾
                                    
                                 
                              
                           , the corresponding modified cost is set to the maximum value obtained in previous iterations. The slope scaling heuristic stops when 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                              
                            does not change.

All algorithms were coded in Java and evaluated on a server with a 2gigahertz Intel Xeon processor, 2gigabytes of RAM and the Linux operating system. The following subsection describes how the instances used are generated. Next, the lower and upper bounds are compared with the results of CPLEX, on instances with 5 products and 62–224 nodes Finally, more detailed results are given for instances with up to 3–7 products and 62–434 nodes, varying the following parameters: the ratio number of depots/number of plants, the ratio number of customers/number of depots, the number of products, the average number of module types and the ratio total capacity of depots/total demand.

The nodes of our instances are located on a 
                           
                              3
                              ×
                              2
                           
                         grid, like in Gendron et al. (2003). In these graphs, customers and depots are confined in predefined customer zones and depot zones. Depot zones overlap customer zones. Each zone is defined by a density which determines the number of nodes in it. Since our problem has an additional layer (the plants), we randomly distribute the plant locations in the depot zones, according to the zone density. Transportation costs are equal to the Euclidean distance, multiplied by a random factor in 
                           
                              [
                              1
                              ,
                              5
                              ]
                           
                        . The reader is referred to the work of Gendron et al. (2003) for more details about this node generation method. The links between depots in this work are here ignored, since our problem excludes shipments among depots.

As the problem considered in this paper is similar to the one of (Li et al., 2011), most parameters of test instances were constructed by using the random generation method proposed in our preliminary trial (Li et al., 2011), but with slight difference on two parameter definition: (1) the number of modules of type m at depot j (
                           
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                           
                        ) is drawn in 
                           
                              [
                              0.8
                              ×
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              /
                              (
                              10
                              ×
                              |
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              |
                              )
                              ,
                              1.2
                              ×
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              /
                              (
                              10
                              ×
                              |
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              |
                              )
                              ]
                           
                         and (2) the handling cost 
                           
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                           
                         is set to 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          tot
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              /
                              (
                              10
                              ×
                              |
                              K
                              |
                              )
                           
                        , in which 
                           
                              
                                 
                                    h
                                 
                                 
                                    tot
                                 
                              
                           
                         denotes the sum of unit transportation costs over all arcs. The tests involve 30 groups of 5 instances each. All instances in a group share the following attributes: the number of plants 
                           
                              |
                              I
                              |
                           
                        , the number of potential depots 
                           
                              |
                              J
                              |
                           
                        , the number of customers 
                           
                              |
                              K
                              |
                           
                         and the average number of module types per depot, denoted as 
                           
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                           
                        . All other data are randomly generated using uniform distributions.

In this subsection, results of our algorithm are first compared with those of CPLEX, on 12 groups of instances P1 to P12 with 
                           
                              
                                 
                                    R
                                 
                                 
                                    JI
                                 
                              
                              =
                              |
                              J
                              |
                              /
                              |
                              I
                              |
                              =
                              10
                              ,
                              
                                 
                                    R
                                 
                                 
                                    KJ
                                 
                              
                              =
                              |
                              K
                              |
                              /
                              |
                              J
                              |
                              =
                              2
                              ,
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              =
                              10
                           
                         and 
                           
                              Δ
                              =
                              2
                           
                        . To improve CPLEX performance, we set cut strategy of GUB cuts, flow cover cuts and cover cuts with aggressive. The results are shown in Table 1
                        . The columns for CPLEX concern the linear mixed-integer program (1)–(12) presented in Section 2. For the five instances of each group, they provide average values for the solution gap in percent, the CPU time in seconds and the number of failures due to memory overflows (Fail). The gap is computed as 
                           
                              (
                              
                                 
                                    UB
                                 
                                 
                                    CPLEX
                                 
                              
                              -
                              
                                 
                                    LB
                                 
                                 
                                    CPLEX
                                 
                              
                              )
                              ×
                              100
                              /
                              
                                 
                                    LB
                                 
                                 
                                    CPLEX
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    UB
                                 
                                 
                                    CPLEX
                                 
                              
                           
                         and 
                           
                              
                                 
                                    LB
                                 
                                 
                                    CPLEX
                                 
                              
                           
                         denote the upper and lower bounds found by CPLEX. A memory overflow occurs when there is no memory left to allocate new nodes in the branch-and-bound procedure of CPLEX. In that case, the solver returns the best bounds found at this time point. SOP means the subgradient optimization procedure and DWPR the weighted Dantzig–Wolfe decomposition followed by the path-relinking procedure. The gap is equal to 
                           
                              (
                              
                                 
                                    UB
                                 
                                 
                                    ∗
                                 
                              
                              -
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                              )
                              ×
                              100
                              /
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    UB
                                 
                                 
                                    ∗
                                 
                              
                           
                         and 
                           
                              
                                 
                                    LB
                                 
                                 
                                    ∗
                                 
                              
                           
                         are the best bounds achieved by our approach. The last two lines display the average and standard deviations for the gaps and running times.

We can observe that CPLEX can solve to optimality the smallest instances, in groups P1 (62 nodes) and P2 (64 nodes). For all the other groups, the branch-and-bound of CPLEX lacks memory and the CPU time grows rapidly with problem size, exceeding 3hours on instances with more than 200 nodes (groups P6 and P12). Apart from groups P1, P2, P3, P7 and P8 (at most 124 nodes) for which CPLEX provides smaller solution gaps, the deviations obtained by the two approaches are quite close. Our approach even outperforms CPLEX a little on groups P9 and P12. In all cases, the SOP+DWPR achieves small gaps (average 1.31%, maximum 1.73), in less than one hour of computation.


                        Table 2
                         illustrates the contribution of the two phases of our approach, the subgradient optimization procedure (SOP) and the weighted Dantzig-Wolfle decomposition followed by path-relinking (WDPR). We can see that SOP achieves a gap of 3.93%, in 18minutes on average and 54minutes on the largest instances of group P21 with 310 nodes, 5 products and 10 module types per depot. WDPR divides these gaps by three, which can be explained by its better exploitation of problem structure. Moreover, the gaps are rather stable, as shown by the standard deviation. The price to pay is a larger running time, multiplied by 2.4 compared with SOP. Three hours are required for the largest instances, which is acceptable for a problem involving strategic decisions: building depots on the selected sites will engage the company for years, which is worth consuming a few hours of computer time.


                        Tables 3 and 4
                        
                         show how results are affected if more plants or more customers are added, with the same number of depots. In Table 3, 
                           
                              
                                 
                                    R
                                 
                                 
                                    JI
                                 
                              
                           
                         is reduced to 5 while 
                           
                              
                                 
                                    R
                                 
                                 
                                    KJ
                                 
                              
                           
                         is increased up to 
                           
                              2.5
                           
                         in Table 4. In both cases, the flow subproblem (FSP) formulated in Section 3.1 is larger and, as it is repeatedly solved in the subgradient procedure and in the weighted Dantzig–Wolfe decomposition, the two phases last longer on average, especially in Table 4 (+15% for SOP and +34% for DWPR). However, the solution gaps are only marginally affected. The average distance to the lower bound increases a bit when more plants are added, but the difference comes mainly from instances with 20 depots, for which the results are not as good as in Table 2 (1.73% vs. 0.72%). This average is even slightly improved in the case of additional customers (1.09%). In the two cases, the gaps are remarkably stable, with a standard deviation below 0.2%. We can conclude that our approach is not very sensitive to the numbers of plants or customers.

We provide in Table 5
                         results for 3 and 7 products instead of 5. A smaller number of products decreases the number of variables in the multicommodity min-cost flow problem (FSP). Our algorithms are in that case able to solve larger instances with up to 140 depots and 434 nodes (P37 group). Increasing the number of products has an opposite effect: with a running time limited to 5hours (18,000seconds), we cannot solve instances as large as in the previous tables: the biggest instances (P49 group) contain 80 depots and 248 nodes. Again in this table, solution quality and stability must be underlined.


                        Table 6
                         presents some results when the average number 
                           
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                           
                         of module types is doubled. The running times increase a bit but the solution gaps are very close to those in Table 2, although we have to choose among more module types. The reason is that the associated knapsack problems are solved very rapidly by modern solvers like CPLEX.

Finally, we tried to change the tightness factor 
                           
                              Δ
                           
                         used to choose depot capacities in the random generation of instances (Section 4.1). This parameter was set to 2 in previous tables. Table 7
                         depicts the results for 
                           
                              Δ
                              =
                              2.25
                           
                         and 
                           
                              Δ
                              =
                              1.75
                           
                        . Compared with the case 
                           
                              Δ
                              =
                              2
                           
                         (Table 2) with its average solution gap of 1.24%, the problem becomes harder when the total capacity of depot sites is closer to total demand (
                           
                              Δ
                              =
                              1.75
                           
                        ): the gap reaches 1.46% and the running time increases by 72%. When 
                           
                              Δ
                              =
                              2.25
                           
                        , our method returns smaller solution gaps (1.17%) but the running is still larger (+34%). The reason probably resides in the higher number of possible choices for the open depots.

In this paper, in addition to the opening costs of depots and transportation costs considered in the classical two-stage capacitated facility location problem, we handle handling costs to make a step toward on a more realistic problem since the cross-docking operations in logistic hubs is known to represent a labor and capital intensive process. The proposed solution method integrates a subgradient optimization procedure based on the Lagrangean relaxation of a linear mixed-integer formulation of the problem, a weighted Dantzig–Wolfe decomposition and path-relinking.

The tests on 350 randomly generated instances with 62–434 nodes show that our approach consistently provides average solution gaps below 1.5%, with a remarkable stability confirmed by standard deviations. In comparison, a direct resolution of the MIP via CPLEX leads to a systematic memory overflow beyond 64 nodes. Concerning running times, instances with 100 nodes can be tackled in 15minutes and with 200 nodes in less than four hour. The computational time is mainly affected by the number of products, with up to 4hours and 40minutes for 8 plants, 80 depots and 160 customers. However, such durations are acceptable for a problem involving decisions at the strategic level.

In the future, we envisage to extend our problem by considering a multiperiod horizon, giving a dynamic facility location problem with handling costs. Besides deciding which depots must be opened or closed, we wish to tackle period-dependent demands, supplies, shipment costs and the labor force. The goal will be to minimize the total cost of the system over the planning horizon. Our next step is to elaborate an efficient and effective solution method for this interesting problem.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank the referees for their helpful and careful remarks, which have improved the quality of the paper.

@&#REFERENCES@&#

