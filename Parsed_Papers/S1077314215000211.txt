@&#MAIN-TITLE@&#Discriminative structured dictionary learning with hierarchical group sparsity

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A powerful discriminative dictionary learning method is proposed.


                        
                        
                           
                           Our method is built upon collaborative hierarchical group sparsity.


                        
                        
                           
                           Dictionary and classifier are simultaneously learned.


                        
                        
                           
                           An efficient alternating iterative scheme is presented.


                        
                        
                           
                           Our method has shown excellent performance on several image recognition tasks.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Discriminative dictionary learning

Structured sparse coding

Group sparsity

Image classification

@&#ABSTRACT@&#


               
               
                  Learning adaptive dictionaries for sparse coding has been the focus of latest research as it provides a promising way to maximize the efficiency of sparse representation. In particular, learning discriminative dictionaries rather than reconstructive ones has demonstrated significantly improved performance in pattern recognition. In this paper, a powerful method is proposed for discriminative dictionary learning. During the dictionary learning process, we enhance the discriminability of sparse codes by promoting hierarchical group sparsity and reducing linear prediction error on sparse codes. With the employment of joint within-class collaborative hierarchical sparsity, our method is able to learn adaptive dictionaries from labeled data for classification, which encourage coefficients to be sparse at both group level and singleton level and thus enforce the separability of sparse codes. Benefiting from joint dictionary and classifier learning, the discriminability of sparse codes is further strengthened. An efficient alternating iterative scheme is presented to solve the proposed model. We applied our method to face recognition, object recognition and scene classification. Experimental results have demonstrated the excellent performance of our method in comparison with existing discriminative dictionary learning approaches.
               
            

@&#INTRODUCTION@&#

In recent years, sparse representation has drawn much attention from the computer vision community and led to state-of-the-art results in many computer vision tasks, e.g. image classification [1–4] and image restoration [5–8]. The success of sparse representation based classification is attributed to the fact that high-dimensional image data from the same class lie on a low-dimensional manifold and thus can be coded using a few representative elements (the so-called atoms). The collection of such elements is often referred to as a dictionary.

The choice of dictionary is one of the fundamental considerations in employing sparse representation based models. While predefined dictionaries such as off-the-shelf bases like wavelets [5,7] have been successfully applied to sparse modeling in many signal processing applications, many reconstructive dictionary learning methods [9–12] have shown that noticeable performance improvement can be obtained by learning adaptive dictionaries from data themselves. The learned reconstructive dictionaries are adapted to the underlying structures of data and hence are able to improve the efficiency of sparse coding.

However, the reconstructive dictionaries often suffer from the insufficiency of discrimination in complex recognition tasks. In fact, a dictionary becomes useful for sparsity-based recognition when it not only enjoys excellent sparse-representational power but also has the ability to induce discriminative representation for samples from different categories. As a result, many discriminative dictionary learning methods [13–25] have been proposed to learn both reconstructive and discriminative dictionaries for sparse coding.

In this paper, a powerful discriminative dictionary learning method is proposed for sparse coding based classification. In the proposed method, we simultaneously learn a structured dictionary with hierarchical group sparsity and train a linear classifier for classification. By promoting joint within-class collaborative hierarchical sparsity in sparse codes, our method is able to learn dictionaries adapted to the underlying structures of data. The learned dictionaries encourage samples from different categories to exhibit distinct hierarchical group sparsity patterns, making the sparse codes more separable between classes. Meanwhile, benefiting from joint dictionary learning and classifier training, the learned dictionaries are both reconstructive and discriminative. As a result, the discriminability of sparse codes and the discrimination of active groups of dictionary atoms are further strengthened. Experimental results on face recognition, object recognition and scene classification have demonstrated the excellent performance of our method in comparison with many state-of-the-art discriminative dictionary learning methods.

@&#RELATED WORK@&#

The techniques used in discriminative dictionary learning methods can be roughly categorized into two types, which are detailed as follows:


                           
                              Learning class-associated subdictionaries.
                            In order to obtain discriminative dictionaries, many approaches (e.g. [15,19,20]) train class-associated subdictionaries using labeled data. The differences of these approaches lie in two aspects: the way of associating subdictionaries with class information and the regularization imposed on subdictionaries. For instance, Yang et al. [23] proposed to associate each dictionary atom with a class label and encourage each input signal to be well represented only by the dictionary atoms that share the same class label with the signal. In [20], the class-specific subdictionaries dictionaries are encouraged to be independent of each other.


                           
                              Integrating supervised learning.
                            To enforce discriminability in sparse codes, many approaches incorporate classifier training into the dictionary learning, i.e., the dictionary and classifier are jointly learned. The classification loss functions vary in these methods, e.g., the softmax discriminative cost [15,16], Fisher discrimination criterion [13,23,24,26], linear predictive classification error [17,22,25], hinge loss [21,27], and logistic loss [16,28].

While the standard sparsity induced by 
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       0
                                    
                                 
                              
                            norm or its convex relaxation 
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                              
                            norm has been widely-used for sparse coding, recent literature [29–43] seeks for some higher-level sparsity (often referred to as structured sparsity) to encode higher-order information about the patterns of non-zero coefficients in sparse codes. The concept of structured sparsity is first introduced in image restoration and the benefits of structured sparse coding have been confirmed both theoretically and via numerous applications [33]. There are many types of structured sparsity, e.g., sparsity defined on disjunct groups [38,39] or overlapping groups [31], tree sparsity [34,35,43], and graph sparsity [30].

The structured sparsity is an effective tool to reveal the underlying structures of data. Thus, a few methods [40–43] employ structured sparsity in dictionary learning for classification. In [43], Szlam et al. proposed a fast approximate sparse coding algorithm that uses a tree structure for inference and applied it to build an accurate real time object recognition system. For face recognition, Jenatton et al. [41] proposed the so-called structured sparse PCA, in which the sparsity patterns of all dictionary elements are structured and constrained in a pre-specified set of shapes. Although impressive results have been achieved by these methods, there is still much room for the improvement of discriminability in sparse codes.

We illustrate our motivation by two examples. See Fig. 1
                         for an illustration of the benefits of using hierarchical group sparsity in document representation. Assume that we have multiple documents that are related to different topics, e.g. political news and fashion magazines. The key words of the documents serve naturally as a good dictionary, and thus each document can be represented by histogram of key words. Then we assign the dictionary atoms (i.e. key words) into several groups, e.g. city-state nouns, fashion-related words, etc. The histogram of key words of a document should be sparse because each only contains a tiny part of all the key words. This can be considered as the singleton-level sparsity. Besides, each document can be efficiently represented by the words from a few specific groups, which can be interpreted as group-level sparsity. Furthermore, documents from the same category would share the same sparsity pattern at the group-level but not necessarily at the singleton-level. This naturally yields to the joint within-class collaborative hierarchical sparse representation. Such a well-designed group sparsity is very effective and efficient for classifying documents.

Now turn to the case of image classification, in which we do not have a good dictionary containing well-clustered visual key words. Thus, it is necessary to learn a structured dictionary to obtain joint within-class collaborative hierarchical sparse representation for image classification. See Fig. 2
                         for the example. Suppose we have obtained some low-level features (e.g. bag-of-words based on SIFT descriptors [44]) of multiple object images from different categories. Such features on some objects (e.g. cats and leopards) are quite similar such that they are rarely linearly separable in feature space. Then we need to pursue an ideal group-structured dictionary consisting of good atoms (e.g. visual attributes), each of which could capture certain common properties across different categories, either semantic (e.g. furry) or discriminative (e.g. cats have it but leopards do not). Once we get such a dictionary, collaborative hierarchical group sparsity patterns can be obtained for each object category, just like the case in document representation. Such joint within-class collaborative hierarchical sparse representation is more separable for classification than the original feature. In Fig. 2, active groups of two distinct categories could be very different, e.g. group 1 and 2 for wild cat and group 3 and 4 for lotus. Two closely-related categories (e.g. cats and leopards) may have some overlap group (e.g. group 1) but can still be distinguished.

In real-world applications, often the learned group-structured dictionary is insufficiently discriminative for classification. In particular, each active group is not guaranteed to be shared by few classes. In the case where active groups are shared by a lot of classes, the discriminability of the structured sparse codes would dramatically decrease. Thus, more discriminative information like classification feedback should be incorporated into structured dictionary learning, which can improve the interclass discrimination of active atom groups and sparse codes.

The arguments above inspire us to propose a discriminative structured dictionary learning approach for sparse coding, which integrates hierarchical group sparsity promotion and classifier training into the dictionary learning process. Compared with the traditional purely reconstructive dictionary learning methods, the learned dictionaries are both reconstructive and discriminative. In comparison with the purely supervised dictionary learning methods like D-KSVD [22], the dictionaries learned by our method can reveal the underlying structures of data and encourage distinct hierarchical group sparsity patterns on sparse codes of samples from different categories. Compared to the purely structured dictionary learning methods, our method is able to support the discrimination of active groups shared by different classes and produce discriminative sparse codes for classification. Experimental results on face recognition, object recognition and scene classification have demonstrated the excellent performance of our method in comparison with many state-of-the-art discriminative dictionary learning methods.

The rest of this paper is organized as follows. Section 2 is devoted to the preliminaries and background knowledges on sparse representation and discriminative dictionary learning. Section 3 describes our method. Section 4 is for experimental evaluation and results. Section 5 concludes the paper and discusses future work.

We first give an introduction to the definitions and notations used in this paper. Bold upper letters are used for matrices, bold lower letters for column vectors, regular lower letters for scalars, and calligraphic English alphabets for sets. For example, 
                        
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                        
                      denotes the j-th column of the matrix 
                        
                           Y
                           ,
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                        
                      denotes the i-th element of the vector 
                        
                           y
                        
                     , and 
                        
                           
                              
                                 Y
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        
                      denotes the entry of 
                        
                           Y
                        
                      at the i-th row and the j-th column. Besides, let 
                        
                           
                              
                                 y
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                      denote the 
                        
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        
                     -th element of a sequence 
                        
                           
                              
                                 {
                                 
                                    
                                       y
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 }
                              
                              
                                 t
                                 ∈
                                 N
                              
                           
                        
                     . Given a matrix 
                        
                           Y
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                                 ×
                                 p
                              
                           
                        
                     , a set of row indices 
                        
                           G
                           ⊆
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                      and a set of column indices 
                        
                           P
                           ⊆
                           {
                           1
                           ,
                           …
                           ,
                           p
                           }
                        
                     , let 
                        
                           Y
                           
                              
                              
                                 [
                                 G
                                 ]
                              
                           
                        
                      denote a sub-matrix of 
                        
                           Y
                        
                      formed by taking rows from 
                        
                           Y
                        
                      with indices 
                        
                           G
                        
                     , and let 
                        
                           Y
                           
                              
                              
                                 (
                                 P
                                 )
                              
                           
                        
                      denote the sub-matrix of 
                        
                           Y
                        
                      formed by collecting columns from 
                        
                           Y
                        
                      with indices 
                        
                           P
                        
                     . For a matrix 
                        
                           X
                        
                     , its Frobenious norm is defined as 
                        
                           ‖
                           X
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                           =
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     , its 
                        
                           
                              
                                 ℓ
                              
                              
                                 0
                              
                           
                        
                      norm is defined as the number of nonzero entries in 
                        
                           X
                        
                     . Given a vector 
                        
                           x
                        
                     , its 
                        
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        
                      norm is defined as 
                        
                           ‖
                           x
                           
                              
                                 ‖
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                              
                           
                           |
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                           |
                        
                     . Besides, 
                        
                           
                              
                                 I
                              
                              
                                 M
                              
                           
                        
                      denotes the 
                        
                           M
                           ×
                           M
                        
                      identity matrix.

Let 
                           
                              Y
                              =
                              [
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    y
                                 
                                 
                                    p
                                 
                              
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    p
                                 
                              
                           
                         be a set of input signals and 
                           
                              D
                              =
                              [
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    m
                                 
                              
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    m
                                 
                              
                           
                         denote a given dictionary. Sparse coding is to find the sparse code 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           
                         of each signal 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         with the dictionary 
                           
                              D
                           
                        , which can be accomplished by solving the following problem:
                           
                              (1)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          C
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                                 ‖
                                 Y
                                 -
                                 DC
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 λ
                                 ψ
                                 (
                                 C
                                 )
                                 ,
                              
                           
                        where 
                           
                              C
                              =
                              [
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    p
                                 
                              
                              ]
                           
                         is the sparse codes to pursue, 
                           
                              ψ
                           
                         is a sparsity-inducing functional, and 
                           
                              λ
                           
                         is a parameter that balances the trade-off between sparsity and fidelity of the solution. A common choice of 
                           
                              ψ
                           
                         is 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    0
                                 
                              
                           
                         norm or its convex relaxation 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    1
                                 
                              
                           
                         norm. Both of 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    0
                                 
                              
                           
                         norm and 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    1
                                 
                              
                           
                         norm primarily encourage sparse solutions, regardless of the potential structural relationships (e.g. spatial, temporal or hierarchical) existing among variables.

Inspired by the fact that often nonzero coefficients in sparse codes are not randomly distributed but have certain patterns, recent approaches [29–43] seek for new sparsity-inducing functionals which are capable of encoding higher-order information about the patterns of non-zero coefficients. The resulting sparsity on sparse codes is called structured sparsity. One simple but efficient method for structured sparse coding is the so-called collaborative hierarchical group Lasso (CHiLasso) method [36,39], which induces both standard sparsity and group sparsity by solving the following problem:
                           
                              (2)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          C
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                m
                                                ×
                                                p
                                             
                                          
                                       
                                    
                                 
                                 ‖
                                 Y
                                 -
                                 DC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 C
                                 )
                                 ,
                              
                           
                        where 
                           
                              S
                              =
                              
                                 
                                    {
                                    
                                       
                                          G
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    |
                                    S
                                    |
                                 
                              
                           
                         is a set of groups generated by a partition of atom indices, 
                           
                              
                                 
                                    G
                                 
                                 
                                    l
                                 
                              
                              ⊆
                              {
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                         is a subset of atoms indices, and 
                           
                              ψ
                           
                         is the group sparsity regularizer defined as
                           
                              (3)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 C
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          G
                                          ∈
                                          S
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       C
                                    
                                    
                                       [
                                       G
                                       ]
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    G
                                    ]
                                 
                              
                           
                         denotes the coefficients of 
                           
                              C
                           
                         which correspond to the atoms with indices 
                           
                              G
                           
                        . It can be seen from (3) that, each sparse code 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           
                         is partitioned into several groups according to 
                           
                              S
                           
                        , and the mixed 
                           
                              ℓ
                              1
                           
                        /
                           
                              ℓ
                              2
                           
                         norm is computed on the grouped sparse codes to induce structured sparsity. Note that the group sparsity regularizer 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    S
                                 
                              
                              (
                              C
                              )
                           
                         is not separable w.r.t each signal, making the sparse coding procedure collaborative. When 
                           
                              |
                              S
                              |
                              =
                              1
                           
                         and 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              =
                              {
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                        , it is easy to verify that 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    S
                                 
                              
                              (
                              c
                              )
                              =
                              ‖
                              c
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                           
                        . As a generalization of 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    1
                                 
                              
                           
                        -norm, 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    S
                                 
                              
                              (
                              c
                              )
                           
                         encourages sparsity at group level instead of singleton level. By jointly employing 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    1
                                 
                              
                           
                         norm and 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    S
                                 
                              
                              (
                              c
                              )
                           
                        , the CHiLasso model (2) encourages sparsity both at group and singleton level while allowing the input signals share the same sparsity patterns at the group level but not necessarily at singleton level. Thus, the resulting structured sparsity is referred to as collaborative hierarchical group sparsity.

Solving the CHiLasso Problem (2) is challenging. Two effective algorithms with guaranteed convergence to global minimum have been proposed by Sprechmann et al. [36,39].
                           1
                           In the experimental section, the performance of both the algorithms will be investigated.
                        
                        
                           1
                         For brevity, these algorithms are summarized in Appendix A.

Learning an adaptive dictionary can improve the efficiency of sparse coding. The dictionary learning problem can be generally formulated as follows:
                           
                              (4)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          D
                                          ,
                                          C
                                       
                                    
                                 
                                 ‖
                                 Y
                                 -
                                 DC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 λ
                                 ψ
                                 (
                                 C
                                 )
                                 +
                                 α
                                 ϕ
                                 (
                                 D
                                 )
                                 ,
                              
                           
                        where 
                           
                              α
                           
                         is a scalar controlling the contribution of 
                           
                              ϕ
                              (
                              D
                              )
                           
                        , and 
                           
                              ϕ
                              (
                              ·
                              )
                           
                         is the constraint on dictionary, e.g., indicator function forcing each column of dictionary to be normalized with unit norm.
                           2
                           Such normalization constraint on the norm of each atom is often required in dictionary learning methods. For brevity, we omit this unit norm constraint in the following sections if unnecessary.
                        
                        
                           2
                         The obtained sparse codes 
                           
                              C
                           
                         can be directly used as features for classification. But separating dictionary learning from classifier construction is not optimal as sparse codes are not enforced to be discriminative for classification. One alternative is to combine dictionary learning and classifier construction in a unified framework (e.g. [16,17,22,27]), which can be formulated as follows:
                           
                              (5)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          D
                                          ,
                                          W
                                          ,
                                          C
                                       
                                    
                                 
                                 ‖
                                 Y
                                 -
                                 DC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                 
                                 ψ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 γ
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                 
                                 χ
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 f
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 W
                                 )
                                 )
                                 +
                                 β
                                 ω
                                 (
                                 W
                                 )
                                 +
                                 α
                                 ϕ
                                 (
                                 D
                                 )
                                 ,
                              
                           
                        where 
                           
                              W
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    N
                                    ×
                                    m
                                 
                              
                           
                         denotes the classifier parameters, 
                           
                              χ
                           
                         is the loss functional of classification (see Section 1.1 for some examples), 
                           
                              ω
                           
                         is the regularization functional on 
                           
                              W
                           
                         that determines the type of the classifier, 
                           
                              β
                           
                         is a scalar controlling the contribution of 
                           
                              ω
                              ,
                              N
                           
                         is the total number of categories of training samples, and 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              N
                              }
                           
                         is the label of training sample 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                        .

In this section, we propose a discriminative dictionary learning model based on joint within-class collaborative hierarchical sparse representation. Hierarchical group sparsity promotion and classifier training are integrated into the dictionary learning process. With the employment of joint within-class collaborative hierarchical sparse coding, our method is able to learn dictionaries which encourage signals from the same category to share the same hierarchical group sparsity pattern. Besides, benefiting from joint dictionary learning and classifier training, discriminability of sparse codes is further strengthened. Then an alternating iterative scheme is presented for solving the proposed model.

As mentioned in Section 1, correlation of data from the same category can be efficiently encoded with collaborative hierarchical group sparsity, i.e., sparsity at both singleton-level and group-level. Thus we can train a useful dictionary by inducing collaborative hierarchical sparse representation within each category of signals during dictionary learning. But in this way the interclass discrimination cannot be obtained, as similar categories may still have the potential to share the same active groups. In order to further enhance discriminability of the sparse codes, the training of a multi-class linear classifier is integrated into the dictionary learning process. Finally, we construct an effective dictionary learning models follows. Let 
                           
                              L
                              =
                              {
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    N
                                 
                              
                              }
                           
                         denote the group partition of signals with 
                           
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                              ⊆
                              {
                              1
                              ,
                              …
                              ,
                              p
                              }
                           
                         as a subset of signal indices corresponding to kth category, 
                           
                              S
                              =
                              {
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    G
                                 
                                 
                                    |
                                    S
                                    |
                                 
                              
                              }
                           
                         denote the group partition of atom indices satisfying 
                           
                              
                                 
                                    ⋃
                                 
                                 
                                    l
                                    =
                                    1
                                 
                                 
                                    |
                                    S
                                    |
                                 
                              
                              
                                 
                                    G
                                 
                                 
                                    l
                                 
                              
                              =
                              {
                              1
                              ,
                              …
                              ,
                              m
                              }
                           
                         and 
                           
                              ∀
                              l
                              
                              ≠
                              
                              j
                              ,
                              
                              
                              
                                 
                                    G
                                 
                                 
                                    l
                                 
                              
                              ∩
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              =
                              ∅
                           
                        , and 
                           
                              H
                              =
                              [
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    h
                                 
                                 
                                    p
                                 
                              
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    N
                                    ×
                                    p
                                 
                              
                           
                         denote the binary labels of training samples with 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              =
                              [
                              0
                              ,
                              0
                              ,
                              …
                              ,
                              1
                              ,
                              …
                              ,
                              0
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    N
                                 
                              
                           
                         as the binary label vector of sample 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                        . Then our model, called Collaborative HIerarchicaL Discriminative Dictionary Learning (CHILD-DL), is defined as
                           
                              (6)
                              
                                 
                                    
                                       
                                          argmin
                                       
                                       
                                          D
                                          ,
                                          W
                                          ,
                                          C
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 Y
                                 -
                                 DC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 H
                                 -
                                 WC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ,
                              γ
                           
                         are the scalars controlling the relative contribution of each term, 
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                           
                         is a submatrix of 
                           
                              C
                           
                         that contains the sparse codes of signals from the k-th category, and 
                           
                              W
                           
                         is a multi-class linear classifier to be learned.
                           3
                           Similar in spirit to the D-KSVD and LC-KSVD methods [22,25], instead of using explicit regularization in the model, we implicitly control the energy of 
                                 
                                    W
                                 
                               in the optimization procedure followed by a renormalization stage.
                        
                        
                           3
                        
                     

In the CHILD-DL model (6), the joint within-class collaborative hierarchical group sparsity induced by 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    p
                                 
                              
                              ‖
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    S
                                 
                              
                              (
                              
                                 
                                    C
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                              )
                           
                         adapts the learned dictionary to the underlying structures of input signals and enforces signals from the same category to share the same hierarchical sparsity patterns. This enhances the separability of the sparse codes associated with different signal categories and benefits the improvement of classification performance. On the other hand, reducing the classification error of sparse codes according to 
                           
                              ‖
                              H
                              -
                              WC
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                         can not only help to enhance discriminability of sparse codes, but also encourage signals from different categories to use distinct active groups, making the collaborative hierarchical group sparse representation more useful in classification.

Solving the minimization problem of (6) is nontrivial. Intuitively, we need to alternately estimate the unknown variables one at a time. To make the optimization procedure more efficient, we propose to update the dictionary 
                           
                              D
                           
                         and classifier 
                           
                              W
                           
                         simultaneously, which is similar to schemes used in [22,25]. For this purpose, we rewrite (6) as
                           
                              (7)
                              
                                 
                                    
                                       
                                          argmin
                                       
                                       
                                          D
                                          ,
                                          W
                                          ,
                                          C
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 X
                                 -
                                 UC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          p
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 )
                                 ,
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                 
                                 ∀
                                 j
                                 ,
                                 ‖
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                        where 
                           
                              
                              X
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                Y
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                
                                                H
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              U
                              =
                              [
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    m
                                 
                              
                              ]
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                
                                                W
                                             
                                          
                                       
                                    
                                 
                              
                           
                        .

Then we find the optimal solutions for 
                           
                              U
                           
                         and 
                           
                              C
                           
                         in (7) with an alternating iteration scheme. Such a scheme divides the minimization problem into several simpler ones in each iteration. The iteration stops until either of the following stopping criteria is satisfied: (1) the change of objective functional are small enough; (2) the maximum iteration number has been reached.

At the beginning of the 
                              
                                 (
                                 ℓ
                                 +
                                 1
                                 )
                              
                            iteration, with dictionary 
                              
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       ℓ
                                       )
                                    
                                 
                              
                            fixed, the update of the structured sparse codes 
                              
                                 C
                              
                            is as follows:
                              
                                 (8)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          (
                                          ℓ
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             argmin
                                          
                                          
                                             C
                                          
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ‖
                                    X
                                    -
                                    
                                       
                                          U
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    C
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             p
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          S
                                       
                                    
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    )
                                    ,
                                 
                              
                           which is group separable and can be decomposed into N independent subproblems:
                              
                                 (9)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          ℓ
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             argmin
                                          
                                          
                                             C
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   m
                                                   ×
                                                   |
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ‖
                                    
                                       
                                          X
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    -
                                    
                                       
                                          U
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    C
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          S
                                       
                                    
                                    (
                                    C
                                    )
                                    .
                                 
                              
                           This is actually the CHiLasso problem (2) and can be solved by the algorithms proposed in [36,39]. Interested readers can refer to Appendix A
                           
                              4
                              Two algorithms are mentioned in Appendix A. In Section 4, the performance of both the algorithms will be tested and compared.
                           
                           
                              4
                            or the original literature for more details.

With fixed 
                              
                                 
                                    
                                       C
                                    
                                    
                                       (
                                       ℓ
                                       +
                                       1
                                       )
                                    
                                 
                              
                            from the previous step, the dictionary 
                              
                                 U
                              
                            is updated as follows:
                              
                                 (10)
                                 
                                    
                                       
                                          U
                                       
                                       
                                          (
                                          ℓ
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          argmin
                                       
                                       
                                          U
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ‖
                                    X
                                    -
                                    
                                       
                                          UC
                                       
                                       
                                          (
                                          ℓ
                                          +
                                          1
                                          )
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    
                                    s
                                    .
                                    t
                                    .
                                    
                                    ∀
                                    j
                                    ,
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    1
                                    .
                                 
                              
                           By applying the projected gradient descent method, we update 
                              
                                 
                                    
                                       U
                                    
                                    
                                       (
                                       ℓ
                                       +
                                       1
                                       )
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       ℓ
                                       +
                                       1
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                    
                                       (
                                       ℓ
                                       +
                                       1
                                       )
                                    
                                 
                                 ]
                              
                            column by column as follows:
                              
                                 (11)
                                 
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          +
                                          1
                                          )
                                       
                                    
                                    ∈
                                    
                                       
                                          argmin
                                       
                                       
                                          ‖
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          1
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    
                                       
                                          s
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    m
                                    ,
                                 
                              
                           where
                              
                                 (12)
                                 
                                    
                                       
                                          s
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                             
                                             
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          
                                             
                                                u
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    Q
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          (
                                          ℓ
                                          +
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                    
                                       ℓ
                                    
                                 
                              
                            is the step size, 
                              
                                 Q
                                 (
                                 C
                                 ,
                                 U
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 X
                                 -
                                 UC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       ℓ
                                       )
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       ℓ
                                       +
                                       1
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                       -
                                       1
                                    
                                    
                                       (
                                       ℓ
                                       +
                                       1
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       ℓ
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                    
                                       (
                                       ℓ
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       m
                                    
                                    
                                       (
                                       ℓ
                                       )
                                    
                                 
                                 ]
                              
                           . By direct calculation, the problem of (11) has a closed-form solution
                              
                                 (13)
                                 
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          +
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    /
                                    ‖
                                    
                                       
                                          s
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          ℓ
                                          )
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

By the above algorithm we can obtain the solution 
                           
                              
                                 
                                    U
                                 
                                 
                                    ¯
                                 
                              
                           
                         in (7), which is column-wise normalized and can be directly decomposed into 
                           
                              
                                 
                                    D
                                 
                                 
                                    ¯
                                 
                              
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    ¯
                                 
                              
                           
                        . Then the final learned dictionary 
                           
                              D
                           
                         and classifier 
                           
                              W
                           
                         are computed by renormalization:
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             D
                                             =
                                             {
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   m
                                                
                                             
                                             }
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             W
                                             =
                                             {
                                             
                                                
                                                   w
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   w
                                                
                                                
                                                   m
                                                
                                             
                                             }
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  ‖
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Given a test sample 
                           
                              
                                 
                                    y
                                 
                                 
                                    test
                                 
                              
                           
                        , we compute the sparse code 
                           
                              
                                 
                                    c
                                 
                                 
                                    test
                                 
                              
                           
                         as follows:
                           
                              (15)
                              
                                 
                                    
                                       c
                                    
                                    
                                       test
                                    
                                 
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       c
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       y
                                    
                                    
                                       test
                                    
                                 
                                 -
                                 Dc
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ‖
                                 c
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ψ
                                    
                                    
                                       S
                                    
                                 
                                 (
                                 c
                                 )
                                 ,
                              
                           
                        which is a special case of the CHiLasso model (2). Once 
                           
                              
                                 
                                    c
                                 
                                 
                                    test
                                 
                              
                           
                         is computed, the learned linear classifier 
                           
                              W
                           
                         is applied to 
                           
                              
                                 
                                    c
                                 
                                 
                                    test
                                 
                              
                           
                         to generate a label prediction vector 
                           
                              
                                 
                                    l
                                 
                                 
                                    test
                                 
                              
                           
                         on 
                           
                              
                                 
                                    y
                                 
                                 
                                    test
                                 
                              
                           
                         by
                           
                              (16)
                              
                                 
                                    
                                       l
                                    
                                    
                                       test
                                    
                                 
                                 =
                                 
                                    
                                       Wc
                                    
                                    
                                       test
                                    
                                 
                                 .
                              
                           
                        For the values of 
                           
                              
                                 
                                    l
                                 
                                 
                                    test
                                 
                              
                           
                         are unnecessarily binary, the final label of 
                           
                              
                                 
                                    y
                                 
                                 
                                    test
                                 
                              
                           
                         is set to be the index which corresponding to the largest element of 
                           
                              
                                 
                                    l
                                 
                                 
                                    test
                                 
                              
                           
                        .

In our implementation, the initial dictionary 
                           
                              
                                 
                                    D
                                 
                                 
                                    (
                                    0
                                    )
                                 
                              
                           
                         is generated by random sampling of training data. More precisely, a certain number of samples from each category are randomly picked up and combined as one group of the dictionary. The sparse codes 
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    0
                                    )
                                 
                              
                           
                         is initialized by solving
                           
                              (17)
                              
                                 
                                    
                                       argmin
                                    
                                    
                                       C
                                    
                                 
                                 ‖
                                 Y
                                 -
                                 DC
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                 ∀
                                 i
                                 ,
                                 ‖
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       0
                                    
                                 
                                 ⩽
                                 T
                                 ,
                              
                           
                        which is solved by the OMP algorithm
                           5
                           In our experiments we found that using pseudo-inverse solution of 
                                 
                                    
                                       
                                          argmin
                                       
                                       
                                          C
                                       
                                    
                                    ‖
                                    Y
                                    -
                                    
                                       
                                          D
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                    
                                    C
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                 
                               instead for the initialization has almost no influence on the classification results.
                        
                        
                           5
                         
                        [45]. Then the multi-class linear classifier 
                           
                              W
                           
                         is initialized by
                           
                              (18)
                              
                                 
                                    
                                       W
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       argmin
                                    
                                    
                                       W
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 H
                                 -
                                 
                                    
                                       WC
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 W
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        which is the ridge regression with explicit solution
                           
                              (19)
                              
                                 
                                    
                                       W
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       HC
                                    
                                    
                                       (
                                       0
                                       )
                                       ⊤
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   (
                                                   0
                                                   )
                                                   ⊤
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   γ
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

@&#EXPERIMENTS@&#

We evaluate the both the effectiveness and efficiency of our CHILD-DL method by applying it to face recognition on the Extended YaleB dataset [46] and the AR face dataset [47], object recognition on the Caltech-101 dataset [48], and scene classification on the Scene-15 dataset [49]. The evaluation protocols are consistent with [25], including the experimental setup and the employed image features,
                        6
                        All the data for the experiments are provided by Jiang et al. and available on the website: http://www.umiacs.umd.edu/zhuolin/projectlcksvd.html.
                     
                     
                        6
                      which is detailed in the following subsections.

The methods for comparison mainly include K-SVD [10], D-KSVD [22], LC-KSVD [25], SRC [1], FDDL [23], and LLC [3].
                              7
                              In [25], two versions of LC-KSVD are presented. Here we select the improved version with better performance reported. The parameter setting and results of all these compared methods are consistent with [25].
                           
                           
                              7
                            The SRC method is implemented with two different dictionary sizes: (1) the original version denoted by SRC that stacks all the training samples as a dictionary; (2) the reduced version denoted by SRC∗ whose dictionary size is the same as ours. As there are two algorithms for solving the subproblem defined in (9), we derive two CHILD-DL methods, which is denoted by CHILD-DL-A and CHILD-DL-B respectively. In the experiments, we compared these two methods to distinguish which one is better.

Besides, to demonstrate the necessity to jointly learn dictionary and classifier in our method, we implemented a baseline method denoted by Baseline for comparison. The baseline method separates the dictionary learning and classifier training as follows: (1) Setting 
                              
                                 γ
                                 =
                                 0
                              
                            in (7), we learn a dictionary 
                              
                                 D
                              
                            without training 
                              
                                 W
                              
                            and also the sparse codes 
                              
                                 C
                              
                            on all training samples; (2) The sparse codes 
                              
                                 C
                              
                            and the label matrix 
                              
                                 H
                              
                            are used to train a multi-class linear classifier via ridge regression; (3) The test stage is done via (15) and (16).

Considering the randomness in partitioning training and testing sets, we run all experiments 10 times and report the averages as well as the standard deviations of the prediction accuracies. For other compared methods, we only report the standard deviations where available.

The parameters of CHILD-DL include the regularization parameters, the dictionary size, and the configuration of groups. The setting of these parameters on each dataset is summarized in Table 1
                           . Note that the CHILD-DL-A, CHILD-DL-B and Baseline methods are using the same parameter setting.


                           Regularization parameters. The choice of regularization parameters in our model (7), like 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 γ
                              
                           , depends on the application and data. In all experiments, if no specific instructions mentioned, we use fivefold cross validation to find the parameters of the proposed model that give the best results while avoiding over-fitting. We also tested the effects of regularization parameter selection, which is detailed in Section 4.2.


                           Dictionary size. As shown in [23,50], the larger the dictionary size is, the better the performance of the dictionary learning methods can be achieved. To have a fair comparison in all the experiments, the dictionary size of all the compared methods mentioned above except SRC are set to be the same as [25].


                           Group configuration. The configuration of groups 
                              
                                 S
                              
                            is another key factor in our method. Although the configuration of groups are independent of the signal categories, it is natural to expect that signals from different categories could use distinct groups in the context of classification. For simplicity, we set 
                              
                                 |
                                 S
                                 |
                              
                            to be equal to the number of categories N. The set of groups 
                              
                                 S
                              
                            is set to satisfy the following three conditions: (1) 
                              
                                 
                                    
                                       ⋃
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 }
                              
                           ; (2) 
                              
                                 ∀
                                 i
                                 
                                 ≠
                                 
                                 j
                                 ,
                                 
                                 
                                 
                                    
                                       G
                                    
                                    
                                       i
                                    
                                 
                                 ∩
                                 
                                    
                                       G
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 ∅
                              
                           ; (3) 
                              
                                 ∀
                                 k
                                 ,
                                 
                                 
                                 |
                                 
                                    
                                       G
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 =
                                 r
                                 =
                                 m
                                 /
                                 N
                              
                           . Although we do not employ group overlap here,
                              8
                              It is worth mentioning that our model is not restricted to such a simple group assignment scheme.
                           
                           
                              8
                            different categories are still allowed to share atoms during the dictionary learning process. The number of active groups shared by signals from the same category is implicitly determined by the scalars 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 γ
                              
                           .

The Extended YaleB dataset [46] contains 
                           
                              2
                              ,
                              414
                           
                         images of 38 human frontal faces under about 64 illumination conditions and expressions, as shown in Fig. 3
                        (a). There are about 64 images for each person. The original images were cropped to 
                           
                              192
                              ×
                              168
                           
                         pixels. Each face image is projected into a 504-dimensional feature vector using a random matrix of zero-mean normal distribution [22]. We randomly select half of the images for training and the other half for testing in each class.

The experimental results are summarized in Table 2
                        . We can see that CHILD-DL achieved very competitive results among all the compared methods. The CHILD-DL-B method performed better than the baseline method and the CHILD-DL-A method. The CHILD-DL-B method outperformed many state-of-the-art approaches except FDDL and SRC. But note that the performance of the SRC method degrades dramatically when using dictionary of the same size as ours (see SRC∗). Although our method performed worse than the FDDL method, it can be seen in Section 4.6 that our method is more efficient compared with the FDDL method.

The sparsity regularization parameters 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                           
                         as well as the discrimination regularization parameter 
                           
                              γ
                           
                         are determined by fivefold cross validation. To analyze the parameter sensitivity of our method, we conduct a test on the Extended YaleB dataset by adjusting the regularization parameters 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              γ
                           
                         while fixing ratio between 
                           
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                           
                        .
                           9
                           We fix the ratio between 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                 
                               as 1 and test the CHILD-DL-B algorithm.
                        
                        
                           9
                         The effects of parameter selection are shown in Fig. 4
                        . We can observe that good performance is achieved at 
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              =
                              0.02
                           
                         and 
                           
                              γ
                              =
                              5
                           
                        .

The AR face dataset [47] consists of over 4000 frontal images from 126 individuals. For each individual, 26 pictures were taken in tow separate sessions. The main characteristic of the AR dataset is that it includes frontal views of faces with different facial expressions, lighting and occlusion conditions, as shown in Fig. 3(b). Same as the standard evaluation procedure from [22], we use a subset of the dataset consisting of 
                           
                              2
                              ,
                              600
                           
                         images from 50 male subjects and 50 female subjects. For each person, twenty images are randomly picked up for training and the rest for testing. Each face image is cropped to 
                           
                              165
                              ×
                              120
                           
                         and then projected onto a 540-dimensional feature vector.

The experimental results are summarized in Table 3
                        . Similar to what happened on the YaleB dataset, CHILD-DL outperformed the baseline method and several state-of-the-art approaches including K-SVD, D-KSVD, LLC and LC-KSVD, but did not perform as well as the FDDL and SRC methods. The CHILD-DL-A method is slightly better than the CHILD-DL-B method in this case.

The Caltech-101 dataset [48] is a large dataset, which contains 8677 images in 101 object categories with different shapes and appearances and 467 images selected from an additional background category. The number of images per category varies greatly from 31 to 800. Some sample images selected from the caltech101 dataset are illustrated in Fig. 5
                        (a). As recommended in [25], the spatial pyramid features [49] based on SIFT descriptors are extracted and the dimension of each feature is further reduced to be 3000 via PCA.

Following the experimental settings in [25], we randomly pick up 
                           
                              5
                              ,
                              10
                              ,
                              15
                              ,
                              20
                              ,
                              25
                           
                         and 30 samples per category for training the dictionary as well as the classifier, and test on the remaining samples. The dictionary size of our method is set proportional to the size of training set per category, as shown in Table 1. Besides the compared methods used in the above face recognition, the reported results of other state-of-the-art approaches [2,17,49,51–55] are also involved for comparison.

See Table 4
                         for the performance comparison. We can see that both the CHILD-DL-A and CHILD-DL-B methods performed better than the baseline method and each has its own advantages in cases with certain number of training samples per category. Besides, CHILD-DL outperformed many competitive supervised dictionary learning methods and some other state-of-the-art approaches, while achieving accuracy comparable to FDDL and LC-KSVD.

The Scene-15 dataset introduced in [49] contains a wide range of outdoor and indoor scenes. The scene categories include bedroom, suburb, industrial, kitchen, living room, coast, forest, highway, inside cite, mountain, open country, street, tall building, office and store. See Fig. 5(b) for the sample images per category. The number of images per category varies from 210 to 410, and the resolution of each image is about 
                           
                              250
                              ×
                              300
                           
                        . Similar to the feature extraction process on the Caltech-101 dataset, the spatial pyramid features [49] based on SIFT descriptors are extracted and the dimension of each feature is further reduced to be 3000 via PCA.

Following the experimental settings recommended in [25], we randomly select 100 images per category as training data and use the rest as test data. Besides the methods used in the above face recognition experiments, several state-of-the-art scene classification approaches [2,21,49,57,58] with available results are included for comparison.

The experimental results on Scene-15 dataset is are listed in Table 5
                        . It can be seen that the CHILD-DL-B method is slightly better than the FDDL method and achieved the best average recognition accuracy among all the compared methods.

In order to evaluate the complexity of our method, we compare the computational efficiency of several tested methods above, in terms of the average running time on the Extended YaleB dataset during the training phase and the testing stage. More specifically, for each tested method, both the average training time per iteration during dictionary learning and the average test time for an test image during classification are reported. To have a fair comparison, all the tested methods are implemented under the same computational environment. The software environment is the MATLAB 2014a platform run on the Windows 8 operating system, and the hardware platform is a laptop computer with Intel Dual-Core i7-2640M 2.8GHz CPU and 8GB memory.

From Table 6
                        , it can be seen that CHILD-DL is much better than the FDDL method in terms of computational time, but worse than D-KSVD, LC-KSVD and SRC methods. It can be also seen that CHILD-DL-B is much faster than CHILD-DL-A, especially in terms of training time.

@&#CONCLUSIONS@&#

Learning discriminative sparse representations from labeled data has drawn much interest in computer vision community. In order to obtain efficient representations with structured sparsity and strong discriminability for image classification, we introduced the concept of collaborative hierarchical group sparsity and the integration of classification feedback into discriminative dictionary learning. Our dictionary learning model is constructed by combining reconstruction error, joint within-class hierarchical group sparsity and linear prediction error into a unified minimization framework. Benefiting from using the joint within-class collaborative hierarchical sparsity, our method encourages signals from the same category to share the same hierarchical sparsity patterns, which promotes the separability of the sparse codes associated with different signal categories. The discriminability of sparse codes is further strengthened by joint dictionary construction and classifier learning. An efficient alternating iterative scheme is developed to solve the proposed model. Our method is applied to image classification by simultaneously learning dictionary, sparse representation and classifier from image features. We applied our method to face recognition, object classification and scene recognition. The experimental results have demonstrated the excellent performance of our method. In future, we would like to investigate higher-level structured sparsity for discriminative dictionary learning.

Two Effective solvers for the ChiLasso Problem (2) have been proposed by Sprechman et al. in [36,39]. We denote these two solvers as ChiLasso-Solver-A and ChiLasso-Solver-B respectively.


                     ChiLasso-Solver-A 
                     
                        [36]
                     . The basic idea of ChiLasso-Solver-A is to use ADMOM [59] iterations to divide the overall sparse coding problem into two subproblems: (1) breaking the multi-signal case into p single-signal 
                        
                           
                              
                                 ℓ
                              
                              
                                 1
                              
                           
                        
                      regressions; (2) treating the multi-signal case as a single group Lasso-like problem. For this purpose, we rewrite the ChiLasso Problem (2) as a constrained optimization model
                        
                           (A.1)
                           
                              
                                 
                                    
                                       argmin
                                    
                                    
                                       C
                                    
                                 
                              
                              ‖
                              Y
                              -
                              DC
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              ‖
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    S
                                 
                              
                              (
                              B
                              )
                              
                              
                              
                              s
                              .
                              t
                              .
                              
                              
                              
                              C
                              =
                              B
                              .
                           
                        
                     Then the ADMOM iterations for solving (A.1) are given as follows:
                        
                           (A.2)
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       C
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ‖
                              Y
                              -
                              DC
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              ‖
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              +
                              Tr
                              (
                              
                                 
                                    C
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              )
                              +
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              ‖
                              
                                 
                                    B
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              -
                              C
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              ;
                           
                        
                     
                     
                        
                           (A.3)
                           
                              
                                 
                                    B
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       B
                                    
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              ‖
                              B
                              -
                              
                                 
                                    C
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              +
                              Tr
                              (
                              
                                 
                                    B
                                 
                                 
                                    ⊤
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              )
                              +
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    S
                                 
                              
                              (
                              B
                              )
                              ;
                           
                        
                     
                     
                        
                           (A.4)
                           
                              
                                 
                                    P
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    P
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              +
                              θ
                              (
                              
                                 
                                    C
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              -
                              
                                 
                                    B
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              )
                              .
                           
                        
                     The problem of (A.2) is signal-signal separable and thus can be solved by updating 
                        
                           C
                        
                      column by column, i.e.
                        
                           (A.5)
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       c
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ‖
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              -
                              Dc
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ‖
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    ⊤
                                 
                              
                              c
                              +
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              ‖
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              -
                              c
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                     which can be solved by applying SpaRSA [60]. The problem of (A.3) is group separable and thus can be separated into 
                        
                           |
                           S
                           |
                        
                      optimization problems in vectorial form as follows:
                        
                           (A.6)
                           
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       f
                                    
                                 
                              
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ‖
                              f
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    q
                                 
                                 
                                    ⊤
                                 
                              
                              f
                              +
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              ‖
                              z
                              -
                              f
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                     where 
                        
                           f
                           ,
                           z
                        
                      and 
                        
                           q
                        
                      are column vectors by concatenating the columns of 
                        
                           
                              
                                 B
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 (
                                 t
                                 +
                                 1
                                 )
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        
                      respectively. This minimization problem can be solved by simple vectorial thresholding, i.e.,
                        
                           (A.7)
                           
                              f
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                      {
                                                      0
                                                      ,
                                                      ‖
                                                      z
                                                      +
                                                      θ
                                                      q
                                                      
                                                         
                                                            ‖
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      }
                                                   
                                                   
                                                      θ
                                                      ‖
                                                      z
                                                      +
                                                      θ
                                                      q
                                                      
                                                         
                                                            ‖
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                (
                                                z
                                                +
                                                θ
                                                q
                                                )
                                             
                                             
                                                if
                                                
                                                ‖
                                                z
                                                +
                                                θ
                                                q
                                                
                                                   
                                                      ‖
                                                   
                                                   
                                                      2
                                                   
                                                
                                                >
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                if
                                                
                                                ‖
                                                z
                                                +
                                                θ
                                                q
                                                
                                                   
                                                      ‖
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  


                     ChiLasso-Solver-B 
                     
                        [39]
                     
                     . In [39], the SpaRSA framework is employed to generate a sequence of iterates 
                        
                           
                              
                                 {
                                 
                                    
                                       C
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 }
                              
                              
                                 t
                                 ∈
                                 N
                              
                           
                        
                     , which converges to the solution of (2) under certain conditions. At each iteration, 
                        
                           
                              
                                 C
                              
                              
                                 (
                                 t
                                 +
                                 1
                                 )
                              
                           
                        
                      is obtained by solving:
                        
                           (A.8)
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       Z
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ‖
                              Z
                              -
                              
                                 
                                    V
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              ‖
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    G
                                 
                              
                              (
                              Z
                              )
                              ,
                           
                        
                     where 
                        
                           
                              
                                 V
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           =
                           [
                           
                              
                                 v
                              
                              
                                 1
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 p
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           ]
                        
                      is defined a matrix with its ith column given by 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 i
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           -
                           
                              
                                 1
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                           
                              
                                 D
                              
                              
                                 T
                              
                           
                           (
                           
                              
                                 Dc
                              
                              
                                 i
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           -
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           )
                        
                     , and 
                        
                           
                              
                                 {
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 }
                              
                              
                                 t
                                 ∈
                                 N
                              
                           
                        
                      is some sequence of parameters with 
                        
                           
                              
                                 α
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                      which determine the convergence conditions about the algorithm. In the aforementioned formulation, all terms in the cost function can be group separable. Thus, the problem of (A.8) can be solved independently for each group, that is
                        
                           (A.9)
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       Z
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ‖
                              Z
                              -
                              
                                 
                                    V
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              ‖
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                              ‖
                              Z
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                              
                              .
                           
                        
                     
                  

The sub-gradient of (A.9) for the case where the optimum 
                        
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                           
                           ≠
                           
                           0
                        
                      is inspected as 
                        
                           
                              
                                 V
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           -
                           (
                           1
                           +
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 ‖
                                 
                                    
                                       Z
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                 
                              
                           
                           )
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                           ∈
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                           ∂
                           ‖
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                           
                              
                                 ‖
                              
                              
                                 1
                              
                           
                        
                     . It can be observed that each element of 
                        
                           (
                           1
                           +
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 ‖
                                 
                                    
                                       Z
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                 
                              
                           
                           )
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                        
                      is the solution of the well known scalar soft thresholding operator. We can set 
                        
                           G
                           =
                           
                              
                                 T
                              
                              
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           (
                           
                              
                                 V
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              
                                 (
                                 t
                                 )
                              
                           
                           )
                        
                     , where 
                        
                           
                              
                                 T
                              
                              
                                 λ
                              
                           
                           (
                           X
                           )
                        
                      denotes the matrix obtained when applying the soft-thresholding operator with parameter 
                        
                           λ
                        
                      to each element of 
                        
                           X
                        
                     . From the information above, it can be easily inferred that 
                        
                           ‖
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                           
                              
                                 ‖
                              
                              
                                 F
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 ‖
                                 
                                    
                                       Z
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       ‖
                                       
                                          
                                             Z
                                          
                                          
                                             ∗
                                          
                                       
                                       
                                          
                                             ‖
                                          
                                          
                                             F
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ‖
                           G
                           
                              
                                 ‖
                              
                              
                                 F
                              
                              
                                 2
                              
                           
                        
                      and then obtain 
                        
                           ‖
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                           =
                           ‖
                           G
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                           -
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     . Since all terms are positive, this can only hold as 
                        
                           ‖
                           G
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                           >
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     , which shows a vectorial thresholding condition on the solution 
                        
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                        
                      in terms of 
                        
                           ‖
                           G
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                        
                     . It’s easy to show that 
                        
                           ‖
                           G
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                           <
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                      is a sufficient condition for 
                        
                           
                              
                                 Z
                              
                              
                                 ∗
                              
                           
                           =
                           0
                        
                     .

Therefore, the corresponding closed-form solution for each subproblem (A.9) is given by
                        
                           (A.10)
                           
                              
                                 
                                    C
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                      {
                                                      0
                                                      ,
                                                      ‖
                                                      G
                                                      
                                                         
                                                            ‖
                                                         
                                                         
                                                            F
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                   
                                                      ‖
                                                      G
                                                      
                                                         
                                                            ‖
                                                         
                                                         
                                                            F
                                                         
                                                      
                                                   
                                                
                                                G
                                             
                                             
                                                if
                                                
                                                ‖
                                                G
                                                
                                                   
                                                      ‖
                                                   
                                                   
                                                      F
                                                   
                                                
                                                >
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                if
                                                
                                                ‖
                                                G
                                                
                                                   
                                                      ‖
                                                   
                                                   
                                                      F
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     This ChiLasso-Solver-B provides such solution in closed-form, requiring just two thresholding, both linear in the dimension of 
                        
                           Y
                        
                     .

@&#REFERENCES@&#

