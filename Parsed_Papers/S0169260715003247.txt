@&#MAIN-TITLE@&#Near infrared image processing to quantitate and visualize oxygen saturation during vascular occlusion

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study oxygen saturation by vascular occlusion test.


                        
                        
                           
                           NIRS camera captured 2D images of hand during ischaemia and in perfusion.


                        
                        
                           
                           We applied edge detection and segmentation to NIRS images.


                        
                        
                           
                           With the applied methods, we can visualize the oxygenation changes.


                        
                        
                           
                           The method allows to quantitate and visualize oxygenation at the same time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Near-infrared spectrum

Oxygen saturation

Multiscale analysis

Edge detection

Segmentation

Region growing

@&#ABSTRACT@&#


               
               
                  The assessment of microcirculation spatial heterogeneity on the hand skin is the main objective of this work. Near-infrared spectroscopy based 2D imaging is a non-invasive technique for the assessment of tissue oxygenation. The haemoglobin oxygen saturation images were acquired by a dedicated camera (Kent Imaging) during baseline, ischaemia (brachial artery cuff occlusion) and reperfusion. Acquired images underwent a preliminary restoration process aimed at removing degradations occurring during signal capturing. Then, wavelet transform based multiscale analysis was applied to identify edges by detecting local maxima and minima across successive scales. Segmentation of test areas during different conditions was obtained by thresholding-based region growing approach. The method identifies the differences in microcirculatory control of blood flow in different regions of the hand skin. The obtained results demonstrate the potential use of NIRS images for the clinical evaluation of skin disease and microcirculatory dysfunction.
               
            

@&#INTRODUCTION@&#

Assessment of tissue oxygen saturation (StO2) is important in monitoring several pathological changes, especially in critically ill patients. Microcirculation, tissue oxygen supply and consumption are often disturbed in such patients. Several techniques have been proposed in the past to investigate microcirculatory function in the skin. Daly et al. provides an extensive review of the state of the art on the advancement of blood flow imaging methods and the advances in noninvasive imaging modalities [1]. Also, Leahy et al. reviewed the main bio photonic methods to assess microcirculation as well as the advancement during years [2].

Among these different techniques, laser Doppler imaging (LDI) and laser speckle contrast imaging (LSCI) are the most advanced and used ones. LDI was developed for point wise monitoring and imaging of skin. Johansson and Charkoudian in [3,4] had presented their findings on microcirculatory blood flow in human hand based on LDI. Their work was done in relation to the applied pressure and during thermo-regulation. Although LDI has been applied in many applications, the complex nature of acquisition and calculations limits the integration of this technology in clinical applications [1]. Similarly first introduced in 1980, Laser Speckle Contrast Imaging (LSCI) is a powerful tool for full field imaging of blood flow. Boas et al. provided the review on the application of LSCI in multiple field e.g. neuroscience, dermatology, etc. [5]. The method has the advantage of being able to acquire images in real time, making it possible, for instance, to measure blood flow response to occlusion [1]. LDI and LSCI can measures the perfusion (i.e. the blood flow) of tissue but not the StO2 level.

First described by Jöbsis in 1977 [6], near infrared spectroscopy (NIRS) is a non-invasive method for assessing blood flow and StO2. Its reproducibility during brachial artery occlusion has already been demonstrated in healthy subjects [7], Light in the infrared region has the capacity to penetrate in skin and bone and further reach into deeper structures e.g. in muscle tissue. Near infrared light penetrates into tissue and experiences absorption, due to tissue chromophores such as haemoglobin (Hb)+myoglobin (Mb) in their oxy- and deoxy-forms, and scattering. Consequently, when light of different wavelengths is emitted through muscle tissue, it is absorbed to a different degree depending on the concentration of oxy and deoxy Hb. The difference in absorptions is used by NIRS-sensitive sensors to calculate the amount of Hb+Mb StO2.

NIR spectroscopy has been largely used for measurement of changes in intravascular haemoglobin and intramuscular myoglobin for many applications [8–11]. In [11], Ferrari et al. have reviewed the development and applications of functional NIRS. Recently, Lipcsey et al. reviewed the application of NIRS in anaesthesia and intensive care [12]. In another study, they had estimated the forearm blood flow using NIRS [13]. Gruartmoner et al. have used near-infrared spectroscopy to study whether thenar tissue StO2 and its changes derived from an ischaemic challenge are associated to weaning outcome [14]. Also, Gerovasili et al. used near infrared spectroscopy to study vascular occlusions in order to estimate different parameters [15]. They had provided the review of NIRS in clinical application specifically during vascular occlusion. A similar study is provided by Mayeur et al. They have presented their results performing vascular occlusion tests using NIRS in [16]. More recently, Hirasawa et al., has studied the skin blood flow of cerebral region using NIR spectroscopy [17]. The more comprehensive state of the art of such techniques based on NIRS is provided by Daly et al. [1].

Early studies have used an NIR spectroscopy probe placed on the thenar eminence and held in place by a form-fitting plastic adhesive. The probe has both illumination and detection optical fibres and uses the reflectance mode to measure scattering light reflected at some distance from where the light is transmitted into the tissue. Tissue oxygenation in the microvasculature of muscle tissue, comprising the arteriolar, capillary and venular compartments, is measured continuously, and then the values are transferred to a computer and analyzed using dedicated software [18].

Recent developments in NIR spectroscopic 2D imaging techniques have offered the possibility of visualizing StO2 distribution in large tissue areas [19]. Moreover, the short acquisition time required to obtain NIR spectroscopic images facilitates the evaluation of micro vascular ‘dynamic’ conditions, such as the vascular response to physical or pharmacological stimuli.

Currently, several methods are available for assessing peripheral vascular abnormalities. These methods provide functional or structural information but none of them explores microcirculation simultaneously in multiple areas. This is particularly important in some microcirculation diseases like as systemic scleroderma that is characterized by a very heterogeneous spatial distribution of the micro vascular abnormalities. As suggested by the pivotal study of Skarda et al., NIRS of the thenar eminence has a potential role in the clinical management of critical conditions as septic shock [20]. None of existing tools has been accepted as standard method for the investigation of microcirculation and, at present, they are used in different ways depending on the specific clinical question.

The aim of the present study is to use, for the first time, near infrared sensitive camera to not only quantitate but to visualize the distribution of StO2 in large tissue areas. Moreover, the short acquisition time of NIRS camera allows the evaluation of dynamic condition such as the vasodilating response to short periods of ischaemia. The mapping of haemoglobin (Hb) StO2 changes in the hand skin during baseline, ischaemia and reperfusion is the main objective here. The NIRS images acquired from NIRS camera are further processed with multiscale edge detection algorithms to extract thenar eminence region. At the final stage, by segmenting these NRS images, we were able to demonstrate the behaviour of StO2 level during vascular occlusion.

We worked on a semi-automatic segmentation technique to highlight areas of oxygenated blood in the hand skin using NIRS images. The acquired data set includes two sets of NIRS images from palmar and dorsal side of the hand, given in Fig. 1
                     . Marked gradients in StO2 (from blue=low to red=high) can be observed on palmar and dorsal faces. As by 2D NIRS imaging technique we imaged the entire hand, any number and site of ROIs (regions of interest) within the image could be selected and analyzed. In this report we just used thenar eminence and one phalange as two exemplifying ROIs without any pathophysiologic intent. We have selected thenar eminence (base of the thumb) of the palm and the 2nd phalange (finger bone) of the middle finger on the dorsal view as regions of interest (ROI) as shown in Fig. 1. The advantage of thenar eminence compared with other sites, in terms of minimizing variability, is the relatively thin fat tissue over the muscle and seems to be less influenced by oedema [13,19].

The Kent imaging camera used to take the NIRS images, is a non-invasive tissue oxygenation measurement system based on near infrared light. The camera reports and approximates value of Hb+Mb StO2 in superficial tissue. The StO2 is automatically calculated by the NIRS camera software. The oxygen saturation calculation methods used by the camera system are not user-configurable. Using a first-derivative approach [21,22] the system determines the concentration of Hb and HbO2 in the tissue and calculates the ratio of oxygenated haemoglobin to total haemoglobin. Each pixel in the resulting image is representative of the output of this calculation. In particular, the used camera is a non-invasive tissue oxygenation measurement system that reports the value of StO2 calculated starting from HbO2 level and Hb level in tissue. It is based on an array of 5mm diameter LEDs with four wavelengths (670, 730, 890, and 940nm) and a CCD receiver sensor. LEDs are distributed randomly within a rectangular area approximately 190mm×115mm. As stated by the manufacturer, the penetration depth of the NIR light is approximately 3mm, so the camera permits to measure StO2 in subcutaneous tissues. The camera is mounted on a routable head (190mm×115mm) at the extremity of an articulated arm; it is able to produce, in less than one second (acquisition time=0.7s), the two-dimensional colour-coded image of tissue oxygenation of the scanned surface and reports multispectral tissue oxygenation measurements for selected tissue regions. By simple touch-screen approach, immediately after the acquisition the user may visualize StO2 value in any region of interest of choice. The acquired images can be exported in DICOM standard format for further analysis. Each image has a resolution of 750×480 pixels with 12 bit resolution. We worked on Core i5 3210M – Windows 8 64-bit – 4GB RAM. The camera contains six positioning indicators, which appear as red lights on the subject: four lights are used to indicate the corner of the camera field of view, while two lights are used to show the centre of the image and to indicate when the camera is at the proper distance from the subject to achieve clear focus. For our test, the correct distance from the camera to the hand surface was about 40cm.

In a normal male subject of age 72, we obtained total of 13 NIRS saturation images of his right hand for each ROI. Among them, 1 in basal condition, 6 during 3min ischaemia (cuff occlusion of brachial artery) and further 6 images during reperfusion (Fig. 2
                     ).

NIRS Hb StO2 is measured as the ratio between oxygenated Hb (in the arterial+venous blood) and Mb (in the muscle) and the total amount of Hb and Mb (sum of oxygenated+deoxygenated components) comprised in the field of view explored. In normal conditions arterial Hb O2 saturation is near to maximal while Hb desaturation occurs in the capillaries, due to O2 transfer to the tissue, and a parallel increase of deoxygenated Hb occurs in the venous blood where pO2 is in equilibrium with tissue pO2 (pO2 is the partial pressure of O2, Hb and Mb O2 saturation depends on pO2). The net balance between O2 supplies (determined by arterial O2 content and blood flow) and tissue O2 consumption (determined by tissue metabolism) is responsible for the proportion of deoxygenated Hb+Mb. Finally, it should be considered that in the blood volume comprised in the field of view, the proportion of capillary and venous blood is largely prevalent in comparison with the arterial component. In our study, O2 consumption by cutaneous tissue was assumed to remain constant during the experiment, while interference of Mb O2 saturation can be excluded due to the absence of muscle tissue within the explored optical field. Thus, the observed tissue heterogeneity of StO2 can be attributed to heterogeneity of blood perfusion i.e. of microcirculatory neuro-humoral blood flow control.

The level of O2 saturation of haemoglobin (StO2) progressively decreases passing from arterial to venous blood due to the transfer of O2 to tissue during the blood passage through the microcirculation. Microcirculation distributes blood to all body tissues delivering oxygen and energetic substrates while draining products of catabolism. Vasomotricity i.e. selective constriction or dilation of different portions of the micro vascular network, by complex local and/or systemic humoral and nervous control mechanisms, warrants the continuous fine matching between blood delivery and tissue metabolic demand. Haemoglobin StO2 in the peripheral blood i.e. the pool of blood contained in small vessels (arterioles, capillaries and venules) surrounding the tissue cells, reflects tissue O2 content as the proportion in volume of venous blood is largely prevalent on the arterial one. Thus, the estimation of blood StO2 in the “intorno” of tissue cells can be considered a reliable “sensor” of tissue O2 content. Tissue O2 content is the result of O2 delivery (blood flow times arterial O2 concentration) minus O2 tissue consumption. With constant tissue O2 consumption (constant metabolic activity of the tissue), any change in StO2 reflects parallel changes in O2 delivery, which, in absence of variations in arterial O2 concentration, equates parallel changes in micro vascular flow. Among body tissues, skin has a very low O2 consumption; in the contest of the present study, the large variations in StO2 observed cannot be attributed to parallel changes in tissue metabolic activity but rather to the experimental manipulation of micro vascular flow. In conclusion NIRS does not measure blood flow but rather tissue oxygenation that can be affected by blood flow changes (as in the present work). Imaging of tissue oxygenation appears to be clinically relevant as this parameter conditions the function and the survival of any organ. As far as myoglobin StO2, the thenar eminence contains muscle, which however does not interfere with the estimation of haemoglobin StO2 as penetration of the light into the tissue is not sufficiently high to reach the muscle below. This study is intended to explore the feasibility of using 2D NIRS in the clinical setting. Several studies are still needed in normal and pathological conditions to conclude about its utility.

As explained in the previous section, in this work we use NIRS camera, not only to visualize but also to estimate the StO2 level during different vascular conditions. In order to visualize better and estimate the levels of StO2, it is required to remove background while preserving the edges of the hand. This background subtraction is the first important step in many real time applications and several algorithms have been proposed in the past to achieve these objectives. Radke et al. performed a comprehensive survey of image change detection algorithms [23]. Their survey covers different methods for detecting changes in images and issues related to the processing of input data and resulting masks. Different methodologies were compared to evaluate the performances of test algorithms. Similarly, Parks and Fels in their survey have presented the analysis of different post processing and background removal techniques [24]. More recently Benezeth et al. have presented the comparative analysis of different simpler and sophisticated background subtraction methods for moving objects [25]. In this work, the obtained NIRS hand image has a single clear and sharp edge (Fig. 1). Therefore, we avoided more complex and sophisticated techniques and used simple edge detection based background removal. In the coming subsections, we will briefly explain the theoretical perspective of applied multiscale edge detection method.

Edges are significant local changes of intensity in an image and occur on the boundary between two different regions. In order to separate these edges, wavelet transform based multiscale analysis was applied on the image by detecting local maxima and minima. A multiscale version of the edge detector is implemented by smoothing the surface with the convolution kernel θ(x) that is dilated. This is computed with the two wavelet functions as shown in (1) that are the partial derivative of θ 
                        [26].
                           
                              (1)
                              
                                 
                                    
                                       ψ
                                       1
                                    
                                    =
                                    
                                       
                                          ∂
                                          θ
                                       
                                       
                                          ∂
                                          
                                             x
                                             1
                                          
                                       
                                    
                                     
                                    and
                                     
                                    
                                       ψ
                                       2
                                    
                                    =
                                    
                                       
                                          ∂
                                          θ
                                       
                                       
                                          ∂
                                          
                                             x
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Although, the scale varies along the dyadic sequence to ensure the evolution of maxima but the selection of these scale to compute maxima depends on the type of an image and on application as well. The maxima corresponding to the sharp edges can be detected even on the coarser scales but, in order to detect very small edges, the selection of much finer scale is required. The wavelet transform components are proportional to the coordinates of the gradient vector of f smoothed by 
                           
                              
                                 θ
                                 
                                    
                                       2
                                       j
                                    
                                 
                              
                           
                         
                        [26].
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         W
                                                         1
                                                      
                                                      f
                                                      (
                                                      u
                                                      ,
                                                      
                                                         2
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         W
                                                         2
                                                      
                                                      f
                                                      (
                                                      u
                                                      ,
                                                      
                                                         2
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       2
                                       j
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            ∂
                                                            
                                                               u
                                                               1
                                                            
                                                         
                                                      
                                                      (
                                                      f
                                                      *
                                                      
                                                         
                                                            
                                                               θ
                                                               
                                                                  
                                                                     2
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         ¯
                                                      
                                                      )
                                                      (
                                                      u
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         
                                                            ∂
                                                            
                                                               u
                                                               2
                                                            
                                                         
                                                      
                                                      (
                                                      f
                                                      *
                                                      
                                                         
                                                            
                                                               θ
                                                               
                                                                  
                                                                     2
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         ¯
                                                      
                                                      )
                                                      (
                                                      u
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If I(x, y) corresponds to the intensity image after wavelet transformation then, the discrete version of multiscale analysis can be written as in (3) 
                        [26]:
                           
                              (3)
                              
                                 
                                    
                                       
                                          ^
                                          G
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       →
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         G
                                                         i
                                                      
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         G
                                                         j
                                                      
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      −
                                                      I
                                                      (
                                                      i
                                                      −
                                                      1
                                                      ,
                                                      j
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      I
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      −
                                                      I
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           
                              
                                 G
                                 i
                              
                              
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 G
                                 j
                              
                              
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         correspond to the gradients in horizontal and vertical directions respectively. The gradient image in both directions (horizontal and vertical) of the subject image is given in Fig. 3
                        a and b respectively. The modulus of this gradient vector is proportional to the wavelet transform modulus as in (4) and shown in Fig. 3c.
                           
                              (4)
                              
                                 
                                    M
                                    f
                                    (
                                    u
                                    ,
                                    
                                       2
                                       j
                                    
                                    )
                                    =
                                    
                                       
                                          |
                                          
                                             W
                                             1
                                          
                                          f
                                          (
                                          u
                                          ,
                                          
                                             2
                                             j
                                          
                                          )
                                          
                                             |
                                             2
                                          
                                          +
                                          |
                                          
                                             W
                                             2
                                          
                                          f
                                          (
                                          u
                                          ,
                                          
                                             2
                                             j
                                          
                                          )
                                          
                                             |
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Let Af(u, 2
                           j
                        ) be the angle of the wavelet transform vector in the plane (x
                        1,x
                        2) in (5).
                           
                              (5)
                              
                                 
                                    A
                                    f
                                    (
                                    u
                                    ,
                                    
                                       2
                                       j
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      α
                                                      (
                                                      u
                                                      )
                                                   
                                                
                                                
                                                   
                                                      if
                                                         
                                                      
                                                         W
                                                         1
                                                      
                                                      f
                                                      (
                                                      u
                                                      ,
                                                      
                                                         2
                                                         j
                                                      
                                                      )
                                                      ≥
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      π
                                                      −
                                                      α
                                                      (
                                                      u
                                                      )
                                                   
                                                
                                                
                                                   
                                                      if
                                                         
                                                      
                                                         W
                                                         1
                                                      
                                                      f
                                                      (
                                                      u
                                                      ,
                                                      
                                                         2
                                                         j
                                                      
                                                      )
                                                      <
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with
                           
                              
                                 
                                    α
                                    (
                                    u
                                    )
                                    =
                                    
                                       
                                          tan
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                   2
                                                
                                                f
                                                (
                                                u
                                                ,
                                                
                                                   2
                                                   j
                                                
                                                )
                                             
                                             
                                                
                                                   W
                                                   1
                                                
                                                f
                                                (
                                                u
                                                ,
                                                
                                                   2
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It can be seen from Fig. 3 that there exist few edges at the initial scales. This corresponds to the finer scale intensity variations that are removed by the averaging with 
                           
                              
                                 θ
                                 
                                    
                                       2
                                       j
                                    
                                 
                              
                           
                         when 2
                           j
                         is large [26].

After computing the magnitude and directions of the edges, the next step is to extract the meaningful transitions by detecting all local maxima present at that particular scale. In order to extract local maxima from modulus of gradient image, we performed classical interpolation technique based on two points system. The schematic illustration of local maxima extraction is given in Fig. 4
                        . The corresponding pixel follows the direction in its phase angle in both positive and negative directions and compares the gradient from both neighbourhood pixel to assess if the current point is local maxima or not. The current point can only be local maxima if it satisfies the following condition [26]:
                           
                              (6)
                              
                                 
                                    |
                                    
                                       
                                          
                                             G
                                             
                                                n
                                                +
                                             
                                          
                                       
                                       →
                                    
                                    |
                                    <
                                    |
                                    
                                       
                                          
                                             G
                                             c
                                          
                                       
                                       →
                                    
                                    |
                                    >
                                    |
                                    
                                       
                                          
                                             G
                                             
                                                n
                                                −
                                             
                                          
                                       
                                       →
                                    
                                    |
                                 
                              
                           
                        where 
                           
                              |
                              
                                 
                                    
                                       G
                                       
                                          n
                                          +
                                       
                                    
                                 
                                 →
                              
                              |
                           
                         corresponds to the gradient of the neighbourhood pixel in the positive direction of phase angle and similarly 
                           
                              |
                              
                                 
                                    
                                       G
                                       
                                          n
                                          −
                                       
                                    
                                 
                                 →
                              
                              |
                           
                         corresponds to the neighbourhood pixel in the negative direction of phase angle. 
                           
                              |
                              
                                 
                                    
                                       G
                                       c
                                    
                                 
                                 →
                              
                              |
                           
                         correspond to the gradient of the current pixel/point. After computing all modulus maxima, we applied simple thresholding to extract only sharp maxima, which correspond to the maximum intensity change.

In the previous section, local modulus maxima were estimated by following the direction of the gradient using linear interpolation between corresponding adjacent neighbours. We addressed the problem of edges delocalization by tracing the maxima from coarser scale towards the respective maxima in the finer scale by following the direction of the maxima. In order to extract only strong edges, we applied thresholding on detected local maxima. The threshold criterion is based on the Median Absolute Deviation (MAD) of the maxima on the corresponding scales [27].
                           
                              (7)
                              
                                 
                                    Threshold
                                    =
                                    σ
                                    
                                       
                                          2
                                          log
                                           
                                          (
                                          n
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    σ
                                    =
                                    
                                       
                                          MAD
                                          (
                                          m
                                          )
                                       
                                       
                                          0.6745
                                       
                                    
                                 
                              
                           
                        
                     

Median absolute deviation (MAD) based threshold values were estimated for each scale. The nonlinear filtering based soft thresholding was applied on each scale as [27]:
                           
                              (9)
                              
                                 
                                    
                                       η
                                       t
                                    
                                    (
                                    y
                                    )
                                    =
                                    sgn
                                    (
                                    y
                                    )
                                    
                                       
                                          (
                                          |
                                          y
                                          |
                                          −
                                          t
                                          )
                                       
                                       +
                                    
                                 
                              
                           
                        which sets to zero data y below t in absolute value, and pulls other data towards the origin by an amount t. Thresholding results in the identification of only those maxima which correspond to the expected boundary of the hand. Fig. 5
                         shows the corresponding maxima before and after applying thresholding on NIRS image of palmar hand. It can be seen from the figure that the thresholding eliminated most of the small edges saving the strong ones only. Although the extraction results in highlighting the boundary of the hand, we still can observe some small noise blobs. These erroneous blobs can be removed by applying simple filtering algorithms resulted in ROIs on the palmar side shown in Fig. 6
                        . The obtained NIRS interest region before and after the removal of background is shown in Fig. 7
                        . After this removal, in the next section we will apply the segmentation methods to estimate StO2 levels in both ROIs.

After removing noise and unwanted background, we had analyzed the heterogeneity of hand skin microcirculation. We had applied semi-automatic region-growing segmentation technique to extract micro-regions with different iso-levels of StO2. From a seed point, the pixels are grouped by using criteria of homogeneity. The relative areas were further extended in all the directions until reaching the borders of the homogeneous area. We will explain the applied methods in the next coming sections.

In this approach we grouped the pixels or sub regions into larger regions. Here, regions correspond to different StO2 levels. Initially starting with ‘seed’ pixel, the procedure grouped pixels into larger regions by appending connected neighbouring pixels having similar properties (e.g. intensity). If the difference is under a given threshold, the studied patch is grouped to the current region and the global equation of the feature criteria is updated. This process is repeated until no more patches can be grouped to that region. The global process is then repeated until the entire pixel in the image is included in any of the regions. Based on the combination of region growing and thresholding, the segmentation method is composed of the following steps.

Initially the image is divided into the window of 10×10 pixels. After computing the mean saturation value (M
                           
                              x
                           ) of each window, the most saturated (highest intensity) pixel inside the lowest mean saturation of all pixels inside that window is then fixed as the ‘seed’ as shown in Fig. 8
                           . The grey window corresponds to the one with the minimum saturation and the most saturated pixel (highlighted) is considered as a seed pixel in that window (Fig. 9
                           ).

Starting from the seed, all connected pixels with intensity smaller than a determined threshold value are appended, by considered that as the part of the region and labelled for the segmentation mask. All the pixels with the saturation greater than threshold are added to the segmentation mask as the part of the corresponding region. The final segmented image highlights the areas of different StO2 values. By appending all the regions, the final obtained binary image correspond to the StO2 level at that particular instant. In the same way, we had applied the method on complete set of NIRS images of both ROIs. In the next coming section, we will explain the obtained segmented images and will relate the complete set in terms of saturation curves.

@&#RESULTS AND DISCUSSION@&#

We had applied the image processing methods on complete set of NIRS images of both dorsal and palmar views of the hand. Fig. 10
                      shows the behaviour of StO2 during vascular occlusion test on palmar ROI. We can observe the reduction in number of well-saturated micro-areas, reflecting the reduction in blood supply. The rate of desaturation after vascular occlusion can be used to estimate the rate of oxygen consumption. With the removal of cuff, StO2 rapidly increases, reaching higher level respect to its basal value which is normal for healthy subject (as in our case) [13,15,16]. This swift restoration of blood flow can be described in terms of reperfusion rate which correspond to the regression line of the increase in StO2 after cuff deflation (shown in Fig. 10) and then gradually settling down to basal condition with time.


                     Fig. 11
                      illustrates the visual analysis of the microcirculatory behaviour on palmar ROI of the hand. The applied image processing methods had successfully detected the saturated regions and presents the StO2 behaviour during vascular occlusion test as already detected and given in literature. Relative to baseline (Fig. 11a), StO2 progressively decreases with brachial artery occlusion reducing well saturated regions (Fig. 11b–f), reaching its minimum in Fig. 11f. After the cuff deflation, the sudden increase in the StO2 corresponds to reperfusion shown in Fig. 11g–l. It is possible to correlate the visual results with saturation curve (Fig. 10) during ischaemia and reperfusion. The reduction of well saturated micro areas are visible during ischaemic phase with the minimum at Fig. 11f. With the removal of cuff, restoration of saturate areas corresponds to reperfusion as visible in Fig. 11g–l.

At the second stage, we had applied the same processing methods on dorsal ROI of the hand. Fig. 12
                      shows the behaviour of StO2 during vascular occlusion test on dorsal ROI. We had observed approximately similar behaviour here, as in palmar side. With the cuff occlusion, the reduction in the number of well-saturated micro-areas, correspond to ischaemia with high oxygen consumption. With the deflation of cuff, there is a swift restoration of blood flow. During ischaemia, the deprivation of oxygen causes vasodilation (widening of blood vessels) which after release of cuff can leads to hyperemia. As compared to the palmar ROI, we had observed the peak saturation just after removal of cuff during reperfusion exceeded basal value and resulted in hyperaemia.


                     Fig. 13
                      illustrates the visual analysis of microcirculatory behaviour on dorsal ROI of the hand. The applied image processing methods had successfully detected the saturated regions. Relative to baseline (Fig. 13a), StO2 progressively decreases with brachial artery occlusion reducing well saturated regions (Fig. 13b–f), reaching its minimum in Fig. 13f. Occlusion release rapidly enhanced skin oxygenation, even exceeding baseline condition at peak reperfusion resulting in hyperaemia (Fig. 13g) and then gradually settling to baseline conditions (Fig. 13h and i). By correlating the obtained visual results with saturation curve (Fig. 12) during ischaemia and reperfusion, we observed the reduction of well saturated micro areas as visible in ischaemic phase (minimum at Fig. 13f) followed by removal of cuff. The restoration of saturate areas correspond to reperfusion as visible in Fig. 13g–i.

In order to quantify spatial heterogeneity of blood perfusion we had applied statistical analysis to both ROIs of the hand. The standard deviation of spatial heterogeneity of blood flow on both sides is shown in Fig. 14
                     . In thenar eminence heterogeneity reached its minimum during reperfusion while in the dorsal finger ROI heterogeneity progressively increased during occlusion, while decreased at peak ischaemia and early reperfusion, gradually settling down to basal condition. Also we had observed very high heterogeneity during early reperfusion due to the release of cuff.

In this section, we had demonstrated the behaviour of StO2 with 2D NIRS images during basal, ischaemic and in perfusion state. As we have already mentioned in the previous sections that the main objective of this work is not only to quantitate, as already given in literature and explained in the past, but also to visualize the results for better understanding and diagnosis of dysfunction. As this work is an initial attempt to achieve these objectives therefore limited data was acquired and with this limited data, the obtained results has correctly demonstrated the behaviour of StO2 during vascular occlusion. These results encourage us to acquire more data in future and strongly support the idea of using NIRS 2D imaging to investigate StO2 levels in different pathological conditions.

@&#CONCLUSION@&#

In this work, we have studied the microcirculation and its spatial heterogeneity in the hand skin by means of optical NIRS imaging of blood StO2. The data were collected by performing vascular occlusion test and using NIR sensitive camera. The classical image processing techniques (edge detection and segmentation) were applied on the set of 2D NIRS images. Multiscale edge detection extracted thenar eminence area from the palmar side of the hand. The extracted modulus maxima highlighted the significant transitions of the edges followed by nonlinear filtering. We were able to demonstrate, by analysing a sequence of images obtained during basal, ischaemia and reperfusion conditions, the progressive decrease and then increase of StO2 curve. Furthermore, segmentation of ROIs allowed us to visualize and quantitate microcirculatory spatial heterogeneity, an information precluded to current techniques, as Doppler and Laser speckle imaging, devoted to measure vessel blood flow or Doppler laser probe, by which assessment of microcirculation is confined to a tiny area at the time (as opposite to any number and size of ROIs in our case). We were able to demonstrate the behaviour of StO2 during vascular occlusion tests. In conclusion, NIRS 2D imaging looks a promising diagnostic tool especially in patients with micro vascular diseases typically characterized by heterogeneously distributed blood flow disorders, with some areas deprived of oxygen while others are not [28,29]. On this regard, it is noteworthy that the number, size and anatomical location of the ROIs we chose in the present study, were by way of example but not limited thereto. Any other number, size and site of ROIs could have been selected from the same set of experimental data. Moreover, one should consider that preservation of pixel data allows unlimited re-analyses of the experimental data set, based on different anatomical criteria or comparison with novel acquisitions during the follow-up. The results of this pilot study support the feasibility of a clinical controlled trial with the use of 2D NIR spectroscopic hand imaging. It will also be important to test the utility of NIR spectroscopic hand imaging in the management of critical disease such as septic shock [20], and the objective control of micro vascular response to therapeutic interventions.

@&#ACKNOWLEDGEMENT@&#

This work has been supported by ‘Regione Toscana, Direzione Generale Competitività e Sviluppo Competenze, Area di Coordinamento della Ricerca’.

@&#REFERENCES@&#

