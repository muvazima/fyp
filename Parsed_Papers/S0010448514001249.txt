@&#MAIN-TITLE@&#Multi-morphology transition hybridization CAD design of minimal surface porous structures for use in tissue engineering

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We proposed two CAD methods for heterogeneous scaffold designs.


                        
                        
                           
                           The SF method was an improvement on transfinite interpolation.


                        
                        
                           
                           The GRBF method could handle the pixel or voxel cases.


                        
                        
                           
                           Bio-mimetic structures could be achieved.


                        
                        
                           
                           The proposed CAD method was suitable for an additive manufacturing process.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Porous morphology

Structure hybridization

Triply periodic minimal surface

Sigmoid functions

Gaussian radial basis functions

@&#ABSTRACT@&#


               
               
                  There has been considerable work on scaffold design based on triply periodic minimal surfaces (TPMS). Current methods used to adjust the parameters in one type of TPMS model are insufficiently flexible for designing architectures comprising multiple porous structures. In this paper, we propose two CAD methods that combine different TPMS-based structures with given transition boundaries. One method is a sigmoid function (SF) method that can be effectively applied to simple transition boundary cases. The second method is a Gaussian radial basis function (GRBF) method that can be applied to more general cases. These methods provide for placing given TPMS-based substructures on given 3D subspaces with perfect transitions to their adjacent substructures within a scaffold domain. We present various examples of functionally graded porous structures with desired internal porous structures and external geometries to demonstrate the effectiveness of these two methods. The resulting models can be exported as STL-files and be fabricated using an additive manufacturing process.
               
            

@&#INTRODUCTION@&#

For scaffolds that are used for tissue engineering, their pore architectures and properties, such as pore shape, pore size, porosity, mechanical stiffness, surface properties, and rate of degradation, can govern cell attachment  [1], provide for efficient cell seeding into a scaffold  [2], transfer metabolites  [3,4], deliver drugs or growth factors  [5], and provide a sufficient regeneration space for newly formed tissue  [6]. However, recent studies have shown that a native tissue cannot be represented by a homogeneous structure; rather, it is a multi-scale structure  [7]. For example, Karageorgiou et al.  [8] found that larger pores resulted in substantial bone ingrowth, whereas smaller pores resulted in ingrowth of non-mineralized osteoid tissue.

Various traditional fabrication methods are available for scaffold production, including salt leaching  [9], gas-foaming  [10], phase-separation followed by freeze-drying  [11], thermal induced phase separation  [12,13], and electrospinning  [14,15]. However, these techniques have limitations with regard to accurately controlling pore morphologies, sizes, interconnectivities, and spatial distributions. By comparison, more advanced additive manufacturing techniques (AMT), such as 3D printing  [16,17], fused deposition modeling  [18], rapid prototyping, selective laser sinter  [19], and stereolithography  [20,21], have been used to produce porous metallic/non-metallic scaffolds for tissue engineering. As compared with the conventional raw stock processing methods, AMT was found to greatly improve object fabrication by stacking 2D solid sheets of finite thicknesses in a layer-by-layer manner  [22].

Recently, combinations of AMT and CAD methods were used to provide efficient solutions for scaffold fabrication. Bael et al.  [23] designed a porous structure CAD model for a polycaprolactone (PCL) scaffold and fabricated it using a selective laser sintering technique. The product was a cubic open porous scaffold designed as a 3D lattice network with a pore size of 2 mm and strut sizes of 1 mm. However, this structure was too regular to achieve a given bio-mimetic target. Pasko et al.  [24] proposed a function-based method to construct regular and irregular porous structures, although this method might not be able to include combining different structures. They also proposed a transfinite interpolation of the shape of a unit cell using metamorphosis between two unit cells  [25]. Ohtake  [26] presented a multi-level partition of unity implicit surface to construct surface models from large sets of points. This approach could provide for considerable flexibility in choosing local shape functions and could represent sharp features by selecting appropriate shape functions.

Compared with conventional CAD-based manual design methods, TPMS is an effective, although simple mathematical method for defining pore geometries. Moreover, conventional CAD design methods have limitations with regard to controlling the spatial distributions of heterogeneous pore architectures. However, according to the previous reports  [27–31], the TMPS method is a powerful solution for making pores for scaffold design. Although there have been many reports on TPMS-based structure design, few studies have considered combining different porous morphologies.

Thus, in this paper, we propose two methods for hybridizing different TPMS-based structures for bio-mimetic design purposes. In Section  2, we introduce the mathematical methods used for multi-structure hybridization; in Section  3, various interesting examples are given; in Section  4, we discuss the properties and limitations of this method, and comparisons with other methods and new ideas for future research; and Section  5 provides our concluding remarks.

@&#METHODS@&#

Based on the previous studies  [27–31], we revised the TPMS functions for simpler operation purposes. These revisions were
                           1
                        
                        
                           1
                           This list only includes some of the TPMS functions.
                        : 
                           
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    =
                                    cos
                                    
                                       (
                                       a
                                       x
                                       )
                                    
                                    sin
                                    
                                       (
                                       b
                                       y
                                       )
                                    
                                    +
                                    cos
                                    
                                       (
                                       b
                                       y
                                       )
                                    
                                    sin
                                    
                                       (
                                       c
                                       z
                                       )
                                    
                                    +
                                    cos
                                    
                                       (
                                       c
                                       z
                                       )
                                    
                                    sin
                                    
                                       (
                                       a
                                       x
                                       )
                                    
                                    +
                                    d
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             II
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    =
                                    sin
                                    
                                       (
                                       a
                                       x
                                       )
                                    
                                    sin
                                    
                                       (
                                       b
                                       y
                                       )
                                    
                                    +
                                    sin
                                    
                                       (
                                       b
                                       y
                                       )
                                    
                                    sin
                                    
                                       (
                                       c
                                       z
                                       )
                                    
                                    +
                                    sin
                                    
                                       (
                                       c
                                       z
                                       )
                                    
                                    sin
                                    
                                       (
                                       a
                                       x
                                       )
                                    
                                    +
                                    d
                                 
                              
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             III
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    =
                                    cos
                                    
                                       (
                                       a
                                       x
                                       )
                                    
                                    +
                                    cos
                                    
                                       (
                                       b
                                       y
                                       )
                                    
                                    +
                                    cos
                                    
                                       (
                                       c
                                       z
                                       )
                                    
                                    +
                                    d
                                 
                              
                              
                                 (1)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             IV
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    =
                                    cos
                                    
                                       (
                                       a
                                       x
                                       )
                                    
                                    cos
                                    
                                       (
                                       b
                                       y
                                       )
                                    
                                    cos
                                    
                                       (
                                       c
                                       z
                                       )
                                    
                                    −
                                    sin
                                    
                                       (
                                       a
                                       x
                                       )
                                    
                                    sin
                                    
                                       (
                                       b
                                       y
                                       )
                                    
                                    sin
                                    
                                       (
                                       c
                                       z
                                       )
                                    
                                    +
                                    d
                                    .
                                 
                              
                           
                        
                     

In these equations, an inequality 
                           ϕ
                           ≤
                           0
                         represents the solid part within a scaffold and 
                           ϕ
                           >
                           0
                         represents the pores. Parameters 
                           a
                           ,
                           b
                        , and 
                           c
                         are adjustable in order to control the pore size in the 
                           x
                           ,
                           y
                        , and 
                           z
                         directions, respectively. Parameter 
                           d
                         controls porosity. In general, larger values of 
                           a
                           ,
                           b
                        , and 
                           c
                         result in smaller pore sizes, while porosity linearly increases based on the value of 
                           d
                        . Additionally, 
                           a
                           ,
                           b
                        , and 
                           c
                         do not affect porosity; thus, 
                           d
                         is the only factor related to porosity.

At the intersection between two porous morphologies within one scaffold, there should be a special shape as a bridge to smoothly connect these two morphologies. Mathematically, in order to avoid piecewise formulas for each part, using one continuous function is better for describing the entire structure. Thus, the entire structure can be defined by 
                           
                              (2)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          hyb
                                       
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 =
                                 α
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 +
                                 
                                    (
                                    1
                                    −
                                    α
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 ϕ
                              
                              
                                 
                                    hyb
                                 
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         indicate, respectively, the function for the final hybrid morphology and the parent morphologies 1 and 2. The expression 
                           α
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is a weight function that satisfies: 
                           α
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . This describes a monotonic change from 0 to 1, which was inspired by the sigmoid function (SF) shown in (Fig. 1
                        (a)). Then, we define: 
                           
                              (3)
                              
                                 α
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             −
                                             k
                                             G
                                             
                                                (
                                                x
                                                ,
                                                y
                                                ,
                                                z
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           G
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                           =
                           0
                         is the transition boundary with which we intend to intersect the two TPMS morphologies, and 
                           G
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is a continuous function. The parameter 
                           k
                           
                           
                              (
                              k
                              >
                              0
                              )
                           
                         can be used to change the transition gradient. As shown in Fig. 1(b), a large value of 
                           k
                         results in a more abrupt transition between two TPMS morphologies.

The SF method is a convenient, efficient means to hybridize two porous structures. In addition, it can also be used to construct architectures with multiple porous structures via the recursive operations described in Section  3. However, it cannot flexibly handle complex and compound transition boundaries. This problem can be overcome by applying the GRBF method proposed in the next subsection.

Assuming that there are 
                           n
                         structures within one scaffold domain, Eq. (2) can be extended by
                           
                              (4)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          hyb
                                       
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                              
                           
                         where 
                           n
                         is the number of TPMS-based porous morphology types, 
                           X
                           =
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is a spatial coordinate, and 
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           
                              (
                              ⋅
                              )
                           
                         is a weight function for the 
                           j
                        th porous morphology, which should satisfy: 
                           
                              (5)
                              
                                 
                                    
                                       α
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             X
                                             ∈
                                             
                                                
                                                   
                                                      region
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             X
                                             ∉
                                             
                                                
                                                   
                                                      region
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    region
                                 
                              
                              
                                 j
                              
                           
                         is the region that contains the 
                           j
                        th porous morphology. Although Eq. (5) is a step function, it can be approximated by a continuous function.


                        
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           
                              (
                              X
                              )
                           
                         is defined as a Gaussian radial basis function (GRBF):
                           
                              (6)
                              
                                 
                                    
                                       α
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 exp
                                 
                                    (
                                    −
                                    
                                       
                                          
                                             
                                                
                                                   ‖
                                                   X
                                                   −
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           δ
                         can change the transition gradient, 
                           
                              
                                 β
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         is a weight coefficient for the 
                           i
                        th point in the 
                           j
                        th region, 
                           
                              
                                 X
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ∈
                              
                                 
                                    
                                       region
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                              )
                           
                         is the 
                           i
                        th point coordinate in 
                           
                              
                                 
                                    region
                                 
                              
                              
                                 j
                              
                           
                        , and 
                           m
                         is the point number in 
                           
                              
                                 
                                    region
                                 
                              
                              
                                 j
                              
                           
                        . The motivation for this is that a region represented by numerous inequalities can be simply represented by a function based on the points 
                           
                              
                                 X
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        .

For example, if we intend to represent the region 
                           
                              (
                              
                                 
                                    
                                       (
                                       x
                                       −
                                       1
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ≤
                              1
                              )
                           
                           ∩
                           
                              (
                              y
                              ≥
                              0.5
                              sin
                              
                                 (
                                 4
                                 x
                                 )
                              
                              )
                           
                           ∩
                           
                              (
                              y
                              ≥
                              0
                              )
                           
                        , we first construct many points inside this region as shown in Fig. 2
                        . Using the GRBF, we can represent this region using a continuous function based on these points. As a simple method, these points can be constructed with equal intervals as shown in the Appendix (Algorithm 1).

Then, based on Eqs. (5) and (6), we obtain a linear system of equations in matrix form: 
                           
                              (7)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                1
                                                ,
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                1
                                                ,
                                                2
                                                )
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                1
                                                ,
                                                m
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                2
                                                ,
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                2
                                                ,
                                                2
                                                )
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                2
                                                ,
                                                m
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                m
                                                ,
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                m
                                                ,
                                                2
                                                )
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                m
                                                ,
                                                m
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                   ,
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   m
                                                   ,
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         where 
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                           
                              (
                              i
                              ,
                              k
                              )
                           
                           =
                           exp
                           
                              (
                              −
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       −
                                       
                                          
                                             X
                                          
                                          
                                             k
                                             ,
                                             j
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              /
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . The unknowns, 
                           
                              
                                 β
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                        , can be obtained by solving these equations.

@&#RESULTS@&#

Based on the descriptions in Sections  2.2 and 2.3, our proposed mathematical methods could be performed using Wolfram Mathematica 9.0 software. Using this software, we directly input the inequalities used in the above equations and used the “RegionPlot3D” command to generate all the figures in this paper. In addition, using the “Export” command, we saved these data as STL files for 3D-printing purposes. The command “NSolve” was used to solve the set of equations in Eq. (7). Many interesting results are shown in this section (the algorithms used for these examples are shown in the Appendix).

A 3D structure comprising two pore morphologies with one transition boundary could be generated by one SF operation based on Eqs. (2) and (3). As shown in Fig. 3
                           (a), the transition domain was elongated by a small 
                              k
                            value and shortened by a large 
                              k
                            value.

It is important to be able to combine a complex porous structure with a given external shape for an object in many applications  [3]. Here, we attempted to construct a sphere-shell shaped structure. The solid model was defined by the Boolean set expression: 
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       ∩
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                       ∩
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   hyb
                                                
                                             
                                          
                                          ≤
                                          0
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   Spherical_outer
                                                
                                             
                                          
                                          ≤
                                          0
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          (
                                          −
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   Spherical_inner
                                                
                                             
                                          
                                          ≤
                                          0
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                Spherical_outer
                                             
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             
                                                Spherical_inner
                                             
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                            where 
                              R
                            and 
                              r
                            were, respectively, the outer and inner sphere radii.

The software used allowed directly defining Boolean set expressions. This result is shown in Fig. 3(b). The two porous structures changed smoothly near their transition boundary (marked as blue), and the external shape of this structure was a sphere-shell.

As is well known, natural bone exhibits a heterogeneous, anisotropic material distribution. At the macrostructure level, bone is classified as either cortical or cancellous  [32], and a scaffold structure should conform to these designations. With our method, a particular form can be readily achieved by changing the form of the transition boundary. For example, in cross-section, a femur has a dense cortical shell, a porous cancellous interior, and a transition boundary that is approximately a cylindrical surface. Using our SF operations, TPMS morphologies I and III were combined to obtain this structure as shown in Fig. 4
                           (a), for which the form of transition boundary was simulated using 
                              G
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           .

Moreover, flat bones, such as calvaria, have a sandwich structure; dense cortical layers on their outer surfaces with a thin, reinforcing cancellous structure inside (Fig. 4(b)), for which the form of transition boundary was 
                              G
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           .

In addition, a sphere boundary was defined by 
                              G
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                              =
                              
                                 
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       (
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 (
                                 z
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                            and a sinusoid boundary was defined by 
                              G
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                              =
                              sin
                              
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       ˆ
                                    
                                 
                                 x
                                 )
                              
                              +
                              
                                 
                                    b
                                 
                                 
                                    ˆ
                                 
                              
                           . These results are shown in Fig. 5
                           .

It has been shown that minimal surface sheet solids are considerably stiffer than network solids with the same volume fraction and material  [30]. With our model, a network solid can be expressed by: 
                              ϕ
                              ∈
                              
                                 (
                                 −
                                 ∞
                                 ,
                                 0
                                 ]
                              
                           , and a sheet solid can be expressed by: 
                              ϕ
                              ∈
                              
                                 [
                                 
                                    
                                       n
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       ˆ
                                    
                                 
                                 ]
                              
                           , where 
                              
                                 
                                    n
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    m
                                 
                                 
                                    ˆ
                                 
                              
                            are two constants.

If we consider two sheet solids, 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ∈
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                               and 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                              , then their hybrid structure is represented by 
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ∩
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             (
                                             −
                                             
                                                (
                                                α
                                                
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   1
                                                   −
                                                   α
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             ≤
                                             0
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             (
                                             α
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                α
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             ≤
                                             0
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

The hybrid result of a sheet solid, 
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ∈
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                              , and a network solid, 
                                 
                                    
                                       ϕ
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    (
                                    −
                                    ∞
                                    ,
                                    0
                                    ]
                                 
                              , is represented by 
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ∩
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             (
                                             −
                                             
                                                (
                                                α
                                                
                                                   (
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   1
                                                   −
                                                   α
                                                   )
                                                
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             ≤
                                             0
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             (
                                             α
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                −
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                α
                                                )
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   2
                                                
                                             
                                             ≤
                                             0
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

As shown in Fig. 6
                              (a)–(c), there were three original scaffolds of sheet solid types I and III and a network solid type IV (I, III, and IV types were defined in Eq. (1)). The sheet solid types I and III were hybridized as shown in Fig. 6(d), and the sheet solid type I and network solid type IV were hybridized as shown in Fig. 6(e).

The SF method can become more flexible via recursive operations with Eq. (2). A recursive operation is defined by
                              
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             hyb
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    ⇐
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             hyb
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    +
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                       )
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                 
                              
                            or by 
                              
                                 (8)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             hyb
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    ⇐
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                    +
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                       )
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          
                                             hyb
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                    
                                 
                              
                            where 
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       hyb
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            are, respectively, the weight function, the hybridization structure, and the structure to be added at the 
                              i
                           th time, and 
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       hyb
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            is the hybridization structure at the 
                              
                                 (
                                 i
                                 +
                                 1
                                 )
                              
                           th time. As shown in Fig. 7
                           , these SF recursive operations could be used to construct a multi-TPMS structure in many different ways. The algorithm for generating a four-TPMS structure in a linear manner is shown in the Appendix (Algorithm 2).

Compared with the SF method, the GRBF method has a greater capability for porous morphology transitions with compound boundaries. As shown in Fig. 8
                        (b), there were two regions in the rectangle area of a spine CT image; a low porosity region (high brightness) with high mechanical stiffness and a high porosity region (low brightness) with low mechanical stiffness. The problem was to combine these two porous architectures in these two regions with compound boundaries (comprising three lines and one arc).

A surface representing 
                           α
                           
                              (
                              X
                              )
                           
                         in 3D was constructed as shown in Fig. 8(a). This diagram represents a simplified version of the rectangle area of the CT image shown in Fig. 8(b). A combination of the same porous morphology with different porosities and pore sizes is shown in the middle of Fig. 8(b), and a combination of different morphologies with different porosities and pore sizes is shown at the bottom of Fig. 8(b). The algorithm that was used is described in the Appendix (Algorithm 3).

By applying our GRBF method, we designed and fabricated an ellipsoid shell scaffold with three porous morphologies (I, III, and IV) as shown in Fig. 9
                        . The internal and external surfaces were both ellipsoid surfaces, and the three porous morphologies were combined in an arbitrary manner. Using Wolfram Mathematica software, the resulting model was saved as an STL file and manufactured using the 3D printing system Objet30 Pro (Israel) with Objet VeroWhitePlus (material). The 3D model was fabricated by stacking the 2D patterns. This system could judge where to place the support materials and where to place the main materials based on the STL file. Finally, the support materials were removed by a water flushing device provided with this system.

It is also important to be able to design artificial joints for tissue engineering. The two parts of a joint can be designed as a heterogeneous porous morphology. As shown in Fig. 10
                        (a) and (b), each part of a turning joint comprises two porous morphologies. A coaxial joint and a non-coaxial joint can be used for an artificial knee joint and a hip joint, respectively. As shown in Fig. 10(c), the first figure shows the right view of the non-coaxial artificial joint from the red plane. There is a small interval between these two parts; thus, in this way, they can turn relative to one another. These two parts can be simultaneously fabricated using AMT (Fig. 10(d)).

This showed that: 
                           
                              (1)
                              One kind of porous structure changed smoothly to the others.

The solid and porous areas were connected respectively.

The final product could be formed according to STL model specifications without the need for time-consuming and error-prone slicing processes.

@&#DISCUSSION@&#

A resulting model comprising multiple structures could be represented by no more than one continuous function in the intersection regions, such as Eqs. (2) and (4), and had 
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                            continuity.

The core of our GRBF method is a set of linear equations, Eq. (7), for which the numbers of variables and equations are equal. Thus, we can achieve a unique solution. Therefore, this method is convergent.

It should be pointed out that an alternative set of equations according to Eq. (5) should be Eq. (9) rather than Eq. (7). 
                              
                                 (9)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   p
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   p
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   ,
                                                   p
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   +
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   +
                                                   1
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   +
                                                   1
                                                   ,
                                                   p
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   +
                                                   2
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   +
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   m
                                                   +
                                                   2
                                                   ,
                                                   p
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   p
                                                   ,
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   p
                                                   ,
                                                   2
                                                   )
                                                
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   p
                                                   ,
                                                   p
                                                   )
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      1
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      2
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      m
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      m
                                                      +
                                                      1
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      m
                                                      +
                                                      2
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      p
                                                      ,
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                1
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                            where the GRBF function values of points 1, 2,…, 
                              m
                            inside 
                              
                                 
                                    
                                       region
                                    
                                 
                                 
                                    j
                                 
                              
                            are “1”, and the GRBF function values of points 
                              m
                              +
                              1
                              ,
                              m
                              +
                              2
                              ,
                              …
                              ,
                              p
                            outside 
                              
                                 
                                    
                                       region
                                    
                                 
                                 
                                    j
                                 
                              
                            are “0” according to Eq. (5).

However, we found some problems with Eq. (9) in our numerical experiments. First, as compared with Eq. (7), it required much more computing time when many “0” points were added. By using Eq. (7), only the “1” points need to be handled; thus, the computing time was minimized and good results were obtained. Second, the interpolation function was prone to generate multiple peaks because of the rigorous constraints used in Eq. (9), which resulted in structural deformations. This problem was improved by using Eq. (7). However, the constraints from 
                              
                                 (
                                 m
                                 +
                                 1
                                 )
                              
                           th to 
                              p
                           th in Eq. (9) also exist in Eq. (7). Based on the properties of the GRBF, the value of 
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                            will naturally decrease to zero in the region 
                              X
                              ∉
                              
                                 
                                    
                                       region
                                    
                                 
                                 
                                    j
                                 
                              
                           .

With the GRBF method, the transition area near a boundary was adjusted by the parameters 
                              m
                            and 
                              δ
                           . Using a 2D example for visualization purposes, the transition area (near the boundary 
                              x
                              =
                              4
                           ) narrowed when 
                              δ
                            decreased (Fig. 11
                           ); at the same time, 
                              m
                            needed to be increased in order to avoid multiple peaks in the function 
                              α
                              
                                 (
                                 X
                                 )
                              
                           . The left side of Fig. 11 shows 
                              α
                              
                                 (
                                 X
                                 )
                              
                            plots and the right side shows the 2D hybrid structures. It is important to note that the hybrid structure was defined by: 
                              
                                 
                                    α
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    
                                       IV
                                    
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       IV
                                    
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              ≤
                              0
                           ; that is, 
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          
                                             IV
                                          
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                 
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       I
                                    
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              +
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          
                                             IV
                                          
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          
                                             I
                                          
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          
                                             IV
                                          
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                 
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       IV
                                    
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              ≤
                              0
                           . Thus, in the transition area, there was a gradual transition between the two TPMS-based structures. In essence, this was the same as when using the SF method (see Fig. 12
                           ).

As shown in Fig. 12, area I and area IV were conjoint, although there was a gap between the two interpolation function surfaces above these two areas, which would not cause any problems. This gap existed between those locations where the two functions began to decrease. Within the transition area, there was a medial bridge structure that connected structures I and IV. That is, structure I began to change to structure IV at that location with a small distance away from the transition boundary, and vice versa.

As shown in Fig. 13
                           (a), we drew a 2D “C” shaped area in pixel format. The central point of each pixel (voxel) could be regarded as a point of 
                              
                                 
                                    X
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           , as noted in Section  2.3. We could easily construct a GRBF surface (Fig. 13(b)) and obtain the resulting structure (Fig. 13(c)). With regard to medical applications, the shape of a native tissue could be obtained from 3D CT data and represented in voxel format (Fig. 13(d)). The GRBF could handle this case directly.

@&#LIMITATIONS@&#

A limitation of our method is that the values of 
                              m
                            and 
                              δ
                            used in Eq. (6) are subjective for a designer. If 
                              m
                            and 
                              δ
                            do not match, the GRBF surface will have multiple peaks. Thus, the relationship between 
                              m
                            and 
                              δ
                            for generating better structures will require further research for improvements.

Using transfinite interpolation  [33] (see the Introduction section), some problems may arise when we define different data for set 
                           A
                         and its complementary set 
                           
                              
                                 A
                              
                              ¯
                           
                         (note that 
                           A
                         and 
                           
                              
                                 A
                              
                              ¯
                           
                         are conjoint).

For example, in a one-dimensional space, we prescribed 1 in region 
                           x
                           ≥
                           2
                         and −1 in region 
                           x
                           <
                           2
                        , based on  [33], the interpolating function was:
                           
                              (10)
                              
                                 
                                    α
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    1
                                    ⋅
                                    
                                       
                                          W
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       (
                                       −
                                       1
                                       )
                                    
                                    ⋅
                                    
                                       
                                          W
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                2
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    x
                                    −
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    −
                                    
                                       (
                                       x
                                       −
                                       2
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

If 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                         are equal even numbers, then we have 
                           α
                           
                              (
                              x
                              )
                           
                           ≡
                           0
                        . If 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                         are equal odd numbers, then the denominators of 
                           
                              
                                 W
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 W
                              
                              
                                 2
                              
                           
                         will be zero. And if 
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                           =
                           1
                         and 
                           
                              
                                 μ
                              
                              
                                 2
                              
                           
                           =
                           2
                        , then we have 
                           α
                           
                              (
                              x
                              )
                           
                           =
                           
                              
                                 x
                                 −
                                 3
                              
                              
                                 x
                                 −
                                 1
                              
                           
                        , which has an abrupt change near 
                           x
                           =
                           1
                         as shown in Fig. 14
                        (a). These problems could be related to the form of the weight function 
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                        .

In fact, our proposed SF method can be regarded as an improvement on transfinite interpolation. This implies that the weight function 
                           
                              
                                 W
                              
                              
                                 i
                              
                           
                         in Eq. (10) could be rewritten in a new form
                           
                              (11)
                              
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             1
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             1
                                             +
                                             
                                                
                                                   e
                                                
                                                
                                                   −
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           ≥
                           0
                        . These problems disappear immediately when using Eq. (11), and we can freely choose the positive real values for 
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           >
                           0
                         and 
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           >
                           0
                        . The result with the same question is shown in Fig. 14(b).

On the other hand, when using the GRBF, we only define the data for set 
                           A
                        , and the function value will naturally decrease to zero in set 
                           
                              
                                 A
                              
                              ¯
                           
                        , which would not cause similar problems.

@&#FUTURE WORK@&#

Our next task will be to investigate the mechanical properties and mass transport properties near a transition boundary to determine if this hybridization results in new defects in a scaffold. For bio-mimetic designs, a random porous structure to simulate a bone’s microstructure could be achieved by changing some pore generating mechanism. Thus, detailed investigations of optimal pore shapes, sizes, and porosity distributions based on mechanical and biological requirements are also needed.

In addition, constructing a solid model with prescribed cross-sectional shapes is also a challenge, which could extend the results of Pan  [34] and Chen  [35]. Their studies involved constructing minimal area surfaces with prescribed boundaries.

@&#CONCLUSIONS@&#

In this paper, we proposed two methods to prepare heterogeneous porous tissue scaffolds for bio-mimetic design purposes. Our SF method can be used in those cases with simple transition boundaries, while our GRBF method can be used in more general cases. The resulting models were defined coincidentally within the function framework and had 
                        
                           
                              C
                           
                           
                              ∞
                           
                        
                      continuities. This allows for constructing a new structure comprising multiple substructures. With these resulting models, we can directly fabricate novel hybrid structures with high quality using AMT.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the China Post-doctoral Foundation No. 2012M520572, Tianjin Municipal Education Commission Grant No. 20120401, and Tianjin Municipal Science and Technology Commission Key Grant No. 14JCZDJC39500.


                     
                        
                           
                              
                              
                                 
                                    
                                       Algorithm 1 Construction of 
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                        in  
                                          
                                             
                                                
                                                   region
                                                
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                      (
                                                      x
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             ≤
                                             1
                                             )
                                          
                                          ∩
                                          
                                             (
                                             y
                                             ≥
                                             0.5
                                             sin
                                             
                                                (
                                                4
                                                x
                                                )
                                             
                                             )
                                          
                                          ∩
                                          
                                             (
                                             y
                                             ≥
                                             0
                                             )
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       Initialization:
                                 
                                 
                                    
                                       
                                          m
                                          =
                                          1
                                       ;
                                 
                                 
                                    
                                       Procedure:
                                 
                                 
                                    for (
                                          p
                                          =
                                          0
                                       ; 
                                          p
                                          ≤
                                          60
                                       ; 
                                          p
                                          =
                                          p
                                          +
                                          1
                                       )
                                 
                                 
                                    {
                                          for
                                          
                                             (
                                             i
                                             =
                                             0
                                             ;
                                             i
                                             ≤
                                             60
                                             ;
                                             i
                                             =
                                             i
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                        {
                                          x
                                          =
                                          i
                                          ∗
                                          2
                                          /
                                          60
                                       ;
                                 
                                 
                                    
                                       
                                       
                                          y
                                          =
                                          p
                                          ∗
                                          2
                                          /
                                          60
                                       ;
                                 
                                 
                                    
                                        if 
                                          
                                             (
                                             
                                                
                                                   
                                                      (
                                                      x
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             ≤
                                             1
                                             )
                                          
                                          ∩
                                          
                                             (
                                             y
                                             ≥
                                             0.5
                                             sin
                                             
                                                (
                                                4
                                                x
                                                )
                                             
                                             )
                                          
                                          ∩
                                          
                                             (
                                             y
                                             ≥
                                             0
                                             )
                                          
                                        then
                                 
                                 
                                    
                                        {
                                          
                                             
                                                X
                                             
                                             
                                                m
                                                ,
                                                j
                                             
                                          
                                          =
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       ;
                                 
                                 
                                    
                                       
                                       
                                          m
                                          =
                                          m
                                          +
                                          1
                                       ;
                                 
                                 
                                    
                                        }
                                 
                                 
                                    
                                        }
                                 
                                 
                                    }
                                 
                                 
                                    
                                       
                                          m
                                          =
                                          m
                                          −
                                          1
                                       ;
                                 
                                 
                                    
                                       Return   
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        
                           
                              
                              
                                 
                                    
                                       Algorithm 2 Construction of a four-TPMS structure in a linear manner
                                 
                              
                              
                                 
                                    
                                       Initialization:
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   cos
                                                   
                                                      (
                                                      3
                                                      x
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      3
                                                      y
                                                      )
                                                   
                                                   +
                                                   cos
                                                   
                                                      (
                                                      3
                                                      y
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      3
                                                      z
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   +
                                                   cos
                                                   
                                                      (
                                                      3
                                                      z
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      3
                                                      x
                                                      )
                                                   
                                                   +
                                                   0.5
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            II
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   sin
                                                   
                                                      (
                                                      3.3
                                                      x
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      3.3
                                                      y
                                                      )
                                                   
                                                   +
                                                   sin
                                                   
                                                      (
                                                      3.3
                                                      y
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      3.3
                                                      z
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   +
                                                   sin
                                                   
                                                      (
                                                      3.3
                                                      z
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      3.3
                                                      x
                                                      )
                                                   
                                                   −
                                                   0.1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   III
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                          =
                                          cos
                                          
                                             (
                                             4
                                             x
                                             )
                                          
                                          +
                                          cos
                                          
                                             (
                                             4
                                             y
                                             )
                                          
                                          +
                                          cos
                                          
                                             (
                                             4
                                             z
                                             )
                                          
                                          −
                                          0.2
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            IV
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   cos
                                                   
                                                      (
                                                      2
                                                      x
                                                      )
                                                   
                                                   cos
                                                   
                                                      (
                                                      2
                                                      y
                                                      )
                                                   
                                                   cos
                                                   
                                                      (
                                                      2
                                                      z
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   −
                                                   sin
                                                   
                                                      (
                                                      2
                                                      x
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      2
                                                      y
                                                      )
                                                   
                                                   sin
                                                   
                                                      (
                                                      2
                                                      z
                                                      )
                                                   
                                                   +
                                                   0.3
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   hyb
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                          ⇐
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   III
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       Procedure:
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            hyb
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   ⇐
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  −
                                                                  3
                                                                  
                                                                     (
                                                                     x
                                                                     +
                                                                     4
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            hyb
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         +
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               −
                                                               3
                                                               
                                                                  (
                                                                  x
                                                                  +
                                                                  4
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            hyb
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   ⇐
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  −
                                                                  3
                                                                  
                                                                     (
                                                                     x
                                                                     +
                                                                     0
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            hyb
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         +
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               −
                                                               3
                                                               
                                                                  (
                                                                  x
                                                                  +
                                                                  0
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            II
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            hyb
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   ⇐
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  −
                                                                  3
                                                                  
                                                                     (
                                                                     x
                                                                     −
                                                                     4
                                                                     )
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            hyb
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         +
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               −
                                                               3
                                                               
                                                                  (
                                                                  x
                                                                  −
                                                                  4
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         
                                                            IV
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       Return   
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   hyb
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                          ≤
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        
                           
                              
                              
                                 
                                    
                                       Algorithm 3 Combination of two porous architectures (III and IV) based on a CT image
                                 
                              
                              
                                 
                                    
                                       Initialization:
                                 
                                 
                                    Generate points 
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                             )
                                          
                                        in the grey region of Fig. 8(a).
                                 
                                 
                                    Define 
                                          α
                                          
                                             (
                                             X
                                             )
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          exp
                                          
                                             (
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            X
                                                            −
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                        and let 
                                          
                                             
                                                δ
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          0.2
                                       .
                                 
                                 
                                    
                                       Procedure:
                                 
                                 
                                    Calculate 
                                          
                                             
                                                β
                                             
                                             
                                                i
                                             
                                          
                                          
                                          
                                             (
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             m
                                             )
                                          
                                        from the following linear equations set to get 
                                          α
                                          
                                             (
                                             X
                                             )
                                          
                                       .
                                 
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      Ω
                                                      
                                                         (
                                                         1
                                                         ,
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      Ω
                                                      
                                                         (
                                                         1
                                                         ,
                                                         2
                                                         )
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      Ω
                                                      
                                                         (
                                                         1
                                                         ,
                                                         m
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      Ω
                                                      
                                                         (
                                                         2
                                                         ,
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      Ω
                                                      
                                                         (
                                                         2
                                                         ,
                                                         2
                                                         )
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      Ω
                                                      
                                                         (
                                                         2
                                                         ,
                                                         m
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      ⋮
                                                   
                                                   
                                                      ⋮
                                                   
                                                   
                                                      ⋮
                                                   
                                                   
                                                      ⋮
                                                   
                                                
                                                
                                                   
                                                      Ω
                                                      
                                                         (
                                                         m
                                                         ,
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      Ω
                                                      
                                                         (
                                                         m
                                                         ,
                                                         2
                                                         )
                                                      
                                                   
                                                   
                                                      ⋯
                                                   
                                                   
                                                      Ω
                                                      
                                                         (
                                                         m
                                                         ,
                                                         m
                                                         )
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ⋮
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      ⋮
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    where 
                                          Ω
                                          
                                             (
                                             i
                                             ,
                                             k
                                             )
                                          
                                          =
                                          exp
                                          
                                             (
                                             −
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             /
                                             
                                                
                                                   δ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       .
                                 
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   hyb
                                                
                                             
                                          
                                          
                                             (
                                             X
                                             )
                                          
                                          ⇐
                                          
                                             (
                                             1
                                             −
                                             α
                                             
                                                (
                                                X
                                                )
                                             
                                             )
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   III
                                                
                                             
                                          
                                          
                                             (
                                             X
                                             )
                                          
                                          +
                                          α
                                          
                                             (
                                             X
                                             )
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   IV
                                                
                                             
                                          
                                          
                                             (
                                             X
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       Return   
                                          
                                             
                                                ϕ
                                             
                                             
                                                
                                                   hyb
                                                
                                             
                                          
                                          
                                             (
                                             X
                                             )
                                          
                                          ≤
                                          0
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

