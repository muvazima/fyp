@&#MAIN-TITLE@&#A new method of detecting micro-calcification clusters in mammograms using contourlet transform and non-linking simplified PCNN

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new MCs detection method using contourlet transform and non-linking simplified PCNN in mammograms.


                        
                        
                           
                           We first introduce the non-linking simplified PCNN to detect MCs.


                        
                        
                           
                           We first come up with the evaluate indicators (MCC_PS, CEI) which take the samples proportion into account.


                        
                        
                           
                           The results tested on two open and common databases including the MIAS and the database from JSMIT.


                        
                        
                           
                           This method is verified on the mammograms from the People's Hospital of Gansu Province to show our method can be used in clinical application.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Mammography

Micro-calcification clusters (MCs) detection

Contourlet transform

Simplified pulse-coupled neural network (SPCNN)

@&#ABSTRACT@&#


               
               
                  Background and objectives
                  Mammography analysis is an effective technology for early detection of breast cancer. Micro-calcification clusters (MCs) are a vital indicator of breast cancer, so detection of MCs plays an important role in computer aided detection (CAD) system, this paper proposes a new hybrid method to improve MCs detection rate in mammograms.
               
               
                  Methods
                  The proposed method comprises three main steps: firstly, remove label and pectoral muscle adopting the largest connected region marking and region growing method, and enhance MCs using the combination of double top-hat transform and grayscale-adjustment function; secondly, remove noise and other interference information, and retain the significant information by modifying the contourlet coefficients using nonlinear function; thirdly, we use the non-linking simplified pulse-coupled neural network to detect MCs.
               
               
                  Results
                  In our work, we choose 118 mammograms including 38 mammograms with micro-calcification clusters and 80 mammograms without micro-calcification to demonstrate our algorithm separately from two open and common database including the MIAS and JSMIT; and we achieve the higher specificity of 94.7%, sensitivity of 96.3%, AUC of 97.0%, accuracy of 95.8%, MCC of 90.4%, MCC-PS of 61.3% and CEI of 53.5%, these promising results clearly demonstrate that the proposed approach outperforms the current state-of-the-art algorithms. In addition, this method is verified on the 20 mammograms from the People's Hospital of Gansu Province, the detection results reveal that our method can accurately detect the calcifications in clinical application.
               
               
                  Conclusions
                  This proposed method is simple and fast, furthermore it can achieve high detection rate, it could be considered used in CAD systems to assist the physicians for breast cancer diagnosis in the future.
               
            

@&#INTRODUCTION@&#

Breast cancer is a public health problem, which has both high incidence and mortality, especially among women. According to the International Agency for Research on Cancer (IARC) 2012, there were estimated nearly 1.7million people diagnosed with breast cancer on a global scale, which was close to 11.9% of all cancers, and about 0.52million women died of the disease in the same year. The data from IARC 2012 also reveal that new cancer cases will increase to nearly 19.3million by 2025, and it is worth noting that breast cancer is the fastest growing of all diseases [1].

In order to improve the diagnosis and prognosis of breast cancer, early detection is becoming more and more important [2]. The ways of breast cancer detection and diagnosis can be concluded into breast self-examination (BSE), clinical breast exam (CBE), imaging or mammography and surgery. Among these methods, X-ray mammography as the most efficient and reliable early detection technique is widely used by radiologists; it can detect 85–90% of all breast cancers. Micro-calcification clusters (MCs) are a major sign of breast cancer in mammography [3], the size, shape, texture and distribution of the micro-calcifications provide significant information for diagnosis, hence the accurate detection of MCs is a critical step in computer aided detection (CAD) system.

Recent years, there have a great deal of researches engaged in development of computerized methods for automatic detection of MCs, which potentially give assistance to radiologists in diagnosis of breast cancer. Although making research on MCs detection in CAD system has sustained for decades, the research of calcification detection still possess meaningful and challenging topic because of the inhomogeneous background and the high noise level in mammography. Various approaches have been suggested to detect MCs accurately.

According to these studies, these methods can be roughly divided into classic methods and emerging methods. These classic methods can be decomposed into three steps; firstly, reduce the noise and enhance MCs; secondly, detect the MCs applying a specific segmentation technique; thirdly, select true MCs by diverse novel methods. A variety of techniques have been used in different steps. For mammogram enhancement, variety attempts have been done, such as improved histogram equalization [4], image enhancement based on wavelet fusion [5], automated lesion intensity enhance [6], modified multifractal analysis [7], etc.; in the segmentation step, many techniques have been suggested, such as multistable cellular neural networks, geodesic active contours (GAC) technique associated with anisotropic texture filtering [8], case-adaptive decision rule method [9], new scale-specific blob detection technique [10], etc.; in the third step, select true MCs by extracting a group of features of micro-calcifications like moment-based geometrical features [11], wavelet feature and Gabor feature [12] and so on. These aforementioned techniques make great contributions, however because the MCs detection faces different difficulties, the hybrid detection algorithms combining different theories seems more popular.

For years, Oliver et al. [13] presented a knowledge-based approach to detect MCs automatically, which was based on local features extracted by a bank of filters to gain a local descriptor of the micro-calcifications morphology, the approach was demonstrated on the full digitized MIAS database and full-field digital mammograms extracted from a non-public database, and resulted in better than 80% sensitivity at 1 false positive cluster per image. Pal et al. [14] proposed to use multi-layered perceptron network to segment the MCs. In their approach, the position of the MCs was taken into account, so the system could locate the calcified regions quite accurately. They used 7 abnormal and 1 normal mammogram images from MIAS digital mammogram database to design the system. Lifeng [15] introduced a novel multi-scale and multi-position classification (MSPC) method for detecting mammographic MCs, and their experiments tested on the digital database for screening mammography (DDSM) data showed that the detection rate of clustered pleomorphic calcification (CPMC) could reach up to 97.26% with a 36.84% false positive rate. Yu and Huang [16] investigated the performance of MCs by adopting combined model-based and statistical textural features, 20 mammograms containing 25 areas of MCs from the MIAS database were used to test the performance, and a true positive rate of about 94% was achieved at the rate of 1.0 false positive per image, or the false positives per image could be reduced to 0.65 false positive per image at the rate of true positive about 90%. Malar et al. [17] exhibited the effectiveness of wavelet based tissue texture analysis for detecting MCs in mammograms using extreme learning machine (ELM), the sample image were collected from the MIAS database, and achieved relatively better classification accuracy (94%). AbuBaker [18] proposed a novel algorithm to detect and classify the MCs accurately and automatically by employing multi-statistical filters and wavelet transform, the proposed method was found sensitive in detecting MCs in mammogram images by achieving a high true positive percentage of 98.1% and a low false positive rate 0.63 cluster per image for both MIAS and USF database. Zhang and Gao [19] presented an innovative framework for detection of MCs in mammograms employing the twin support vector machine (TWSVM), the proposed scheme is evaluated on the DDSM database. Chen et al. [20] presented a multi-scale topological approach to MCs classification by building a multi-scale graph of the inter-micro-calcification relationships, then various graph metrics were extracted from this graph and were fed into a k-nearest neighbor classifier to produce the final classification results, and evaluated this method on MIAS database. Although these approaches achieved competitive detection results, there was still room for improving MCs detection rate.

In our work, a new MCs detection method is proposed, in the first step, remove label and pectoral muscle adopting the largest connected region marking and region growing method; then enhance MCs using the double top-hat transform and grayscale-adjustment function; in the second step, obtain the suspicious calcification clusters by reconstructing the modified sub bands only with high frequencies contourlet transform coefficients; finally, use the non-linking SPCNN to detect calcification clusters. The results show our method is efficient and accurate. The remainder of paper is structured as follows: Section 2 briefly describes the database used in this work. In Section 3, we extend our approach to the detection of MCs. The assessment indicators are defined in Section 4. We illustrate the algorithm in three aspects, including the subjective evaluation, objective evaluation and method validation in Section 5. At last, the conclusion is presented in Section 6. Our detection algorithm is depicted in Fig. 1
                     
                  

The mammograms tested in this paper are collected from the Mammographic Image Analysis Society (MIAS) database [21] and the Japanese Society of Medical Imaging Technology (JSMIT) [22] respectively. These two databases have been widely used in breast cancer diagnosis in mammograms. The MIAS database contains 322 mammograms of right and left breast from 161 patients, in which 51 are diagnosed as malignant, 64 benign and 207 normal. The abnormalities are classified into micro-calcifications, circumscribed mass, ill-defined mass, speculated mass, architecture distortion and asymmetry. The resolution of the images was 200μm pixels and the size of the images was 1024×1024, it offers corresponding information of lesion area such as type, location, severity and character of background tissue, the character of background tissue includes fatty (F), fatty-glandular (G) and dense-glandular (D). The coordinates of the center of some abnormality are given. Images with only micro-calcifications are total 23 cases and just 20 cases has the central coordinate and radius drew by experts, we provide addition information about the size and position of that 3 cases. Mammograms from JSMIT are collected from several medical institutions, and they are digitized with a pixel size of 100μm×100μm and 10-bit gray-level resolution, the size of each image is 2510×2000 pixels. There are 11 mammograms with micro-calcifications containing 15 cases; for the abnormal case, the expert just draws out the rough location. Fig. 2
                      shows the mammograms both from the MIAS database and the JSMIT database respectively.

@&#PROPOSED METHOD@&#

In this section, we choose the mammogram ‘mdb209’ from MIAS database to take an example, so as to give an all-round description of the proposed method.

The mammogram includes breast region, pectoral muscle, background and label. In order to reduce the interference and improve the detection accuracy, we use the maximum connected region marking and region growing method [23] to remove label and pectoral muscle. The result is shown in Fig. 3.1
                           .

The aim of enhancement is to improve the subjective image quality, and make the enhanced image is more suitable for a specific application. Here we propose a hybrid method which combines double top-hat transform with a “ball-shaped” non-flat structuring element [24], and grayscale-adjustment function to enhance MCs.

A top-hat is a residual filter which preserves those features in an image that can fit inside the structuring element (SE) and removes those that cannot. The double top-hat transform with a “ball-shaped” non-flat structuring element only enhance the MCs and retain the original features of mammogram simultaneously. The implementation [25] is shown as follows:
                              
                                 (1)
                                 
                                    
                                       
                                          r
                                          
                                             TH
                                          
                                       
                                       =
                                       
                                          I
                                          O
                                       
                                       −
                                       
                                          r
                                          B
                                       
                                    
                                 
                              
                           where r
                           TH is used to define the difference between the original image I
                           
                              O
                            and r
                           
                              B
                           . r
                           
                              B
                            is grayscale opening with the structuring element SE.
                              
                                 (2)
                                 
                                    
                                       
                                          Φ
                                          
                                             TH
                                          
                                       
                                       =
                                       Φ
                                       
                                          −
                                          
                                          
                                          
                                          B
                                          
                                       
                                       
                                          I
                                          O
                                       
                                    
                                 
                              
                           where Φ
                           TH is defined as the difference between the grayscale closing Φ
                           
                              B
                            using the structuring element SE, and the original image I
                           
                              O
                           .
                              
                                 (3)
                                 
                                    
                                       r
                                       =
                                       
                                          I
                                          O
                                       
                                       +
                                       
                                          r
                                          
                                             TH
                                          
                                       
                                       −
                                       
                                          Φ
                                          
                                             TH
                                          
                                       
                                    
                                 
                              
                           where r is the enhanced image, the top-hat by opening and closing has the effect of accentuating high-intensity (light) structures and low-intensity (dark) structures.

In our work, we choose the 3D structuring elements, non-flat SE, which is used to explore the intensity “shape” of features in the image. For example, the non-flat “ball-shaped” structuring element with R
                           =8, H
                           =50 is shown in Fig. 3.2(a). The enhancement results are displayed in Fig. 3.3(b), and we evaluate the enhancement results using enhancement measure (EME) [26], entropy parameters, and PSNR (peak signal to noise ratio) [4]. These parameters are computed for all 23 images and we just show two of them in Table 1
                           . The EME and entropy values of original image are given, the improvement in the EME and entropy notifies that our enhancement method have better performance. PSNR is a measure of the deviation of the enhanced image from the original image with respect to the peak value of the gray level. Higher PSNR value denotes more light intensity free from image. As Table 1 shows, our method holds greater improvement in EME and entropy values compared to the original image and possess higher PSNR value.

For MCs image, we apply double top-hat transform by the non-flat “ball-shaped” structuring element with R
                           =8, H
                           =50, and then use the gray scale-adjustment function to improve the visual perception, the grayscale-adjustment function used in this work is the gamma function, as are shown as follows:
                              
                                 (4)
                                 
                                    
                                       
                                          y
                                          1
                                       
                                       =
                                       r
                                       −
                                       min
                                       (
                                       r
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          y
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                y
                                                1
                                             
                                          
                                          
                                             max
                                             (
                                             
                                                y
                                                1
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          y
                                          3
                                       
                                       =
                                       
                                          
                                             
                                                y
                                                2
                                             
                                          
                                          
                                             (
                                             1
                                             /
                                             gamma
                                             )
                                          
                                       
                                    
                                 
                              
                           Here, r is the image applied double top-hat transform, gamma is constant value, if 0<gamma<1, enhancing the contrast of bright regions, if gamma>1, enhancing the contrast of dark regions. We choose gamma=0.3 by experience. Fig. 3.2(b) displays the curve of the nonlinear enhancement. Fig. 3.3(c) illustrates the enhanced image, and we can see that the MCs are more obvious in the enhanced mammogram than that in original image. We choose contrast improvement index (CII) [5] to reflects image contrast, CII combines human visual perception and can reflect the enhancement effect of the overall image and details. Table 2
                            shows the CII value of the two image, if the contrast cannot be enhanced, the CII value is equal to 1, otherwise CII>1. Our method makes great improvement in contrast.

Contourlet transform (CT) is proposed by Do and Vetterli [27], which has better performance of representing edges and textures of images than wavelets for its anisotropy and directionality, and is well-suited for multi-scale image enhancement. It is constructed by Laplacian pyramid (LP) and directional filter banks (DFB), which firstly uses the LP to capture singular points in the horizontal and vertical directions, and then use DFB link singularity into linear structure. It can capture the intrinsic geometrical structure of original image. It is an excellent tool for the analysis of 2D digital images, and it has been used in mammogram images. In our work, we adopt simple nonlinear function to modify the contourlet coefficients to further enhance MCs, and remove noise and other interference information, retain the significant information and obtain suspicious calcification area, the effect is particularly obvious. The decomposition structure of contourlet transform is shown in Fig. 4.1
                           .

During the process of contourlet decomposition, we set the decomposition levels as [1–3]; “9–7” filter is selected to use in LP and “pkva” filter is used in the DFB. As known, micro-calcifications have a higher X-ray attenuation than the normal breast tissue, and they present as a cluster of small granular bright spots in the mammograms [28], so we suppress the low frequency sub bands, and manipulate each high frequencies coefficients with nonlinear function, then obtain the suspicious calcification clusters by reconstructing the modified sub bands only with high frequencies coefficients.

The nonlinear function equation [29] is as follows:
                              
                                 (7)
                                 
                                    
                                       
                                          y
                                          α
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         if
                                                          
                                                         x
                                                         <
                                                         α
                                                         σ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               −
                                                               α
                                                               σ
                                                            
                                                            
                                                               α
                                                               σ
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     α
                                                                     σ
                                                                  
                                                               
                                                            
                                                         
                                                         q
                                                         +
                                                         
                                                            
                                                               2
                                                               α
                                                               σ
                                                               −
                                                               x
                                                            
                                                            
                                                               α
                                                               σ
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                          
                                                         σ
                                                         ≤
                                                         x
                                                         <
                                                         2
                                                         α
                                                         σ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  x
                                                               
                                                            
                                                         
                                                         q
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                          
                                                         2
                                                         α
                                                         σ
                                                         ≤
                                                         x
                                                         <
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                                  x
                                                               
                                                            
                                                         
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                          
                                                         x
                                                         ≥
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Here, t determines the degree of non-linearity and introduces a dynamic range compression. α is normalization parameter. σ is the standard deviation for each band of the contourlet transform. The t is the value under which coefficients are amplified, this value depends on the pixel values obviously. Using anon-zero function to enhance the faintest edges and soften the strongest edges. α, q, s, t are all adjustable parameters. In our paper, we set α
                           =3, q
                           =5, s
                           =1, and let t
                           =
                           L
                           ×
                           M
                           
                              a
                           , with constant L
                           <1, where M
                           
                              a
                            is the maximum ontourlet coefficient of the relative band. We conduct a lot of experiments for parameter setting, and we obtain obvious suspicious MCs, and the result is shown in Fig. 3.3(d).

The non-linking simplified pulse-coupled neural network (SPCNN) is used to detect micro-calcification, then post-processing is utilized to remove the isolated points, finally we get the micro-calcification clusters.

Pulse coupled neural network (PCNN) is a single layer neural network, which is stemmed from the Eckhorn's neuron model [30]. The Eckhorn's neuron model was provoked by the observations of synchronous pulse bursts in the cat visual cortex. PCNN is different with the traditional neural networks, and has been proven to be highly effective in a diverse set of applications. It has done well in image segmentation because of its biological background, and it is usually applied to binary image segmentation.


                           Fig. 4.2
                            is the traditional PCNN model, where F
                           
                              ij
                           [n] is the feedback input of the neuron in (i, j), S
                           
                              ij
                            is the input stimulus such as the normalized gray level of image pixels in (i, j) position, and L
                           
                              ij
                            is the linking item, E
                           
                              ij
                           [n] is the dynamic threshold, Y
                           
                              ij
                           [n] stands for the pulse output of neuron and it gets either the binary value 0 or 1, U
                           
                              ij
                           [n] is the internal activity of neuron, They all satisfy the equations in Ref. [31].

Clearly, although PCNN model can effectively simulate the synchronous firing phenomenon, it is uneasy to use and spend too much time because of too many parameters. Therefore, some simplified models are proposed to solve the practical problems. Chen et al. [32] proposed the SPCNN model derived from SCM. The only difference between this SPCNN and the SCM [33] is the firing condition in SPCNN model, the traditional firing condition is U
                           
                              ij
                           [n]=
                           E
                           
                              ij
                           [n
                           −1]; in SCM model, the sigmoid function is adopted. SPCNN model is employed in our work, and according to the characteristic of MCs, we introduce the non-linking SPCNN model as follows [34]:
                              
                                 (8)
                                 
                                    
                                       
                                          F
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          S
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          U
                                          
                                             i
                                             j
                                          
                                       
                                       [
                                       n
                                       ]
                                       =
                                       
                                          e
                                          
                                             −
                                             
                                                α
                                                F
                                             
                                          
                                       
                                       
                                          U
                                          
                                             i
                                             j
                                          
                                       
                                       [
                                       n
                                       −
                                       1
                                       ]
                                       +
                                       
                                          S
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          Y
                                          
                                             i
                                             j
                                          
                                       
                                       [
                                       n
                                       ]
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         if
                                                          
                                                         
                                                            U
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         [
                                                         n
                                                         ]
                                                         >
                                                         
                                                            E
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         [
                                                         n
                                                         −
                                                         1
                                                         ]
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       
                                          E
                                          
                                             i
                                             j
                                          
                                       
                                       [
                                       n
                                       ]
                                       =
                                       
                                          e
                                          
                                             −
                                             
                                                α
                                                E
                                             
                                          
                                       
                                       
                                          E
                                          
                                             i
                                             j
                                          
                                       
                                       [
                                       n
                                       −
                                       1
                                       ]
                                       +
                                       
                                          V
                                          E
                                       
                                       
                                          Y
                                          
                                             i
                                             j
                                          
                                       
                                       [
                                       n
                                       −
                                       1
                                       ]
                                    
                                 
                              
                           For the non-linking PCNN model, while with appropriate parameters, the firing timing looks like the upper ladder as the gray value changing from 1 to 0. The pixels with similar gray value may be fired at the same time, which present the effect of the coupled SPCNN model. Although the non-linking SPCNN reveals the effect of the coupled SPCNN model, we should note that the coupling is decided by the mathematical properties of differential equations, and do not fully reflect the interaction between neurons, here we call the coupling characteristics of PCNN as coupling characteristics of mathematics. It can be seen that the non-linking PCNN has simple structure and lower computational complexity.

In the non-linking SPCNN model, only four parameters are preserved, namely, α
                           
                              F
                           , α
                           
                              E
                           , V
                           
                              E
                            and n, which greatly facilitates its application while maintains the key features of PCNN. Considering the features of the calcification clusters, the parameters are set as follows:
                              
                                 (12)
                                 
                                    
                                       
                                          α
                                          F
                                       
                                       =
                                       log
                                        
                                       
                                          
                                             
                                                1
                                                δ
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          α
                                          E
                                       
                                       =
                                       0.001
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          V
                                          E
                                       
                                       =
                                       m
                                       +
                                       
                                          k
                                          0
                                       
                                       δ
                                    
                                 
                              
                           
                           
                              
                                 (15)
                                 
                                    
                                       n
                                       =
                                       3
                                    
                                 
                              
                           where δ is the standard deviation of the image, m is the mean value, and k
                           0 is a constant. α
                           
                              E
                            is small value nearby zero, just because the micro-calcification clusters is weaker coupled in mammograms. The non-linking SPCNN model is shown in Fig. 4.3
                           , the detection of micro-calcifications by the non-linking SPCNN is presented in Fig. 5(b), from the picture, and we can find the micro-calcifications are all detected as we expected.

After the above processing, there still have many isolated points such as noise, bright points. In order to detect the true MCs and improve true-positive rate, we remove the isolated points according to the density maximum principle. The result is shown in Fig. 5(c), we find that the detected MCs almost are all inside the circle draw by expert.

In order to show the effectiveness of the proposed method, we test it on two common and open database. The first dataset is taken from the MIAS database, we choose 23 mammograms (7 Glandular, 10 Dense, 6 Fatty) containing micro-calcification clusters and 50 mammograms (15 Glandular, 20 Dense, 15 Fatty) without micro-calcification randomly, In order to preserve complete geometric information of the mammograms, we apply the whole image to the proposed method rather than the region of interest; The second dataset is extracted from the Japanese Society of Medical Imaging Technology, 11 mammograms contain 15 cases with micro-calcification clusters, and 30 cases without micro-calcification clusters are selected randomly. Because that MIAS database provides the central coordinate and radius definitively, and the second dataset just draw out the rough location, we make the following definitions to further explain the performance of the proposed method respectively.

For the first database, we draw a bounding circle to the detected MCs, and make the following definitions [35]:
                        
                           (1)
                           If more than 2/3 bounding circle of the micro-calcification clusters are overlapped with the criterion region of ground truth segmented by experts, we consider it as correct, that is true-positive (TP), otherwise is considered wrong, namely false negative (FN).

For mammograms that contain multiple calcification clusters area, if we detect at least one satisfy (1), we define it as TP.

For mammograms without micro-calcifications, if we cannot detect out any micro-calcifications, we consider it as true negative (TN), otherwise it is false positive (FP).

For the second database, the expert just draw out the rough location, so we adopt the visual perceptual evaluation [36], we choose 20 people randomly and stand in line to review the images independently, the reading time of each observer was limited to less than 20s for each reading. The observers independently evaluated one pair of images, which are shown on the monitor one at a time, the image shown on the left is detected calcification clusters which is shown in the enhanced image, the right image is the ground truth drawn by expert. In order to achieve detection accuracy, we make the following definitions:
                        
                           (1)
                           We provide the maximum score of 10 points, and let each observer grade the left image comparing to the right image, we record the 20 sets of data and get the average, if the average score is more than 8, we considered it to be correct, that is TP, otherwise is considered wrong, namely FN.

For mammograms without calcification, if we cannot detect out any calcification, we consider it is TN, otherwise it is FP.

In order to give a clearer explanation, we define TP, FN, FP and TN in following Table 3
                     .

According to the definitions above, for the sake of make further assessment, we statistics the entire overlapping ratio for 23 mammograms with micro-calcification clusters in MIAS database, and also we record the results of the visual perceptual evaluation of 15 mammograms with micro-calcification clusters in the second database. The results are listed in Tables 4 and 5
                     
                     . We can notice that a total of 22 mammograms’ overlap ratio is greater than 2/3 in MIAS, only one mammogram cannot detect precisely; in the second database, some mammograms may contain 2 cases with micro-calcification clusters, so the suffix presents the different case. Noticing that 14 mammograms can be detected precisely except the C112. Also the number of the TP, FN, TN and FP are saved, and then will be applied in the following assessment measures.

In our work, we guess that different sample proportions lead to different test results, so we choose three different sample proportions in MIAS database to make further analysis. The test result is displayed in Table 6
                     .

A number of experiments validates our guess, just as Table 6 shows, different sample proportion leads to different sensitivity, specificity and accuracy, so in the following quantitative evaluation, we will take the sample proportion into consideration.

In our work, objective evaluation criterion is measured by classification of sensitivity, specificity, accuracy, Matthew's correlation coefficient (MCC), proportion of sample (PS), MCC_PS, comprehensive evaluation indicator (CEI), receiver operating characteristic (ROC) and the area under the ROC curve (AUC). They are defined below.

Sensitivity is used to deal only with positive cases; it presents the proportion of the detected positive cases over the actual positive cases, the higher the sensitivity, the lower false negative rate.
                        
                           (16)
                           
                              
                                 Sensitivity
                                 =
                                 
                                    
                                       TP
                                    
                                    
                                       TP
                                       +
                                       FN
                                    
                                 
                                 (
                                 %
                                 )
                              
                           
                        
                     Specificity is used to deal only with negative cases; it reflects the proportion of the detected negative cases over the actual negative cases, the higher the specificity, the lower false positive rate.
                        
                           (17)
                           
                              
                                 Specificity
                                 =
                                 
                                    
                                       TN
                                    
                                    
                                       TN
                                       +
                                       FP
                                    
                                 
                                 (
                                 %
                                 )
                              
                           
                        
                     Accuracy can be used to deal with all cases; it indicates the precision of predict results. The higher accuracy, the better system is.
                        
                           (18)
                           
                              
                                 Accuracy
                                 =
                                 
                                    
                                       TP
                                       +
                                       TN
                                    
                                    
                                       TP
                                       +
                                       TN
                                       +
                                       FP
                                       +
                                       FN
                                    
                                 
                                 (
                                 %
                                 )
                              
                           
                        
                     Higher sensitivity and specificity can lead to higher accuracy. But in clinical practice, sensitivity and specificity, we cannot have both. If we increase the sensitivity of diagnosis, necessarily reduce its diagnostic specificity, so we need to make a compromise according to our demanding.

MCC [37] is an effective accuracy evaluation indicator about machine learning approaches. It can provide a better evaluation to the case that the negative samples numbers are obviously unbalanced compared to the positive samples number, the higher MCC, the greater machine learning capability is.
                        
                           (19)
                           
                              
                                 MCC
                                 =
                                 
                                    
                                       TP
                                       ×
                                       TN
                                       −
                                       FP
                                       ×
                                       FN
                                    
                                    
                                       
                                          
                                             (
                                             TP
                                             +
                                             FP
                                             )
                                             (
                                             TP
                                             +
                                             FN
                                             )
                                             (
                                             TN
                                             +
                                             FP
                                             )
                                             (
                                             TN
                                             +
                                             FN
                                             )
                                          
                                       
                                    
                                 
                                 (
                                 %
                                 )
                              
                           
                        
                     Different sample proportion leads to different result, so proportion of sample is a very important index, we define PS as follows:
                        
                           (20)
                           
                              
                                 PS
                                 =
                                 
                                    
                                       MCs
                                    
                                    
                                       Non-MCs
                                    
                                 
                                 =
                                 
                                    
                                       TP
                                       +
                                       FN
                                    
                                    
                                       TN
                                       +
                                       FP
                                    
                                 
                                 (
                                 %
                                 )
                              
                           
                        
                     Although MCC can evaluate the machine learning approaches, it cannot consider the influence of the sample proportion; here we come up with the MCC_PS evaluation indicator, which can give an overall evaluation of machine learning capability and the sample proportion.
                        
                           (21)
                           
                              
                                 MCC
                                 _
                                 PS
                                 =
                                 
                                    
                                       MCC
                                    
                                    
                                       1
                                       +
                                       PS
                                    
                                 
                                 (
                                 %
                                 )
                              
                           
                        
                     At last, we define a comprehensive evaluation indicator (CEI) by using sensitivity, specificity, accuracy, MCC and PS, we define CEI as follows:
                        
                           (22)
                           
                              
                                 CEI
                                 =
                                 
                                    
                                       Sensitivity
                                       ×
                                       Specificity
                                       ×
                                       Accuracy
                                       ×
                                       MCC
                                    
                                    
                                       1
                                       +
                                       PS
                                    
                                 
                                 (
                                 %
                                 )
                              
                           
                        
                     Below we will give an explanation about MCC_PS and CEI in detail:
                        
                           (1)
                           In clinical cases about mammograms, normal cases are in the majority, and sick case in the minority. So in all designed algorithm, we should choose appropriate sample proportion to meet this phenomenon.

That is to say, if the PS>1, we consider it is not a best sample proportion. It is not helpful to the method, If 0<PS<1, we think it is relatively better to the method, i.e., the greater 1/PS, the better system is. In order to present the relative of MCC_PS and PS, we choose MCC=0.8, we plot the curve in Fig. 6(a).

Also, we plot the curve of CEI and PS, where we choose sensitivity=0.909, specificity=0.522, accuracy=0.82, MCC=0.653, as is shown in Fig. 6(b).

In Fig. 6, we can find that MCC_PS increases as the PS decreasing; the CEI has the same trend with MCC_PS. The smaller sample proportion, the better algorithm.

As our knowledge, it is the first time to take the proportion of samples into account to evaluate the algorithm performance; we discover that the PS affects the algorithm seriously and reveals the inversely proportional relationship.

The receiver operating characteristic (ROC) curve is used to measure the predictive accuracy of the proposed model. It indicates the true positive rate and false positive rate. The AUC is a descriptor of test result. If the AUC is close to 1.0 indicates that the diagnostic test is reliable; on the contrary, AUC is close to 0.5 demonstrates the unreliable test result. But the disadvantage is that the different sample proportion may change the area under the ROC, so it is not the best evaluation indicator.

@&#RESULTS AND DISCUSSION@&#

Here, for the sake of the visual evaluation, we display four mammograms in the first database and two mammograms in the second database in Figs. 7.1 and 7.2
                        
                        . Fig. 7.1 is the ‘mdb209’, ‘mdb213’, ‘mdb252’ and ‘mdb249’. It can give a visual evaluation. The ‘mdb209’, ‘mdb213’ and ‘mdb252’ have one MCs areas, the ‘mdb249’ has two micro-calcification areas, and we can detect them precisely; Fig. 7.2 shows the detecting effect of the second database, the detected calcification clusters are approximately the same to the ground truth.

In our paper, we guess different type of the breast and the different database may have an impact on the algorithm, hence we choose three different types in MIAS and two different databases to test the effect; in the last, we compare our method to the current state-of-the art algorithms. Objective evaluation is done by using PS, sensitivity, specificity, AUC, accuracy, MCC, MCC_PS and CEI. In order to get a good visual effect, we list the measures indicators on the table and plot the bar of the evaluation indicators at the same time, and the following description will give a detailed analysis.

Quantitative measures are obtained in a separate way for three types of breast considered in the mini-MIAS database; mammograms without MCs used in this paper are randomly selected, the detected result is shown in Table 7
                         and Fig. 7.3(a).
                           
                              1)
                              Notice that fatty breast has the highest sensitivity, specificity, accuracy, AUC and MCC; the lower PS, the more scientific system is; from the bar in Fig. 7.3(a), we can observe fatty breast hold the lower PS value, which is helpful to the system, if we adopt MCC_PS and CEI to evaluate the method, they also hold the highest value, which reflect our method has the better performance to the fatty breast.

For dense breast, it has relatively high specificity (95.0%); the other evaluation indicators have the minimum value than the fatty and glandular breast expect PS value.

The glandular tissue has the same value of the sensitivity (100.0%) to fatty tissue; other values rank second.

Taking notice of the fact that the types of breast make a difference to the method, our method has better detection result to fatty tissue, the MCC_PS and CEI can give a comprehensive evaluation. Also we draw the ROC curve in Fig. 7.3(d). The glandular and dense breasts have high density fiber and dense tissue, which have an impact on algorithm to detect the calcification clusters. The good choice of the sample proportion is helpful to the fatty breasts.

Two different databases have utilized to test the accuracy and robustness of the algorithm, and the objective evaluation is obtained in Table 8
                         and Fig. 7.3(b). The sensitivity, accuracy and MCC value in MIAS is a bit larger than the second database except specificity. So just apply these evaluation measures cannot reflect the difference of different databases, so here we mainly apply the MCC_PS and CEI to evaluate the result. Noticing that the MCC_PS and CEI value in MIAS database are higher than the second database; the MCC_PS value is 2.1% higher in MIAS than the second database, and the CEI value is 2.9% higher, which reveals that the performance in MIAS is better than the second database. Fig. 7.3(e) shows the ROC curve to indicate the performance. The reason may be contain two sides: firstly, MIAS databases provide the central coordinate and radius definitively, so we can provide objective evaluation, but the second dataset just draw out the rough location, we can only use the visual perceptual evaluation to evaluate the performance, the evaluation brings a certain degree of subjectivity; secondly, the PS in MIAS is a bit smaller than the second database, this also influences the results.

To further fully confirm the effectiveness of our method, we compare our method to three referenced methods [6,38,39] based on MIAS database in recent years. In Ref. [6], Civcik et al. proposed a novel method of detection micro-calcification with multi-stable cellular neural networks using a new image enhancement method: automated lesion intensity enhancer (ALIE), the proposed method was applied on the MIAS database, and achieved 82.0% accuracy, 90.9% sensitivity, and 52.2% specificity values. But there are some weaknesses in their technique, the proposed method failed on low density mammogram images and micro-calcifications neighboring the pectoral muscle. In Ref. [38], Desai et al. presented an improved multi-scale morphological gradient watershed segmentation (Improved-MMGW) method for automatic detection of cluster micro-calcification, the true positive rate is observed to be 0.953 and 0.94 for MIAS and NMR datasets respectively, which better than O-MMGW by approximately 20%, but the method was sensitive to highlighted portion on the boundaries of mammography. In Ref. [39], Krishnaveni et al. introduced Naive Bayes classifier to detect micro-calcification at each location in the mammogram. When compared to several other methods, Naive Bayes classifier shows accuracy 96.25% micro-calcification detection in mammograms. In order to give quantitative analysis, quantitative evaluation is done in Table 9
                         and Fig. 7.3(c). It can be seen that when considering sensitivity, specificity, accuracy, AUC and MCC to evaluate the algorithm, our method performs relatively better than the other approaches; for ranking, the Ref. [39] ranks first; Ref. [38] has the better performance than the Ref. [6].

If we take the sample proportion into account, it can be observed that our method have the highest value of the MCC_PS and CEI, our method maintains high levels of sensitivity (95.7%), specificity (96.0%), AUC (97.2%), accuracy (95.9%) and MCC (90.7%), while maintaining the highest MCC-PS (62.1%) and CEI (54.7%). The CEI embraces sensitivity, specificity, accuracy, MCC and PS value to give the method a comprehensive evaluation, which is more believable. In Fig. 7.3(f), the ROC curve presents that the area under the ROC of our method is much better than the method in Refs. [38,6], which demonstrates that the test result is reliable. After the above analysis, we can make a conclusion that our method performances much better than the others.

In order to verify the effectiveness of our method in clinical application, we implement it on the mammograms with micro-calcifications from the People's Hospital of Gansu Province (2044×1142 pixels, 32-bit gray-level resolution). 20 mammograms are tested in this work, 3 mammograms are identified as abnormal, while 17 are identified as normal, which consent with the radiologist's diagnosis. The detected three abnormal mammograms are shown in Fig. 8
                        , we can see that our algorithm can detect calcifications accurately.

@&#CONCLUSION@&#

The proposed method use CT and the non-linking SPCNN to detect micro-calcification clusters. Original mammogram is preprocessed to remove label and pectoral muscle, then using the combination of double top-hat transforms and grayscale-adjustment function to enhance micro-calcifications; subsequently, CT is adopted to removal some noises, backgrounds etc., and retain the significant information by nonlinear function; at last, we use the non-linking SPCNN to detect calcification clusters. In our work, we choose 118 mammograms including 38 mammograms with micro-calcification clusters and 80 mammograms without micro-calcification to demonstrate our algorithm from two different database; we can achieve the specificity of 94.7%, sensitivity of 96.3%, AUC of 97.0%, accuracy of 95.8%, MCC of 90.4%, MCC-PS of 61.3% and CEI of 53.5%. These promising results clearly demonstrate that the proposed approaches can automatic detect the biomedical data. In order to further verify the method in clinical, we test this new method on the mammograms from the People's Hospital of Gansu Province.

In our work, we employ the CT to deal with image, which can capture the direction information of calcifications because of the anisotropic, multi-scale and multi-direction properties of the CT; we first introduce non-linking SPCNN to detect calcification clusters, it is simple and fast and obtain high detection rate; we first come up with the evaluate indicators (MCC_PS, CEI) that take the proportion of samples into account to evaluate the algorithm performance comprehensively, which is the highlights of this work. The proposed method could be considered to assist the radiologist in diagnosis of breast cancer.

These experiments are based on a limited sample database. In the future, we should pay attention to larger mammographic database, and we also would like to introduce this proposed method to other medical diagnosis.

@&#ACKNOWLEDGMENTS@&#

Authors would like to thank the retrieval of MIAS database and JSMIT for the experiments of this paper, and thank to the People's Hospital of Gansu Province. This work is jointly supported by the National Natural Science Foundation of China (nos. 61175012 and 61201421), Natural Science Foundation of Gansu Province (nos. 145RJZA181 and 1208RJZA265), Specialized Research Fund for the Doctoral Program of Higher Education of China (grant no. 20110211110026), and the Fundamental Research Funds for the Central Universities of China (nos. lzujbky-2013-k06 and lzujbky-2015-196).

@&#REFERENCES@&#

