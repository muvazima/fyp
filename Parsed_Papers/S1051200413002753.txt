@&#MAIN-TITLE@&#DNA sequence watermarking based on random circular angle

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           DNA watermarking is for copyright protection and authentication of a DNA sequence.


                        
                        
                           
                           We address the random circular-angle based watermarking for the coding DNA sequence.


                        
                        
                           
                           Our method satisfies amino acid preservation, mutation resistance, and security.


                        
                        
                           
                           Embeddable codons are selected by random mapping table and singularity detection.


                        
                        
                           
                           The watermark changes random circular angles of embeddable codons.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

DNA watermarking

Copyright protection

Codon random mapping table

Amino acid residue conservation

Mutation resistance

@&#ABSTRACT@&#


               
               
                  This paper discusses DNA watermarking for copyright protection and authentication of a DNA sequence. We then propose a DNA watermarking method that confers mutation resistance, amino acid residue conservation, and watermark security. Our method allocates codons to random circular angles using a random mapping table and selects a number of codons for embedding targets using the Lipschitz regularity that is measured from the evolution across scales of local modulus maxima of codon circular angles. We then embed the watermark into random circular angles of codons without changing the amino acid residue. The length and location of target codons depend on the random mapping table and the singularity of detection of Lipschitz regularity. This table is used as the watermark key and can be applied to any codon sequence regardless of sequence length. Without knowledge of this table, it is very difficult to detect the length and location of sequences for extracting the watermark. From experimental results on the suitability of similar watermark capacities, we verified that our method has a lower bit-rate error for point mutations compared with previous methods. Further, we established that the entropies of the random mapping table and the location of target codons are high, indicating that the watermark is secure.
               
            

@&#INTRODUCTION@&#

The genetic code contains profound personal information. It may be considered as a personal diary, and its unauthorized disclosure may be considered as a grave invasion of privacy and a violation of human rights. Legal measures have been established to ensure the safety and security of procedures for collecting human genetic information (HGI) [1–3]. There are laws of ethics or guidelines for HGI use, but security techniques for preventing illegal copying and piracy of HGI are urgently required. DNA is considered as a new biometric medium for storing extraordinarily large amounts of data. Thus, DNA storage demands that DNA security techniques are addressed. Recent research on DNA security includes DNA cryptography [4–7], steganography [8–16], and watermarking [17–25] using DNA sequences with a character stream of A, G, T (or U), and C. These studies [4–25] were validated by in vivo, in vitro, or in silico experiments.

DNA cryptography [4–7] is a technique for biological encryption and decryption based on the polymerase chain reaction (PCR) or DNA chips and has been recognized as a new biological encryption technique for potential widespread use in the future. However, it has not yet begun to replace the conventional encryption algorithms because of the difficulty in its implementation. DNA steganography [8–16] is the technique for hiding messages in DNA sequences and is useful for DNA signature/identification and DNA storage of vast quantities of information. However, the purposes of DNA cryptography and steganography are not to recover DNA sequences or messages under changing experimental conditions or from mutations, and they are therefore not suitable as applications for copyright protection.

DNA watermarking [17–25] is a technique for protecting the information within a DNA sequence. DNA-based watermarks can be applied to copyright-protect DNA sequences as well as for discriminating between wild-type and artificial genomes [25]. Recently, J. Craig Venterʼs research team inserted a watermark at intergenic sites known to tolerate transposon insertions to identify the genome of Mycoplasma genitalium JCVI-1.0 as synthetic [26,27]. Jupiter et al. [28,29] presented the strategy of watermark implementation for tracking select or infectious agents. They suggested five features for implementation strategy as follows: message fidelity, error tolerance, easy interpretation, uniqueness, and resistance. They compared and analyzed the features of DNA and multimedia watermarking. Multimedia watermarking schemes for audio, image, video, and 3D model are mostly processed in the frequency domain of the discrete cosine transform (DCT) [30,31], discrete wavelet transform (DWT) [32–34], and scale-invariant feature transform (SIFT) [35], as well as the geometric domain [36,37]. However, DNA-based watermark must be embedded without changing the function of coding regions, which represents the main difference between DNA and multimedia watermarking.

The genome contains all of an organismʼs hereditary information, and it includes coding sequences (genes), which are translated into polypeptide chains (proteins), representing, for example, approximately 1.5% of the human genome. Sequences that do not encode proteins may be transcribed into non-coding RNAs such as micro-RNAs, which may code for RNAs that regulate gene function. The genome also includes pseudogenes, which are mutated remnants of genes that are unable to encode a functional product. The majority of the human genome comprises non-coding repeated sequences. DNA steganography or watermarking methods have been designed differently depending on whether the information is embedded in non-coding [17–20] or coding DNA [21–24].

Non-coding DNA-based methods typically assume that non-coding DNA does not change the phenotype of an organism. Based on this assumption, any pirate could substitute an arbitrary sequence or dummy sequence for a non-coding DNA sequence while including embedded sequences without changing phenotype. However, many types of non-coding DNA sequences have known biological functions, including the transcriptional and translational regulation of protein-coding sequences. Non-transcribed DNA sequences may contribute to chromosomal properties or possess functions that are yet to be discovered. Therefore, it is not yet been appropriate to manipulate non-coding DNA for steganography and watermarking.

Coding DNA is translated to a polypeptide chain, so the watermark embedded in coding DNA sequences should preserve the protein profile of an organism. This is a prerequisite and a limitation of coding DNA-based methods. We refer to this limit here as amino acid residue (amino acid) conservation. Amino acid conservation is problematic when designing DNA watermarking, in contrast to image and video watermarking.

Most conventional DNA watermarking methods focus on the embedding process through simple substitutions or bit allocations to a base or codon as determined by the genetic code, and focus has been placed on watermarked gene in in vivo experiments. Therefore, it is necessary to analyze the resistance to phenotypic change, amino acid sequence conservation, as well as security for signal processing when designing a DNA watermarking method that satisfies the above requirements.

Here we present a coding DNA watermarking method for copyright protection of a DNA sequence that provides mutation resistance, watermark security, and amino acid sequence conservation. We analyze the performance of coding DNA watermarking using in silico experiments. The main features of our method are as follows: First, we map codons to numerical values of random circular angles using a random mapping table for security and ease of signal processing. The random mapping table for 64 codons, which includes start and stop codons, is used as the watermark key. Coding sequences of various lengths can be mapped to random circular angles using any random mapping table. Second, we select a number of target codons for embedding using the Lipschitz regularity of local modulus maxima at multi-resolution scales. The local modulus maxima of random circular angles depend on the random mapping table. The length and location of target codons depend on Lipschitz values of local modulus maxima. It is very difficult to detect locations of embedded codons without the knowledge of random mapping table. Third, we embed repeatedly a binary watermark into random circular angles of codons to confer mutation resistance. An angle of a center codon and the distance between two angles of neighboring codons are changed by a bit of a watermark without changing the encoded amino acid. Finally, random circular angles are based on circular coding, which makes the numerical transformation of DNA symbols easier and allows estimation of symbol errors in arbitrary positions. Moreover, it allows the allocation of synonymous codons to neighboring numerical values.

The performance of our in silico experiments verified that our method ensures amino acid sequence conservation and is more resist to point mutations compared with DNA-Crypt watermarking [21] and the Liss method [24]. We investigated the capacity based on the analysis by Balado et al. [38–40]. We computed the entropy of the random mapping table and random positions of codons for analyzing security and confirmed that the entropies were high.

This paper is organized as follows: In Section 2, we explain the structure of DNA sequences and the genetic code and analyze conventional watermarking methods. We present the proposed DNA watermarking method in Section 3 before analyzing its performance using in silico experiments in Section 4. Finally, are conclusions are presented in Section 5.

In this section, we examine the genetic code [41–43] and then analyze the requirements of DNA watermarking for copyright protection of a DNA sequence.

DNA is a long polymer that carries genetic information in simple units called nucleotides, the backbones of which are composed of carbohydrate and inorganic phosphate groups joined by phosphodiester bonds. The nucleotide bases are the purines A (adenine) and G (guanine), and the pyrimidines C (cytosine) and T (thymine). Uracil (U) occurs in RNA instead of thymine. Three nucleotides form a codon, the basic unit of the genetic code that specifies one amino acid. Fig. 1
                         shows that the genetic code represents a set of rules, which allows the information encoded in DNA to be transcribed into messenger RNAs (mRNAs) that are translated into polypeptide chains composed of amino acids. This code is called the triplet code. There are 
                           
                              
                                 4
                              
                              
                                 3
                              
                           
                           =
                           64
                         different codon combinations, because there are four distinct nucleotide bases. All 64 codons encode one of 20 amino acids or translational stop signals.


                        Table 1
                         shows the correspondence of codons to amino acids (Fig. 1). In this table, the cardinality of synonymous codons in each amino acid is from 1 to 6. ‘ATG’ encoding methionine (‘Met’) is the most frequently used start codon, whereas ‘TAA’, ‘TAG’, and ‘TGA’ for ‘Stp’ are stop codon marking the end of coding regions. Except for start and stop codons and the codon for the tryptophan (W), all codons in coding DNA sequences can be used for watermark embedding, and they can be substituted by a watermark while conserving the amino acid. However, all codons including the excepted codons are allocated to numerical values and circular angles because of computational tractability of numerical mapping.

DNA watermarking requires amino acid sequence conservation, mutation resistance, message fidelity, security, capacity, error tolerance, and easy interpretation as follows:
                           
                              •
                              Amino acid conservation: Amino acid sequences into which a host DNA sequence and a watermarked DNA sequence are translated must be the same. Although codons are changed by the watermark, amino acids into which they are translated are not. Amino acid conservation can be similar to invisibility with the high quality constraint of multimedia watermarking.

Mutation resistance: Watermarks must resist spontaneous or induced mutations. Thus, watermarks must be extracted from mutated or damaged DNA sequence to certify ownership.

Security: Watermarks must be very difficult to extract without the knowledge of the key even if a DNA sequence is known.

Message fidelity: Watermarks must not alter the phenotype of an organism. DNA sequences and watermarks do not mutually interfere in a manner similar to amino acid sequence conservation.

Capacity: Watermarks must contain enough information for copyrighting. The capacity for watermarking should be considered differently compared with the capacity for steganography.

Error tolerance: Errors in the detection of watermarks can occur through mutation by transfer delay and in PCR or organic synthetic reactions. Watermarks must be recovered within the tolerance of detection error and is similar to resistance.

Easy delivery/interpretation: A watermarked DNA sequence must be clear and definitive. Detection and delivery of a watermark within an organism must be easy.

Amino acid conservation and mutation resistance differ with the requirements of multimedia watermarking. Other requirements are similar between DNA and multimedia watermarking. However, they should be confirmed using different methods, because the embedding targets are different, for example, DNA codons and nucleotide bases versus image pixels and frequency coefficients.

Any pirate can use a mutation of the DNA or protein to attack the watermarked DNA sequence. The information in sequences can be changed by mutagens during DNA replication or transcription. Mutations are can be classified as small-scale or large-scale [44,45]. Small-scale mutations involve one or a few nucleotides, and they include point mutations, insertions, and deletions. Point mutations are often caused by a malfunction in DNA replication, and they replace a single nucleotide, which is classified as a transition or a transversion depending on whether the change involves pyrimidines or purines. Insertions and deletions add or remove one or more nucleotide. They can alter the reading frame of the gene, which can generate a protein with either a subtly or dramatically altered sequence [46], but they are rare. The latter may affect chromosomal structure and includes amplifications, deletions, and loss of heterozygosity. We consider only point mutations of small-scale mutations as suitable attacks on DNA watermarking. Mutations can be caused by spontaneous and induced processes. However, any pirate can maliciously produce intentional mutations. If all codons in protein-coding regions are intentionally changed by silent mutations, most watermarks in these regions will be removed. Nevertheless, DNA watermarks must be resistance to spontaneous, induced, and intentional mutations.

Watermarking can be classified as private and public, depending on the detection method. The first detects a watermark using the host sequence and the watermark, whereas the second detects the watermark without the host sequence and the watermark. Private watermarking has many problems in terms of security, so DNA watermarking must be public.

Research into DNA cryptography or steganography began in the late 1990s, and DNA watermarking has been researched since the late 2000s. Some papers present DNA steganography using watermarking; however, the two should be considered individually. DNA steganography communicates a secret message through a DNA sequence. Therefore, the security and capacity are the main requirements in DNA steganography. However, DNA watermarking is designed for copyright protection of a DNA sequence. Resistance to mutation is the main requirement for DNA watermarking.

Clelland et al. [8] presented the first DNA steganography method using DNA microdots, and they implemented the technique in vitro. This method hides a secret message in DNA microdots based on a simple permutation cipher. However, this method requires specific primers to recover the message. Leier et al. [9] mixed binary-encoded plain text with DNA dummy strands in DNA steganography. This method also requires knowledge of primer sequences. Anam et al. [7] reviewed DNA cryptography methods using PCR and DNA steganography methods using DNA sequencing or DNA chip technology. They found that the difficulties of DNA cryptography and steganography were caused by lack of a theoretical basis and practical methodologies that could be readily implemented in the field of information security. Shimanovsky et al. [11] combined codon redundancy with arithmetic encoding and public key cryptography when embedding watermarks into coding DNA sequences. They allocated four bases to 2-bit binaries and converted the binary sequence to a decimal number from 0 to 1, which was used as the target number in repeated subdivision steps of arithmetic encoding. However, this method fails to accurately extract the target number in each step if any codons are mutated. Arita et al. [12] embedded a short signature into the coding DNA sequence of Bacillus subtilis based on the degenerate genetic code and a permutation cipher function. However, this method requires the host sequence to recover the embedded message, which is non-blind.

Several methods exist for embedding watermarks into non-coding DNA sequences. Yachie et al. [17,18] redundantly embedded duplicated data encoded by nucleotide sequences into multiple loci of the B. subtilis genome. Heider et al. [19] applied the DNA-Crypt algorithm [20] to non-coding DNA sequences in in vivo experiments using the small cytoplasmic RNA I (scR1) from yeast Saccharomyces cerevisiae and the lac promoter region of Escherichia coli. However, their results show that the watermark can deactivate promoter regions and that it further affected the secondary structures of regulatory RNA molecules, although the watermarked RNA and one of the watermarked promoters were not different from the wild-type RNA and promoter regions, respectively. Therefore, they concluded that watermark embedding is not suitable for regulatory regions such as promoters or other regulatory regions.

To embed watermarks in coding sequences, Heider et al. [21] inserted encrypted information into S. cerevisiae using the DNA-Crypt algorithm [20]. This method only produces a protein profile, because they did not consider the redundancy of the genetic code. The DNA-Crypt algorithm allocates four bases 
                           {
                           A
                           ,
                           C
                           ,
                           G
                           ,
                           T
                           }
                         to 2 bits and embeds the last base of four synonymous codons into 2 bits of the watermark. This algorithm corrects mutations by any code in which the integrated fuzzy controller decides whether to use the 8/4 Hamming code, n-time WDH code, and no correction code for optimal performance. The binary information can be encrypted by integrating the encryption algorithms AES, Blowfish, RSA, or OTP in DNA-Crypt. However, because the target codons can be easily revealed even if the binary information is encrypted, any pirate can intentionally remove the watermark. Shuhong et al. [23] permuted a third base symbol for codons according to the watermark bit, which was similar to a least significant bit permutation based on Aritaʼs genetic code [12]. This method can only be applied to four synonymous codons. Liss et al. [24] embedded text messages into open reading frames of synthetic genes considering gene optimization. They designed ORFs of the watermarked genes using codon usage table of host genes that were already optimized for protein expression. For example, given a codon usage table for a particular amino acid, odd ranked codons in this table represent a binary 0 and even-ranked codons represent a binary 1. They encoded a text message into four or six synonymous codons that retain a high degree of codon assignment flexibility. However, this method does not consider the mutation resistance and security, although it retains gene optimization. Balado et al. [38–40] used Shannonʼs theory to model the maximum capacity of data with mutation resistance.

Conventional watermarking methods for coding DNA have some problems with amino acid conservation, their resistance to mutations, and watermark security. Although the purposes of steganography and watermarking are different distinctly, many DNA watermarking methods hide vast amounts of information without mutation resistance and security, similar to steganography.

This paper presents a watermarking method for DNA sequences with the features as follows: 1) Embed the binary watermark into coding DNA sequences. Non-coding DNA sequences are included in regulatory regions such as promoters or other regulatory motifs, so coding DNA sequence are suitable for use as the embedding target. 2) Ensure amino acid conservation and resist small-scale mutations such as point mutations. 3) Use a fixed-length watermark key regardless of the sequence length and ensure high-level security. 4) Directly extract the watermark without the host sequence.


                     Fig. 2
                     (a) shows the proposed embedding process, which consists of the numerical mapping of codons using a random mapping table, the selection of target codons using the Lipschitz regularity of local modulus maxima, the binary embedding in target codons, and the generation of the watermarked DNA sequence. A random mapping table is used as a key for extracting the watermark. The watermark is extracted using a similar process to embedding, as shown in Fig. 2(b).

The definitions of terms are as follows: Denote a character symbol as a lower-case Roman letter, a numerical value as a lower-case italic letter, and a set as an upper-case bold letter.
                           
                              –
                              A sequence of codons is 
                                    C
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          ⩽
                                          i
                                          ⩽
                                          N
                                       
                                    
                                  and a sequence of watermarked codons is 
                                    
                                       
                                          C
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          ⩽
                                          i
                                          ⩽
                                          N
                                       
                                    
                                 . N is the sequence length.

A nucleotide base is 
                                    b
                                    =
                                    {
                                    G
                                    ,
                                    A
                                    ,
                                    C
                                    ,
                                    T
                                    }
                                  and a codon of triplet bases is 
                                    c
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                    
                                 . Numerical values of a base and a codon are b and c.

The amino acid represented by a codon c is 
                                    S
                                    =
                                    f
                                    (
                                    c
                                    )
                                  and 
                                    f
                                    |
                                    C
                                    →
                                    S
                                  is the translation from codons to amino acids (Table 1).


                                 
                                    |
                                    S
                                    |
                                  is the number of synonymous codons that are translated to an amino acid S, which is known as the cardinality of an amino acid S.

A random mapping table D is 
                                    D
                                    =
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    T
                                  the difference between a reference code table T and a random code table 
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                 .

A circular angle of a codon value c is θ and a circular angle of a random codon value 
                                    
                                       
                                          c
                                       
                                       
                                          ˆ
                                       
                                    
                                  on D is 
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                       
                                    
                                 . A sequence of circular angles is 
                                    Θ
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          ⩽
                                          i
                                          ⩽
                                          N
                                       
                                    
                                  without random mapping. A sequence of random circular angles is 
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                D
                                                ,
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          1
                                          ⩽
                                          i
                                          ⩽
                                          N
                                       
                                    
                                  on D.

Dyadic wavelet transform of 
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                  is 
                                    
                                       
                                          W
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                    )
                                  and the local modulus maxim of 
                                    
                                       
                                          W
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                    )
                                  is 
                                    
                                       
                                          W
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          LM
                                       
                                    
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                    )
                                 .

A binary watermark of 
                                    
                                       
                                          N
                                       
                                       
                                          W
                                       
                                    
                                  bits is 
                                    w
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          )
                                       
                                       
                                          1
                                          ⩽
                                          k
                                          ⩽
                                          
                                             
                                                N
                                             
                                             
                                                W
                                             
                                          
                                       
                                    
                                  and an extracted watermark is 
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                 .

A target codon for 1-bit embedding is 
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                  that consists of 3 consecutive codons. The number of target codons is the same as the number of watermark bits 
                                    
                                       
                                          N
                                       
                                       
                                          W
                                       
                                    
                                 .

Nucleotide sequences and codon sequences are character strings produced by a combination of G, A, C, T. They must be converted to numerical values when embedding the watermark as binary, integer, or floating type for signal processing.

Shimanovsky [11], Heider [20], and Shuhong [23] mapped four nucleotide bases to 2 bits of 
                              {
                              00
                              ,
                              01
                              ,
                              10
                              ,
                              11
                              }
                            and converted the nucleotide sequences to binary sequences. Balado [38–40] mapped four nucleotide bases to four integers 
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              3
                              }
                            and converted 64 codons to triplet integer values. However, these methods do not consider the rules of the genetic code and the correlations among synonymous codons. Further, these methods have limited applications in signal processing for watermark embedding.

The numerical mapping of codons is a basic step in the identification of protein-coding regions and DNA walks using DNA Fourier [43] or wavelet transform analysis [49,50]. Cristea [47,48] presented the codon code depending upon the base code [T = 0, C = 1, A = 2, G = 3] that is optimally selected under the minimally non-monotonic correspondence between 64 codons and 20 amino acids. Anastassiou [43] mapped four characters to complex values such as 
                              A
                              =
                              1
                              +
                              j
                           , 
                              T
                              =
                              1
                              −
                              j
                           , 
                              C
                              =
                              −
                              1
                              −
                              j
                           , 
                              G
                              =
                              −
                              1
                              +
                              j
                           , and analyzed the DNA spectrogram of the complex value sequences using DFT (Discrete Fourier Transform). Similarly, Machado et al. [49] mapped 
                              {
                              A
                              ,
                              C
                              ,
                              T
                              ,
                              G
                              }
                            to 
                              {
                              1
                              ,
                              −
                              1
                              ,
                              j
                              ,
                              −
                              j
                              }
                            and transformed the complex value sequences to the wavelet domain for the analysis of human DNA sequences. Mena-Chalco et al. [50] segmented the codon sequence to four-base binary sequences and identified the protein-coding regions based on the magnitude of Gabor wavelet coefficients for each of the four sequences.

These methods are based on signal analysis using the forward frequency transformation. However, they do not require an inverse transform to generate the host codon sequence. Digital watermarking should generate the codon sequence from the watermarked numerical values using reversible numerical mapping, whereas the forward and the inverse mappings are reversible. Therefore, a DNA frequency transform is not suitable for numerical mapping during DNA watermarking but it may be suitable for detecting the target codons for embedding. Therefore, the proposed method uses a codon-coding table (Table 2
                           ) that is suitable for a watermarking system, and it maps 64 codons to integer values of 6 bits based on this table before converting them to circular angles.

First, we set 
                              b
                              =
                              {
                              G
                              ,
                              A
                              ,
                              C
                              ,
                              T
                              }
                            to 
                              b
                              =
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              3
                              }
                            and map a codon 
                              c
                              =
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                            to the integer value c of 6 bits using the polynomial expression.
                              
                                 (1)
                                 
                                    c
                                    =
                                    
                                       
                                          4
                                       
                                       
                                          2
                                       
                                    
                                    ×
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          4
                                       
                                       
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          4
                                       
                                       
                                          0
                                       
                                    
                                    ×
                                    
                                       
                                          b
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                            We then transform c to the circular angle θ, as shown in Fig. 3
                           (a).
                              
                                 (2)
                                 
                                    θ
                                    =
                                    
                                       
                                          2
                                          c
                                          π
                                       
                                       64
                                    
                                    
                                    or
                                    
                                    
                                       
                                          2
                                          c
                                          π
                                       
                                       64
                                    
                                    −
                                    2
                                    π
                                 
                              
                            This figure illustrates an example of circular angles generated by the reference code table T. θ is re-allocated to an angle such that the difference from the codon angle 
                              
                                 
                                    θ
                                 
                                 
                                    −
                                    1
                                 
                              
                            of two angles is small.
                              
                                 (3)
                                 
                                    θ
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      c
                                                      π
                                                   
                                                   64
                                                
                                                ,
                                             
                                             
                                                if 
                                                |
                                                
                                                   
                                                      2
                                                      c
                                                      π
                                                   
                                                   64
                                                
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                |
                                                <
                                                |
                                                
                                                   
                                                      2
                                                      c
                                                      π
                                                   
                                                   64
                                                
                                                −
                                                2
                                                π
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                |
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      c
                                                      π
                                                   
                                                   64
                                                
                                                −
                                                2
                                                π
                                                ,
                                             
                                             
                                                if 
                                                |
                                                
                                                   
                                                      2
                                                      c
                                                      π
                                                   
                                                   64
                                                
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                |
                                                >
                                                |
                                                
                                                   
                                                      2
                                                      c
                                                      π
                                                   
                                                   64
                                                
                                                −
                                                2
                                                π
                                                −
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                |
                                             
                                          
                                       
                                    
                                 
                              
                            A codon c can be easily recovered from a circular angle θ using inverse mapping. From Eq. (3), the integer value c can be obtained as follows.
                              
                                 (4)
                                 
                                    c
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   64
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                θ
                                                ,
                                             
                                             
                                                if 
                                                θ
                                                >
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   64
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                (
                                                2
                                                π
                                                +
                                                θ
                                                )
                                                ,
                                             
                                             
                                                otherwise 
                                             
                                          
                                       
                                    
                                 
                              
                            Three bases of a codon 
                              c
                              =
                              
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    b
                                 
                                 
                                    3
                                 
                              
                            are
                              
                                 (5)
                                 
                                    
                                       
                                          b
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       ⌊
                                       
                                          c
                                          
                                             
                                                4
                                             
                                             
                                                2
                                             
                                          
                                       
                                       ⌋
                                    
                                    ,
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       ⌊
                                       
                                          
                                             c
                                             %
                                             
                                             
                                                
                                                   4
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          4
                                       
                                       ⌋
                                    
                                    ,
                                    
                                    
                                       
                                          b
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       (
                                       c
                                       %
                                       
                                       
                                          
                                             4
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    %
                                    
                                    4
                                 
                              
                            We refer to the sequence of circular angles for a codon sequence as the numerical sequence. Table 2 shows the reference code table T for 64 codons. This table can be varied in the order 
                              {
                              G
                              ,
                              A
                              ,
                              T
                              ,
                              C
                              }
                           . T is selected as one among 24 tables. Thus, a codon is coded to c by the sequential mapping of three bases. Because the integer value c of the codon is simply a code value that is similar to the decimal point in ASCII code, it has nothing to do with the physical quantity.

The features of our codon-coding method are as follows:
                              
                                 (1)
                                 Generally, the numerical codes of six synonymous codons are separated into two groups. The code separation, which depends on the method for codon mapping, should be minimized for facilitating the processing for DNA watermarking. In our method, most synonymous codons come together in one place, except for the codons for ‘Ser’ and stop codons. Codons can be grouped to the center points of each amino acid region much like vector quantization (VQ), so that the embedding process is simple when viewed as signal processing. For example, the synonymous codons in ‘Arg’ are bound to 
                                       (
                                       x
                                       00
                                       ,
                                       x
                                       01
                                       ,
                                       202
                                       ,
                                       203
                                       )
                                    , 
                                       x
                                       =
                                       1
                                       ,
                                       2
                                    , and the synonymous codons in ‘Leu’ are bound to 
                                       (
                                       x
                                       30
                                       ,
                                       x
                                       31
                                       ,
                                       232
                                       ,
                                       233
                                       )
                                    , 
                                       x
                                       =
                                       2
                                       ,
                                       3
                                    . As mentioned in the next section, we group together ‘Ser’ and stop codons using random mapping.

Forward and inverse mapping between a codon and a numerical value are very simple and reversible, with no data loss. Thus, each step in the embedding process of “codon → numerical value → watermarked numerical value → watermarked codon” can be designed mathematically and simply.

The integer value 
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                     with a single base error can be estimated using the 
                                       16
                                       ×
                                       4
                                     codon coding table. If the first base b1 of a codon 
                                       c
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                     has an error where 
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                    , 
                                       
                                          
                                             c
                                          
                                          
                                             ′
                                          
                                       
                                     will be changed to any codon in the column on c. If the second base has an error where 
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                    , 
                                       
                                          
                                             c
                                          
                                          
                                             ′
                                          
                                       
                                     will be changed to any codon in the row on c. If the third base has an error where 
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             3
                                          
                                          
                                             ′
                                          
                                       
                                    , 
                                       
                                          
                                             c
                                          
                                          
                                             ′
                                          
                                       
                                     will be changed to the codon above or below c. The integer value 
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                     of 
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                     is changed by 
                                       
                                          
                                             4
                                          
                                          
                                             3
                                             −
                                             i
                                          
                                       
                                     multiples depending on the error position i.

In the example 
                                       (
                                       c
                                       ,
                                       c
                                       )
                                       =
                                       (
                                       
                                          CCC
                                       
                                       ,
                                       42
                                       )
                                    , if 
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                     is the error, 
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                     will be changed to one of (GCC,10), (ACC,26), or (TCC,58). If 
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                     is the error, 
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                     will be changed to one of (CGC,34), (CAC,38), or (CTC,46). If 
                                       
                                          
                                             b
                                          
                                          
                                             3
                                          
                                       
                                     is the error, 
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                     will be changed to one of (CCG,40), (CCA,41), or (CCT,42). Errors of b1 and b2 in (CCC,42) will change the amino acid.

The watermark can be embedded while ensuring amino acid conservation by the signal processing of the numerical sequence. Using the codon-coding table, a codon can be exchanged for another in a codon group of the amino acid. Like the VQ concept, synonymous codons can be easily grouped and modeled mathematically.

Circular angles in the reference codon table have the resolution of 64 codons as shown in Fig. 3(a). To secure the watermark, we extend the resolution with 
                              R
                              (
                              >
                              64
                              )
                            samplings by zero padding and map 64 codons to any sampled code as a unit of synonymous codons. M zeros are padded between amino acids, and 
                              M
                              |
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              |
                            zeros are padded in each amino acid. Thus, the resolution for an amino acid 
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                            will be 
                              (
                              M
                              +
                              1
                              )
                              |
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              |
                            and the full resolution for all codons will be 
                              R
                              =
                              20
                              M
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    20
                                 
                              
                              (
                              M
                              +
                              1
                              )
                              |
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              |
                           .

First, we list all codons in Table 2 as a unit of synonymous codons in random order. Then we randomly allocate codons in synonymous codons to M times sampled code. For example, when the randomly ordered amino acids are 
                              S
                              =
                              {
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    S
                                 
                                 
                                    20
                                 
                              
                              }
                           , 
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              =
                              {
                              
                                 
                                    c
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                              |
                              j
                              ∈
                              [
                              1
                              ,
                              |
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              |
                              ]
                              }
                           , any codon 
                              
                                 
                                    c
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                            in synonymous codons of nth ordered amino acid 
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                            become allocated as follows:
                              
                                 (6)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          n
                                          ,
                                          j
                                       
                                    
                                    →
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                (
                                                l
                                                (
                                                j
                                                )
                                                +
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                M
                                                +
                                                1
                                                )
                                                |
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      l
                                                   
                                                
                                                |
                                                +
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                                )
                                                %
                                                R
                                                ,
                                             
                                             
                                                if 
                                                n
                                                >
                                                1
                                             
                                          
                                          
                                             
                                                l
                                                (
                                                j
                                                )
                                                +
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                             
                                             
                                                if 
                                                n
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                            
                           
                              l
                              (
                              j
                              )
                            is randomly selected in 
                              j
                              ∈
                              [
                              1
                              ,
                              |
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              |
                              ]
                           . 
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                            is the starting codon value and is randomly selected in 
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              ∈
                              [
                              1
                              ,
                              M
                              ]
                           . Accordingly, a codon value 
                              
                                 
                                    c
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                            in the reference code table T is permuted to a random value 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                           ; 
                              
                                 
                                    c
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                              :
                              
                                 
                                    c
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                              →
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                           . A circular angle 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    n
                                    ,
                                    j
                                 
                              
                            for a permuted value 
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                            can be computed using Eq. (3): 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    n
                                    ,
                                    j
                                 
                              
                              =
                              
                                 
                                    2
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          j
                                       
                                    
                                    π
                                 
                                 R
                              
                            or 
                              
                                 
                                    2
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          n
                                          ,
                                          j
                                       
                                    
                                    π
                                 
                                 R
                              
                              −
                              2
                              π
                           .

We define the random mapping table D as the difference of the reference code table 
                              T
                              =
                              {
                              
                                 
                                    c
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                              |
                              n
                              ∈
                              [
                              1
                              ,
                              20
                              ]
                              ,
                              j
                              ∈
                              [
                              1
                              ,
                              |
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              |
                              ]
                              }
                            and the random code table 
                              
                                 
                                    T
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              {
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                              |
                              n
                              ∈
                              [
                              1
                              ,
                              20
                              ]
                              ,
                              j
                              ∈
                              [
                              1
                              ,
                              |
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              |
                              ]
                              }
                           .
                              
                                 (7)
                                 
                                    D
                                    =
                                    
                                       
                                          T
                                       
                                       
                                          ˆ
                                       
                                    
                                    −
                                    T
                                 
                              
                            Two tables of T and D can be used as keys in the public-key infrastructure (PKI) protocol where T is the public key and D is the private key. The embedding process is performed on a sequence of random codon values 
                              
                                 
                                    C
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    N
                                 
                              
                           . The watermarked codon values 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    N
                                 
                              
                            are recovered to 
                              
                                 
                                    C
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    N
                                 
                              
                            by D, and the watermarked codons 
                              
                                 
                                    C
                                 
                                 
                                    ′
                                 
                              
                            are generated from 
                              
                                 
                                    C
                                 
                                 
                                    ′
                                 
                              
                            using Eq. (5).


                           Fig. 3(b) illustrates random circular angles that are permuted as a unit of synonymous codons by the random mapping table D in no zero padding 
                              M
                              =
                              0
                           . This process allocates synonymous codons of 
                              {
                              S
                              ,
                              R
                              ,
                              L
                              }
                            to consecutive values and makes the embedding process easy, because the random circular values 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                 
                              
                            can be recovered as the reference circular values θ using the random mapping table D, and this table makes the circular angles for the embedding process unpredictable. In Section 4.3, we explain fully the unpredictability of the random circular angles 
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                            and the position of center codons for embedding targets using the random mapping table D.

Our method selects a number of target codons 
                           
                              
                                 c
                              
                              
                                 k
                              
                              
                                 (
                                 3
                                 )
                              
                           
                           =
                           (
                           
                              
                                 c
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                         in a sequence of codons C and embeds a watermark bit 
                           
                              
                                 w
                              
                              
                                 k
                              
                           
                         into random circular angles of target codons. This section explains two processes for searching target codons and embedding bits.

The embedding targets can all be codons except for start and stop codons and one synonymous codon for ‘Trp’ (W). Given a codon sequence C, a sequence of random circular angles 
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                            is decided by the random mapping table D that is one of a very large number of tables. Because the conventional methods embed the watermark into four or six synonymous codons in C, and anyone can know their positions, the watermarked codons are easily estimated, although randomly mapped. For the unpredictability of the watermarked codons, the codons can be randomly selected for embedded targets. However, additional information must be stored, in this case the positions of selected codons. Given the random mapping table used as a key, the random circular angles as well as the positions and numbers of target codons should be determined together. Accordingly, our method selects the codons for embedded targets for the purposes as follows:
                              
                                 (1)
                                 The position and number of embedded targets should be regulated on a sequence of random circular angles 
                                       
                                          
                                             Θ
                                          
                                          
                                             D
                                          
                                       
                                    .

It should be very difficult to predict the positions and numbers of the embedded targets without the knowledge of random mapping table D.

Because the wavelet coefficients of random circular angles that appear as random noise are influenced strongly by neighboring angles, it is difficult for the Lipschitz regularity to be reliably computed. Therefore, we remove irregular perturbations in a sequence of random circular values 
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                            using hard-thresholding according to the Birgé–Massart strategy [53]. We then decompose a sequence of threshold circular values to a multi-scale wavelet transform with the same length, 
                              {
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          J
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                              ,
                              
                                 
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    j
                                    ⩽
                                    J
                                 
                              
                              }
                           , and detect local modulus maxima 
                              {
                              
                                 
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          LM
                                       
                                    
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    j
                                    ⩽
                                    J
                                 
                              
                              }
                            by finding positions where 
                              |
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                              |
                            is larger than its two closest neighboring coefficients and strictly larger than at least one. 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          J
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                            is the coarse signal at the scale 
                              
                                 
                                    2
                                 
                                 
                                    J
                                 
                              
                            and 
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                            is the wavelet transform signal at the scale 
                              
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                           .

In the Mallat theory, if 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                 
                              
                            has the local modulus maxima 
                              |
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    LM
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                              |
                              >
                              0
                            at 
                              j
                              =
                              0
                            and it is equal to the convolution of a function with local singularity with a Gaussian of variance 
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           , the Lipschitz regularity is the upper bound 
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                            of the set of α that satisfy regularity over 
                              [
                              a
                              ,
                              b
                              ]
                           .
                              
                                 (8)
                                 
                                    
                                       |
                                       
                                          
                                             W
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             LM
                                          
                                       
                                       (
                                       
                                          
                                             Θ
                                          
                                          
                                             D
                                          
                                       
                                       )
                                       |
                                    
                                    ⩽
                                    K
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                       
                                          α
                                          −
                                          1
                                       
                                    
                                    
                                    where 
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                2
                                             
                                             
                                                2
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    
                                       {
                                       
                                          
                                             (
                                             
                                                |
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      LM
                                                   
                                                
                                                (
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      D
                                                   
                                                
                                                )
                                                |
                                             
                                             )
                                          
                                          
                                             1
                                             ⩽
                                             j
                                             ⩽
                                             J
                                          
                                       
                                       ,
                                       
                                       ∀
                                       c
                                       ∈
                                       [
                                       a
                                       ,
                                       b
                                       ]
                                       }
                                    
                                 
                              
                           Parameters 
                              K
                              ,
                              α
                              ,
                              σ
                            can be obtained by minimizing
                              
                                 (9)
                                 
                                    arg
                                    
                                       min
                                       
                                          K
                                          ,
                                          α
                                          ,
                                          σ
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       J
                                    
                                    
                                       
                                          (
                                          
                                             
                                                log
                                             
                                             
                                                2
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   W
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   LM
                                                
                                             
                                             (
                                             
                                                
                                                   Θ
                                                
                                                
                                                   D
                                                
                                             
                                             )
                                             |
                                          
                                          −
                                          
                                             
                                                log
                                             
                                             
                                                2
                                             
                                          
                                          K
                                          −
                                          j
                                          −
                                          
                                             
                                                α
                                                −
                                                1
                                             
                                             2
                                          
                                          
                                             
                                                log
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   2
                                                
                                                
                                                   2
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            We obtain codons 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                            where 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    k
                                 
                              
                            are the local modulus maxima and its Lipschitz regularity is below a threshold 
                              α
                              <
                              t
                              h
                            
                           
                              (
                              −
                              1
                              <
                              t
                              h
                              ⩽
                              1
                              )
                           . These are used to center codons of target codons.
                              
                                 (10)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ⁎
                                       
                                    
                                    =
                                    h
                                    (
                                    
                                       
                                          Θ
                                       
                                       
                                          D
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                             
                                                ⁎
                                             
                                          
                                          )
                                       
                                       
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                ⁎
                                             
                                          
                                          |
                                          ∈
                                          Z
                                       
                                    
                                 
                              
                            The target codons for 1-bit embedding are the center codon and its two closest codons:
                              
                                 (11)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                             
                                                ⁎
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       |
                                       
                                          |
                                          
                                             
                                                W
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                LM
                                             
                                          
                                          (
                                          
                                             
                                                θ
                                             
                                             
                                                D
                                                ,
                                                k
                                             
                                          
                                          )
                                          |
                                       
                                       >
                                       0
                                       
                                       and
                                       
                                       
                                          
                                             α
                                          
                                          
                                             k
                                          
                                       
                                       <
                                       0
                                       }
                                    
                                    .
                                 
                              
                            The support region 
                              [
                              a
                              ,
                              b
                              ]
                            and the maximum scale J have slight effects on the above parameters. Here we limit the maximum scale to 
                              0
                              <
                              J
                              ⩽
                              6
                            according to the length of sequence and set the support region 
                              [
                              a
                              ,
                              b
                              ]
                            to 
                              [
                              0
                              ,
                              p
                              (
                              j
                              )
                              ]
                            considering the propagation of local maxima of delta functions across scales. The setting for the maximum scale J and support region 
                              [
                              a
                              ,
                              b
                              ]
                            are explained fully in Appendix A.


                           Fig. 4
                            shows random circular angles 
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                           , filtered angles of 
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                           , local modulus maxima 
                              |
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    LM
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                              |
                            on the scale 
                              j
                              =
                              0
                              ,
                              2
                              ,
                              4
                           , and the Lipschitz regularity α and K parameter for codon DNA sequence of Homo sapiens (ANG; NM_001145). 
                              |
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    LM
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                              |
                            where 
                              α
                              <
                              0
                            decreases when the scale increases. In contrast, 
                              |
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    LM
                                 
                              
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                              |
                            when 
                              α
                              >
                              0
                            increases when the scale increases. The K parameter gives the magnitude of sharp variations of signal. This figure shows that the sharp variations increase when K is high.

Our method uses codons with the local modulus maxima and 
                              α
                              <
                              t
                              h
                            as the center codon of triplet codons. th can be determined condignly considering capacity and security. Center codons of target codons, 
                              
                                 
                                    c
                                 
                                 
                                    ⁎
                                 
                              
                              =
                              h
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    D
                                 
                              
                              )
                           , depend on the random mapping table D and the codon sequence C. If D is unknown, 
                              
                                 
                                    c
                                 
                                 
                                    ⁎
                                 
                              
                            is very difficult to estimate.

All bits of watermark, 
                              w
                              =
                              
                                 
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    k
                                    ⩽
                                    
                                       
                                          N
                                       
                                       
                                          W
                                       
                                    
                                 
                              
                           , are embedded into random circular angles of triplet codons, 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                       
                                          ⁎
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    k
                                    ⩽
                                    
                                       
                                          N
                                       
                                       
                                          W
                                       
                                    
                                 
                              
                           , one by one, while ensuring amino acid conservation. Fig. 5
                            illustrates an embedding example with three zeros padding in target codons 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              =
                              {
                              
                                 ATC
                              
                              ,
                              
                                 CAG
                              
                              ,
                              
                                 GCC
                              
                              }
                           .

Set amino acids and synonymous codons of triplet codons 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              =
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    ⁎
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                            as
                              
                                 (12)
                                 
                                    
                                       f
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       )
                                       →
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       :
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       f
                                       
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                             
                                                ⁎
                                             
                                          
                                          )
                                       
                                       →
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       :
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   ,
                                                
                                             
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       f
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       )
                                       →
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       :
                                       {
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       }
                                    
                                 
                              
                            where 
                              
                                 
                                    n
                                 
                                 
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ∈
                              [
                              1
                              ,
                              20
                              ]
                            and their random circular angles on random mapping table D as
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             D
                                          
                                       
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                       =
                                       {
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             D
                                          
                                       
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       )
                                       =
                                       {
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             D
                                          
                                       
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                       =
                                       {
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             D
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       }
                                    
                                 
                              
                            Thus, 
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                              )
                            is the set of random circular angles of synonymous codons in an amino acid 
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                            on D. And 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    n
                                    ,
                                    j
                                 
                              
                            is the random circular angle of a codon 
                              
                                 
                                    c
                                 
                                 
                                    n
                                    ,
                                    j
                                 
                              
                            that is jth codon in a set of nth synonymous codons.

A random circular angle 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    i
                                 
                              
                            of a center codon 
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    ⁎
                                 
                              
                            moves to maximum and minimum angles in 
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                            according to a bit 
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           .
                              
                                 (14)
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                          ,
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                max
                                                (
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                min
                                                (
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                            The maximum and minimum angles are 
                              max
                              (
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    1
                                 
                              
                            and 
                              max
                              (
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                              )
                              =
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    |
                                 
                              
                            because random circular angles of synonymous codons are continuous in their group, as shown in Fig. 3(b).

Our method moves random circular angles of left and right codons to angles with the maximum or minimum distances, in clockwise and counterclockwise directions from the reference point according to a bit 
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           . The reference point 
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                            is the average of random circular angles 
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                            for the center codon; 
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 1
                                 
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    |
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    |
                                    
                                       
                                          S
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    |
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    j
                                 
                              
                           . As shown in Fig. 5, we define the clockwise distance d⥁ between 
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                            and random circular angles 
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                              )
                            in 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                           
                           
                              
                                 (15)
                                 
                                    d
                                    ⥁
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          ,
                                          j
                                       
                                    
                                    )
                                    =
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          ,
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    ,
                                    
                                    ∀
                                    j
                                    ∈
                                    
                                       [
                                       1
                                       ,
                                       |
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                       ]
                                    
                                 
                              
                            and the counterclockwise distance d⥀ between 
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                            and random circular angles 
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              )
                            in 
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    d
                                    ⥀
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          j
                                       
                                    
                                    )
                                    =
                                    2
                                    π
                                    −
                                    |
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                          ,
                                          
                                             
                                                n
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          M
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    ,
                                    
                                    ∀
                                    j
                                    ∈
                                    
                                       [
                                       1
                                       ,
                                       |
                                       
                                          
                                             S
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       |
                                       ]
                                    
                                 
                              
                            A random circular angle 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    i
                                    −
                                    1
                                 
                              
                            moves to maximum or minimum clockwise distances in 
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                              )
                            on the reference point 
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                           ,
                              
                                 (17)
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                          ,
                                          i
                                          −
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                max
                                                (
                                                d
                                                ⥁
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                min
                                                (
                                                d
                                                ⥁
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                            and a random circular angle 
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    i
                                    +
                                    1
                                 
                              
                            moves to maximum or minimum counterclockwise distances in 
                              
                                 
                                    Ω
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              )
                            on the reference point 
                              
                                 
                                    M
                                 
                                 
                                    k
                                 
                              
                           ,
                              
                                 (18)
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          D
                                          ,
                                          i
                                          +
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                max
                                                (
                                                d
                                                ⥀
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                min
                                                (
                                                d
                                                ⥀
                                                (
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      D
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                                )
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                            Watermarked angles of triplet codons, (
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    i
                                    −
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    D
                                    ,
                                    i
                                    +
                                    1
                                 
                                 
                                    ′
                                 
                              
                           ), are inversely converted to reference angles (
                              
                                 
                                    θ
                                 
                                 
                                    i
                                    −
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    ′
                                 
                              
                           ) by random mapping table D. These angles are inversely mapped to watermarked integer values (
                              
                                 
                                    c
                                 
                                 
                                    i
                                    −
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    ′
                                 
                              
                           ) from Eq. (4).
                              
                                 (19)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   R
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ⩾
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                   
                                                      2
                                                      π
                                                   
                                                
                                                (
                                                2
                                                π
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                ,
                                             
                                             
                                                if 
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                <
                                                0
                                             
                                          
                                       
                                    
                                    
                                    for 
                                    i
                                    ∈
                                    [
                                    −
                                    1
                                    ,
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                            Finally the watermarked codons are obtained from Eq. (5); 
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                    −
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                    +
                                    1
                                 
                                 
                                    ′
                                 
                              
                              )
                              =
                              
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          3
                                          i
                                          +
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    3
                                    ⩽
                                    j
                                    ⩽
                                    5
                                 
                              
                           . Using the above process, all bits of watermark are embedded into target codons in order.

Given a received or pirated coding DNA sequence 
                           
                              
                                 C
                              
                              
                                 ˜
                              
                           
                        , the watermark is extracted in 
                           
                              
                                 C
                              
                              
                                 ˜
                              
                           
                         using the random mapping table D. The extraction and embedding processes are similar (Fig. 2(b)). During the extracting process, we generate random circular angles 
                           
                              
                                 
                                    
                                       Θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                              
                           
                         of 
                           
                              
                                 C
                              
                              
                                 ˜
                              
                           
                         on D and search center codons 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 ⁎
                              
                           
                         using the Lipschitz regularity of local modulus maxima of hard-threshold angles and then obtain a number of target codons 
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       k
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                    
                                       ⁎
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 )
                              
                              
                                 1
                                 ⩽
                                 k
                                 ⩽
                                 
                                    
                                       N
                                    
                                    
                                       W
                                    
                                 
                              
                           
                        .

When extracting a watermark bit from target codons 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                              
                                 (
                                 3
                                 )
                              
                           
                        , we compute random circular angles (
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                                 ,
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                                 ,
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                                 ,
                                 i
                                 +
                                 1
                              
                           
                        ) of 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                              
                                 (
                                 3
                                 )
                              
                           
                        , sets of random circular angles of synonymous codons 
                           (
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                              
                           
                           (
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                           
                           )
                           ,
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                              
                           
                           (
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           )
                           ,
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                              
                           
                           (
                           
                              
                                 S
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           )
                           )
                        , and average values (
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        ) of these sets. Further, we compute the clockwise distance on 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         with a circular angle 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                                 ,
                                 i
                                 −
                                 1
                              
                           
                           ;
                           d
                           ⥁
                           (
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                                 ,
                                 i
                                 −
                                 1
                              
                           
                           )
                         and the counterclockwise distance on 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         with a circular angle 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                                 ,
                                 i
                                 +
                                 1
                              
                           
                           ;
                           d
                           ⥀
                           (
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 D
                                 ,
                                 i
                                 +
                                 1
                              
                           
                           )
                        . Three bits of triplet codons can be computed by comparing 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                              
                           
                         and the distances.
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             if 
                                             d
                                             ⥁
                                             (
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   D
                                                   ,
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             )
                                             >
                                             d
                                             ⥁
                                             (
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise 
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             if 
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   D
                                                   ,
                                                   i
                                                
                                             
                                             >
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise 
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             if 
                                             d
                                             ⥀
                                             (
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   D
                                                   ,
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                             >
                                             d
                                             ⥀
                                             (
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise 
                                          
                                       
                                    
                                 
                              
                           
                         Therefore, a watermark bit 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                           
                         can be determined based on the majority rule of three bits; 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 k
                              
                           
                           =
                           
                              floor
                           
                           (
                           
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                              3
                           
                           )
                        .

All bits of watermark 
                           
                              
                                 w
                              
                              
                                 ˜
                              
                           
                         are computed using the above process. Whether a pirated DNA sequence is copied or not can be determined based on the similarity or bit error rate (BER) of the original watermark w and the extracted watermark 
                           
                              
                                 w
                              
                              
                                 ˜
                              
                           
                        .

@&#EXPERIMENTAL RESULTS@&#

Our in silico experiment used coding DNA sequences from the National Center for Bioinformatics information database (Table 3
                     ). We analyzed the data capacity of our, Heider et al. [20,21] and Liss et al. methods [24], and adjusted the watermark lengths to be similar. We then evaluated their mutation resistance. Further, we analyzed the security of our method based on differential entropy. We used a 
                        
                           WDH
                        
                        (
                        n
                        )
                      code for error correction from the DNA-Crypt method of Heider et al. However, because Liss et al. method does not resist mutations, we repeatedly embedded the watermark bit into four and six synonymous codons. Our experiment was performed using the Matlab Bioinformatics Toolbox 3.

The capacity of a watermark embedded into a coding sequence should be determined with consideration for amino acid conservation and resistance. High data capacity requires numerous embedding targets. Given the maximum allowable embedding targets, data capacity can be increased by the low repeated times but degrades resistance. In contrast, data capacity can be decreased by the high repeated times but improves resistance. If the embedding targets are large (many repeats or data capacity), a pirate can detect the embedded targets because of the limited space of codon sequence. The relation of data capacity and resistance limits the amount of information for copyright.

Balado et al. [38–40] studied the maximum capacity that can be embedded into non-coding and coding sequences. We investigated the capacity of our method and conventional methods based on the analysis by Balado et al. The capacities of all methods are different. To conduct an experiment that measures mutation resistance under comparable circumstances, we adjusted the watermark lengths of all methods to be similar by controlling the repeated time in their capacities.

Our method embeds a watermark bit into codons. If all codons except for the start and stop codons are grouped as a set of codons, the maximum capacity of watermark bits, 
                           
                              
                                 C
                              
                              
                                 max
                              
                           
                        , is 
                           
                              
                                 C
                              
                              
                                 max
                              
                           
                           =
                           1
                           /
                           3
                         [bit/codon]. However, our method detects singularities of random circular angles, which are obtained from the random mapping table D from the Lipschitz regularity of local modulus maxima and uses them as center codons of target codons. Therefore, watermark capacity is determined by the threshold th 
                        
                           (
                           −
                           1
                           <
                           t
                           h
                           ⩽
                           1
                           )
                         of the Lipschitz regularity α and the local modulus maxima 
                           
                              
                                 W
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 LM
                              
                           
                           (
                           
                              
                                 Θ
                              
                              
                                 D
                              
                           
                           )
                         at the first scale. Because the number and position of local modulus maxima depend on D, the watermark capacity varies with D. Denote the number of target codons as 
                           |
                           
                              
                                 c
                              
                              
                                 (
                                 3
                                 )
                              
                           
                           |
                         and the length of codon sequence 
                           |
                           C
                           |
                           =
                           N
                        . The watermark capacity 
                           
                              
                                 C
                              
                              
                                 proposed
                              
                           
                         is
                           
                              (23)
                              
                                 
                                    
                                       C
                                    
                                    
                                       proposed
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                       |
                                    
                                    
                                       N
                                       −
                                       2
                                    
                                 
                                 ⩽
                                 
                                    1
                                    3
                                 
                                 
                                 [
                                 bit
                                 /
                                 codon
                                 ]
                              
                           
                         where 
                           N
                           −
                           2
                         is the length of the coding sequence, except for the start and end codons.

Heider et al. method embeds the watermark using a mutation correction code of an 8/4 Hamming code and WDH(n) code with a fuzzy controller. Then they embed the watermark bits as a unit of 2 bits into codons where the number of codons is greater than four, 
                           |
                           S
                           |
                           ⩾
                           4
                        . Because WDH(n) is more resistant to mutation than the 8/4 Hamming code according to their report, we used the WDH(n) code from the DNA-Crypt algorithm. In this case, the watermark capacity 
                           
                              
                                 C
                              
                              
                                 Heider
                              
                           
                         is
                           
                              (24)
                              
                                 
                                    
                                       C
                                    
                                    
                                       Heider
                                    
                                 
                                 =
                                 
                                    ⌊
                                    
                                       
                                          2
                                          |
                                          
                                             
                                                Z
                                             
                                             
                                                4
                                             
                                          
                                          |
                                       
                                       n
                                    
                                    ⌋
                                 
                                 ×
                                 
                                    1
                                    
                                       N
                                       −
                                       2
                                    
                                 
                                 
                                 [
                                 bit
                                 /
                                 codon
                                 ]
                              
                           
                         where 
                           |
                           
                              
                                 Z
                              
                              
                                 4
                              
                           
                           |
                         is the number of four synonymous codons. n is the number of repeats of WDH.

Liss et al. method embeds ASCII characters into four and six synonymous codons as a unit of 1 bit. Therefore, the maximum embeddable bits are 
                           |
                           
                              
                                 Z
                              
                              
                                 4
                                 ,
                                 6
                              
                           
                           |
                         bits. However, because this method does not consider mutation resistance, the watermark can be lost to mutation. To consider mutation resistance, our experiment embedded the watermark repeatedly with R times on the capacity of 
                           |
                           
                              
                                 Z
                              
                              
                                 4
                                 ,
                                 6
                              
                           
                           |
                         bits. In this case, the watermark capacity 
                           
                              
                                 C
                              
                              
                                 
                                    Liss
                                 
                                 +
                                 Repeat
                              
                           
                         is
                           
                              (25)
                              
                                 
                                    
                                       C
                                    
                                    
                                       
                                          Liss
                                       
                                       +
                                       Repeat
                                    
                                 
                                 =
                                 
                                    ⌊
                                    
                                       
                                          |
                                          
                                             
                                                Z
                                             
                                             
                                                4
                                                ,
                                                6
                                             
                                          
                                          |
                                       
                                       R
                                    
                                    ⌋
                                 
                                 ×
                                 
                                    1
                                    
                                       N
                                       −
                                       2
                                    
                                 
                                 
                                 [
                                 bit
                                 /
                                 codon
                                 ]
                              
                           
                         
                        Fig. 6
                         shows the watermark capacities about th of the Lipschitz regularity, α of our method, n in WDH(n) in Heiderʼs method, and R in Lissʼs method. The watermark capacity 
                           
                              
                                 C
                              
                              
                                 proposed
                              
                           
                         of our method is an average of results obtained from 1000 experiments with each DNA sequence, because it varies on the random mapping table. 
                           
                              
                                 C
                              
                              
                                 proposed
                              
                           
                        , has the maximum value of 
                           t
                           h
                           =
                           1
                        , which is the number of local modulus maxim at the first scale, 
                           
                              
                                 W
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 LM
                              
                           
                           (
                           
                              
                                 Θ
                              
                              
                                 D
                              
                           
                           )
                        . Without considering mutation resistance, 
                           t
                           h
                           =
                           1.0
                         in our method, 
                           n
                           =
                           1
                         in Heider et al. method, and 
                           R
                           =
                           1
                         in Liss et al. method, Heider et al. method can embed more bits than the other methods. Our method can embed smaller bits than conventional methods because target codons are selected for 1-bit embedding resistance to mutation. Considering mutation resistance, the watermark capacities of Heider et al. and Liss et al. methods decrease exponentially with parameters n and R.

To evaluate mutation resistance in a comparable manner, parameters of th of our method, n of Heider et al. method, and R of Liss et al. method should be set for all watermark capacities so that they are all similar. First, our experiment set 
                           t
                           h
                           =
                           0
                         and selected 
                           
                              
                                 W
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 LM
                              
                           
                           (
                           
                              
                                 Θ
                              
                              
                                 D
                              
                           
                           )
                         with 
                           α
                           <
                           0
                         as center codons of our method. In this case, the average 
                           
                              
                                 C
                              
                              
                                 proposed
                              
                           
                           =
                           0.137
                        . Then, for 
                           
                              
                                 C
                              
                              
                                 proposed
                              
                           
                           ≈
                           
                              
                                 C
                              
                              
                                 Heider
                              
                           
                           ≈
                           
                              
                                 C
                              
                              
                                 
                                    Liss
                                 
                                 +
                                 Repeat
                              
                           
                        , two parameters n and R of conventional methods are
                           
                              (26)
                              
                                 n
                                 ∈
                                 
                                    (
                                    
                                       
                                          2
                                          |
                                          Z
                                          |
                                       
                                       
                                          ⌊
                                          
                                             
                                                C
                                             
                                             
                                                proposed
                                             
                                          
                                          ×
                                          (
                                          N
                                          −
                                          2
                                          )
                                          ⌋
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          2
                                          |
                                          Z
                                          |
                                       
                                       
                                          ⌊
                                          
                                             
                                                C
                                             
                                             
                                                proposed
                                             
                                          
                                          ×
                                          (
                                          N
                                          −
                                          2
                                          )
                                          ⌋
                                       
                                    
                                    ]
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 R
                                 ∈
                                 
                                    (
                                    
                                       
                                          |
                                          z
                                          |
                                       
                                       
                                          ⌊
                                          
                                             
                                                C
                                             
                                             
                                                proposed
                                             
                                          
                                          ×
                                          (
                                          N
                                          −
                                          2
                                          )
                                          ⌋
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          |
                                          Z
                                          |
                                       
                                       
                                          ⌊
                                          
                                             
                                                C
                                             
                                             
                                                proposed
                                             
                                          
                                          ×
                                          (
                                          N
                                          −
                                          2
                                          )
                                          ⌋
                                       
                                    
                                    ]
                                 
                              
                           
                         From our experiments, n and R can be obtained by 4 and 3. However, the even number of n is inadequate for extracting a bit from repeatedly embedded bits. Therefore, we set n to 5, which is the nearest odd number and R to 3 (Fig. 6). Then we evaluated the mutation resistance of all watermarks.

Because the coding DNA watermarking corresponds to a silent mutation, the amino acid is conserved. The watermark mutation rate depends on the number of target codons and the relation between the watermark and the target codons. The former and latter exert a major and minor influence on mutation rate, respectively. We computed the distribution of the watermark mutation rate of our (
                           t
                           h
                           =
                           0
                        ), Heider et al. (WDH(5)), and Liss et al. 
                           (
                           R
                           =
                           3
                           )
                         method (Fig. 7
                        ). The watermark mutation rates have normal distributions of 
                           (
                           0.099
                           ,
                           
                              
                                 0.0131
                              
                              
                                 2
                              
                           
                           )
                           ,
                           N
                           (
                           0.122
                           ,
                           
                              
                                 0.00155
                              
                              
                                 2
                              
                           
                           )
                        , and 
                           N
                           (
                           0.141
                           ,
                           
                              
                                 0.0217
                              
                              
                                 2
                              
                           
                           )
                        , in our, Heiderʼs, and Lissʼs methods, respectively. These results establish that the watermark mutation rate of our method is lower by a factor of 0.022 and 0.042 compared with Heider et al. and Liss et al. methods, respectively.


                        Fig. 8
                         shows the ANG sequence and the watermarked sequences using our and Heider et al. methods. Comparing the bases in the host sequence to those in watermarked sequence, revealed differences in 21%, 11%, and 14% with our, Heider et al., and Liss et al. methods, respectively. The amino acids encoded by all watermarked bases were translated into the same as the host species. These results establish that both methods conserve the amino acids. Further, both methods preserve the fidelity of the message, because they embed a watermark that is randomly generated without the mutual interference of the watermark and the hostʼs DNA sequence.

We consider only point mutations among small-scale mutations for evaluating mutation resistance. Insertions and deletions (indels) are not considered in our experiments, because they are very rare. Thus, our experiments introduce point mutations into the watermarked codons and then extracted the watermark from the mutated codons.

Set the mutation rate r as the ratio of the number of mutated bases to the total. We produce simultaneously point mutations with r in random positions where r varies from 1 to 40. We performed 5000 mutation experiments with watermarked sequence using two methods. Then we computed BER (bit error rate); 
                           e
                           (
                           w
                           ,
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                           )
                         of the original watermark w, and extracted watermark 
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                         for evaluating the resistance of two methods.


                        Fig. 9
                         shows the average of BERs computed from 5000 mutation experiments. The BERs computed by our method are lower by factors of 0.006–0.115 compared with those of Heider et al. method and from 0.001 to 0.157 compared with Liss et al. method for all mutation rates. Generally, if 
                           e
                           (
                           w
                           ,
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                           )
                           <
                           0.2
                        , two binary watermarks 
                           w
                           ,
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                         are judged to be similar. Define the mutation rate r as 
                           e
                           (
                           w
                           ,
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                           )
                           <
                           0.2
                         as the maximum resistance rate 
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                        . As shown in Fig. 9, 
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                         of our method is [26%, 28%] in all test sequences. However, 
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                           s
                         of Heider et al. and Liss et al. methods are [16%, 22%] and [13%, 20%] respectively. Further, our method yields higher 
                           
                              
                                 r
                              
                              
                                 max
                              
                           
                         values from 4% to 14% compared with conventional methods for each test sequence.

For evaluating detection performance, we analyzed ROC (receiver operating characteristic) curves by FP (false positive probability) 
                           p
                           
                              
                                 r
                              
                              
                                 FP
                              
                           
                         and TP (true positive probability) 
                           p
                           
                              
                                 r
                              
                              
                                 TP
                              
                           
                         when the mutation rate r is 20 and 40. 
                           p
                           
                              
                                 r
                              
                              
                                 FP
                              
                           
                         and 
                           p
                           
                              
                                 r
                              
                              
                                 TP
                              
                           
                         are defined as follows:
                           
                              (28)
                              
                                 p
                                 
                                    
                                       r
                                    
                                    
                                       FP
                                    
                                 
                                 (
                                 T
                                 )
                                 =
                                 Probility
                                 
                                    [
                                    e
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    <
                                    T
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                    ≠
                                    w
                                    ]
                                 
                                 (
                                 Detect
                                 
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 
                                 when
                                 
                                 
                                    
                                       H
                                    
                                    
                                       0
                                    
                                 
                                 
                                 is true
                                 )
                              
                           
                        
                        
                           
                              (29)
                              
                                 p
                                 
                                    
                                       r
                                    
                                    
                                       TP
                                    
                                 
                                 (
                                 T
                                 )
                                 =
                                 Probility
                                 
                                    [
                                    e
                                    (
                                    w
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    <
                                    T
                                    ]
                                 
                                 (
                                 Detect
                                 
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 
                                 when
                                 
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 
                                 is true
                                 )
                              
                           
                         where T is the detection threshold when 
                           0
                           <
                           T
                           <
                           1
                        . Fig. 10
                         shows ROC curves for each codon sequence. These results establish that when the mutation rate is high, the detection performance of our method is better than those of Heiderʼs and Lissʼs methods.

Although the watermarking method and DNA codon sequence are open, the watermark must be very difficult to detect. Other methods are not concerned with watermark security, which is important. Therefore, any pirate could easily detect the watermark by estimating the positions of the watermarked codons.

Our method selects the codons as embedding targets in open codon sequence using random mapping table D and the Lipschitz regularity of local modulus maxima. Further, the numbers of codons and the watermark depend on D. Therefore, if D is unknown, any pirate will encounter difficulty in estimating codon numerical values, the positions of codons, and their numbers. Our method can be applied to biological DNA watermarking by integrating previous biological DNA encryption in which the embedding position represents encrypted keys of PCR primer pairs or specific probes.

Denote the space of random mapping tables as X and the number of cases of random mapping tables as 
                              N
                              (
                              D
                              )
                           . 
                              N
                              (
                              D
                              )
                            is computed as follows;
                              
                                 (30)
                                 
                                    N
                                    (
                                    D
                                    )
                                    =
                                    (
                                    20
                                    !
                                    )
                                    
                                       (
                                       
                                          ∏
                                          
                                             i
                                             =
                                             1
                                          
                                          20
                                       
                                       (
                                       M
                                       +
                                       1
                                       )
                                       |
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       )
                                    
                                    
                                       
                                          M
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                            by the ordering cases of amino acids, the ordering cases of synonymous codons for each amino acid, and the start code value 
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              =
                              M
                              +
                              1
                            by zero padding. 
                              N
                              (
                              D
                              )
                            can be allocated by 
                              ⌈
                              
                                 
                                    log
                                 
                                 
                                    2
                                 
                              
                              
                              N
                              (
                              D
                              )
                              ⌉
                            bits that are considered the length of the watermark key.
                              
                                 (31)
                                 
                                    
                                       ⌈
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       N
                                       (
                                       D
                                       )
                                       ⌉
                                    
                                    =
                                    
                                       ⌈
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          (
                                          20
                                          !
                                          )
                                          
                                             (
                                             
                                                ∏
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                20
                                             
                                             (
                                             M
                                             +
                                             1
                                             )
                                             |
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             )
                                          
                                          
                                             
                                                M
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       ⌉
                                    
                                    ⩾
                                    
                                       ⌈
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          20
                                          !
                                          
                                             ∏
                                             
                                                i
                                                =
                                                1
                                             
                                             20
                                          
                                          |
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          )
                                       
                                       ⌉
                                    
                                    +
                                    
                                       ⌈
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             M
                                             +
                                             1
                                             )
                                          
                                          
                                             21
                                          
                                       
                                       ⌉
                                    
                                    ⩾
                                    90
                                    +
                                    
                                       ⌈
                                       21
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       M
                                       +
                                       1
                                       )
                                       ⌉
                                    
                                 
                              
                            This depends on the zero number M for padding. When the length of a key is 
                              
                                 
                                    N
                                 
                                 
                                    K
                                 
                                 
                                    ′
                                 
                              
                           , M is
                              
                                 (32)
                                 
                                    M
                                    =
                                    
                                       ⌊
                                       
                                          
                                             2
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         K
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   −
                                                   90
                                                
                                                21
                                             
                                          
                                       
                                       ⌋
                                    
                                 
                              
                            To provide security equivalent to a symmetric key of 256 bits, zeros of 
                              M
                              =
                              239
                            will be padded.

In the space of the random mapping table, 
                              X
                              =
                              
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    ⩽
                                    i
                                    ⩽
                                    N
                                    (
                                    D
                                    )
                                 
                              
                           , the pmf (probability mass function) of 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            is 
                              p
                              
                                 
                                    r
                                 
                                 
                                    X
                                 
                              
                              (
                              D
                              )
                              =
                              1
                              /
                              N
                              (
                              D
                              )
                           . The entropy of X for estimating the uncertainty of D is
                              
                                 (33)
                                 
                                    H
                                    (
                                    X
                                    )
                                    =
                                    −
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                          (
                                          D
                                          )
                                       
                                    
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    D
                                    )
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    D
                                    )
                                    =
                                    
                                       
                                          log
                                       
                                       
                                          2
                                       
                                    
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          X
                                       
                                    
                                    (
                                    D
                                    )
                                 
                              
                            The entropy 
                              H
                              (
                              X
                              )
                            of D about M is shown in Fig. 11
                           . If 
                              H
                              (
                              X
                              )
                            is high, the random value of D will be high and many trials of 
                              
                                 
                                    α
                                 
                                 
                                    H
                                    (
                                    X
                                    )
                                 
                              
                            
                           
                              (
                              α
                              >
                              1
                              )
                            for estimating a key value will be required.

If a pirate does not know the random mapping table D, the pirate must attempt to learn the number and positions of codons for detecting the watermark. The number and positions of codons 
                              
                                 
                                    c
                                 
                                 
                                    ⁎
                                 
                              
                            are obtained from the Lipschitz regularity of local modulus maxima in random circular angles by D. They are statistically independent of D. When the length of a codon sequence is N, the number of codons n is normally distributed on 
                              N
                              (
                              m
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                            (
                              m
                              =
                              0.137
                           , 
                              σ
                              =
                              0.05
                           ) within the range 
                              [
                              ⌈
                              0.05
                              N
                              ⌉
                              ,
                              ⌈
                              N
                              /
                              3
                              ⌉
                              ]
                            according to average data capacity (Fig. 6).

The pmf of the number of codons n is 
                              p
                              
                                 
                                    r
                                 
                                 
                                    N
                                 
                              
                              (
                              n
                              )
                              =
                              N
                              (
                              n
                              ;
                              m
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                              /
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    =
                                    ⌈
                                    0.05
                                    N
                                    ⌉
                                 
                                 
                                    ⌈
                                    N
                                    /
                                    3
                                    ⌉
                                 
                              
                              N
                              (
                              n
                              ;
                              m
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              )
                           . The probability that n codons are selected randomly in a sequence of codon is 
                              p
                              
                                 
                                    r
                                 
                                 
                                    I
                                 
                              
                              (
                              I
                              |
                              n
                              )
                              =
                              
                                 1
                                 
                                    (
                                    
                                       
                                          
                                             N
                                          
                                       
                                       
                                          
                                             n
                                          
                                       
                                    
                                    )
                                 
                              
                              =
                              
                                 
                                    n
                                    !
                                    (
                                    N
                                    −
                                    n
                                    )
                                    !
                                 
                                 
                                    N
                                    !
                                 
                              
                           . Therefore, the probability of detecting codon positions is as follows.
                              
                                 (34)
                                 
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    I
                                    |
                                    N
                                    =
                                    n
                                    )
                                    =
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          N
                                       
                                    
                                    (
                                    n
                                    )
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          I
                                       
                                    
                                    (
                                    I
                                    /
                                    n
                                    )
                                    =
                                    
                                       1
                                       
                                          (
                                          
                                             
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   n
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          N
                                          (
                                          n
                                          ;
                                          m
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                ⌈
                                                0.05
                                                N
                                                ⌉
                                             
                                             
                                                ⌈
                                                N
                                                /
                                                3
                                                ⌉
                                             
                                          
                                          N
                                          (
                                          n
                                          ;
                                          m
                                          ,
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                            Therefore, the conditional entropy 
                              H
                              (
                              I
                              |
                              N
                              )
                            is as follows.
                              
                                 (35)
                                 
                                    H
                                    (
                                    I
                                    |
                                    N
                                    )
                                    =
                                    
                                       ∑
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          N
                                       
                                    
                                    (
                                    n
                                    )
                                    H
                                    (
                                    n
                                    /
                                    N
                                    =
                                    n
                                    )
                                    =
                                    
                                       ∑
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                    p
                                    
                                       
                                          r
                                       
                                       
                                          N
                                       
                                    
                                    (
                                    n
                                    )
                                    
                                       (
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   n
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                            
                           
                              H
                              (
                              I
                              |
                              N
                              )
                            of a sequence of codons is very high (Table 3). 
                              H
                              (
                              I
                              |
                              N
                              )
                            is influenced by the length of the codon sequence. Our experiment verified that 
                              H
                              (
                              I
                              |
                              N
                              )
                            about N approaches a linear equation.

@&#CONCLUSIONS@&#

The main requirements of codon DNA watermarking are amino acid conservation, mutation resistance, and security. Here we present a codon DNA watermarking method that satisfies these requirements and was evaluated in silico. The main features of the proposed method are the numerical mapping to random circular angles based on random mapping table, searching for codons using the local modulus maxima according to the Lipschitz regularity, and watermark embedding to ensure amino acid conservation. The codon-coding table and numerical mapping were designed to be suitable for processing DNA watermarking. The watermark was resistant to mutations by embedding it into the difference of circular angles of adjacent codons. We evaluated our method with respect to its the resistance to point mutations, amino acid conservation, security, and data capacity for the HEXA, ANG, CCT2, and bp1 genes. The experimental results show that our method confers superior resistance to mutations with the same capacity as Heider et al. and Liss et al. methods, ensuring amino acid conservation. Further, we established that the random mapping table and the position of target codons are secure from entropy.

@&#ACKNOWLEDGEMENTS@&#

This research was supported by Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Education, Science and Technology (NRF-2011-0023118) and the Busan Metropolitan City, Korea, under the 2013 Brain Busan 21 program grants.

This section determines the maximum scale and the support region of the Mallat wavelet for computing Lipschitz regularity. According to the fast wavelet decomposition of Mallat, the wavelet decomposition on the scale j is
                        
                           (36)
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                              f
                              =
                              
                                 1
                                 
                                    
                                       λ
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              f
                              ⁎
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                              
                              and 
                              
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                              f
                              =
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              f
                              ⁎
                              
                                 
                                    H
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                              0
                              ⩽
                              j
                              <
                              J
                           
                        
                      where 
                        
                           
                              H
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              G
                           
                           
                              j
                           
                        
                      are finite impulse response (FIR) filters of quadratic spline wavelets with 
                        
                           
                              2
                           
                           
                              j
                           
                        
                        −
                        1
                      zeros and 
                        
                           
                              λ
                           
                           
                              j
                           
                        
                      is the normalization factor for quadratic wavelets.

(1) Scale J
                  

As the length of codon sequence 
                        C
                        =
                        
                           
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              1
                              ⩽
                              i
                              ⩽
                              N
                           
                        
                      is N, it extends to odd symmetry for the boundary continuity; 
                        
                           
                              (
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                              −
                              N
                              /
                              2
                              ⩽
                              j
                              ⩽
                              3
                              N
                              /
                              2
                           
                        
                        =
                        
                           
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           
                              1
                              ⩽
                              i
                              ⩽
                              N
                           
                        
                     , 
                        
                           
                              c
                           
                           
                              j
                           
                        
                        =
                        
                           
                              c
                           
                           
                              1
                              −
                              j
                           
                        
                      for 
                        −
                        N
                        /
                        2
                        <
                        j
                        ⩽
                        0
                     , 
                        
                           
                              c
                           
                           
                              j
                           
                        
                        =
                        
                           
                              c
                           
                           
                              2
                              N
                              +
                              1
                              −
                              j
                           
                        
                      for 
                        −
                        N
                        <
                        j
                        ⩽
                        3
                        N
                        /
                        2
                     . The maximum scale is 
                        
                           
                              J
                           
                           
                              max
                           
                        
                        =
                        
                           
                              log
                           
                           
                              2
                           
                        
                        (
                        N
                        )
                        +
                        1
                      as 
                        
                           
                              2
                           
                           
                              
                                 
                                    J
                                 
                                 
                                    max
                                 
                              
                           
                        
                        =
                        2
                        N
                     . The more the scale increases, the more the influence of neighboring singularities increases over scales. Therefore, our method limits the scale so that the maximum covering region of the wavelet filter becomes 25% of the length of the codon sequence.
                        
                           (37)
                           
                              J
                              =
                              
                                 ⌊
                                 
                                    
                                       log
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       1
                                       3
                                    
                                    
                                       (
                                       
                                          N
                                          4
                                       
                                       −
                                       
                                          ⌊
                                          
                                             
                                                T
                                                a
                                                b
                                             
                                             2
                                          
                                          ⌋
                                       
                                       )
                                    
                                    +
                                    1
                                    )
                                 
                                 ⌋
                              
                              
                              for 
                              2
                              ⩽
                              J
                              ⩽
                              6
                              
                              (
                              J
                              =
                              1
                               for 
                              J
                              <
                              2
                              ,
                              
                              J
                              =
                              6
                              
                              for 
                              J
                              >
                              6
                              )
                           
                        
                      
                     Tab is 
                        T
                        a
                        b
                        =
                        max
                        (
                        |
                        H
                        |
                        ,
                        |
                        G
                        |
                        )
                     , which is the maximum among the lengths of two filters H, G.

(2) Support region 
                     
                        [
                        a
                        ,
                        b
                        ]
                     
                  

To determine the support region of a wavelet filter, we analyzed the frequency response 
                        
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              δ
                              (
                              n
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                     , 
                        
                           
                              (
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              δ
                              (
                              n
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                      about the impulse signal 
                        δ
                        (
                        n
                        )
                      and the local maxima response 
                        
                           
                              (
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    LM
                                 
                              
                              δ
                              (
                              n
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                      (Fig. 12
                     ). The support region of 
                        
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              δ
                              (
                              n
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                      increases exponentially over the scales; however, the magnitude of 
                        
                           
                              (
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              δ
                              (
                              n
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                      diminishes (Fig. 12(a)).

The wavelet signal 
                        
                           
                              W
                           
                           
                              
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                           
                        
                        f
                      for a signal f falls under the support region of 
                        
                           
                              S
                           
                           
                              
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                           
                        
                        f
                     . Because the wavelet signals in random circular angles fall under the support regions of many coarse signals, the support region of 
                        
                           
                              S
                           
                           
                              
                                 
                                    2
                                 
                                 
                                    j
                                 
                              
                           
                        
                        f
                      is barely suitable for the support regions [
                        a
                        ,
                        b
                     ] for estimating the propagation of local maxima across scales.

We identified the positions of local modulus maxima 
                        
                           
                              (
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    LM
                                 
                              
                              δ
                              (
                              n
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                      of 
                        δ
                        (
                        n
                        )
                      and determined the regions over the scales as the support region. 
                        
                           
                              (
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    LM
                                 
                              
                              δ
                              (
                              n
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                      propagates to the right over the scales (Fig. 12(c)). And their positions 
                        
                           
                              (
                              p
                              (
                              j
                              )
                              )
                           
                           
                              1
                              ⩽
                              j
                              ⩽
                              J
                           
                        
                      are shown in Fig. 12(d). They can be represented as an approximate polynomial expression as follows:
                        
                           (38)
                           
                              p
                              (
                              j
                              )
                              =
                              
                                 round
                              
                              
                                 (
                                 0.0417
                                 
                                    
                                       j
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 0.3056
                                 
                                    
                                       j
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 1.0417
                                 
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 0.7540
                                 j
                                 +
                                 1
                                 )
                              
                           
                        
                      Consequently, the support region of 
                        [
                        a
                        ,
                        b
                        ]
                      is 
                        [
                        0
                        ,
                        p
                        (
                        j
                        )
                        ]
                     .

@&#REFERENCES@&#

