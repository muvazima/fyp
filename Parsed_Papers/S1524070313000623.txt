@&#MAIN-TITLE@&#Deformation similarity measurement in quasi-conformal shape space

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel framework for analysis and characterization of shape deformation.


                        
                        
                           
                           A novel quasi-conformal metric to classify the deformations in shape space.


                        
                        
                           
                           Classification of the left ventricle deformation in myopathic patients.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Shape space

Shape deformation

Riemannian metric

@&#ABSTRACT@&#


               
               
                  This paper presents a novel approach based on the shape space concept to classify deformations of 3D models. A new quasi-conformal metric is introduced which measures the curvature changes at each vertex of each pose during the deformation. The shapes with similar deformation patterns follow a similar deformation curve in shape space. Energy functional of the deformation curve is minimized to calculate the geodesic curve connecting two shapes on the shape space manifold. The geodesic distance illustrates the similarity between two shapes, which is used to compute the similarity between the deformations. We applied our method to classify the left ventricle deformations of myopathic and control subjects, and the sensitivity and specificity of our method were 88.8% and 85.7%, which are higher than other methods based on the left ventricle cavity, which shows our method can quantify the similarity and disparity of the left ventricle motion well.
               
            

@&#INTRODUCTION@&#

Recently, the scanning technologies, such as Magnetic Resonance Imaging, and Positron Emission Tomography, have been advancing rapidly, many of which can be used to capture motions of dynamic objects, such as cardiac motion, face expressions, gestures. A new grand challenge arises in analyzing this type of temporal motion data, especially when there is a necessity to visualize and compare the deformation behavior across subjects. Appropriate deformable shape analysis techniques are of utmost important for this type of time-varying shape comparison and classification. From a physical point of view, the behavior of shapes is governed by physical principles. Therefore, physically based approaches, such as deformable models, are employed to approximate the object deformation by minimizing the summation of the deformation energy under the constraint of smoothness of the model in the Lagrangian setting [1]. Then, the analysis of the derived deformable model can be achieved through finite element analysis.

In contrast, from a geometric point of view, in order to support efficient shape characterization, a higher level of shape abstraction and information reduction is necessary. In machine vision techniques, a shape descriptor extracts a geometric feature from the shape, which is either global feature such as boundary or volume of the shape [2], convex-hull packing [3], or a local feature such as mean or Gaussian curvature and edge length [4]. Then, an energy functional based on the shape descriptor is minimized to classify the shapes. The modern geometry introduces shape space [5,6], where coordinates of points in this space represent some generalized properties related to various geometrical properties. In other words, a shape space is established such that each surface group relates to the same point in shape space. This inspires us to innovate the geometry-based approaches for dynamic shape analysis and shape deformation classification.

In shape space, a deformation sequence is shown by a curve. The geodesic distance between two points yields the similarity between two shapes according to the property which shape space preserves. Lipman et al. [7] estimate the deformation between two isometric manifolds by minimizing a geometric expressing functional. Huang et al. [8] suggest a constrained energy function based on the gradient domain techniques for deformation estimation. Zhou et al. [9] introduce the Volumetric Graph Laplacian technique to minimize a quadratic energy function preserving the volumetric details during the 3D deformation. Huang et al. [10] present a geometrical potential function with constant stiffness matrix to speed up the deformation approximation. Funck et al. [11] minimize an energy function based on the divergence free vector field to get a smooth, volume preserving deformation. Xu et al. [12] deal with the deformation as gradient field interpolation, and propose a novel shape interpolation approach based on the Poisson equation. However, all these methods directly estimate one diffeomorphism between two shapes by minimizing an energy functional under some constraints, which increases the inconsistency and instability of these methods, especially, in high-dimensional shape spaces.

To address this problem, Kilian et al. [13] present a geometric structure for isometric deformations, which encodes all smooth groups of diffeomorphisms mapping two objects together. The desired characteristics to which shape space is invariant can be induced by choosing an appropriate geometric structure. During the deformation, the Gaussian curvature at each point on the manifold may change according to the deformation characteristics. Based on the spectral geometry, the eigenvalues of the Laplace–Beltrami operator can serve as numerical fingerprints of 2D or 3D manifolds [14], which can also be used to build shape space invariant to isometric deformations. Completely invariant to the conformal transformations, a conformal structure based on the period matrix and related algorithms to calculate the period matrix for manifolds with arbitrary topologies are introduced in [15,16]. Wang et al. [17] further provide a 3D matching framework based on the least squares conformal maps. To induce conformal mappings in 2D and quasi-conformal mappings in 3D, the Green Coordinates [18] are used in the cage-based space deformation estimation. Hurdal et al. [19] and Haker et al. [20] computed quasi-conformal and conformal maps of the cerebral cortex, respectively.

Continuous Ricci flow [21] conformally deforms a Riemannian metric on a smooth surface such that the Gaussian curvature evolves like a heat diffusion process. Eventually, the Gaussian curvature becomes constant and the limiting Riemannian metric is conformal to the original one. In discrete case, the circle packing metric [22] determines the discrete Gaussian curvature, and the discrete Ricci flow [23,24] conformally deforms the circle packing metrics with respect to the Gaussian curvatures. In [25], the geodesic lengths of homotopy classes, measured by Hyperbolic Uniformization metric, is used to determine the coordinates of each conformal class in the Teichmüller shape space to classify the shapes with negative Euler number. In fact, surfaces with the same conformal class share the same Uniformization metric and can be used to classify the surfaces [26]. Some Researchers use the surface Ricci flow method to compute the Teichmüller shape descriptor and analyze abnormalities in brain cortical morphometry, e.g. in patients with Alzheimers disease [27].

In the real world, the deformation characteristic is determined by the elasticity of the material structure undergoing the deformation. Zeng et al. [28] conducted a series of experiments to verify whether natural surface deformations are conformal. They reported that isometric or conformal mappings are rare in the real world, and diffeomorphisms between surfaces which are induced by natural deformations are quasi-conformal mappings. The diffeomorphisms are complex value functions which have one-to-one correspondence to the space of Beltrami coefficients. This one-to-one correspondence can be used for shape analysis between registered surfaces [29,30], as the space of Beltrami coefficients is a simpler functional space that captures the essential features of surface maps. Lui et al. [31] propose a simple representation of surface diffeomorphisms using Beltrami coefficients to facilitate the optimization of surface registrations. Their method reconstructs a unique surface map using Beltrami coefficients and Beltrami Holomorphic Flow, and converts the variational problems of diffeomorphisms to that of Beltrami coefficients. Also, Zeng et al. [28] propose an algorithm to register surfaces with large deformations using quasi-conformal curvature flow method. Their method can circumvent the local minima with appropriate normalization conditions. In the study of anatomical configurations, one should consider the anatomical differences across subjects in order to increase the statistical analysis accuracy within anatomically defined regions of interest. The Large Deformation Diffeomorphic Metric Mapping (LDDMM) method [32] provides diffeomorphisms to map anatomical configurations to extrinsic atlas coordinates. Therefore, the anatomical variations between different configurations are removed and the group-wise analysis can be carried out across different anatomic regions, e.g. enhancement of functional data of medial temporal lobe (MTL), and detection of shape abnormality of the left hippocampus in patients with dementia of the Alzheimer type [33,34].

In this study, we employ the structure proposed in [13], in which the geometrical properties of the deformations can be enforced by choosing a suitable metric in shape space. We present a novel quasi-conformal metric to classify and comparatively analyze the deformations which are following the transformations which are not rigid, iso-metric or conformal. This metric is a symmetric form and utilizes the local changes of curvature to measure the similarity between deformations. One challenge in development of the quasi-conformal geometry is to compute effective numerical quasi-conformal mappings. Although there are some numerical quasi-conformal mapping techniques in the literature solving differential equations with finite elements, they deal with simple domains and cannot be applied on general regions. Zeng et al. [35] propose an algorithm to numerically compute the quasi-conformal mapping on general Riemann surfaces of any genus. The framework we utilize in this study numerically minimizes an energy function to find the geodesic curve connecting two models in the shape space manifold. This minimization process can be carried out within the local variations of the intermediate models and will converge to the geodesic curve in a linear time with respect to the number of intermediate models which can be applied on any surface. This framework is very effective for the classification of deformations with various local curvature changes and is not computationally expensive, in contrast, some metrics such as Weil-Peterson metric [36] are difficult to estimate. For example, Weil-Peterson metric is a Riemannian metric with negative sectional curvature, in which estimation of Weil-Peterson curvature is difficult due to the need to work with the operator 
                        
                           D
                           =
                           -
                           2
                           
                              
                                 (
                                 Δ
                                 -
                                 2
                                 )
                              
                              
                                 -
                                 1
                              
                           
                        
                     , where 
                        
                           Δ
                        
                      is the Laplacian operator [37].

One of the applications of this deformation classification framework is to analyze the deformation of the left ventricle in myopathic patients. Cardiomyopathy refers to a family of diseases which cause dilation or hypertrophy in myocardium. In hypertrophic cardiomyopathy (HCM) a portion of myocardium, e.g. free wall, becomes thickened, which reduces stroke volume and increases the risk of arrhythmia and sudden cardiac death, especially in children. HCM is usually detected by echocardiogram or Cardiac Magnetic Resonance imaging (CMR), which detect the physical properties of the left ventricle wall [38]. However, navigation through sequential poses of a 3D deformation needs highly experienced cardiologists, which increases subjectivity in the analysis. This urges a deformation analysis method which classifies the 3D heart deformations [39]. Certain local shape descriptors such as Strain Analysis, Mean and Gaussian Curvature, Shape Index, Shape Spectrum, and Wall Thickness can provide rich information for the cardiac analysis [40]. We use the local Gaussian curvature changes to classify the LV myopathic and healthy subjects.

Our contributions in this paper can be summarized as follows,
                        
                           •
                           We propose a novel framework for the effective analysis of dynamic shapes and shape deformations.

We introduce a novel quasi-conformal metric to characterize and classify the quasi-conformal deformations in shape space.

We apply our classification approach on the left ventricle (LV) deformation of some patients with hypertrophic cardiomyopathy (HCM). The sensitivity and specificity of our method for classification of myopathic and control subjects are higher than other methods based on the LV cavity, mean radial displacement and mean radial velocity [41].

The remainder of this paper is organized as follows. The quasi-conformal metric and the classification framework are introduced in Section 2; the results on the synthetic and left ventricle datasets are illustrated in Sections 3 and 4, followed by conclusion in Section 5.


                     Shape space: Let 
                        
                           G
                        
                      be the space of all immersions with the same connectivity. The deformation of the immersion 
                        
                           M
                        
                      constitutes a curve in this space. Therefore, the tangent vector of X, which belongs to the tangent plane of 
                        
                           G
                        
                      at point 
                        
                           M
                        
                     , assigns a vector 
                        
                           
                              
                                 X
                              
                              
                                 p
                              
                           
                        
                      to each point p on 
                        
                           M
                        
                     . Given a smooth deformation of all points on 
                        
                           M
                        
                     , the vector field 
                        
                           X
                           (
                           t
                           )
                        
                      is 
                        
                           ∂
                           p
                           (
                           t
                           )
                           /
                           ∂
                           t
                        
                      for all points p. Depending on the deformation characteristics in which we are interested, various shape spaces having different intrinsic geometries may be defined.

Let 
                           
                              Σ
                           
                         be a simplicial complex, and a mapping 
                           
                              f
                              :
                              Σ
                              →
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           
                         embed 
                           
                              Σ
                           
                         to the Euclidean space, then 
                           
                              M
                              =
                              (
                              Σ
                              ,
                              f
                              )
                           
                         is a triangular mesh. Let 
                           
                              Δ
                              pqr
                           
                         be a face of M and 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    p
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    q
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    r
                                 
                              
                              }
                           
                         be their corresponding deformations.

In the Riemannian geometry, each metric is defined as the inner product of two vector fields. Suppose two different deformation fields as X and Y, the distance between them are measured by 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                ,
                                                Y
                                             
                                          
                                       
                                    
                                 
                              
                           
                         in shape space. Based on the Riemannian metric definition, some geometric structures have been established to provide the Isometric and Rigid metrics [13]. The as Rigid as possible metric is defined as,
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                      ,
                                                      Y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       M
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                p
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                p
                                             
                                          
                                          ,
                                          
                                             
                                                Y
                                             
                                             
                                                p
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                           
                         are the Rigid component of the deformations. In contrast, if the deformation is strictly Isometric, the length of every edge on the immersion M remains unchanged. Thus the following relation holds,
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                p
                                             
                                          
                                          -
                                          
                                             
                                                X
                                             
                                             
                                                q
                                             
                                          
                                          ,
                                          p
                                          (
                                          t
                                          )
                                          -
                                          q
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        and the as Isometric as possible metric is defined as follows,
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                      ,
                                                      Y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       M
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          p
                                          ,
                                          q
                                          )
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                p
                                             
                                          
                                          -
                                          
                                             
                                                X
                                             
                                             
                                                q
                                             
                                          
                                          ,
                                          p
                                          -
                                          q
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                p
                                             
                                          
                                          -
                                          
                                             
                                                Y
                                             
                                             
                                                q
                                             
                                          
                                          ,
                                          p
                                          -
                                          q
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              (
                              p
                              ,
                              q
                              )
                           
                         is the edge of M. Here we propose a quasi-conformal metric within this structure. Let 
                           
                              Δ
                              pqr
                           
                         and 
                           
                              Δ
                              
                                 
                                    p
                                 
                                 
                                    ́
                                 
                              
                              
                                 
                                    q
                                 
                                 
                                    ́
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    ́
                                 
                              
                           
                         be two triangles such that,
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   p
                                                   (
                                                   t
                                                   +
                                                   Δ
                                                   t
                                                   )
                                                   =
                                                   p
                                                   (
                                                   t
                                                   )
                                                   +
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   q
                                                   (
                                                   t
                                                   +
                                                   Δ
                                                   t
                                                   )
                                                   =
                                                   q
                                                   (
                                                   t
                                                   )
                                                   +
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   =
                                                   r
                                                   (
                                                   t
                                                   +
                                                   Δ
                                                   t
                                                   )
                                                   =
                                                   r
                                                   (
                                                   t
                                                   )
                                                   +
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

During the conformal deformation, the angle between two edges of each triangle would be preserved. Generalizing this idea, one may try to preserve the proportion of two edge lengths of each triangle during the deformation. In the Euclidean geometry, if the edge lengths of a triangle are multiplied by the same coefficient, the resulting triangle has the same angles as the original one; therefore,
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   -
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   t
                                                   )
                                                   -
                                                   q
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   -
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ‖
                                       p
                                       (
                                       t
                                       )
                                       -
                                       r
                                       (
                                       t
                                       )
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Eq. 4 yields the following relation,
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   -
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   t
                                                   )
                                                   -
                                                   q
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   t
                                                   )
                                                   -
                                                   q
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   -
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ́
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   t
                                                   )
                                                   -
                                                   r
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   t
                                                   )
                                                   -
                                                   r
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The numerator shows the changes of the squared edge length within 
                           
                              Δ
                              t
                           
                        . If both sides of the equal sign are divided by 
                           
                              Δ
                              t
                           
                        , and also 
                           
                              Δ
                              t
                              →
                              0
                           
                        ; then, the numerator would be equal to the derivative of the squared edge length. By differentiating 
                           
                              
                                 
                                    
                                       
                                          p
                                          (
                                          t
                                          )
                                          -
                                          q
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          p
                                          (
                                          t
                                          )
                                          -
                                          r
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        , Eq. 6 will be derived,
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                t
                                                )
                                                -
                                                q
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      p
                                                   
                                                
                                                (
                                                t
                                                )
                                                -
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      q
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       ‖
                                       p
                                       (
                                       t
                                       )
                                       -
                                       q
                                       (
                                       t
                                       )
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                p
                                                (
                                                t
                                                )
                                                -
                                                r
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      p
                                                   
                                                
                                                (
                                                t
                                                )
                                                -
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   (
                                                   t
                                                   )
                                                   -
                                                   r
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        from which 
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              (
                              X
                              )
                           
                         is achieved as follows,
                           
                              (7)
                              
                                 
                                    
                                       T
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   -
                                                   q
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      p
                                                      -
                                                      r
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   p
                                                   -
                                                   r
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      p
                                                      -
                                                      q
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Likewise, 
                           
                              
                                 
                                    T
                                 
                                 
                                    q
                                 
                              
                              (
                              X
                              )
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    r
                                 
                              
                              (
                              X
                              )
                           
                         are calculated. To preserve angles of each triangle 
                           
                              Δ
                              pqr
                           
                        , a similarity transformation requires that all 
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              (
                              X
                              )
                              ,
                              
                                 
                                    T
                                 
                                 
                                    q
                                 
                              
                              (
                              X
                              )
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    r
                                 
                              
                              (
                              X
                              )
                           
                         vanish during deformation. Thus a conformal metric is obtained as follows,
                           
                              (8)
                              
                                 
                                    
                                       T
                                    
                                    
                                       Δ
                                       pqr
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                p
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                    
                                 
                                 +
                                 |
                                 
                                    
                                       T
                                    
                                    
                                       q
                                    
                                 
                                 (
                                 X
                                 )
                                 |
                                 +
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                r
                                             
                                          
                                          (
                                          X
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                      ,
                                                      Y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       M
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          Δ
                                          pqr
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       Δ
                                       pqr
                                    
                                 
                                 (
                                 X
                                 )
                                 ·
                                 
                                    
                                       T
                                    
                                    
                                       Δ
                                       pqr
                                    
                                 
                                 (
                                 Y
                                 )
                                 .
                              
                           
                        
                     

Although this metric preserves characteristics of conformal deformations, but the shape space geometry of these conformal deformations cannot be reconciled to the characteristics of some non-conformal deformations. This necessitates a quasi-conformal shape space which better preserves these non-conformal deformation characteristics. Let 
                           
                              Δ
                              
                                 
                                    K
                                 
                                 
                                    p
                                 
                              
                           
                         be the changes of curvature at the vertex p during deformation, thus 
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              (
                              X
                              )
                           
                         is redefined as follows,
                           
                              (10)
                              
                                 
                                    
                                       T
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 X
                                 )
                                 =
                                 Δ
                                 
                                    
                                       K
                                    
                                    
                                       p
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   -
                                                   q
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         q
                                                      
                                                   
                                                
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      p
                                                      -
                                                      r
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   p
                                                   -
                                                   r
                                                   ,
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      p
                                                      -
                                                      q
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        and by substituting the new 
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                              (
                              X
                              )
                           
                         from Eq. 10 in Eq. 8 and Eq. 9 the final quasi-conformal metric is achieved which is a symmetric form. Since this metric contains a conformal term extracted from Eq. 7, there are some non-vanishing deformation fields X, e.g. conformal deformation fields, such that 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                X
                                                ,
                                                X
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              0
                           
                        . To avoid this, we can add a regularization term, e.g. 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         shape metric to the proposed quasi-conformal metric [13],
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                      ,
                                                      Y
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       M
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                p
                                             
                                          
                                          ,
                                          
                                             
                                                Y
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       A
                                    
                                    
                                       p
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    A
                                 
                                 
                                    p
                                 
                              
                           
                         is one-third of the area of all triangles adjacent to the vertex p. Please note that we only use the deformations which are not iso-metric or conformal, thus we do not add 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         shape metric, and use the original quasi-conformal metric (Eq. 9) in this paper. In this quasi-conformal metric, changes in the curvature at each vertex are considered such that each vertex with lower curvature changes has less effect in the metric. The Gaussian curvature of vertex p is approximated as,
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       p
                                    
                                 
                                 =
                                 2
                                 π
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          Δ
                                          pqr
                                          ∈
                                          M
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                    
                                    
                                       qr
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    θ
                                 
                                 
                                    p
                                 
                                 
                                    qr
                                 
                              
                           
                         is the corner angle of 
                           
                              Δ
                              pqr
                           
                        . In order to find the geodesic on the shape space manifold, the energy functional 
                           
                              E
                              (
                              M
                              )
                              =
                              ∫
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                   ,
                                                   X
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    M
                                 
                              
                              dt
                           
                         of the curve connecting each pair of meshes is minimized to achieve the geodesic line connecting two end points on the shape space manifold. To estimate the length of curve in Euclidean space, we can take some samples from the curve and inscribe a polyline to the curve, and measure the curve length as summation of the length of the line segments. As we refine the polyline the estimated length converges to the true length of the curve. Here, we use the same strategy in Riemannian space, by taking some sample shapes 
                           
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    M
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           
                         and the segments 
                           
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    X
                                 
                                 
                                    n
                                 
                              
                           
                        . For our proposed quasi-conformal metric, we utilize the symmetric energy function of the polyline M as,
                           
                              (12)
                              
                                 E
                                 (
                                 M
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        which yields the sum of squared lengths of the line segments. In fact, this energy function is locally minimized and the polyline converges to the geodesic, once we utilize a scaled arc length parameterization [42]. We use the quasi-Newton method to minimize the energy functional and estimate the geodesic line by allowing the intermediate vertices to change in order to minimize the length functional.

An algorithm is introduced to classify the shape deformation. Fig. 1
                         shows the pipeline of our algorithm. In first step, the corresponding points are determined on the intermediate meshes at sequential time points. In synthetic datasets, we know the point correspondence beforehand, and this step can be skipped, but in the experimental datasets, we employ a non-rigid registration method to find the corresponding points, as described in Section 4. The following describes the rest of the pipeline in details.

To estimate the deformation of an object some time-varying samples should be taken from the object during the deformation. In order to increase the temporal resolution of the sampling, the interpolation step is necessary. The algorithm to interpolate the deformation is as follows.
                              
                                 
                              
                           
                        

Let 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                            be two sequential meshes sampled during the deformation. We aim to increase the temporal resolution by interpolating n intermediate meshes 
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                            between 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                           . First, the average of 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                              
                            is considered as an initial intermediate point. Then by minimizing the energy functional 
                              
                                 E
                                 (
                                 M
                                 )
                              
                           , the intermediate point is determined more accurately reflecting the applied metric. In the next step, some other initial intermediate points may be entered to the energy functional and all the intermediate meshes will be finally optimized together. To accelerate the optimization process, we employ a multi-resolution framework as follows [13].

At resolution k, we begin with the two end meshes, 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       k
                                    
                                 
                              
                           , and estimate the intermediate meshes, 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                    
                                       k
                                    
                                 
                              
                           , as mentioned above. Then, we increase the resolution of 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                    
                                       k
                                    
                                 
                              
                            such that we project each vertex p added to 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                            onto mesh 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                              
                           , and find face f containing its projection point p′. Finally, the barycentric coordinates of p′ with respect to face f are used to initialize the location of the newly added vertex with respect to the intermediate meshes at resolution 
                              
                                 k
                                 +
                                 1
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       n
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           . These refined meshes initialize the optimization of the energy functional at resolution 
                              
                                 k
                                 +
                                 1
                              
                           . As a result, the intermediate refined meshes can be obtained more reliably compared with interpolating the high resolution intermediate meshes without a multi-resolution framework. In our implementation, we use three resolutions during the interpolation process. Please note, the temporal interpolation is not a necessary step in the pipeline, but if the temporal resolution is poor, we can increase it, as mentioned. Even in Euclidean space, one can better judge the difference between two curves with enough number of intermediate points rather than just few intermediate points.

Two deformations are comparable, if their deformation curves are transferred to the same point of shape space. In the Euclidean shape space, this is simple and will not change the curve, but in non-Euclidean shape space, the parallel transport 
                           [43] approach is employed for the deformation transfer (Fig. 2
                           ).

Let M be an immersion on the shape space manifold 
                              
                                 G
                              
                           . We sample the deformation path at equidistant points 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                           , thus the line segments connecting each pair of sequential samples will be 
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 Δ
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            (i.e., a discrete tangent vector). The deformation of M is transferred to the point 
                              
                                 
                                    
                                       N
                                    
                                    
                                       0
                                    
                                 
                              
                            such that 
                              
                                 
                                    
                                       M
                                    
                                    
                                       0
                                    
                                 
                              
                            is mapped to 
                              
                                 
                                    
                                       N
                                    
                                    
                                       0
                                    
                                 
                              
                           .

Let the curve 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 :
                                 [
                                 0
                                 
                                 1
                                 ]
                                 →
                                 G
                              
                            be the geodesic line on the shape space manifold connecting 
                              
                                 
                                    
                                       M
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 0
                                 )
                              
                            to 
                              
                                 
                                    
                                       N
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 1
                                 )
                              
                           , and 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 )
                              
                            be a vector field along 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                              
                            at time t. 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 )
                              
                            is parallel transferred along the curve 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                              
                           , if the angle 
                              
                                 
                                    
                                       α
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      (
                                                      t
                                                      )
                                                      ,
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             0
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                 
                              
                            is constant during the transfer, provided 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 )
                              
                            rotates minimally around 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 t
                                 )
                              
                           . We take some samples along 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                              
                            and calculate 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 )
                              
                            at the discrete time points as follows,
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                )
                                                -
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           subject to:
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                         ,
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                0
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                           Once 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 t
                                 )
                              
                            is transferred along 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 1
                                 )
                              
                            is achieved (Fig. 2.a).

In the second step, the geodesic line 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                              
                            connecting 
                              
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                              
                            is calculated and the vector 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 0
                                 )
                              
                            is transferred along it to achieve 
                              
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 1
                                 )
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 1
                                 )
                              
                            (Fig. 2b). We keep transferring deformation segments until all the segments are transferred [13].

To compare the similarity between two deformations, we determine the similarity between the corresponding intermediate poses after transferring the deformations to the same region of shape space. Let 
                              
                                 M
                                 =
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                M
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 N
                                 =
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                            be two deformations, and 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                              
                            be their ith intermediate poses after temporal interpolation and deformation transfer. We measure the geodesic distance between each pair of corresponding poses by minimizing the functional energy in Eq. 12, and then, measure the deformation similarity by adding the geodesic distances between all pairs of the corresponding intermediate poses, that’s,
                              
                                 (13)
                                 
                                    similarity
                                    (
                                    M
                                    ,
                                    N
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    dis
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 dis
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            is the geodesic distance between 
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                              
                           .

Our aim is to classify different deformations into some classes based on the deformation similarity metric. We employ the k-means clustering algorithm to classify the deformations into k classes, 
                              
                                 S
                                 =
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           , such that the sum of squared with-in cluster distances is minimized,
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             S
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    similarity
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                              
                            is the intrinsic mean of the deformations 
                              
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                           ’s in class 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                              
                           . Intrinsic mean 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                              
                            is calculated at each iteration based on the similarity metric using the following algorithm [44],
                              
                                 
                              
                           
                        

As mentioned in Section 1, the rigid, iso-metric, or conformal transformation are so rare in the real world. Since this study aims at classification of the deformations which follow natural transformations, we generated some synthetic deformations which are not rigid, iso-metric or conformal. In order to generate the synthetic datasets, we first generated six genus zero shapes (Fig. 3
                     a), as the initial shapes whose point correspondence was known. Then, each of the initial shapes was deformed in accordance with eight known deformations, as shown in Fig. 3b–i. Therefore, in total, we generated 48 deformations each including three poses. Fig. 3b–i show the eight deformations applied on a torus at three sequential time points, such that the leftmost pose illustrates the pose at time point zero.

We compare the performance of our quasi-conformal metric with the isometric metric (Eq. 3). The first and last poses of each deformation serve as input poses, and the middle pose is interpolated by the temporal interpolation algorithm. Fig. 4
                        a and b show the interpolation of the middle pose of the deformation in Fig. 3f by our metric and the isometric metric, respectively. The interpolation error at each vertex is shown by different color. As seen, the quasi-conformal metric results in more accurate interpolation than the isometric one. Fig. 4c illustrates the interpolation error of each deformation separately. Each error bar in Fig. 4c shows the mean and standard deviation of the interpolation error for each deformation applied on the six initial shapes (Fig. 3a). As seen, the quasi-conformal metric results in lower error than isometric metric for all the deformations.

In order to compare the performance of our metric with the isometric one for deformation transfer, we deformed a sphere as shown in Fig. 5
                        a, and then, transferred its deformation to an ellipsoid such that the ellipsoid should follow the sphere’s deformation at two sequential time points as shown in Fig. 5b. Fig. 5c and d show how well the ellipsoid can follow the deformation using both metrics. As seen, the deformation transfer error using our metric (Fig. 5c) is lower than that of the isometric metric. The deformation transfer error at each vertex is shown by different color.

We applied our deformation classification approach on the 48 deformations, and measured sensitivity and specificity of the classification. The point correspondence can be skipped, as it is known in synthetic datasets. We interpolated three intermediate poses between two sequential poses, which amounts to nine poses for each deformation. Then, the deformations are transferred into one part of shape space, and classified using k-means clustering into eight separate classes based on the quasi-conformal metric, as mentioned before.


                        Table 1
                         demonstrates the mean of sensitivity and specificity of the quasi-conformal metric compared with conformal, isometric and rigid metrics. We calculate the confusion matrix for each class, produce the final confusion matrix as the average of all the confusion matrices [45], and then calculate the sensitivity and specificity as follows,
                           
                              (15)
                              
                                 sensitivity
                                 =
                                 
                                    
                                       TP
                                    
                                    
                                       TP
                                       +
                                       FN
                                    
                                 
                                 ,
                                 
                                 specificity
                                 =
                                 
                                    
                                       TN
                                    
                                    
                                       FP
                                    
                                 
                                 +
                                 TN
                                 .
                              
                           
                        where 
                           
                              TP
                              ,
                              TN
                              ,
                              FP
                           
                         and FN indicate the true positive, true negative, false positive and false negative of the average confusion matrix, respectively. Here, sensitivity for each deformation type shows the proportion of actual deformations of that type which are correctly classified as such, and specificity illustrates the proportion of actual deformations of the other types which are correctly classified as such. As seen in Table 1, our metric outperforms other metrics.

We also measured the amount of time each step of the pipeline takes for all 48 deformations in Fig. 3 on a Pentium PC with 3GHz CPU speed and 4GB RAM memory. Table 2
                         illustrates the mean and standard deviation (SD) of execution time for each step separately.

High dimensional shape space makes the deformation comparison more complicated. As a result, high dimensional shape space can be projected onto two or three dimensional space such that distance between the projected deformation points reflect the similarity between the deformations in the original high dimensional space as determined by the similarity measure in Eq. 14. Towards this end, we build a distance matrix demonstrating distance of each pair of meshes using the proposed metric. Then, the MultiDimensional Scaling (MDS) method [46] is used to reduce dimensions of shape space and project deformations onto a 2D space. Let 
                           
                              M
                              =
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                              
                           
                         be n deformations. We define the similarity matrix 
                           
                              D
                           
                        , where 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         is the similarity between deformations i and j calculated using the above mentioned similarity metric. We minimize the difference between pair-wise distances on the high dimensional space, e.g. 
                           
                              dis
                              (
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        , and the distance between their corresponding points on the 2D space, e.g. 
                           
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              ‖
                           
                        , that’s,
                           
                              (16)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          <
                                          j
                                       
                                    
                                 
                                 
                                    
                                       (
                                       ‖
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       ‖
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     


                        Fig. 6
                         illustrates the projection result for all 48 deformations such that each point represents the projection of one deformation on the 2D plane and each color represents one of the eight type deformations in Fig. 3b–i, applied on the six initial shapes in Fig. 3a. We expect the shapes undergoing similar deformations to be projected close to each other, as their corresponding geodesic distance on shape space is shorter than other deformations. This can be observed in this experiment, that is to say, despite different initial shapes, the similar deformations are projected to the points (with the same color) close to each other.

To evaluate the noise resistance of the pipeline for measurement of deformation similarity, we add some noise to the deformations, classify the deformations using the k-means clustering algorithm based on the proposed deformation similarity measure, and measure the percentage of deformations classified in the same class before and after adding noise. Let 
                           
                              
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          k
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         be the deformation sets classified in class i before and after adding noise, accordingly. Eq. 17 illustrates the percentage of deformations classified in the same class before and after adding noise,
                           
                              (17)
                              
                                 τ
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               k
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        Table 3
                         represents the algorithm performance against additive noises with different distributions, which were added to the 48 deformations. As seen, the percentage of correctly classified deformations is acceptable up to 10% of additive noise with uniform and Gaussian distribution.

@&#EXPERIMENTAL RESULTS@&#

We applied our classification method on the left ventricle CT images of some patients with hypertrophic cardiomyopathy (HCM) and some control subjects, and compared their deformation during one heart cycle.

Nine myopathic subjects whose cardiac abnormalities were verified by cardiologists to be on the left ventricle free wall, and fourteen control subjects participated in this study. The CT (Computed Tomography) scans of the heart during one heart cycle were acquired from the subjects with voxel size of 
                           
                              0.5
                              ×
                              0.5
                              ×
                              0.625
                           
                        
                        mm3, and tube voltage of 125kV, FOV=500mm (GE Medical Systems) (Fig. 7
                        ). Each dataset contains eight time points during one heart cycle (Fig. 8
                        ).

We apply our method on the left ventricle datasets to classify the myopathic and control left ventricle deformation. The pre-processing steps are as follows,
                           
                              1.
                              We use an extrinsic registration method based on Thin-Plate Splines [47] which uses the intensity information using sixteen landmarks selected on apex, epicardium and endocardium, and register the sequential LV images together. Please note that as we register sequential images to each other, the LV surface does not deform drastically and can be registered using TPS registration method with acceptable accuracy.

The Marching Cubes algorithm [48] is used to construct the LV mesh from the LV image at time point one. The appropriate threshold was determined by calibration across a retrospective set of CT scans.

Each extracted mesh is deformed using the deformation fields estimated by each registration in step 1, in order to construct the LV mesh at different time points, as well as to determine the point correspondence between the intra/inter subject meshes.

Each heartbeat cycle contains eight intermediate meshes, which are temporally interpolated using the quasi-conformal metric to produce three intermediate between each sequential time points, thus in total, we have 24 intermediate meshes for each deformation cycle. Fig. 9
                         illustrates the deformation path by projecting it onto 2D plane using MDS and the quasi-conformal metric. As can be seen, the deformation contains eight original meshes (Blue solid dots), and 24 intermediate meshes added using the temporal interpolation (Blue triangles). The poses at time points 7 and 3 correspond to the end of diastole and end of systole, respectively.

Since the myopathic areas of the subjects are on the free wall, we only consider the faces of the mesh which belong to the LV free wall, and concatenate them to form a large vector in 
                           
                              
                                 
                                    R
                                 
                                 
                                    3
                                    m
                                 
                              
                           
                        , where m vertices are selected on the free wall. Finally, the proposed approach was applied on the sequential deformation vectors of the subjects in order to classify the myopathic and control subjects’ left ventricle deformations.

Both left ventricle mesh generation and corresponding landmark selection steps might introduce some inaccuracies in the location of the corresponding vertices at different time points. However, as aforementioned, the proposed approach resists against additive noise well, and classifies the deformations accurately up to 10% additive noise. Thus, these accuracies in the vertex locations due the surface generation and landmark selection can be avoided well in our approach. Table 4
                         illustrates the sensitivity and specificity of our method, which are calculated as in Eq. 15. Our method shows better performance compared with other methods based on the LV cavity, mean radial displacement and mean radial velocity [41].

@&#CONCLUSION@&#

An algorithm is presented to classify and compare deformations based on a novel quasi-conformal metric in shape space. To make deformation paths intuitively comparable in shape space, the deformations are transferred to the same point of shape space. The synthetic and experimental results on the CT images of the left ventricle verify the performance of the metric. This method shows excellent resistance against additive noise. Note that if the temporal resolution of the poses is acceptable, the interpolation step can be skipped, thus the rest of the pipeline is executed in 
                        
                           O
                           (
                           
                              
                                 mn
                              
                              
                                 2
                              
                           
                           )
                        
                      time. Otherwise, to increase the temporal resolution a nonlinear function should be optimized, whose complexity is 
                        
                           O
                           (
                           mn
                           )
                        
                     , where n is the number of meshes, each having m vertices. Since each point of shape space corresponds to one mesh in 
                        
                           
                              
                                 R
                              
                              
                                 3
                                 m
                              
                           
                        
                     , we can easily retrieve the intermediate meshes [49]. To accelerate the algorithm, we employ the space refinement, in which the spatial resolution of meshes is increased iteratively, from coarser meshes to finer ones to interpolate the intermediate poses.

In this study, the shape space structure requires the triangulation consistency between sequential poses at different time points. In the synthetic datasets, we generated triangulations of some genus-0 (sphere) and genus-1 (torus) models without boundaries, and displaced the triangulations to generate the models at different time points of the deformations. As a result, the triangulation consistency exists in the synthetic datasets. However, the triangulation consistency cannot be preserved in the real datasets, if we extract the surface of the models, e.g. the epicardial and endocardial surfaces of the left ventricle at sequential time points, and generate the triangulation for each model, separately. A traditional way to generate a consistent (isomorphic) triangulations between two surfaces is to compute a parameterization between each 3D surface and a 2D parametric domain, e.g. topological disk, take samples in the parametric domain in order to generate a consistent 2D triangulation in a multi-resolution framework, and derive inverse mapped 3D vertices [50,51]. However, this method might involve an arbitrary graph cut which disrupts the continuity of the parameterization and makes it hard to construct a continuous map between two surfaces. To overcome this issue, Li et al. [52] propose an algorithm based on the intrinsic geometry structure of surfaces in order to estimate a quasi-conformal mapping between surfaces while reaching the global minimum distortion, which can register shapes undergoing large deformations. In fact, using the framework proposed in [52], one can integrate the quasi-conformal registration into the process.

In contrast, in this study, we first register the CT images of the left ventricle at different time points to the pose at the first time point to find the corresponding points using an intensity-based registration method, e.g. TPS, then extract the surface and triangulate the vertices of the first pose. Finally, we apply this triangulation to other poses at other time points, since we already know the point correspondences.

This method shows excellent resistance against the additive noise, added to the surface vertex locations, which, we believe, accounts for the registration accuracies. However, in order to investigate the effect of registration inaccuracies, we registered the intermediate LV poses with different number of landmarks using the TPS method, and examined the sensitivity and specificity of the method, as illustrated in Table 5
                     . The results show that TPS method has acceptable accuracy for 16 chosen landmarks. However, any other non-rigid registration method can be utilized in our framework, such as Advanced Normalization Tools (ANTS) [53], an intensity-based registration method which is available online and has acceptable registration accuracy [54,55].

One drawback of this method for the LV deformation classification is that it does not localize the myopathic area, as the proposed metric considers all the vertices together to measure the similarity. Some researchers used the LV thickness wall information to differentiate the abnormal patients from healthy ones [56]. The wall thickness measure can be utilized to localize the myopathic area, which will be investigated more in the future work.

@&#ACKNOWLEDGMENT@&#

The authors gratefully acknowledge the support of K.C. Wong Education Foundation, Hong Kong, and the National Science Foundation under the grants NSF IIS-0915933, NSF IIS-0937586 and NSF IIS-0713315.

@&#REFERENCES@&#

