@&#MAIN-TITLE@&#Enhancement and bias removal of optical coherence tomography images: An iterative approach with adaptive bilateral filtering

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A new speckle filters based on Gamma statistics is proposed for the enhancement of OCT images.


                        
                        
                           
                           With AUB filter, bias is estimated with a local ML estimator and removed from the adaptive bilateral filter output.


                        
                        
                           
                           With IAUB filter, an iterative approach further refines the AUB filter output.


                        
                        
                           
                           Experiments show that the proposed frameworks provide better performance compared to the state-of-the-art methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bilateral filtering

Denoising

Maximum likelihood estimation

Optical coherence tomography

Speckle noise

@&#ABSTRACT@&#


               
               
                  Optical coherence tomography (OCT) has continually evolved and expanded as one of the most valuable routine tests in ophthalmology. However, noise (speckle) in the acquired images causes quality degradation of OCT images and makes it difficult to analyze the acquired images. In this paper, an iterative approach based on bilateral filtering is proposed for speckle reduction in multiframe OCT data. Gamma noise model is assumed for the observed OCT image. First, the adaptive version of the conventional bilateral filter is applied to enhance the multiframe OCT data and then the bias due to noise is reduced from each of the filtered frames. These unbiased filtered frames are then refined using an iterative approach. Finally, these refined frames are averaged to produce the denoised OCT image. Experimental results on phantom images and real OCT retinal images demonstrate the effectiveness of the proposed filter.
               
            

@&#INTRODUCTION@&#

Optical coherence tomography (OCT) is a noninvasive imaging modality that yields high resolution images of tissue structures and cross-sectional imaging of many biological systems [1]. As an optical equivalent of ultrasound (US) imaging, it uses echoes of light rather than sound [2]. Major OCT applications include detection of eye diseases and skin disorders [3,4].

In ophthalmology, assessment and observation of visual ailments require details about the inner retinal structure of the eye. OCT images are used to visualize the morphological structures of the retina and iris macula and evaluate the retinal nerve fiber layer thickness in the peripapillary region as well as other inner tissue lines associated with the anterior and posterior sections of the eye [5]. The ophthalmologists can observe and measure the anatomical correspondence of the intra-retinal layers viz. retinal nerve fibre layer (RNFL), ganglion cell layer (GCL), inner-plexiform layer (IPL), inner-nuclear layer (INL), outer-plexiform layer (OPL), inner and outer segment of the photoreceptors (IS/OS), the retinal pigment epithelium (RPE) and choriocapillaris (CC)) by performing anterior and posterior imaging of the eye using OCT [6,7]. These are clinically important in case of many ophthalmic diseases such as early detection and diagnosis of eye diseases, including glaucoma, age-related macular degeneration, macular edema, and diabetic retinopathy.

Nevertheless, the visual quality of OCT images can be deteriorated by speckle noise arising due to the interference of photons that undergo multiple scattering in reverse and forward direction, when photons propagate inside tissue [8,9]. It is important to remove unwanted speckle noise from OCT images since the automated segmentation of the inner tissue lining of eye images (e.g., optic nerve head layers, retinal layers, drusens) and its measurement are clinically important for the diagnosis of eye diseases and noise can influence the automatic segmentation process [10]. Apart from OCT images, speckle noise reduction is a significant research topic in other imaging modalities such as synthetic aperture radar (SAR) and US images.

In the literature, various speckle reduction algorithms have been explored for OCT images. In [11], Rogowska et al. have discussed techniques such as image averaging, mean, median and Gaussian filters for removing unwanted components from OCT images. The Lee filter [12], Frost filter [13] and Kuan filter [14] are the most widely discussed spatial adaptive filters to attenuate speckle noise. Improved versions of the Lee and Frost filters are proposed in [15]. Computationally efficient speckle noise reduction algorithms using an adaptive Wiener filter [16] and diffusion filtering techniques [17–20] have also been proposed for speckle reduction.

In the past several methods are proposed for OCT denoising. A complex diffusion filter was proposed in [21] and its improved adaptive technique was discussed in [22]. A combined filter by integrating the benefits of PDE-based approach and the wavelet transform is employed in [23]. Multi-resolution based spatially adaptive discrete wavelet filter [24], complex wavelet filter [25], and curvelets filters [26] are other significant methods proposed in the literature to remove speckle noise. Ozcan et al. have compared various filters including non-orthogonal wavelet transform based filters together with enhanced Lee and adaptive Wiener filters for OCT speckle denoising [27]. I-divergence regularization approach [28] and general Bayesian estimations [29] have also been proposed for speckle reduction in OCT imaging. Moreover, different patch based non-local recovery paradigms have recently introduced for speckle noise reduction in OCT images [30–32].

A better statistical characterization of the observed (noisy) images can help in developing effective despeckling methods. In the literature, different statistical models such as Gaussian, Rayleigh and Log-normal have been investigated to address the restoration of speckled images [11,33]. In this work, a Gamma model is followed for multi-frame OCT images and a three parameter Gamma distribution function is used to fit the observed OCT data. Three parameter Gamma distribution is able to include several well known models such as exponential, Rayleigh, Gamma, Chi-square and normal distribution as subfamilies.

In this paper, we propose an adaptive and unbiased bilateral (AUB) filter to account for the Gamma characteristics of the data and then, incorporated the idea of iterative filtering to refine the AUB filter result. This iterative AUB (IAUB) filtering technique is performed on each single frame, and the outputs of the IAUB filter are averaged to obtain the final despeckled image. The excellent functioning of the proposed filter is well validated by experiments using both simulated and real OCT images and the simulations show that it provides better speckle removal without affecting noticeable structures in the image.

This paper is organized as follows: The noise model for OCT images is briefly described in Section 2, and the proposed methodology is presented in Section 3. Section 4 discusses the experimental results and the evaluation process. Finally, we conclude the paper in Section 5.

The quality of images obtained by any image acquisition system employing coherent wave fields is degraded by speckle noise, an insidious form of noise produced by the interference of waves with random phases [34,35]. The speckle noise manifests itself as a fast fluctuation of the detected intensity (or field envelope) over the spatial extent of the image, conveying a granular texture [36]. High-speed OCT imaging quality is restricted due to the presence of speckle noise [37]. With a large number of polarized quasimonochromatic waves with random phase, a fully developed speckle pattern is formed [38].

In [39], Goodman et al. find a relation for the speckle field using a Rayleigh distribution function. More attempts to model speckle patterns are found in the US literature than in the OCT literature. Despite the fact that a multiplicative model and empirical distributions with useful probabilistic models, e.g., Nakagami, generalized Nakagami, Weibull and Rician inverse Gaussian (RiIG) distributions, have been studied [40–45] for modeling speckle noise in ultrasound, Vegas-Sánchez-Ferrero et al. [46] show that Gamma distribution, which is a good approximation for the weighted sum of Rayleigh variables, accurately fits interpolated B-mode US images, when compression-less data with fully developed speckle is considered.

Motivated by the above studies, we assume the noise field in OCT images is due to fully developed speckle (as discussed in [34]), and hence, we model the OCT data distribution by Gamma probability density function (PDF). Let us consider that there are k frames in the OCT data, and the dimension of each frame is 
                        r
                        ×
                        c
                     . If the noisy OCT data, their noiseless version, and the noise are denoted as 
                        M
                        ,
                        C
                      and 
                        N
                     , respectively, we can express the relation between them as
                        
                           (1)
                           
                              M
                              =
                              C
                              +
                              N
                           
                        
                     where the dimensions of the vectors 
                        M
                        ,
                        C
                     , and 
                        N
                      are all 
                        (
                        
                           r
                           ×
                           c
                        
                        )
                        ×
                        k
                     . In other words, 
                        N
                      denotes a fading variable and takes random numbers from the Gamma distribution with shape and scale parameters ρ and β respectively.

@&#METHODOLOGY@&#

In this section, we concisely present the concept of bilateral filtering, and then propose two filters to reduce speckle from the Gamma distributed OCT data, namely, an adaptive and unbiased bilateral (AUB) filter and the iterative adaptive and unbiased bilateral (IAUB) filter. These filters are suitable for enhancing both single-frame and multiframe OCT images.

The conventional bilateral (CB) filter is a nonlinear spatial filter developed by Tomasi and Manduchi [47]. CB filter is very popular for edge preserved smoothing of images, which are Gaussian distributed. The kernel of the CB filter is composed of two components, namely a range filter kernel and domain filter kernel. The response of the CB filter at a pixel location m can be calculated as [47]
                     
                        
                           (2)
                           
                              
                                 
                                    I
                                 
                                 
                                    ^
                                 
                              
                              (
                              m
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    Z
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       ∈
                                       N
                                       (
                                       m
                                       )
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 m
                                 ,
                                 n
                              
                              )
                              
                                 
                                    w
                                 
                                 
                                    R
                                 
                              
                              (
                              
                                 m
                                 ,
                                 n
                              
                              )
                              I
                              (
                              n
                              )
                              ,
                           
                        
                     where N(m) represents the neighborhood region around m, and n is the position in the neighborhood. The normalization constant Z is given by
                        
                           (3)
                           
                              Z
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       ∈
                                       N
                                       (
                                       m
                                       )
                                    
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 m
                                 ,
                                 n
                              
                              )
                              
                                 
                                    w
                                 
                                 
                                    R
                                 
                              
                              (
                              
                                 m
                                 ,
                                 n
                              
                              )
                              .
                           
                        
                     
                  

The weight function w
                     
                        D
                      is linked to the domain filter and measures the photometric similarity of a pixel around its neighborhood. Similarly, the other weight function w
                     
                        R
                      is related to range filtering and the computed weights are proportional to the radiometric distance around the neighborhood of a pixel. These weight functions can be defined as
                        
                           (4)
                           
                              
                                 
                                    w
                                 
                                 
                                    D
                                 
                              
                              (
                              
                                 m
                                 ,
                                 n
                              
                              )
                              =
                              exp
                              (
                              
                                 −
                                 
                                    
                                       
                                          
                                             |
                                             
                                                m
                                                −
                                                n
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              )
                           
                        
                     and
                        
                           (5)
                           
                              
                                 
                                    w
                                 
                                 
                                    R
                                 
                              
                              (
                              
                                 m
                                 ,
                                 n
                              
                              )
                              =
                              exp
                              (
                              
                                 −
                                 
                                    
                                       
                                          
                                             |
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      m
                                                   
                                                
                                                −
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              )
                           
                        
                     where I
                     
                        m
                      and I
                     
                        n
                      are the intensities at m and n, respectively. The geometrical spread σ
                     
                        d
                      in the domain determines the amount of low pass filtering in the form of blur, and its optimal value is relatively insensitive to noise. However, the photometric spread σ
                     
                        r
                      in the image range is almost linearly related to the true noise standard deviation σ 
                     [48,49].

The first step to derive the adaptive and unbiased bilateral (AUB) filter is the conversion of the CB filter to an adaptive bilateral filter (ABF) by choosing the filter parameters in an adaptive fashion. Even though two spreads determine the performance of the CB filter, we need to make the photometric spread adaptive to reduce speckle because the other spread (geometric) is insensitive to noise. Hence, we define σ
                        
                           r
                         as
                           
                              (6)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 τ
                                 ×
                                 
                                    
                                       σ
                                    
                                    
                                       ^
                                    
                                 
                              
                           
                        where [50]
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ^
                                    
                                 
                                 =
                                 mode
                                 (
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    }
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ^
                              
                           
                         denotes the estimated noise variance from the given input image. The preferred value for σ
                        
                           d
                         is in between 1.2 and 2.1 [48]. In our experiments to find the value of τ, we fixed the σ
                        
                           d
                         value to 1.7, and experimentally find that the optimum value for τ is 0.01. Now, we modify the ABF filter by reducing the bias introduced due to noise in the image and propose the AUB filter. In order to get an accurate estimate of the bias, we have developed an ML estimation based method relying on the Gamma distributed nature of the observed OCT data. In Section 3.2, we will discuss the ML estimation of the bias term.

We assume that the noisy OCT image is Gamma distributed, as in (1), and hence, we model it with the three parameter Gamma distribution described by Cohen and Whitten in [51]. Fig. 1
                         shows the distribution of a homogeneous region of a real swine OCT image (shown in Fig. 5(a)). Comparison with the true Gamma distribution with parameters estimated from the selected homogeneous region shows that the data distribution can be modeled with a Gamma PDF. Let 
                           u
                           =
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                         be k statistically independent random observations from a Gamma distribution. Then, the PDF of the observations is given by [51]
                        
                           
                              (8)
                              
                                 P
                                 (
                                 u
                                 |
                                 γ
                                 ,
                                 ρ
                                 ,
                                 β
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            u
                                                            −
                                                            γ
                                                         
                                                         )
                                                      
                                                      
                                                         ρ
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   Γ
                                                   (
                                                   
                                                      ρ
                                                   
                                                   )
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ρ
                                                      
                                                   
                                                
                                             
                                             exp
                                             (
                                             
                                                −
                                                
                                                   
                                                      (
                                                      
                                                         u
                                                         −
                                                         γ
                                                      
                                                      )
                                                   
                                                   
                                                      β
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             ∀
                                             γ
                                             <
                                             u
                                             <
                                             ∞
                                             ,
                                          
                                       
                                       
                                          
                                          
                                             ρ
                                             >
                                             0
                                             ,
                                             β
                                             >
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           Γ
                           (
                           
                              ·
                           
                           )
                         denotes the Gamma function and γ, ρ and β represent the location, shape and scale parameters respectively.

The mean 
                           
                              
                                 μ
                              
                              
                                 u
                              
                           
                         and variance 
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                         of the above mentioned distribution are
                           
                              (9)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 γ
                                 +
                                 ρ
                                 β
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 ρ
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        respectively. Note that the mean 
                           
                              
                                 μ
                              
                              
                                 u
                              
                           
                         of the observed signal 
                           u
                         has two components, in which γ corresponds to the mean value of the noiseless signal and the product term 
                           ρ
                           β
                         represents the mean of the Gamma distributed pixels in the background, i.e., pixel locations in which the signal intensity is zero. In other words, the product term 
                           ρ
                           β
                         represents a shift in the mean value of the noiseless signal, and in this paper, we have called this term the bias.

In order to compute the bias, the estimation of the distribution parameters, ρ and β is essential and can be estimated by maximizing the corresponding likelihood function 
                           L
                        , or equivalently 
                           log
                           L
                         with respect to ρ and β. Since the parameter γ represents the noiseless signal component, it is unknown at the stage of the bias computation. Hence, (9) can be rewritten as,
                           
                              (11)
                              
                                 γ
                                 =
                                 
                                    
                                       μ
                                    
                                    
                                       u
                                    
                                 
                                 −
                                 ρ
                                 β
                              
                           
                        Then, the unknown noiseless image parameter γ in (8) can be replaced by (11).

Under the condition of 
                           γ
                           <
                           u
                           <
                           ∞
                           ,
                           ρ
                           >
                           0
                           ,
                           β
                           >
                           0
                        , the ML estimator can be defined as follows:
                           
                              (12)
                              
                                 {
                                 
                                    
                                       ρ
                                    
                                    
                                       ML
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       ML
                                    
                                 
                                 }
                                 =
                                 
                                    
                                       
                                          arg
                                          
                                          max
                                       
                                       
                                          ρ
                                          ,
                                          β
                                       
                                    
                                 
                                 (
                                 log
                                 L
                                 )
                              
                           
                        
                     

where
                           
                              (13)
                              
                                 log
                                 L
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 log
                                 P
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 ρ
                                 ,
                                 β
                                 )
                                 =
                                 (
                                 
                                    ρ
                                    −
                                    1
                                 
                                 )
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 log
                                 (
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          u
                                       
                                    
                                    +
                                    ρ
                                    β
                                 
                                 )
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          u
                                       
                                    
                                    +
                                    ρ
                                    β
                                 
                                 )
                                 −
                                 n
                                 [
                                 
                                    log
                                    Γ
                                    (
                                    
                                       ρ
                                    
                                    )
                                    +
                                    ρ
                                    log
                                    β
                                 
                                 ]
                              
                           
                        and ρ
                        
                           ML
                         and β
                        
                           ML
                         are the estimated shape and scale parameters, respectively.

These parameters have fixed values throughout all regions in the input image, and hence, we can compute them from any region in which the underlying intensity is constant. If we assume that there exist many such piecewise homogeneous regions then ρ and β can be estimated as 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 ML
                              
                           
                           =
                           mode
                           (
                           {
                           
                              
                                 ρ
                              
                              
                                 ML
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                           
                           }
                           )
                         and 
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 ML
                              
                           
                           =
                           mode
                           (
                           {
                           
                              
                                 β
                              
                              
                                 ML
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                           
                           }
                           )
                        , where 
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 ML
                              
                           
                         and 
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 ML
                              
                           
                         are the estimated values of ρ and β for the given image. Fig. 2
                         shows the distribution of local estimates of ρ and β from a real swine OCT image (shown in Fig. 5 (a)). Now, the 
                           bias
                           (
                           B
                           )
                         can be written as
                           
                              (14)
                              
                                 B
                                 =
                                 
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       ML
                                    
                                 
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       ML
                                    
                                 
                              
                           
                        This bias increases as the amount of noise in the OCT image increases. The bias computation for each image is tedious and time consuming in a multi-frame OCT dataset because the process has to be repeated for all the frames. Since the experimental set up is same, bias will be more or less the same in all frames. In any case, averaging bias from randomly selected frames will help to reduce the estimation errors associated with the ML method.

It can be observed from (9) and (14) that the mean of the observed Gamma distributed OCT image is biased by the speckle noise and hence, bias must be subtracted from the mean filtered image to achieve the unbiased, filtered image.

For each pixel of the discrete noisy image 
                           I
                           =
                           {
                           
                              I
                              (
                              n
                              )
                              |
                              n
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    N
                                 
                              
                           
                           }
                        , the proposed AUB estimator can be defined as follows:
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       AUB
                                    
                                 
                                 (
                                 
                                    I
                                    (
                                    
                                       n
                                    
                                    )
                                 
                                 )
                                 =
                                 max
                                 (
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          ABF
                                       
                                    
                                    (
                                    
                                       I
                                       (
                                       
                                          n
                                       
                                       )
                                    
                                    )
                                    −
                                    B
                                    ,
                                    0
                                 
                                 )
                              
                           
                        
                     

Therefore, for a k-frame (multiframe) OCT data, the final averaged AUB filter output is given by,
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       avg
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       AUB
                                       ,
                                       k
                                    
                                 
                                 (
                                 
                                    
                                       
                                          I
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    
                                       n
                                    
                                    )
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 max
                                 (
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          ABF
                                          ,
                                          k
                                       
                                    
                                    (
                                    
                                       
                                          
                                             I
                                          
                                          
                                             k
                                          
                                       
                                       (
                                       
                                          n
                                       
                                       )
                                    
                                    )
                                    −
                                    B
                                    ,
                                    0
                                 
                                 )
                              
                           
                        
                        
                           Algorithm 1
                           The IAUB filtering method for speckle reduction. 
                                 
                                    
                                       
                                       
                                          
                                             1: Input: noisy multi-frame OCT images (say, number of frames as R)
                                          
                                          
                                             2: Compute bias B by using (14).
                                          
                                          
                                             3: for 
                                                p=1 to R do
                                             
                                          
                                          
                                             4:Estimate 
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                 from pth OCT image I
                                                
                                                   p
                                                 by using Eq. (7).
                                          
                                          
                                             5:Calculate σ
                                                
                                                   r
                                                
                                                
                                                   p
                                                 with Eq. (6).
                                          
                                          
                                             6:Smooth I
                                                
                                                   p
                                                 by the CB filter defined in Eq. (2) to obtain 
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                .
                                          
                                          
                                             7:Find the AUB filter output 
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                 from 
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                 by using Eq. (15).
                                          
                                          
                                             8:Set 
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                .
                                          
                                          
                                             9:
                                                for 
                                                q=2 to iter 
                                                do
                                             
                                          
                                          
                                             10:
                                                Update 
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                 and estimate σ
                                                
                                                   r
                                                
                                                
                                                   p
                                                 from I
                                                
                                                   p
                                                 by using Eqs. (6) and (7).
                                          
                                          
                                             11:
                                                Find the CB filter output 
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               q
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                 using Eq. (2).
                                          
                                          
                                             12:
                                                Set 
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               q
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             13:
                                                end for
                                             
                                          
                                          
                                             14:
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         IAUB
                                                         ,
                                                         p
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                .
                                          
                                          
                                             15: end for
                                             
                                          
                                          
                                             16: Compute I
                                                
                                                   IAUB
                                                =
                                                   
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         avg
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         IAUB
                                                         ,
                                                         p
                                                      
                                                   
                                                .
                                          
                                          
                                             17: Output: I
                                                
                                                   IAUB
                                                 ⇐ denoised output image.
                                          
                                       
                                    
                                 
                              
                           

The quality of the image denoised with the proposed AUB can be further improved by applying the bilateral filter iteratively. Fig. 3
                         displays the distribution of a homogeneous region of the AUB filtered OCT image shown in Fig. 5(f)). Comparison with the true Gaussian distribution with parameters estimated from the selected homogeneous region shows that the data distribution can be modeled with a Gaussian PDF. As a well known filter to reduce Gaussian noise, the bilateral filter can be used to refine the result further. So, an iterative approach is followed in this paper to refine the AUB filter output and the noise variance is adaptively adjusted. The proposed iterative adaptive and unbiased bilateral (IAUB) filtering methodology is listed in Algorithm1.

In this section, we report the experimental results obtained with synthetic and real OCT images. The results were evaluated through visual inspection and quantitative analysis, and the proposed filter is compared with other state-of-the-art methods.

The various parameters used for the filters discussed in this paper are as follows:
                        
                           1.
                           
                              Bayesian estimation 
                              [29]: σ
                              
                                 spatial
                              =1.5; window-size parameter=3; number of samples used=70; Sigma factor=2;


                              Wavelet multi-frame filter 
                              [37]: Window size for calculating correlation=5×5; wavelet basis=Haar; maximum decomposition level=1; weightmode-parameter=1, [K P R]=[1 5 2].


                              Wiener filter 
                              [16]: Neighborhoods size (to estimate the local image mean and standard deviation)=[5,5].


                              Bilateral filter 
                              [47]: Half width of the filter=5; geometrical spread σ
                              
                                 d
                              =1.7; photometric spread σ
                              
                                 r
                              =0.1.


                              Proposed AUB filter: Half width of the filter=5; geometrical spread σ
                              
                                 d
                              =1.7; photometric spread 
                                 
                                    
                                       σ
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 0.01
                                 ×
                                 σ
                              .


                              Proposed IAUB filter: Half width of the filter=5; geometrical spread σ
                              
                                 d
                              =1.7; photometric spread 
                                 
                                    
                                       σ
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 0.01
                                 ×
                                 σ
                              .

We found that the number of iterations can vary the performance of the IAUB filter and the optimum values for the number of iterations used, in our experiments, with different bias B are given below
                        
                           (17)
                           
                              iter
                              =
                              {
                              
                                 
                                    
                                       
                                          2
                                       
                                       
                                          when
                                       
                                       
                                          B
                                          <
                                          20
                                          ,
                                       
                                    
                                    
                                       
                                          3
                                       
                                       
                                       
                                          20
                                          <
                                          B
                                          <
                                          40
                                          ,
                                       
                                    
                                    
                                       
                                          4
                                       
                                       
                                       
                                          B
                                          >
                                          40
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

This section reports the results of the qualitative and quantitative analysis on a synthetic phantom image of size 256×256. Fig. 4
                        (a) shows the Ground Truth (GT) and Fig. 4 (b) shows the GT corrupted with Gamma noise with parameters 
                           (
                           
                              ρ
                              ,
                              β
                           
                           )
                           =
                           (
                           
                              4
                              ,
                              4
                           
                           )
                        . From Fig. 4, it can be observed that the image denoised with the proposed IAUB filter (see Fig. 4(n)) is much closer to the GT than the image filtered with other speckle removal techniques. For better visual comparison, we have also shown corresponding residual images in Fig. 4.

Qualitatively, our proposed filters provide better preservation of fine structures, good contrast between different regions and better speckle removal than the other methods under consideration. Our quantitative evaluation relies on objective measures such as the peak signal to noise ratio (PSNR) [52], mean structural similarity index matrix (MSSIM) [53], Bhattacharrya coefficient (BC) [54] and Pratt׳s Figure of Merit (Pratt-FOM) [55].

For the quantitative analysis, the phantom image in Fig. 4(a) is artificially corrupted with Gamma random noise generated for different shape and scale parameters, and hence, with various values of the bias (i.e., B=6 to B=56). The quantitative analysis based on PSNR, MSSIM, BC and FOM is summarized in Tables 1, 2, 3 and 4
                        
                        
                        
                        , respectively. It can be observed from the tables that the proposed IAUB filter has a better performance over other state-of-the-art methods, like Bayesian estimation, the wavelet multi-frame filter, the Wiener filter, the wavelet filter, and the bilateral filter, along with the proposed AUB filter.

To validate the performance of the proposed method, experiments were also carried out on real datasets obtained by spectral domain OCT (SD-OCT) systems. In this section, we present the results of two sample datasets: first, a real OCT data set of a swine retina, which is acquired by our self-customized OCT system from the Centre for Optical Fibre Technology (COFT), Nanyang Technological University (NTU), Singapore, and the second, a pig׳s eye dataset, which is available online [37].

The first set of swine retinal images was obtained using an SD-OCT system, which adopts a superluminescent diode (SLD) (Superlum Broadlighters T-850-HP) with a center wavelength of 
                           
                              
                                 λ
                              
                              
                                 c
                              
                           
                           =
                           850
                           
                           nm
                         and a full width at half maximum (FWHM) bandwidth of 
                           Δ
                           λ
                           =
                           165
                           
                           nm
                         as the laser source. It achieves a resolution of 
                           2.3
                           
                           μ
                           m
                         in air in the axial direction, and a resolution of 
                           2.5
                           
                           μ
                           m
                         in the transverse direction. The sensitivity of the system is measured to be 
                           105.6
                           
                           dB
                         with 
                           5.65
                           
                           mW
                         light incident on the sample. The imaging speed of the system is set to be 20 frames per second, with each frame consisting of 512 A-lines. We use a total of 20 images in our experiment for methodology validation, and each image consists of 1024 transverse × 512 axial pixels, covering an area of 
                           0.495
                           
                           mm
                           ×
                           2.24
                           
                           mm
                        .

The set of pig retinal images were obtained from the existing work [37]. This dataset was originally obtained from the Spectralis HRA & OCT (Heidelberg Engineering) device. The imaging speed of the system is 13 frames per second, with each frame consisting of 768 A-scans. It achieves a resolution of 
                           7
                           
                           μ
                           m
                         in air in the axial direction, and a resolution of 
                           3.87
                           
                           μ
                           m
                         in the transverse direction. The dataset comprises of 35 sets, with 13 frames included in each set sharing the same imaging position and hence, a total of 455 images in the dataset. Each image consists of 768 transverse × 496 axial pixels with a resolution of 
                           7
                           
                           μ
                           m
                         in the axial direction. As stated in [37], the reconstruction quality gradually improves using increasing number of frames from 2 to 8. This trend is much less obvious with more than 8 frames. We used total 13 frames (images) of a single set of data in the following experiments to compare our approach with other methods.

The estimate of the shape and scale parameters for the pig eye dataset and the swine eye retinal dataset are 
                           (
                           
                              
                                 
                                    ρ
                                 
                                 
                                    ^
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    ^
                                 
                              
                           
                           )
                           =
                           (
                           
                              2
                              ,
                              18
                           
                           )
                         and 
                           (
                           
                              
                                 
                                    ρ
                                 
                                 
                                    ^
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    ^
                                 
                              
                           
                           )
                           =
                           (
                           
                              5
                              ,
                              8
                           
                           )
                        , respectively. Hence, their corresponding bias B are 36 and 40, respectively. The denoising results for the real datasets can be observed in Figs. 5 and 6
                        
                        . Notice that, the images shown in Figs. 5 and 6 are obtained by averaging the corresponding denoised frames. The despeckled image in Figs. 5(g) and 6(g) shows the capability of our proposed IAUB filter in reducing the speckle noise associated with the ophthalmic OCT images. Its result excels over other despeckled images generated by Bayesian estimation, the wavelet multi-frame filter, the Wiener filter, the bilateral filter and our proposed AUB filter (see Figs. 5(b)–(f) and 6(b)–(f)). The retinal layer structures (see Figs. 5(g) and 6(g)) are more visible in the despeckled image generated by the proposed IAUB filtering method and it preserves the edges and fine structures better. It can be observed that the results of the quantitative evaluation, shown in Tables 1–4, match well with the qualitative results in Figs. 5 and 6.

As an additional measure for evaluation, the expert ophthalmologists scoring on the quality of the various filter outputs in the real OCT images in Figs. 5 and 6 are provided in Table 5
                        . Note that, the ophthalmologists have graded the images on a scale of 1–10, for which 1 and 10 are used to represent the poorest and best results, respectively. It can also be noted through visual inspection that the image contrast is much better for our proposed method when compared to the images denoised with other methods.

One drawback of the proposed filters over other filters is its computational burden. The AUB filter has a time complexity as that of the conventional bilateral filter. However, additional time is required for computing the noise level in the image (i.e., for the ML estimation of scale and shape parameters of Gamma distribution).

@&#CONCLUSION@&#

In this paper, new speckle filters based on Gamma statistics have been presented. First, we assume a Gamma distribution for the data in the noisy frames of the given OCT data, and a local ML estimator is used to estimate the Gamma distribution parameters, and hence the bias term due to noise. In the proposed AUB filter, the calculated bias value is subtracted from an adaptive version of the CB filter. The proposed IAUB filter has an inherent AUB filter, and an iterative approach further refines the AUB filter output. For this purpose, Gaussian distribution is assumed (based on the experimental analysis) for the AUB filter output, and adaptive bilateral filter is applied iteratively considering the superior performance of bilateral filter on Gaussian distributed data. Experiments were carried out on both simulated and real OCT images to validate the performance of the proposed method. Evaluations based on the PSNR, mean SSIM, BC and Pratt-FOM on synthetic images with various noise levels and visual inspections shows that the proposed frameworks provide better performance than the state-of-the-art methods. Also, results indicate that the proposed method achieves considerable speckle noise reduction as well as better detail preservation for the OCT retinal images.

None declared.

@&#ACKNOWLEDGMENT@&#

We sincerely appreciate funding support from Nanyang Technological University, National Research Foundation Singapore (NRF2013NRF-POC001-021 and NRF-CRP13-2014-05), National Medical Research Council Singapore (NMRC/ CBRG/ 0036/ 2013), and Ministry of Education Singapore (MOE2013-T2-2-107) for Nanyang Technological University affiliated authors.

We would like to thank Dr. Victor Koh, MMed (Opthalmology), Department of Ophthalmology, National University Health System (NUHS), Singapore and Dr. S. Sujatha, MD, Professor of Ophthalmology, Joseph Eye Hospital, Tiruchirappalli, India for providing their evaluation of various methods on real OCT images used in this work.

@&#REFERENCES@&#

