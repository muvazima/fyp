@&#MAIN-TITLE@&#Birational 2D Free-Form Deformation of degree 1×
               n
            

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method is proposed for creating a planar free-form deformation of degree 
                                 1
                                 ×
                                 n
                               that has a rational inverse.


                        
                        
                           
                           The control points can be freely positioned, and weights are computed that produce a birational map.


                        
                        
                           
                           Weight computation is simple, and can be performed in real-time as the control points are moved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Free-Form Deformation

Birational map

@&#ABSTRACT@&#


               
               
                  This paper shows that generic 2D-Free-Form Deformations of degree 
                        1
                        ×
                        n
                      can be made birational by a suitable assignment of weights to the Bézier or B-spline control points. An FFD that is birational facilitates operations such as backward mapping for image warping, and Extended Free-Form Deformation. While birational maps have been studied extensively in the classical algebraic geometry literature, this paper is the first to present a family of non-linear birational maps that are flexible enough to be of practical use in geometric modeling.
               
            

@&#INTRODUCTION@&#

Free-Form Deformation (FFD) is an artist-friendly tool for deforming geometric models and graphical images by warping the ambient space (Sederberg and Parry, 1986). FFD is used in numerous applications such as geometric modeling (Hoffmann, 1989), shape optimization (Manzoni et al., 2012), character animation (Chadwick et al., 1989), facial animation (Kalra et al., 1992), image morphing (Lee et al., 1995), medical imaging (Frangi et al., 2001), shape registration (Huang et al., 2006), and sheet metal forming (Lingbeek et al., 2005).

2D-FFD is illustrated in Fig. 1
                     . As a preprocess, the scene in Fig. 1.a is enclosed in a rectangle (Fig. 1.b) which is parametrized by 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        
                           
                              x
                              −
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                           
                        
                        ,
                        
                           
                              y
                              −
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                           
                           
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                           
                        
                        )
                     . To explain the 2D-FFD illustrated in Fig. 1.c, we introduce the following notation. Upper-case bold letters denote elements of 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      and bold lower-case letters denote elements of 
                        
                           
                              R
                           
                           
                              2
                           
                        
                     . Given 
                        P
                        =
                        (
                        
                           
                              P
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              P
                           
                           
                              y
                           
                        
                        ,
                        
                           
                              P
                           
                           
                              w
                           
                        
                        )
                     , the projection operator 
                        Π
                        :
                        
                           
                              P
                           
                           
                              2
                           
                        
                        →
                        
                           
                              R
                           
                           
                              2
                           
                        
                      is defined 
                        Π
                        (
                        P
                        )
                        =
                        (
                        
                           
                              P
                           
                           
                              x
                           
                        
                        /
                        
                           
                              P
                           
                           
                              w
                           
                        
                        ,
                        
                           
                              P
                           
                           
                              y
                           
                        
                        /
                        
                           
                              P
                           
                           
                              w
                           
                        
                        )
                     . The result of projection is denoted by the corresponding lower-case letter, for example, 
                        p
                        =
                        Π
                        (
                        P
                        )
                     . Define
                        
                           (1)
                           
                              P
                              (
                              s
                              ,
                              t
                              )
                              =
                              (
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                              ,
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                              ,
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 m
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    0
                                 
                                 n
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    m
                                 
                              
                              (
                              s
                              )
                              
                                 
                                    B
                                 
                                 
                                    j
                                 
                                 
                                    n
                                 
                              
                              (
                              t
                              )
                           
                        
                      where control points 
                        
                           
                              P
                           
                           
                              i
                              j
                           
                        
                        =
                        (
                        
                           
                              x
                           
                           
                              i
                              j
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              i
                              j
                           
                        
                        ,
                        1
                        )
                      have 
                        
                           
                              p
                           
                           
                              i
                              j
                           
                        
                        =
                        (
                        
                           
                              x
                           
                           
                              i
                              j
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              i
                              j
                           
                        
                        )
                      Cartesian coordinates, 
                        
                           
                              w
                           
                           
                              i
                              j
                           
                        
                      are weights, and 
                        
                           
                              B
                           
                           
                              k
                           
                           
                              d
                           
                        
                        (
                        u
                        )
                     , 
                        u
                        ∈
                        {
                        s
                        ,
                        t
                        }
                     , is the kth Bernstein polynomial of degree 
                        d
                        ∈
                        {
                        m
                        ,
                        n
                        }
                     . The FFD is given by
                        
                           (2)
                           
                              (
                              x
                              ,
                              y
                              )
                              =
                              p
                              (
                              s
                              ,
                              t
                              )
                              =
                              Π
                              (
                              P
                              (
                              s
                              ,
                              t
                              )
                              )
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             w
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             w
                                          
                                       
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

Artists typically manipulate an FFD by moving the control points. Changing the weights 
                        
                           
                              w
                           
                           
                              i
                              j
                           
                        
                      will also modify an FFD, but this is rarely done in practice because the influence of the weights is limited—for non-negative weights, the deformation will never escape the convex hull of the control points. Fig. 2
                      shows the subtle effect of changing weight 
                        
                           
                              w
                           
                           
                              32
                           
                        
                      in the FFD in Fig. 1.c from one to two.

We define a preimage of a given 
                        (
                        x
                        ,
                        y
                        )
                      to be any 
                        (
                        s
                        ,
                        t
                        )
                      for which 
                        p
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        x
                        ,
                        y
                        )
                     . Computing FFD preimages is required in many applications — such as Extended FFD (Coquillart, 1990) and Directly Manipulated FFD (Gain and Dodgson, 2001) — and is useful in other applications, such as backward mapping for image warping.

A preimage 
                        (
                        s
                        ,
                        t
                        )
                      of a given 
                        (
                        x
                        ,
                        y
                        )
                      satisfies the equations
                        
                           (3)
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 x
                                 
                                    
                                       p
                                    
                                    
                                       w
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 0
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 y
                                 
                                    
                                       p
                                    
                                    
                                       w
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 0
                                 .
                              
                           
                        
                      Computing preimages usually involves solving (3) and (4) using numerical methods such as multivariate Newton iteration, or using algebraic methods such as resultants or Gröbner bases. In the simple case of a bidegree 
                        1
                        ×
                        1
                      FFD, (3) and (4) can be solved using algebraic substitution. For the FFD in Fig. 3
                     ,
                        
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       =
                                    
                                    
                                       12
                                       s
                                       (
                                       1
                                       −
                                       t
                                       )
                                       +
                                       8
                                       (
                                       1
                                       −
                                       s
                                       )
                                       t
                                       +
                                       12
                                       s
                                       t
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       =
                                    
                                    
                                       6
                                       (
                                       1
                                       −
                                       s
                                       )
                                       t
                                       +
                                       4
                                       s
                                       t
                                    
                                 
                              
                           
                        
                      from which we can solve
                        
                           (5)
                           
                              s
                              =
                              
                                 
                                    x
                                    −
                                    4
                                    y
                                    +
                                    36
                                    ±
                                    
                                       
                                          f
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                                 24
                              
                              ,
                              
                              t
                              =
                              
                                 
                                    −
                                    x
                                    +
                                    4
                                    y
                                    +
                                    36
                                    ±
                                    
                                       
                                          f
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                                 32
                              
                           
                        
                      where 
                        f
                        (
                        x
                        ,
                        y
                        )
                        =
                        
                           
                              x
                           
                           
                              2
                           
                        
                        −
                        8
                        x
                        y
                        +
                        16
                        
                           
                              y
                           
                           
                              2
                           
                        
                        −
                        72
                        x
                        −
                        96
                        y
                        +
                        1296
                     . For 
                        (
                        x
                        ,
                        y
                        )
                        =
                        (
                        8
                        ,
                        4
                        )
                      there are two preimages, 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        
                           1
                           3
                        
                        ,
                        
                           3
                           4
                        
                        )
                      and 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        2
                        ,
                        2
                        )
                     , i.e., 
                        P
                        (
                        
                           1
                           3
                        
                        ,
                        
                           3
                           4
                        
                        )
                        =
                        P
                        (
                        2
                        ,
                        2
                        )
                        =
                        (
                        8
                        ,
                        4
                        )
                     . A generic FFD of bidegree 
                        m
                        ×
                        n
                      is a 
                        2
                        m
                        n
                        :
                        1
                      map.
                        1
                     
                     
                        1
                        This can be seen as follows. For a fixed 
                              (
                              x
                              ,
                              y
                              )
                           , the polynomials 
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                            and 
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                            are bidegree 
                              m
                              ×
                              n
                           . The preimages of 
                              (
                              x
                              ,
                              y
                              )
                            are the values of 
                              (
                              s
                              ,
                              t
                              )
                            that satisfy 
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                              =
                              0
                            and 
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                              =
                              0
                           . The s-coordinates of these preimages are the roots of the polynomial obtained by taking the resultant of 
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                            and 
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                            with respect to t. Bezout's resultant in this case is the determinant of an 
                              n
                              ×
                              n
                            matrix whose elements are polynomials of degree 2m in s.
                     
                  


                     Sederberg and Zheng (2015) shows that if the FFD in Fig. 3.b is modified by assigning 
                        
                           
                              w
                           
                           
                              01
                           
                        
                        =
                        
                           5
                           3
                        
                      (Fig. 3.c), the map becomes 
                        1
                        :
                        1
                      and
                        
                           (6)
                           
                              s
                              =
                              
                                 
                                    3
                                    x
                                    −
                                    4
                                    y
                                 
                                 
                                    26
                                    −
                                    4
                                    y
                                 
                              
                              ,
                              
                              
                              
                              t
                              =
                              
                                 
                                    2
                                    y
                                 
                                 
                                    20
                                    −
                                    x
                                 
                              
                              .
                           
                        
                      Now, the unique preimage of 
                        (
                        8
                        ,
                        4
                        )
                      is 
                        (
                        s
                        ,
                        t
                        )
                        =
                        (
                        
                           2
                           5
                        
                        ,
                        
                           2
                           3
                        
                        )
                     .

A function 
                           p
                           (
                           s
                           ,
                           t
                           )
                         is called a birational map (or a Cremona transformation) if an inverse 
                           
                              
                                 p
                              
                              
                                 −
                                 1
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         exists that satisfies 
                           
                              
                                 p
                              
                              
                                 −
                                 1
                              
                           
                           (
                           p
                           (
                           s
                           ,
                           t
                           )
                           )
                           ≡
                           (
                           s
                           ,
                           t
                           )
                        , where both 
                           p
                           (
                           s
                           ,
                           t
                           )
                         and 
                           
                              
                                 p
                              
                              
                                 −
                                 1
                              
                           
                           (
                           x
                           ,
                           y
                           )
                         are rational maps from 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           →
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        . Every nonsingular linear or projective transformation is a trivial birational map. Non-linear birational maps have been studied for over 150 years and enjoy an extensive literature in classical and algebraic geometry, much of it cataloged in Hudson (1927).

We define a birational FFD to be an FFD in which an artist can freely move all the control points in the conventional manner, and the FFD can be made to be birational by then adjusting the weights. Birational FFDs were not studied in the classical literature on Cremona transformations, probably because the application to design and graphics did not yet exist. Furthermore, Hudson (1927) predates Bézier and B-spline curves and surfaces. While Hudson (1927) presents numerous specific Cremona transformations such as
                           
                              
                                 p
                                 (
                                 s
                                 ,
                                 t
                                 )
                                 =
                                 (
                                 
                                    1
                                    s
                                 
                                 ,
                                 
                                    1
                                    t
                                 
                                 )
                                 ,
                                 
                                 
                                 
                                 
                                 
                                    
                                       p
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 (
                                 
                                    1
                                    x
                                 
                                 ,
                                 
                                    1
                                    y
                                 
                                 )
                                 ,
                              
                           
                         simply converting such special cases to Bernstein polynomials does not constitute a birational FFD as we have defined it. Likewise, birational FFD has not been studied in the previous FFD literature, probably because nobody realized it was possible.

The result presented in Sederberg and Zheng (2015) can be interpreted as a birational FFD of degree 
                           1
                           ×
                           1
                         because the four control points can be moved to any general position, and the map is birational if the weights satisfy
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             00
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             11
                                          
                                       
                                    
                                    
                                       
                                          
                                             w
                                          
                                          
                                             01
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             10
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             01
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             00
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             10
                                          
                                       
                                       ‖
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             11
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             01
                                          
                                       
                                       |
                                    
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             11
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             01
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             00
                                          
                                       
                                       ‖
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             00
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             11
                                          
                                       
                                       |
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 i
                                 j
                              
                           
                           =
                           (
                           
                              
                                 x
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 i
                                 j
                              
                           
                           ,
                           1
                           )
                         and 
                           |
                           
                              RST
                           
                           |
                           =
                           
                              det
                           
                           (
                           R
                           ,
                           S
                           ,
                           T
                           )
                        . An artist can move the four control points and can even assign three weights; the fourth weight can then be computed from (7).

Section 6 extends the result in Sederberg and Zheng (2015) by showing that 2D FFDs of degree 
                           1
                           ×
                           n
                         are birational FFDs, that is, the control points can be moved to any general position, and weights can be determined such that the map is birational. A key preliminary result used in this procedure, presented in Section 2, is that a planar Bézier curve of any degree can be changed into a monoid by fixing the control points, specifying the location of the multiple point, and then solving for the weights.

Before we can consider monoid curves, we need to discuss representations for points and lines. Let 
                        P
                        =
                        (
                        
                           
                              p
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              y
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              w
                           
                        
                        )
                      and 
                        X
                        =
                        (
                        x
                        ,
                        y
                        ,
                        w
                        )
                     . A triple such as P can represent either a point or a line. 
                        
                           Point
                        
                        (
                        P
                        )
                      denotes a point whose Cartesian coordinates are 
                        Π
                        (
                        P
                        )
                        =
                        (
                        
                           
                              p
                           
                           
                              x
                           
                        
                        /
                        
                           
                              p
                           
                           
                              w
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              y
                           
                        
                        /
                        
                           
                              p
                           
                           
                              w
                           
                        
                        )
                     —assuming 
                        
                           
                              p
                           
                           
                              w
                           
                        
                        ≠
                        0
                     . If 
                        
                           
                              p
                           
                           
                              w
                           
                        
                        =
                        0
                     , 
                        
                           Point
                        
                        (
                        P
                        )
                      is the point at ∞ in the direction 
                        (
                        
                           
                              p
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              y
                           
                        
                        )
                     . 
                        
                           Line
                        
                        (
                        P
                        )
                      denotes the line defined by the equation 
                        P
                        ⋅
                        X
                        =
                        
                           
                              p
                           
                           
                              x
                           
                        
                        x
                        +
                        
                           
                              p
                           
                           
                              y
                           
                        
                        y
                        +
                        
                           
                              p
                           
                           
                              w
                           
                        
                        w
                        =
                        0
                     . 
                        
                           Line
                        
                        (
                        
                           
                              P
                           
                           
                              1
                           
                        
                        )
                      and 
                        
                           Line
                        
                        (
                        
                           
                              P
                           
                           
                              2
                           
                        
                        )
                      intersect at 
                        
                           Point
                        
                        (
                        
                           
                              P
                           
                           
                              1
                           
                        
                        ×
                        
                           
                              P
                           
                           
                              2
                           
                        
                        )
                      and 
                        
                           Point
                        
                        (
                        
                           
                              P
                           
                           
                              1
                           
                        
                        )
                      and 
                        
                           Point
                        
                        (
                        
                           
                              P
                           
                           
                              2
                           
                        
                        )
                      lie on 
                        
                           Line
                        
                        (
                        
                           
                              P
                           
                           
                              1
                           
                        
                        ×
                        
                           
                              P
                           
                           
                              2
                           
                        
                        )
                     . If 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        ⋅
                        
                           
                              P
                           
                           
                              2
                           
                        
                        =
                        0
                     , 
                        
                           Point
                        
                        (
                        
                           
                              P
                           
                           
                              1
                           
                        
                        )
                      lies on 
                        
                           Line
                        
                        (
                        
                           
                              P
                           
                           
                              2
                           
                        
                        )
                     .

Given 
                        R
                        (
                        t
                        )
                        =
                        (
                        
                           
                              r
                           
                           
                              x
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              r
                           
                           
                              y
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              r
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                        )
                        ∈
                        
                           
                              P
                           
                           
                              2
                           
                        
                        [
                        t
                        ]
                     , 
                        
                           Point
                        
                        (
                        R
                        (
                        t
                        )
                        )
                      is a rational curve defined by the parametric equations 
                        (
                        x
                        ,
                        y
                        )
                        =
                        Π
                        (
                        R
                        (
                        t
                        )
                        )
                        =
                        r
                        (
                        t
                        )
                     . 
                        
                           Line
                        
                        (
                        R
                        (
                        t
                        )
                        )
                      is called a moving line (Sederberg et al., 1994), i.e., a line that moves as a function of t, defined by the equation 
                        
                           
                              r
                           
                           
                              x
                           
                        
                        (
                        t
                        )
                        x
                        +
                        
                           
                              r
                           
                           
                              y
                           
                        
                        (
                        t
                        )
                        y
                        +
                        
                           
                              r
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                        w
                        =
                        0
                     . If 
                        
                           
                              R
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ⋅
                        
                           
                              R
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        ≡
                        0
                     , 
                        
                           Point
                        
                        (
                        
                           
                              R
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        )
                      and 
                        
                           Line
                        
                        (
                        
                           
                              R
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        )
                      are said to follow each other. Define 
                        
                           Deg
                        
                        (
                        R
                        (
                        t
                        )
                        )
                      to be the maximum of the degrees of 
                        
                           
                              r
                           
                           
                              x
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              r
                           
                           
                              y
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              r
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                     . If 
                        
                           Deg
                        
                        (
                        R
                        (
                        t
                        )
                        )
                        =
                        
                           
                              d
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              r
                           
                           
                              x
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              r
                           
                           
                              y
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              r
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                      have a common factor 
                        f
                        (
                        t
                        )
                      of degree 
                        
                           
                              d
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              R
                              (
                              t
                              )
                           
                           
                              ˜
                           
                        
                        =
                        R
                        (
                        t
                        )
                        /
                        f
                        (
                        t
                        )
                      is degree 
                        
                           
                              d
                           
                           
                              1
                           
                        
                        −
                        
                           
                              d
                           
                           
                              2
                           
                        
                      and 
                        
                           Point
                        
                        (
                        R
                        (
                        t
                        )
                        )
                        ≡
                        
                           Point
                        
                        (
                        
                           
                              R
                              (
                              t
                              )
                           
                           
                              ˜
                           
                        
                        )
                     . Given curves 
                        
                           Point
                        
                        (
                        
                           
                              R
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        )
                      and 
                        
                           Point
                        
                        (
                        
                           
                              R
                           
                           
                              2
                           
                        
                        (
                        t
                        )
                        )
                      of degree 
                        
                           
                              d
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              d
                           
                           
                              2
                           
                        
                      respectively, 
                        
                           Line
                        
                        (
                        
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                           
                              ˜
                           
                        
                        )
                      is a moving line of degree 
                        ≤
                        
                           
                              d
                           
                           
                              1
                           
                        
                        +
                        
                           
                              d
                           
                           
                              2
                           
                        
                      (Sederberg et al., 1994). If 
                        
                           
                              d
                           
                           
                              1
                           
                        
                        =
                        0
                     , 
                        
                           Line
                        
                        (
                        
                           
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                           
                              ˜
                           
                        
                        )
                      is an axial moving line of degree 
                        ≤
                        
                           
                              d
                           
                           
                              2
                           
                        
                      that pivots about 
                        
                           Point
                        
                        (
                        
                           
                              R
                           
                           
                              1
                           
                        
                        )
                     . We will dispense with the descriptors Point and Line if no ambiguity results.

Given 
                        A
                        =
                        (
                        
                           
                              a
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              y
                           
                        
                        ,
                        
                           
                              a
                           
                           
                              w
                           
                        
                        )
                      and 
                        P
                        (
                        t
                        )
                        =
                        (
                        
                           
                              p
                           
                           
                              x
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              p
                           
                           
                              y
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              p
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                        )
                      (where 
                        
                           Point
                        
                        (
                        P
                        (
                        t
                        )
                        )
                      is a properly parametrized curve), 
                        
                           Point
                        
                        (
                        A
                        )
                      is called a point of multiplicity n on 
                        
                           Point
                        
                        (
                        P
                        (
                        t
                        )
                        )
                      if the equations
                        
                           
                              
                                 
                                    a
                                 
                                 
                                    w
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              (
                              t
                              )
                              −
                              
                                 
                                    a
                                 
                                 
                                    x
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              t
                              )
                              =
                              0
                              
                               and 
                              
                                 
                                    a
                                 
                                 
                                    w
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              (
                              t
                              )
                              −
                              
                                 
                                    a
                                 
                                 
                                    y
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              t
                              )
                              =
                              0
                           
                        
                      have n common roots, counting multiplicity. If 
                        n
                        =
                        0
                     , 
                        
                           Point
                        
                        (
                        A
                        )
                      does not lie on 
                        
                           Point
                        
                        (
                        P
                        (
                        t
                        )
                        )
                     . 
                        
                           Point
                        
                        (
                        A
                        )
                      is called a simple point if 
                        n
                        =
                        1
                     , a double point if 
                        n
                        =
                        2
                     , a triple point if 
                        n
                        =
                        3
                     , etc. A generic degree n planar rational curve always has 
                        (
                        n
                        −
                        1
                        )
                        (
                        n
                        −
                        2
                        )
                        /
                        2
                      double points, where a generic point of multiplicity m counts as 
                        m
                        (
                        m
                        −
                        1
                        )
                        /
                        2
                      double points (Salmon and Cayley, 1879). A monoid is a degree n planar curve that has a point of multiplicity 
                        n
                        −
                        1
                      and no other multiple points (Sederberg, 1983).

We now state the following theorem, which appears as Theorem 1 in Song et al. (2007), and which we will use in the proof of our Theorem 2.3: 
                        Theorem 2.1
                        
                           A 
                           is a singular point of multiplicity 
                           
                              k
                              ≥
                              2
                            
                           of a rational planar curve 
                           
                              P
                              (
                              t
                              )
                            
                           of degree n if and only if there is an axial moving line of degree 
                           
                              n
                              −
                              k
                            
                           with axis 
                           A 
                           that follows the curve 
                           
                              P
                              (
                              t
                              )
                           
                           .
                        


                           Thus a rational planar curve 
                           
                              P
                              (
                              t
                              )
                            
                           of degree n is a monoid curve with a singularity of multiplicity 
                           
                              n
                              −
                              1
                            
                           at the point 
                           A 
                           if and only if there is an axial moving line of degree one with axis 
                           A 
                           that follows the curve 
                           
                              P
                              (
                              t
                              )
                           
                           .
                        


                           Given control points 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ,
                              1
                              )
                            
                           of a generic rational Bézier curve
                           
                              
                                 (8)
                                 
                                    P
                                    (
                                    t
                                    )
                                    =
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    t
                                    )
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          y
                                       
                                    
                                    (
                                    t
                                    )
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       n
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    t
                                    )
                                    ,
                                 
                              
                            
                           choose 
                           
                              A
                              =
                              (
                              
                                 
                                    a
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    w
                                 
                              
                              )
                           
                           , 
                           
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              =
                              (
                              
                                 
                                    q
                                 
                                 
                                    0
                                 
                              
                              x
                              ,
                              
                                 
                                    q
                                 
                                 
                                    0
                                    y
                                 
                              
                              ,
                              1
                              )
                           
                           , and 
                           
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              =
                              (
                              
                                 
                                    q
                                 
                                 
                                    1
                                    x
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    1
                                    y
                                 
                              
                              ,
                              1
                              )
                            
                           (see 
                           
                              Fig. 4
                           
                           
                           ) subject to 
                           
                              A
                              ×
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              ⋅
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                           
                           , 
                           
                              A
                              ×
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              ⋅
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                           , 
                           
                              (
                              Π
                              (
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              )
                              −
                              Π
                              (
                              A
                              )
                              )
                              ⋅
                              (
                              Π
                              (
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                              )
                              −
                              Π
                              (
                              A
                              )
                              )
                              >
                              0
                            
                           and 
                           
                              (
                              Π
                              (
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              )
                              −
                              Π
                              (
                              A
                              )
                              )
                              ⋅
                              (
                              Π
                              (
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                              )
                              −
                              Π
                              (
                              A
                              )
                              )
                              >
                              0
                           
                           . Define 
                           
                              Q
                              (
                              t
                              )
                              =
                              (
                              1
                              −
                              t
                              )
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              +
                              t
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                            
                           and
                           
                              
                                 (9)
                                 
                                    L
                                    (
                                    t
                                    )
                                    =
                                    A
                                    ×
                                    Q
                                    (
                                    t
                                    )
                                    =
                                    (
                                    1
                                    −
                                    t
                                    )
                                    A
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    t
                                    A
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    .
                                 
                              
                            
                           Then there exist weights 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                            
                           for which 
                           
                              
                                 Line
                              
                              (
                              L
                              (
                              t
                              )
                              )
                            
                           follows 
                           
                              
                                 Point
                              
                              (
                              P
                              (
                              t
                              )
                              )
                           
                           , and those weights make the curve a monoid with a point of multiplicity 
                           
                              n
                              −
                              1
                            
                           at 
                           A
                           .
                        


                           
                              
                                 Line
                              
                              (
                              L
                              (
                              t
                              )
                              )
                            follows 
                              
                                 Point
                              
                              (
                              P
                              (
                              t
                              )
                              )
                            if
                              
                                 (10)
                                 
                                    L
                                    (
                                    t
                                    )
                                    ⋅
                                    P
                                    (
                                    t
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    (
                                    t
                                    )
                                    ≡
                                    0
                                    .
                                 
                              
                            Since the Bernstein basis functions are linearly independent, (10) is true if and only if all 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           . By hypothesis, 
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                              =
                              A
                              ×
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              ⋅
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                            and 
                              
                                 
                                    r
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              A
                              ×
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              ⋅
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           . Therefore, 
                              L
                              (
                              t
                              )
                              ⋅
                              P
                              (
                              t
                              )
                              =
                              0
                            if and only if
                              
                                 (11)
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          A
                                          ×
                                          
                                             
                                                Q
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             (
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          A
                                          ×
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                P
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    n
                                    .
                                 
                              
                            
                           (11) can be satisfied by setting 
                              
                                 
                                    w
                                 
                                 
                                    0
                                 
                              
                              =
                              1
                            and
                              
                                 (12)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          i
                                          A
                                          ×
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                P
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          (
                                          n
                                          +
                                          1
                                          −
                                          i
                                          )
                                          A
                                          ×
                                          
                                             
                                                Q
                                             
                                             
                                                0
                                             
                                          
                                          ⋅
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    n
                                    .
                                 
                              
                            With this choice of weights, 
                              L
                              (
                              t
                              )
                            is a degree 1 moving line with axis A that follows the curve 
                              
                                 Point
                              
                              (
                              P
                              (
                              t
                              )
                              )
                           . Therefore by Corollary 2.2, if the weights of 
                              
                                 Point
                              
                              (
                              P
                              (
                              t
                              )
                              )
                            satisfy (12), 
                              
                                 Point
                              
                              (
                              P
                              (
                              t
                              )
                              )
                            is a monoid and A is a point of multiplicity 
                              n
                              −
                              1
                           .  □

The effect of choosing weights according to (12) is illustrated in Fig. 5
                     . To visualize multiple points on a Bézier curve, we usually must extend the curve beyond its normal 
                        [
                        0
                        ,
                        1
                        ]
                      domain. Fig. 5.a shows the three double points on a degree-four Bézier curve with weights all one, and Fig. 5.b shows the monoid that results from assigning weights to satisfy (12). Note that the portion of the curve over the 
                        [
                        0
                        ,
                        1
                        ]
                      domain — that is, the segment of the curve from 
                        
                           
                              P
                           
                           
                              0
                           
                        
                      to 
                        
                           
                              P
                           
                           
                              4
                           
                        
                      — is not altered dramatically, while outside the 
                        [
                        0
                        ,
                        1
                        ]
                      domain, the three double points coalesce into a single triple point at A.


                     
                        Definition 2.4
                        The control points of a monoid curve are in constrained general position if the control polygon only intersects line A-
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                            at 
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                            and line A-
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                            at 
                              
                                 
                                    P
                                 
                                 
                                    n
                                 
                              
                           .

Denoting 
                        X
                        =
                        (
                        x
                        ,
                        y
                        ,
                        1
                        )
                     , the parameter value τ for which 
                        
                           Line
                        
                        (
                        L
                        (
                        t
                        )
                        )
                      contains 
                        
                           Point
                        
                        (
                        X
                        )
                      is the t value for which 
                        L
                        (
                        t
                        )
                        ⋅
                        X
                        =
                        0
                     . Solving from (9),
                        
                           (13)
                           
                              t
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    A
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    ⋅
                                    X
                                 
                                 
                                    A
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    ⋅
                                    X
                                    −
                                    A
                                    ×
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    ⋅
                                    X
                                 
                              
                              =
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 
                                    |
                                    A
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    X
                                    |
                                 
                              
                              .
                           
                        
                      
                     (13) is an inversion equation: for all simple points X on 
                        P
                        (
                        t
                        )
                     , 
                        p
                        (
                        t
                        (
                        x
                        ,
                        y
                        )
                        )
                        ≡
                        (
                        x
                        ,
                        y
                        )
                     .

Given a curve 
                        P
                        (
                        t
                        )
                        =
                        (
                        
                           
                              p
                           
                           
                              x
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              p
                           
                           
                              y
                           
                        
                        (
                        t
                        )
                        ,
                        
                           
                              p
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                        )
                      whose weights satisfy (12), define a triangle 
                        A
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        
                           
                              Q
                           
                           
                              1
                           
                        
                      with 
                        |
                        A
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        |
                        =
                        |
                        A
                        
                           
                              P
                           
                           
                              n
                           
                        
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        |
                        =
                        0
                      (Fig. 6
                     .a). A generic monoid curve can be implicitized using any of the standard methods for implicitizing a rational curve — such as resultants (Sederberg et al., 1984) or moving lines (Sederberg et al., 1994) — or by using the special approach in Chen and Sederberg (2002) for curves with high-order singularities. We now derive an implicit equation 
                        f
                        (
                        x
                        ,
                        y
                        )
                        =
                        0
                      for the monoid curve 
                        P
                        (
                        t
                        )
                      that has a simpler structure than the more general previous methods.

We begin by parametrizing 
                        Δ
                        A
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        
                           
                              Q
                           
                           
                              1
                           
                        
                      with “triangle” coordinates 
                        (
                        t
                        ,
                        u
                        )
                     
                     
                        
                           (14)
                           
                              X
                              =
                              (
                              1
                              −
                              u
                              )
                              A
                              +
                              u
                              [
                              (
                              1
                              −
                              t
                              )
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              +
                              t
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              ]
                           
                        
                      where (14) is a special case of a birational bilinear map (Sederberg and Zheng, 2015) with inverse
                        
                           (15)
                           
                              t
                              =
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 
                                    |
                                    A
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    X
                                    |
                                 
                              
                              ,
                              
                              
                              
                              
                              
                              
                              u
                              =
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 
                                    t
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    |
                                 
                              
                              =
                              
                                 
                                    |
                                    A
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    X
                                    |
                                 
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    |
                                 
                              
                              .
                           
                        
                      
                     Fig. 6.b shows some isoparameter lines for this parametrization. Since each t-isoparameter line (i.e., a line where t is held constant and u varies) is equivalent to 
                        L
                        (
                        t
                        )
                      as defined in (9), 
                        P
                        (
                        t
                        )
                      lies on its corresponding t-isoparameter line in 
                        Δ
                        A
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        
                           
                              Q
                           
                           
                              1
                           
                        
                     . Replacing X with 
                        P
                        (
                        t
                        )
                        /
                        
                           
                              p
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                      in (15), the u triangle coordinate for each point on 
                        P
                        (
                        t
                        )
                      is thus
                        
                           (16)
                           
                              u
                              =
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    P
                                    (
                                    t
                                    )
                                    |
                                 
                                 
                                    t
                                    ⋅
                                    
                                       
                                          p
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    t
                                    )
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    |
                                 
                              
                              .
                           
                        
                      We can obtain an implicit equation 
                        F
                        (
                        t
                        ,
                        u
                        )
                        =
                        0
                      of curve 
                        P
                        (
                        t
                        )
                      in terms of triangle coordinates 
                        (
                        t
                        ,
                        u
                        )
                      by rewriting (16) as
                        
                           (17)
                           
                              F
                              (
                              t
                              ,
                              u
                              )
                              =
                              u
                              ⋅
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              t
                              )
                              |
                              A
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              |
                              −
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    P
                                    (
                                    t
                                    )
                                    |
                                 
                                 t
                              
                              =
                              0
                              .
                           
                        
                      Notice that t divides 
                        |
                        A
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        P
                        (
                        t
                        )
                        |
                     . Indeed, let 
                        h
                        (
                        t
                        )
                        =
                        
                           
                              |
                              A
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              P
                              (
                              t
                              )
                              |
                           
                           t
                        
                     , or
                        
                           
                              h
                              (
                              t
                              )
                              =
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    |
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                0
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    |
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          t
                                          )
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    t
                                    +
                                    …
                                    +
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          n
                                       
                                    
                                    |
                                    
                                       (
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             
                                                n
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                 
                                 t
                              
                              .
                           
                        
                      Then since 
                        |
                        A
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        
                           
                              P
                           
                           
                              0
                           
                        
                        |
                        =
                        0
                     , 
                        |
                        A
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        P
                        (
                        t
                        )
                        |
                      is divisible by t, and
                        
                           (18)
                           
                              h
                              (
                              t
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                               where 
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    n
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    |
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              .
                           
                        
                      The implicit equation of the curve 
                        P
                        (
                        t
                        )
                      in terms of 
                        (
                        t
                        ,
                        u
                        )
                      coordinates can now be written
                        
                           (19)
                           
                              F
                              (
                              t
                              ,
                              u
                              )
                              =
                              u
                              ⋅
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              t
                              )
                              |
                              A
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              |
                              −
                              h
                              (
                              t
                              )
                              =
                              0
                              .
                           
                        
                      An implicit equation in terms of 
                        (
                        x
                        ,
                        y
                        )
                      is obtained by replacing 
                        (
                        t
                        ,
                        u
                        )
                      with the inversion formulae from (15). Denoting 
                        χ
                        =
                        |
                        A
                        (
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        −
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        )
                        X
                        |
                     , we have 
                        t
                        =
                        
                           
                              |
                              A
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              X
                              |
                           
                           χ
                        
                      and 
                        u
                        =
                        
                           χ
                           
                              |
                              A
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              |
                           
                        
                      so
                        
                           (20)
                           
                              F
                              (
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 χ
                              
                              ,
                              
                                 χ
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    |
                                 
                              
                              )
                              =
                              χ
                              ⋅
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 χ
                              
                              )
                              −
                              h
                              (
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 χ
                              
                              )
                              =
                              0
                              .
                           
                        
                      Since 
                        
                           
                              p
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                      and 
                        h
                        (
                        t
                        )
                      are polynomials in Bernstein form, our discussion is assisted by introducing the notation
                        
                           (21)
                           
                              
                                 
                                    c
                                 
                                 
                                    n
                                 
                              
                              [
                              α
                              ,
                              β
                              ]
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 n
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    α
                                 
                                 
                                    n
                                    −
                                    i
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    〈
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          c
                                       
                                       
                                          n
                                       
                                    
                                    〉
                                 
                                 
                                    n
                                 
                              
                              [
                              α
                              ,
                              β
                              ]
                              .
                           
                        
                      Observe that 
                        (
                        1
                        −
                        t
                        )
                        =
                        
                           
                              |
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              A
                              X
                              |
                           
                           χ
                        
                     . Then,
                        
                           
                              F
                              (
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 χ
                              
                              ,
                              
                                 χ
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    |
                                 
                              
                              )
                              =
                              χ
                              ⋅
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                              [
                              
                                 
                                    |
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    A
                                    X
                                    |
                                 
                                 χ
                              
                              ,
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 χ
                              
                              ]
                              −
                              
                                 
                                    h
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              [
                              
                                 
                                    |
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    A
                                    X
                                    |
                                 
                                 χ
                              
                              ,
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 χ
                              
                              ]
                              =
                              0
                              .
                           
                        
                      Clearing the denominator by multiplying by 
                        
                           
                              χ
                           
                           
                              n
                              −
                              1
                           
                        
                      yields the implicit equation
                        
                           (22)
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                              [
                              |
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              A
                              X
                              |
                              ,
                              |
                              A
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              X
                              |
                              ]
                              −
                              
                                 
                                    h
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              [
                              |
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              A
                              X
                              |
                              ,
                              |
                              A
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              X
                              |
                              ]
                              =
                              0
                              .
                           
                        
                     
                  

Given a degree-4 Bézier curve with control points
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 (
                                 0
                                 ,
                                 2
                                 ,
                                 1
                                 )
                                 ,
                                 
                                 
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    5
                                    6
                                 
                                 (
                                 0
                                 ,
                                 3
                                 ,
                                 1
                                 )
                                 ,
                                 
                                 
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    2
                                    3
                                 
                                 (
                                 2
                                 ,
                                 4
                                 ,
                                 1
                                 )
                                 ,
                                 
                                 
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    10
                                    13
                                 
                                 (
                                 5
                                 ,
                                 3
                                 ,
                                 1
                                 )
                                 ,
                                 
                                 
                                 
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    8
                                    13
                                 
                                 (
                                 5
                                 ,
                                 2
                                 ,
                                 1
                                 )
                                 ,
                              
                           
                         with 
                           A
                           =
                           (
                           3
                           ,
                           0
                           ,
                           1
                           )
                        , 
                           
                              
                                 Q
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                           =
                           (
                           0
                           ,
                           2
                           ,
                           1
                           )
                         and 
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                           =
                           (
                           5
                           ,
                           2
                           ,
                           1
                           )
                        . The weights 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           =
                           1
                        , 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           =
                           
                              5
                              6
                           
                        , 
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           =
                           
                              2
                              3
                           
                        , 
                           
                              
                                 w
                              
                              
                                 3
                              
                           
                           =
                           
                              10
                              13
                           
                        , 
                           
                              
                                 w
                              
                              
                                 4
                              
                           
                           =
                           
                              8
                              13
                           
                         satisfy (12), so the curve is a monoid with 
                           
                              
                                 p
                              
                              
                                 w
                              
                              
                                 4
                              
                           
                           [
                           α
                           ,
                           β
                           ]
                           =
                           
                              
                                 〈
                                 1
                                 ,
                                 
                                    5
                                    6
                                 
                                 ,
                                 
                                    2
                                    3
                                 
                                 ,
                                 
                                    10
                                    13
                                 
                                 ,
                                 
                                    8
                                    13
                                 
                                 〉
                              
                              
                                 4
                              
                           
                           [
                           α
                           ,
                           β
                           ]
                        . From (18),
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                3
                                             
                                          
                                          [
                                          α
                                          ,
                                          β
                                          ]
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                〈
                                                4
                                                |
                                                A
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                                |
                                                ,
                                                
                                                   
                                                      4
                                                      |
                                                      A
                                                      
                                                         
                                                            Q
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                ,
                                                
                                                   
                                                      4
                                                      |
                                                      A
                                                      
                                                         
                                                            Q
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      |
                                                   
                                                   3
                                                
                                                ,
                                                
                                                   
                                                      4
                                                      |
                                                      A
                                                      
                                                         
                                                            Q
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      |
                                                   
                                                   4
                                                
                                                〉
                                             
                                             
                                                3
                                             
                                          
                                          [
                                          α
                                          ,
                                          β
                                          ]
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                〈
                                                −
                                                10
                                                ,
                                                
                                                   
                                                      −
                                                      40
                                                   
                                                   3
                                                
                                                ,
                                                
                                                   
                                                      −
                                                      40
                                                   
                                                   3
                                                
                                                ,
                                                
                                                   
                                                      −
                                                      80
                                                   
                                                   13
                                                
                                                〉
                                             
                                             
                                                3
                                             
                                          
                                          [
                                          α
                                          ,
                                          β
                                          ]
                                          .
                                       
                                    
                                 
                              
                           
                         We have 
                           |
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           A
                           X
                           |
                           =
                           2
                           x
                           −
                           2
                           y
                           −
                           6
                        , and 
                           |
                           A
                           
                              
                                 Q
                              
                              
                                 0
                              
                           
                           X
                           |
                           =
                           −
                           2
                           x
                           −
                           3
                           y
                           +
                           6
                        , so from (22), the implicit equation is
                           
                              
                                 
                                    
                                       
                                          f
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                〈
                                                1
                                                ,
                                                
                                                   5
                                                   6
                                                
                                                ,
                                                
                                                   2
                                                   3
                                                
                                                ,
                                                
                                                   10
                                                   13
                                                
                                                ,
                                                
                                                   8
                                                   13
                                                
                                                〉
                                             
                                             
                                                4
                                             
                                          
                                          [
                                          2
                                          x
                                          −
                                          2
                                          y
                                          −
                                          6
                                          ,
                                          −
                                          2
                                          x
                                          −
                                          3
                                          y
                                          +
                                          6
                                          ]
                                       
                                    
                                    
                                       
                                       
                                       
                                          −
                                          
                                             
                                                〈
                                                −
                                                10
                                                ,
                                                
                                                   
                                                      −
                                                      40
                                                   
                                                   3
                                                
                                                ,
                                                
                                                   
                                                      −
                                                      40
                                                   
                                                   3
                                                
                                                ,
                                                
                                                   
                                                      −
                                                      80
                                                   
                                                   13
                                                
                                                〉
                                             
                                             
                                                3
                                             
                                          
                                          [
                                          2
                                          x
                                          −
                                          2
                                          y
                                          −
                                          6
                                          ,
                                          −
                                          2
                                          x
                                          −
                                          3
                                          y
                                          +
                                          6
                                          ]
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

An explicit curve is a parametric curve for which 
                        x
                        ≡
                        t
                     . All degree n explicit curves have a point of multiplicity 
                        n
                        −
                        1
                      at 
                        y
                        =
                        ∞
                     , that is, any explicit curve is a monoid with 
                        A
                        =
                        (
                        0
                        ,
                        1
                        ,
                        0
                        )
                     . It is well-known that a polynomial Bézier curve (weights are all one) is explicit if and only if 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        =
                        i
                        /
                        n
                     , 
                        i
                        =
                        0
                        ,
                        …
                        ,
                        n
                     . A Bézier curve for which 
                        
                           
                              x
                           
                           
                              0
                           
                        
                        =
                        0
                      and 
                        
                           
                              x
                           
                           
                              n
                           
                        
                        =
                        1
                     , but the other control points are arbitrarily positioned, can be created by setting 
                        A
                        =
                        (
                        0
                        ,
                        1
                        ,
                        0
                        )
                      and assigning weights using (12), where 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        =
                        (
                        0
                        ,
                        
                           
                              c
                           
                           
                              0
                           
                        
                        ,
                        1
                        )
                      and 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        =
                        (
                        1
                        ,
                        
                           
                              c
                           
                           
                              1
                           
                        
                        ,
                        1
                        )
                     , yielding 
                        L
                        (
                        t
                        )
                        =
                        (
                        −
                        t
                        ,
                        0
                        ,
                        1
                        )
                     .

A rational explicit curve has an inversion equation 
                        t
                        =
                        x
                     , and an implicit equation
                        
                           (23)
                           
                              y
                              =
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              (
                              x
                              )
                              /
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              x
                              )
                               or 
                              y
                              ⋅
                              
                                 
                                    p
                                 
                                 
                                    w
                                 
                              
                              (
                              x
                              )
                              −
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              (
                              x
                              )
                              =
                              0
                              .
                           
                        
                      
                     Fig. 7
                      shows three examples of explicit rational curves. Poles occur at values of 
                        t
                        =
                        x
                      for which 
                        
                           
                              p
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                        =
                        0
                     . If the control points are in constrained general position (that is, 
                        0
                        <
                        
                           
                              x
                           
                           
                              i
                           
                        
                        <
                        1
                        ,
                        i
                        =
                        1
                        ,
                        …
                        ,
                        n
                        −
                        1
                     ) all weights will be positive and there will be no poles for 
                        x
                        ∈
                        [
                        0
                        ,
                        1
                        ]
                     . In Fig. 7.a and b, poles occur when 
                        
                           
                              p
                           
                           
                              w
                           
                        
                        (
                        t
                        )
                        =
                        0
                     . In Fig. 7.c, the curve for which the weights are all one is shown to have three double points, but for weights that satisfy (12), the singularity becomes a triple point at 
                        y
                        =
                        ∞
                     .

An FFD of degree 
                        1
                        ×
                        n
                      has two degree-n boundary curves
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    0
                                 
                                 n
                              
                              
                                 
                                    w
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              (
                              t
                              )
                              ,
                              
                              
                              
                              j
                              =
                              0
                              ,
                              1
                           
                        
                      and the FFD equation, obtained by setting 
                        m
                        =
                        1
                      in (1), can be written
                        
                           (24)
                           
                              P
                              (
                              s
                              ,
                              t
                              )
                              =
                              (
                              1
                              −
                              s
                              )
                              
                                 
                                    P
                                 
                                 
                                    0
                                 
                              
                              (
                              t
                              )
                              +
                              s
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                              .
                           
                        
                     
                  

Referring to Fig. 8
                     , choose
                        
                           
                              A
                              =
                              (
                              
                                 
                                    P
                                 
                                 
                                    0
                                    ,
                                    0
                                 
                              
                              ×
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    0
                                 
                              
                              )
                              ×
                              (
                              
                                 
                                    P
                                 
                                 
                                    0
                                    ,
                                    n
                                 
                              
                              ×
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    n
                                 
                              
                              )
                              .
                           
                        
                      Choose any points 
                        
                           
                              Q
                           
                           
                              0
                           
                        
                        =
                        (
                        
                           
                              x
                           
                           
                              q
                              0
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              q
                              0
                           
                        
                        ,
                        1
                        )
                      and 
                        
                           
                              Q
                           
                           
                              1
                           
                        
                        =
                        (
                        
                           
                              x
                           
                           
                              q
                              1
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              q
                              1
                           
                        
                        ,
                        1
                        )
                      that satisfy
                        
                           (25)
                           
                              
                                 
                                    P
                                 
                                 
                                    0
                                    ,
                                    0
                                 
                              
                              ×
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    0
                                 
                              
                              ⋅
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              ,
                              
                              
                              
                              
                                 
                                    P
                                 
                                 
                                    0
                                    ,
                                    n
                                 
                              
                              ×
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    n
                                 
                              
                              ⋅
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                              ,
                              
                              
                              
                              Π
                              (
                              
                                 
                                    Q
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              Π
                              (
                              
                                 
                                    Q
                                 
                                 
                                    1
                                 
                              
                              )
                              ≠
                              Π
                              (
                              A
                              )
                              .
                           
                        
                      Make sure that the respective sets of control points for the two boundary curves 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                      are in constrained general position, and then use the results in Section 2 to compute weights 
                        
                           
                              w
                           
                           
                              i
                              j
                           
                        
                      for 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        (
                        t
                        )
                      and 
                        
                           
                              P
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                      such that the boundary curves each follow 
                        L
                        (
                        t
                        )
                     . The resulting FFD is birational, as we will now prove by presenting the inversion formulae, 
                        t
                        (
                        x
                        ,
                        y
                        )
                      and 
                        s
                        (
                        x
                        ,
                        y
                        )
                     . Since 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        (
                        t
                        )
                        ⋅
                        L
                        (
                        t
                        )
                        ≡
                        
                           
                              P
                           
                           
                              1
                           
                        
                        (
                        t
                        )
                        ⋅
                        L
                        (
                        t
                        )
                        ≡
                        0
                     , 
                        t
                        (
                        x
                        ,
                        y
                        )
                      is given by (13):
                        
                           
                              t
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    |
                                    A
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    X
                                    |
                                 
                                 
                                    |
                                    A
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          0
                                       
                                    
                                    −
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    X
                                    |
                                 
                              
                              .
                           
                        
                      Given a point 
                        (
                        x
                        ,
                        y
                        )
                     , its preimage s coordinate can be found procedurally by computing t from (13), then s can be computed by setting 
                        (
                        x
                        ,
                        y
                        )
                        =
                        P
                        (
                        s
                        ,
                        t
                        )
                      in (24). If we combine the steps in this procedure, we discover an interesting relationship between the inversion equation 
                        s
                        (
                        x
                        ,
                        y
                        )
                      and the implicit equations of the boundary curves. If we denote by 
                        
                           
                              f
                           
                           
                              i
                           
                        
                        (
                        x
                        ,
                        y
                        )
                        =
                        0
                      the implicit equation of boundary curve 
                        
                           
                              P
                           
                           
                              i
                           
                        
                        (
                        t
                        )
                      as derived in Section 4,
                        
                           (26)
                           
                              s
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    
                                       
                                          f
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                              
                              .
                           
                        
                     
                  

Let's use the acronym BR-FFD to be an FFD for which all the control points can be freely placed in constrained general position, and then weights can be computed that will make the FFD birational. We have shown that 2D FFDs of degree 
                        1
                        ×
                        n
                      are BR-FFDs. The weight computation is simple enough that, as an artist moves the control points, the weights can be computed so as to display the BR-FFD in real time. With this feedback, an artist's experience using this tool should feel similar to a conventional FFD. Furthermore, the difference between a conventional FFD (with weights all one) and a BR-FFD with the same control point positions is not excessive because, in both cases, the boundary curves are tangent to their respective control polygons at the corners of the FFD, and in both cases, the FFD lies in the convex hull of the control points.

A BR-FFD can also be defined even if the control points are not in constrained general position, but the weights will not all be non-negative. Future research might explore if this is useful.

BR-FFD offers opportunities for future work that can apply classical algebraic geometry to a practical tool in CAGD. The authors have shown that 2D FFDs of pure-degree two (six control points in a triangular lattice) are BR-FFDs, and this will be written up in a subsequent paper. We believe that tensor product 2D FFDs of degree 
                        m
                        ×
                        n
                     , 
                        m
                        ,
                        n
                        >
                        1
                      are not BR-FFDs. However, perhaps a useful tool could be devised in which 
                        r
                        <
                        (
                        m
                        +
                        1
                        )
                        (
                        n
                        +
                        1
                        )
                      control points can be freely positioned, and then the weights and remaining control point positions are computed to create a birational map. We suggest referring to such a tool as a constrained BR-FFD, or CBR-FFD.

We have also explored 3D FFDs and have concluded that the simplest tensor-product case of degree 
                        1
                        ×
                        1
                        ×
                        1
                      is not a BR-FFD. However, our preliminary work convinces us that a 2D or 3D FFD of any degree can be a CBR-FFD, if enough of the control points are constrained. The work needing to be done in this area is to develop CBR-FFD tools in which an artist can move enough control points to be productive, and for which the constraints are simple enough to be computed and imposed in real time.

@&#REFERENCES@&#

