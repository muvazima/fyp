@&#MAIN-TITLE@&#A novel snake model using new multi-step decision model for complex image segmentation

@&#HIGHLIGHTS@&#


               Research highlights
               
                  
                     
                        
                           
                           A multi-step decision model based on adaptive edge preserving generalized gradient vector flow using component-based normalization for snake model is proposed.


                        
                        
                           
                           The proposed algorithm presents a novel external force, which provides better results than other approaches in terms of noise robustness, weak edge preserving and convergence.


                        
                        
                           
                           An improved multi-step decision model based on this novel external force is adopted, which adds new effective weighting function to attenuate the magnitudes of unwanted edges and adopts narrow band method to reduce time complexity.


                        
                        
                           
                           Experimental results and comparisons against other methods show that the proposed method has better segmentation accuracy than other comparative approaches.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Active contours

Gradient information

Directional information

Border detection

@&#ABSTRACT@&#


               Graphical abstract

               
                  
                     
                        
                           Image, graphical abstract
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Active contour model, or snake model, was proposed by Kass et al. [1] in 1987. Snake model has been widely used in the fields of computer vision and image processing, for instance, edge detection [2,3], image segmentation [4,5], and target tracking [6,7]. Snake is an elastic curve which captures the target area of an image by minimizing an energy equation. The energy function generally contains an internal force field and an external force field.

The internal force field, determined by the curve itself, is used to restrain the smoothness and tightness of snake curve. The external force field has the function to drive evolving curve to approach the edge of interesting features in an image. Overall, active contour models are divided into parameter snake model and geometric snake model, whereas the former one is the subject in this paper.

Although conventional active contour model has been widely used, it still has certain disadvantages [8,9]. First, the initial contour must be very close to the interesting features in an image, because the external force field recedes rapidly when the curve is far away from the image edges. Second, image noises may stop the deformation of active contour where the local minimum energy is obtained and leads the contour to incorrect border. The disadvantages limit the applications of original active contour model, which can only handle the objects without cluttered background while the initial active contours are not far from the edges.

Xu proposed GVF snake model [10] based on a new external force field, called gradient vector flow (GVF), which is able to expand the capturing scope of initial contour and has certain convergence capability of indentation. GVF has been widely used and adapted to various models and problems, e.g., segmentation [11], tracking [7], registration [12], and skeletonization [13]. However, during the diffusion of external force field, the competing of forces happens. Thus, the GVF has the difficulty in driving a snake into long and thin indentations as well as noise sensitivity.

Based on the original GVF external force field, Xu and Prince replaced the constant weighting coefficient with two spatially varying weighting functions, and put forward the generalized gradient vector flow (GGVF) snake model [14]. The GGVF has improved GVF convergence to LTIs as well as robustness to noises. However, there is no essential difference between GGVF and GVF, so the ability of entering into the concavity of edge is limited. NGVF snake model proposed by Ning [15] decomposes the Laplace operator in the GVF external force field, and only retains the normal component [16], in this way, it can enter into LTIs at a faster convergence speed. Nevertheless, diffusion along the tangent direction is beneficial to preserve edges and smooth the noises. Furthermore, the tangential component is added to the external force field by later NBGVF snake model [17], which performs well on weak edge preserving and noise robustness. Yet the convergence capability of long and thin depression is still a nasty problem. Qin proposed the GGVF snake model based on component normalization (CN-GGVF) method on the basis of the studies about GGVF and GVF snake model. [18].

Moreover, the above methods have no ideal effect if images have complex edge structures and cluttered background. Incorrect convergence may happen, losing a lot of important foreground information.

To address the problems of driving the active contour to the object with complex boundary and cluttered background, not only can we put forward a novel external force that has a better performance in narrow and deep concavity convergence, noise robustness, and edge preserving, but also we present a multi-step decision model based on the new external force. The main contributions are summarized as follows:

                        
                           (1)
                           We propose a novel external force, called CN-AEGGVF, which integrates into the gradient information of image to preserve weak edges and add the normal and tangential self-adaptive weighting functions to the diffusion process so that it can adjust adaptively according to image characteristics. Furthermore, we also adopt the method of component-based normalization to enhance the ability of concavity convergence.

We also present a new multi-step decision model based on CN-AEGGVF. Firstly, this model uses the CN-AEGGVF snake model for obtaining approximate contour of the interesting area's boundaries. Then, a new distance map is generated according to the approximate contour. Next, the new directional edge map is created by calculating a scalar product of the gradients of the distance map and initial image.

In the process, we adopt a narrow band method to reduce time complexity and make use of the gradient directional information and the magnitude information of the distance map to attenuate unwanted edges. Finally, a refined CN-AEGGVF vector field is built by this edge map to obtain more accurate contour.

This paper begins with an overview of classical snake model and GVF snake model in Section 2. In Section 3, the proposed method is exhibited and analyzed in details. Experimental results are displayed and the results are compared in Section 4. The conclusions are given in Section 5.

@&#RELATED WORK@&#

In the active contour model first proposed in [1], an energy minimizing curve (snake) is guided by external and internal energies to create a contour around an object. It can be expressed by 
                           
                              x
                              (
                              s
                              )
                              =
                              (
                              
                                 x
                                 (
                                 s
                                 )
                                 ,
                                 y
                                 (
                                 s
                                 )
                              
                              )
                              ,
                              s
                              ∈
                              [
                              
                                 0
                                 ,
                                 1
                              
                              ]
                           
                        . The energy function is as follows:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             E
                                             
                                                s
                                                n
                                                a
                                                k
                                                e
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∫
                                                0
                                                1
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         E
                                                         
                                                            i
                                                            n
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            
                                                               (
                                                               s
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         E
                                                         
                                                            e
                                                            x
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            
                                                               (
                                                               s
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ]
                                                
                                                d
                                                s
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∫
                                                0
                                                1
                                             
                                             
                                                
                                                   [
                                                   
                                                      α
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                     x
                                                                     ′
                                                                  
                                                                  
                                                                     (
                                                                     s
                                                                     )
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                         2
                                                      
                                                      +
                                                      β
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                     x
                                                                     
                                                                        ′
                                                                        ′
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     s
                                                                     )
                                                                  
                                                               
                                                               |
                                                            
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         E
                                                         
                                                            e
                                                            x
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            
                                                               (
                                                               s
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ]
                                                
                                                d
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where
Eint
                        (x(s)), the snake's internal energy or prior, is the weighted sum of first and second derivatives of x(s).


                        Eext
                        (x(s)) represents external energy. α(s) is the elastic coefficient, and β(s) denotes intensity coefficient.

Based on the variation principle [16], Eq. (1) satisfies Euler–Lagrange equation at the maximization of contour curve energy:

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             α
                                             
                                                (
                                                s
                                                )
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                   ′
                                                
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             −
                                             β
                                             
                                                (
                                                s
                                                )
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ′
                                                   ′
                                                   ′
                                                   ′
                                                
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             −
                                             ∇
                                             
                                                E
                                                
                                                   e
                                                   x
                                                   t
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        where x‴′(s) represents the fourth derivative of x(s). Eq. (2) can be regarded as force balance equation:

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                F
                                                
                                                   i
                                                   n
                                                   t
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                F
                                                
                                                   e
                                                   x
                                                   t
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      (
                                                      s
                                                      )
                                                   
                                                
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 F
                                 
                                    i
                                    n
                                    t
                                 
                              
                              
                                 (
                                 
                                    x
                                    (
                                    s
                                    )
                                 
                                 )
                              
                              =
                              α
                              
                                 (
                                 s
                                 )
                              
                              
                                 x
                                 
                                    ′
                                    ′
                                 
                              
                              
                                 (
                                 s
                                 )
                              
                              −
                              β
                              
                                 (
                                 s
                                 )
                              
                              
                                 x
                                 
                                    ′
                                    ′
                                    ′
                                    ′
                                 
                              
                              
                                 (
                                 s
                                 )
                              
                           
                         represents internal forces constraining curve smoothing and stretching. 
                           
                              
                                 F
                                 
                                    e
                                    x
                                    t
                                 
                              
                              
                                 (
                                 x
                                 
                                    (
                                    s
                                    )
                                 
                                 )
                              
                              =
                              −
                              ∇
                              
                                 E
                                 
                                    e
                                    x
                                    t
                                 
                              
                              
                                 (
                                 x
                                 
                                    (
                                    s
                                    )
                                 
                                 )
                              
                           
                         denotes external force, driving curve to move to expected feature boundaries. The migration process of snake contour is shown in Fig. 1
                        . The green area ROI denotes the region of interest in an image. In most cases, it is the segmentation target of the image. 
                           
                              υ
                              
                                 i
                                 ,
                                 j
                              
                           
                        . represents the control point in snake curve and the curve line with different color implies different iterative process.

GVF snake proposed by Xu et al. will not consider snake model from the perspective of energy minimization, but consider it as a force balance process. Eq. (3) is the basic equation for the construction of GVF snake model. External force Fext
                        (x(s)) is substituted by a GVF field 
                           
                              υ
                              (
                              
                                 x
                                 ,
                                 y
                              
                              )
                              =
                              [
                              
                                 u
                                 (
                                 
                                    x
                                    ,
                                    y
                                 
                                 )
                                 ,
                                 v
                                 (
                                 
                                    x
                                    ,
                                    y
                                 
                                 )
                              
                              ]
                           
                        . The following energy function is obtained through minimizing its components:

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             E
                                             =
                                             
                                                
                                                
                                                   ∫
                                                
                                                
                                                   ∫
                                                
                                                
                                             
                                             
                                                μ
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                         x
                                                         2
                                                      
                                                      +
                                                      
                                                         u
                                                         y
                                                         2
                                                      
                                                      +
                                                      
                                                         v
                                                         x
                                                         2
                                                      
                                                      +
                                                      
                                                         v
                                                         y
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      
                                                         |
                                                         
                                                            ∇
                                                            f
                                                         
                                                         |
                                                      
                                                   
                                                   2
                                                
                                                
                                                   |
                                                   
                                                      υ
                                                      −
                                                      ∇
                                                      f
                                                   
                                                   |
                                                
                                                d
                                                x
                                                d
                                                y
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where f represents the edge map of processed image I; ∇f denotes gradient field of f; μ represents a parameter controlling the smoothness of GVF field. The gradient vector flow field satisfies the Euler equation:

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         μ
                                                         
                                                            ∇
                                                            2
                                                         
                                                         u
                                                         −
                                                         
                                                            (
                                                            
                                                               
                                                                  f
                                                                  x
                                                                  2
                                                               
                                                               +
                                                               
                                                                  f
                                                                  y
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               u
                                                               −
                                                               
                                                                  f
                                                                  x
                                                               
                                                            
                                                            )
                                                         
                                                         =
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         μ
                                                         
                                                            ∇
                                                            2
                                                         
                                                         v
                                                         −
                                                         
                                                            (
                                                            
                                                               
                                                                  f
                                                                  x
                                                                  2
                                                               
                                                               +
                                                               
                                                                  f
                                                                  y
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            
                                                               v
                                                               −
                                                               
                                                                  f
                                                                  x
                                                               
                                                            
                                                            )
                                                         
                                                         =
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 f
                                 x
                              
                              =
                              
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    x
                                 
                              
                           
                        , 
                           
                              
                                 f
                                 y
                              
                              =
                              
                              
                                 
                                    ∂
                                    f
                                 
                                 
                                    ∂
                                    y
                                 
                              
                           
                        . The first term is diffusion item, and ∇2 is Laplace operator.

Diffusion items in GVF snake and GGVF snake both use Laplace operator. Laplace operator is shown in Eq. (6):

                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   2
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      2
                                                   
                                                   
                                                      ∂
                                                      
                                                         x
                                                         2
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∂
                                                      2
                                                   
                                                   
                                                      ∂
                                                      
                                                         y
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In Eq. (5), ∇2
                           u and ∇2
                           v are diffusion items, 
                              
                                 (
                                 u
                                 −
                                 
                                    f
                                    x
                                 
                                 )
                              
                            and 
                              
                                 (
                                 v
                                 −
                                 
                                    f
                                    y
                                 
                                 )
                              
                            are data items. The diffusion item has strong anisotropic properties, but does not have the capability in protecting boundaries [19]. Nevertheless, data items can protect the boundaries. Therefore, in order to improve boundary protection ability of snake curve, we decompose Laplace operator in the tangential and normal directions:

                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∇
                                                   2
                                                
                                                L
                                                =
                                                
                                                   L
                                                   
                                                      T
                                                      T
                                                   
                                                
                                                +
                                                
                                                   L
                                                   
                                                      N
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                   
                                                      T
                                                      T
                                                   
                                                
                                                =
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            |
                                                            
                                                               ∇
                                                               L
                                                            
                                                            |
                                                         
                                                      
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         L
                                                         x
                                                         2
                                                      
                                                      
                                                         L
                                                         
                                                            y
                                                            y
                                                         
                                                      
                                                      +
                                                      
                                                         L
                                                         y
                                                         2
                                                      
                                                      
                                                         L
                                                         
                                                            x
                                                            x
                                                         
                                                      
                                                      −
                                                      2
                                                      
                                                         L
                                                         x
                                                      
                                                      
                                                         L
                                                         y
                                                      
                                                      
                                                         L
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   L
                                                   
                                                      N
                                                      N
                                                   
                                                
                                                =
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            |
                                                            
                                                               ∇
                                                               L
                                                            
                                                            |
                                                         
                                                      
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         L
                                                         x
                                                         2
                                                      
                                                      
                                                         L
                                                         
                                                            x
                                                            x
                                                         
                                                      
                                                      +
                                                      
                                                         L
                                                         y
                                                         2
                                                      
                                                      
                                                         L
                                                         
                                                            y
                                                            y
                                                         
                                                      
                                                      +
                                                      2
                                                      
                                                         L
                                                         x
                                                      
                                                      
                                                         L
                                                         y
                                                      
                                                      
                                                         L
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where LTT
                            and LNN
                            represent the tangential and normal second derivatives of L, respectively. So Eq. (4) can be rewritten as

                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                υ
                                                =
                                                g
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         ∇
                                                         f
                                                      
                                                      |
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      α
                                                      0
                                                   
                                                   
                                                      υ
                                                      
                                                         T
                                                         T
                                                      
                                                   
                                                   +
                                                   
                                                      β
                                                      0
                                                   
                                                   
                                                      υ
                                                      
                                                         N
                                                         N
                                                      
                                                   
                                                   )
                                                
                                                −
                                                h
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         ∇
                                                         f
                                                      
                                                      |
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      υ
                                                      −
                                                      ∇
                                                      f
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where α
                           0 and β
                           0 are two weighting coefficients controlling diffusion degree of tangential and normal components [15].

To achieve the purpose of adaptive diffusion, this paper replaces g(|∇f|) and h(|∇f|) with weighting functions s(|∇f|) and l(|∇f|) respectively. Furthermore, we add self-adaptive weighting functions [20] to the tangential and normal directions, which preserve sharper boundaries and improves the automatic stopping of the diffusion. The new weighting function can be generated as follows:

                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                l
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         ∇
                                                         f
                                                      
                                                      |
                                                   
                                                   )
                                                
                                                =
                                                1
                                                −
                                                
                                                   e
                                                   
                                                      −
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  |
                                                                  
                                                                     ∇
                                                                     f
                                                                  
                                                                  |
                                                               
                                                            
                                                            2
                                                         
                                                         
                                                            R
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                s
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         ∇
                                                         f
                                                      
                                                      |
                                                   
                                                   )
                                                
                                                =
                                                
                                                   e
                                                   
                                                      −
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  |
                                                                  
                                                                     ∇
                                                                     f
                                                                  
                                                                  |
                                                               
                                                            
                                                            2
                                                         
                                                         
                                                            R
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                K
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     [
                                                                     
                                                                        1
                                                                        −
                                                                        
                                                                           
                                                                              
                                                                                 f
                                                                                 0
                                                                              
                                                                           
                                                                           2
                                                                        
                                                                        /
                                                                        
                                                                           5
                                                                           
                                                                              
                                                                                 
                                                                                    σ
                                                                                    e
                                                                                 
                                                                              
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                     ]
                                                                  
                                                                  2
                                                               
                                                               
                                                               if
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        f
                                                                        0
                                                                     
                                                                  
                                                                  2
                                                               
                                                               /
                                                               
                                                                  5
                                                                  ≤
                                                                  
                                                                     
                                                                        
                                                                           σ
                                                                           e
                                                                        
                                                                     
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The σe
                            is a “robust scale”, which can be adjusted adaptively according to the image structure information, detailed information can be found in [21]:

                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                   e
                                                
                                                =
                                                1.4826
                                                ×
                                                E
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         
                                                            |
                                                            
                                                               ∇
                                                               
                                                                  f
                                                                  0
                                                               
                                                            
                                                            |
                                                         
                                                         −
                                                         E
                                                         
                                                            (
                                                            
                                                               |
                                                               
                                                                  ∇
                                                                  
                                                                     f
                                                                     0
                                                                  
                                                               
                                                               |
                                                            
                                                            )
                                                         
                                                      
                                                      |
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where
E( · ) denotes mean value and f
                           0 is the gradient of an image, and can be shown by 
                              
                                 
                                    f
                                    0
                                 
                                 =
                                 ∇
                                 f
                              
                           . Parameter R is a constant with positive value, depending on the need to protect the image boundary strength.

As shown in Fig. 2
                           , we present different weighting function curves of GVF, GGVF, and our method. The solid line and dotted line with same color imply the weighting functions in one snake model. μ, which is the coefficient of diffusion item in GVF model is a constant, and it is mutually independent with the weighting function |∇f|2 of data item. Both the items cannot be adjusted accordingly when |∇f| changes. Therefore, GVF model cannot adjust diffusion and data items adaptively based on the local image features. Furthermore, our weighting function (the curves with red and blue) has a faster ability to stop and increase than GGVF, this can strengthen the influence of useful item in different stages (image smoothing area and edge regions).

Combining Eq. (11), Eq. (12) and Eq. (13), Eq. (10) can be written in the form of equations as follow:

                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            u
                                                            =
                                                            s
                                                            
                                                               (
                                                               
                                                                  |
                                                                  
                                                                     ∇
                                                                     f
                                                                  
                                                                  |
                                                               
                                                               )
                                                            
                                                            ·
                                                            
                                                               (
                                                               
                                                                  (
                                                                  1
                                                                  −
                                                                  K
                                                                  )
                                                               
                                                               ·
                                                               
                                                                  u
                                                                  
                                                                     T
                                                                     T
                                                                  
                                                               
                                                               +
                                                               K
                                                               ·
                                                               
                                                                  u
                                                                  
                                                                     N
                                                                     N
                                                                  
                                                               
                                                               )
                                                            
                                                            −
                                                            l
                                                            
                                                               (
                                                               
                                                                  |
                                                                  
                                                                     ∇
                                                                     f
                                                                  
                                                                  |
                                                               
                                                               )
                                                            
                                                            
                                                               (
                                                               
                                                                  u
                                                                  −
                                                                  
                                                                     f
                                                                     x
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                            =
                                                            s
                                                            
                                                               (
                                                               
                                                                  |
                                                                  
                                                                     ∇
                                                                     f
                                                                  
                                                                  |
                                                               
                                                               )
                                                            
                                                            ·
                                                            
                                                               (
                                                               
                                                                  (
                                                                  1
                                                                  −
                                                                  K
                                                                  )
                                                               
                                                               ·
                                                               
                                                                  v
                                                                  
                                                                     T
                                                                     T
                                                                  
                                                               
                                                               +
                                                               K
                                                               ·
                                                               
                                                                  v
                                                                  
                                                                     N
                                                                     N
                                                                  
                                                               
                                                               )
                                                            
                                                            −
                                                            l
                                                            
                                                               (
                                                               
                                                                  |
                                                                  
                                                                     ∇
                                                                     f
                                                                  
                                                                  |
                                                               
                                                               )
                                                            
                                                            
                                                               (
                                                               
                                                                  v
                                                                  −
                                                                  
                                                                     f
                                                                     y
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We know the gradient vector ∇Gσ
                            × I(x, y) is orthogonal to the edges, it is easy to show the vector q defined as follows:

                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                q
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               I
                                                               y
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  I
                                                                  x
                                                                  2
                                                               
                                                               +
                                                               
                                                                  I
                                                                  y
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            I
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  I
                                                                  x
                                                                  2
                                                               
                                                               +
                                                               
                                                                  I
                                                                  y
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The vector q is orthogonal to the gradient vector ∇Gσ
                           *I(x, y), so it is parallel to the edges.

We assume a unit vector 
                              
                                 
                                    m
                                    →
                                 
                                 
                                    (
                                    
                                       m
                                       x
                                    
                                    ,
                                    
                                       m
                                       y
                                    
                                    )
                                 
                              
                            to lead our approach, the second derivate of u along the direction represented by 
                              
                                 m
                                 →
                              
                            is given by [22,23]

                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      u
                                                   
                                                   
                                                      ∂
                                                      
                                                         m
                                                         2
                                                      
                                                   
                                                
                                                =
                                                
                                                   u
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                
                                                   m
                                                   x
                                                   2
                                                
                                                +
                                                2
                                                
                                                   u
                                                   
                                                      x
                                                      y
                                                   
                                                
                                                
                                                   m
                                                   x
                                                
                                                m
                                                
                                                   
                                                   y
                                                
                                                +
                                                
                                                   u
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                
                                                   m
                                                   y
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

If 
                              
                                 m
                                 →
                              
                            is orthogonal to the gradient of u, we can show 
                              
                                 m
                                 →
                              
                            as follows:

                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                   →
                                                
                                                =
                                                
                                                   
                                                      (
                                                      
                                                         −
                                                         
                                                            u
                                                            y
                                                         
                                                         ,
                                                         
                                                            u
                                                            x
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                            x
                                                            2
                                                         
                                                         +
                                                         
                                                            u
                                                            y
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Therefore, combining Eq. (17) and Eq. (18), we can obtain the result as follows:

                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      u
                                                   
                                                   
                                                      ∂
                                                      
                                                         m
                                                         2
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         u
                                                         
                                                            x
                                                            x
                                                         
                                                      
                                                      
                                                         u
                                                         x
                                                         2
                                                      
                                                      +
                                                      
                                                         u
                                                         
                                                            y
                                                            y
                                                         
                                                      
                                                      
                                                         u
                                                         y
                                                         2
                                                      
                                                      −
                                                      2
                                                      
                                                         u
                                                         x
                                                      
                                                      
                                                         u
                                                         y
                                                      
                                                      
                                                         u
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                         x
                                                         2
                                                      
                                                      +
                                                      
                                                         u
                                                         y
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Comparing with Eq. (8), we find a conclusion in Eq. (20).

                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      u
                                                   
                                                   
                                                      ∂
                                                      
                                                         m
                                                         2
                                                      
                                                   
                                                
                                                =
                                                
                                                   u
                                                   
                                                      T
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Inspired by the above derivation, naturally, we can get the direction along q as follows:

                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      u
                                                   
                                                   
                                                      ∂
                                                      
                                                         q
                                                         2
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         u
                                                         
                                                            x
                                                            x
                                                         
                                                      
                                                      
                                                         I
                                                         x
                                                         2
                                                      
                                                      +
                                                      
                                                         u
                                                         
                                                            y
                                                            y
                                                         
                                                      
                                                      
                                                         I
                                                         y
                                                         2
                                                      
                                                      −
                                                      2
                                                      
                                                         u
                                                         
                                                            x
                                                            y
                                                         
                                                      
                                                      
                                                         I
                                                         x
                                                      
                                                      
                                                         I
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                         x
                                                         2
                                                      
                                                      +
                                                      
                                                         I
                                                         y
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Therefore, we adopt the operator (21) to our mode to preserve leading weak edge.

Based on the studies of external force features in GGVF [14] snake model, Qin [18] put forward to the effective component-based normalization method to enhance the ability of depression convergence, which is different from the vector-based normalization of GGVF. The new method is used to replace conventional external force field 
                              
                                 −
                                 ∇
                                 
                                    E
                                    
                                       e
                                       x
                                       t
                                    
                                 
                                 
                                    (
                                    v
                                    
                                       (
                                       s
                                       )
                                    
                                    )
                                 
                              
                            with 
                              
                                 
                                    υ
                                    
                                       c
                                       n
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       u
                                       
                                          c
                                          n
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ,
                                    
                                       v
                                       
                                          c
                                          n
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ]
                                 
                              
                           . The components are defined as follows:

                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   
                                                      c
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               
                                                               u
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                               >
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               
                                                               u
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                               =
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               −
                                                               1
                                                               
                                                               u
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                               <
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                   
                                                      c
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               
                                                               v
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                               >
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               
                                                               v
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                               =
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               −
                                                               1
                                                               
                                                               v
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                               <
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In our proposed snake model, we adopt the above method, and detailed information is given in [18].

We present a novel adaptive edge preserving generalized gradient vector field snake model based on component-based normalization, called simply CN-AEGGVF. The CN-AEGGVF is given by the unified diffusion framework:

                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            u
                                                            =
                                                            
                                                               
                                                                  
                                                                     s
                                                                     
                                                                        (
                                                                        
                                                                           |
                                                                           
                                                                              ∇
                                                                              f
                                                                           
                                                                           |
                                                                        
                                                                        )
                                                                     
                                                                     ·
                                                                     
                                                                        (
                                                                        
                                                                           (
                                                                           1
                                                                           −
                                                                           K
                                                                           )
                                                                        
                                                                        ·
                                                                        
                                                                           u
                                                                           
                                                                              T
                                                                              T
                                                                           
                                                                        
                                                                        +
                                                                        K
                                                                        ·
                                                                        
                                                                           u
                                                                           
                                                                              N
                                                                              N
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  smoothness
                                                                  
                                                                  item
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     l
                                                                     
                                                                        (
                                                                        
                                                                           |
                                                                           
                                                                              ∇
                                                                              f
                                                                           
                                                                           |
                                                                        
                                                                        )
                                                                     
                                                                     ·
                                                                     
                                                                        (
                                                                        
                                                                           u
                                                                           −
                                                                           
                                                                              f
                                                                              x
                                                                           
                                                                           −
                                                                           R
                                                                           ·
                                                                           
                                                                              
                                                                                 
                                                                                    ∂
                                                                                    2
                                                                                 
                                                                                 u
                                                                              
                                                                              
                                                                                 ∂
                                                                                 
                                                                                    q
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  data
                                                                  
                                                                  item
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                            =
                                                            
                                                               
                                                                  
                                                                     s
                                                                     
                                                                        (
                                                                        
                                                                           |
                                                                           
                                                                              ∇
                                                                              f
                                                                           
                                                                           |
                                                                        
                                                                        )
                                                                     
                                                                     ·
                                                                     
                                                                        (
                                                                        
                                                                           (
                                                                           1
                                                                           −
                                                                           K
                                                                           )
                                                                        
                                                                        ·
                                                                        
                                                                           v
                                                                           
                                                                              T
                                                                              T
                                                                           
                                                                        
                                                                        +
                                                                        K
                                                                        ·
                                                                        
                                                                           v
                                                                           
                                                                              N
                                                                              N
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  smoothness
                                                                  
                                                                  item
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     l
                                                                     
                                                                        (
                                                                        
                                                                           |
                                                                           
                                                                              ∇
                                                                              f
                                                                           
                                                                           |
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        (
                                                                        
                                                                           v
                                                                           −
                                                                           
                                                                              f
                                                                              y
                                                                           
                                                                           −
                                                                           R
                                                                           ·
                                                                           
                                                                              
                                                                                 
                                                                                    ∂
                                                                                    2
                                                                                 
                                                                                 v
                                                                              
                                                                              
                                                                                 ∂
                                                                                 
                                                                                    q
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  ︸
                                                               
                                                               
                                                                  data
                                                                  
                                                                  item
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

At the image smoothing area, when |∇f| → 0, then we can know K → 1 from Fig. 2. The smoothness term in Eq. (24) is dominated by normal diffusion 
                                 
                                    υ
                                    
                                       N
                                       N
                                    
                                 
                              . In the extreme, i.e. 
                                 
                                    K
                                    =
                                    1
                                 
                              , Eq. (24) is reduced to the following form:

                                 
                                    (25)
                                    
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                               =
                                                               s
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               
                                                                  u
                                                                  
                                                                     N
                                                                     N
                                                                  
                                                               
                                                               −
                                                               l
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               
                                                                  (
                                                                  
                                                                     u
                                                                     −
                                                                     
                                                                        f
                                                                        x
                                                                     
                                                                     −
                                                                     R
                                                                     ·
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 ∂
                                                                                 2
                                                                              
                                                                              u
                                                                           
                                                                           
                                                                              ∂
                                                                              
                                                                                 q
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               =
                                                               s
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               
                                                                  v
                                                                  
                                                                     N
                                                                     N
                                                                  
                                                               
                                                               −
                                                               l
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               
                                                                  (
                                                                  
                                                                     v
                                                                     −
                                                                     
                                                                        f
                                                                        y
                                                                     
                                                                     −
                                                                     R
                                                                     ·
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 ∂
                                                                                 2
                                                                              
                                                                              v
                                                                           
                                                                           
                                                                              ∂
                                                                              
                                                                                 q
                                                                                 2
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

In this way, it can enter into deep and narrow concavity like NGVF [15]. However, our model is different from NGVF [15] for adopting the component-based normalization method, so that our method has stronger convergence ability.

When |∇f| → ∞, namely in the edge regions, then K → 0, therefore, Eq. (24) is reduced to the following form:

                                 
                                    (26)
                                    
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               u
                                                               =
                                                               s
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               
                                                                  u
                                                                  
                                                                     T
                                                                     T
                                                                  
                                                               
                                                               +
                                                               l
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               R
                                                               ·
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ∂
                                                                           2
                                                                        
                                                                        u
                                                                     
                                                                     
                                                                        ∂
                                                                        
                                                                           q
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                               −
                                                               l
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               
                                                                  (
                                                                  u
                                                                  −
                                                                  
                                                                     f
                                                                     x
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               =
                                                               s
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               
                                                                  v
                                                                  
                                                                     T
                                                                     T
                                                                  
                                                               
                                                               +
                                                               l
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               R
                                                               ·
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ∂
                                                                           2
                                                                        
                                                                        v
                                                                     
                                                                     
                                                                        ∂
                                                                        
                                                                           q
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                               −
                                                               l
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        ∇
                                                                        f
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                               
                                                                  (
                                                                  v
                                                                  −
                                                                  
                                                                     f
                                                                     x
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Then, the item 
                                 
                                    s
                                    
                                       (
                                       |
                                       
                                          ∇
                                          f
                                       
                                       |
                                       )
                                    
                                    ·
                                    
                                       u
                                       
                                          T
                                          T
                                       
                                    
                                    +
                                    l
                                    
                                       (
                                       |
                                       
                                          ∇
                                          f
                                       
                                       |
                                       )
                                    
                                    ·
                                    R
                                    ·
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          u
                                       
                                       
                                          ∂
                                          
                                             q
                                             2
                                          
                                       
                                    
                                 
                               that is parallel to edges yields a preserving weak edge effect and efficiently suppresses the influence of noise.

In GVF snake model, boundary image is gained through the image gradient and external force field is achieved based on the boundary information. It is very necessary to get an accurate boundary image. However, GVF snake model only retains the amplitude value of gradient image, losing gradient direction information [24–26]. With a complicated background, snake curve may easily converge to false boundaries. For driving snake curve to converge more correctly to the desired boundary, we optimize the process of capturing a boundary image and present a multi-step decision model based on CN-AEGGVF. The flow chart is shown in Fig. 3.
                           
                        


                           Step 1: We use our CN-AEGGVF snake model to obtain an approximate contour 
                              
                                 L
                                 (
                                 s
                                 )
                                 =
                                 [
                                 
                                    x
                                    (
                                    s
                                    )
                                    ,
                                    y
                                    (
                                    s
                                    )
                                 
                                 ]
                                 (
                                 
                                    s
                                    ∈
                                    [
                                    
                                       0
                                       ,
                                       1
                                    
                                    ]
                                 
                                 )
                              
                           .


                           Step 2: A new distance map is defined associated with the approximate contour. We consider distance map as the final boundary image of ROI and apply it in the iterative process of external force field. The process to generate distance map is as follows.

Firstly, a normal distance is obtained by calculating the minimum Euclidean distance D(x, y) from any point (x, y) in the image to the contour L(s):

                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                D
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                =
                                                m
                                                i
                                                
                                                   n
                                                   
                                                      s
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               [
                                                               
                                                                  x
                                                                  −
                                                                  x
                                                                  
                                                                     (
                                                                     s
                                                                     )
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               [
                                                               
                                                                  y
                                                                  −
                                                                  y
                                                                  
                                                                     (
                                                                     s
                                                                     )
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Then, different from the definition of the calculation formula of distance in [24–26], according to Fig. 2, we define a weighting function as follows:

                              
                                 (28)
                                 
                                    
                                       
                                          
                                             
                                                Q
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      [
                                                      
                                                         1
                                                         −
                                                         
                                                            
                                                               D
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           x
                                                                           ,
                                                                           y
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  r
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     σ
                                                                     d
                                                                  
                                                               
                                                               r
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where σd
                            and r are two non-negative parameters controlling the decline rate of distance weighting function.

Then distance function with weight 
                              
                                 
                                    D
                                    
                                       w
                                       e
                                       i
                                       g
                                       h
                                       t
                                    
                                 
                                 =
                                 D
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ·
                                 Q
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                              
                            is obtained:

                              
                                 (29)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      w
                                                      e
                                                      i
                                                      g
                                                      h
                                                      t
                                                   
                                                
                                                =
                                                m
                                                i
                                                
                                                   n
                                                   
                                                      s
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            [
                                                            x
                                                            −
                                                            x
                                                            (
                                                            s
                                                            )
                                                            ]
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            [
                                                            y
                                                            −
                                                            y
                                                            (
                                                            s
                                                            )
                                                            ]
                                                         
                                                         2
                                                      
                                                   
                                                
                                                ·
                                                
                                                   
                                                      [
                                                      
                                                         1
                                                         −
                                                         
                                                            
                                                               D
                                                               
                                                                  
                                                                     
                                                                        (
                                                                        
                                                                           x
                                                                           ,
                                                                           y
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  r
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     σ
                                                                     d
                                                                  
                                                               
                                                               r
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The curve of Dweight
                            function is shown in Fig. 4
                           . It shows that the function has an inflection point
                              
                                 p
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             σ
                                             d
                                          
                                          
                                             
                                                2
                                                r
                                                +
                                                1
                                             
                                             r
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                             d
                                          
                                          
                                             
                                                2
                                                r
                                                +
                                                1
                                             
                                             r
                                          
                                       
                                       ×
                                       
                                          
                                             [
                                             
                                                
                                                   2
                                                   r
                                                
                                                
                                                   2
                                                   r
                                                   +
                                                   1
                                                
                                             
                                             ]
                                          
                                          2
                                       
                                    
                                    )
                                 
                              
                           , and Dweight
                            curve is an increasing function in the region 
                              
                                 [
                                 
                                    0
                                    ,
                                    
                                       
                                          σ
                                          d
                                       
                                       
                                          
                                             2
                                             r
                                             +
                                             1
                                          
                                          r
                                       
                                    
                                 
                                 ]
                              
                           . Actually, with the increase of the distance D(x,y), the weighting distance function D
                           weight(x,y) should increase gradually. Therefore, D(x, y) must satisfy the following inequality:

                              
                                 (30)
                                 
                                    
                                       
                                          
                                             
                                                D
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   
                                                      σ
                                                      d
                                                   
                                                   
                                                      
                                                         2
                                                         r
                                                         +
                                                         1
                                                      
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We define D
                           max  as the maximum of D(x, y), and σd
                            is expressed as follows:

                              
                                 (31)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                   d
                                                
                                                =
                                                
                                                   
                                                      2
                                                      r
                                                      +
                                                      1
                                                   
                                                   r
                                                
                                                
                                                   D
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Then Eq. (29) is converted to solve the following decreasing function:

                              
                                 (32)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   
                                                      w
                                                      e
                                                      i
                                                      g
                                                      h
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                =
                                                D
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                ·
                                                
                                                   
                                                      [
                                                      
                                                         1
                                                         −
                                                         
                                                            
                                                               D
                                                               
                                                                  
                                                                     (
                                                                     x
                                                                     ,
                                                                     y
                                                                     )
                                                                  
                                                                  r
                                                               
                                                            
                                                            
                                                               
                                                                  (
                                                                  2
                                                                  r
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  
                                                                     
                                                                        D
                                                                        max
                                                                     
                                                                  
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The function of distance map can be acquired from Eqs. (26) and (32).

Actually, we are more interested in the gradient of the distance map, for the gradient can be used to define a new CN-AEGGVF edge map. Therefore, we get the first-order derivative of Eq. (31), which can greatly reflect the gradient of the distance map.

                              
                                 (33)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   w
                                                   ′
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   [
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            D
                                                            
                                                               
                                                                  (
                                                                  x
                                                                  ,
                                                                  y
                                                                  )
                                                               
                                                               r
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  D
                                                                  max
                                                               
                                                            
                                                            r
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                ·
                                                
                                                   [
                                                   
                                                      1
                                                      −
                                                      
                                                         
                                                            D
                                                            
                                                               
                                                                  (
                                                                  x
                                                                  ,
                                                                  y
                                                                  )
                                                               
                                                               r
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               2
                                                               r
                                                               +
                                                               1
                                                               )
                                                            
                                                            ·
                                                            
                                                               
                                                                  
                                                                     D
                                                                     max
                                                                  
                                                               
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The curves of the first-order derivative with different r are shown in Fig. 5
                           , and the value of D
                           max is 20 here, we note that all the curves start from the point (0, 1) and rise gradually till to the point (20, 0).

We can see the effect of the coefficient r on the gradient of the distance map from Fig. 5. When r is small, the magnitude of the gradient decrease rapidly, while when r is large, the magnitude of the gradient decrease slowly.


                           Step 3: We define a signed distance map ϕ(x,y) as mentioned in [27]:

                              
                                 (34)
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               −
                                                               D
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  if
                                                                  
                                                                  point
                                                                  
                                                                  (
                                                               
                                                               x
                                                               ,
                                                               y
                                                               
                                                                  )
                                                                  
                                                                  is
                                                                  
                                                                  inside
                                                                  
                                                                  the
                                                                  
                                                                  contour
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               
                                                                  if
                                                                  
                                                                  point
                                                                  
                                                                  (
                                                               
                                                               x
                                                               ,
                                                               y
                                                               
                                                                  )
                                                                  
                                                                  is
                                                                  
                                                                  on
                                                                  
                                                                  the
                                                                  
                                                                  contour
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               D
                                                               (
                                                               x
                                                               ,
                                                               y
                                                               )
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  if
                                                                  
                                                                  point
                                                                  
                                                                  (
                                                               
                                                               x
                                                               ,
                                                               y
                                                               
                                                                  )
                                                                  
                                                                  is
                                                                  
                                                                  outside
                                                                  
                                                                  the
                                                                  
                                                                  contour
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The gradient of the signed distance is a vector field that has a unit magnitude and points outwards with respect to the approximate contour at every point.

We can know easily the complexity of computing ϕ(x, y) is o(MN), M and N denote respectively the total number of pixels in the image and approximate contour. Therefore, there is a very expensive amount of calculation if the image size is large. Considering the approximate contour is close to the object boundary, we calculate the signed distance in a narrow band, which is shown in Fig. 6
                           . The red curve in the narrow band is approximate contour, and the green curve is external and inner boundary. δ is the width of the strip. So the calculation only requires o(MK), K is the number of pixels in narrow band. The more detailed information is given in [28].

Then the gradient of the signed map is a 2D vector field that has unit magnitude and points outwards with respect to the boundary at every point, which is proposed in [27]. However, different from the definition of this vector field, we replace D(x,y) with D
                           weight(x,y), then a new vector is defined as follows:

                              
                                 (35)
                                 
                                    
                                       
                                          
                                             
                                                n
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                =
                                                
                                                   
                                                      ∂
                                                      
                                                         D
                                                         
                                                            w
                                                            e
                                                            i
                                                            g
                                                            h
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      D
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                
                                                ·
                                                ∇
                                                ϕ
                                                =
                                                
                                                   D
                                                   w
                                                   ′
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                ·
                                                ∇
                                                ϕ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The newly proposed vector field n(x,y) ameliorates the unwanted edges by concerning not only the directionalities of the vectors but also the magnitudes of the vectors, However, the 2D vectors in [25–27] only rely on the directionalities of the vector for they have unit magnitudes.


                           Step 4: The new distance boundary image can be gained by using the calculation of the scalar product of the 2D vector field and the filtered image gradient as follows:

                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   
                                                      n
                                                      e
                                                      w
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  [
                                                                  f
                                                                  
                                                                     (
                                                                     x
                                                                     ,
                                                                     y
                                                                     )
                                                                  
                                                                  ·
                                                                  n
                                                                  
                                                                     (
                                                                     
                                                                        x
                                                                        ,
                                                                        y
                                                                     
                                                                     )
                                                                  
                                                                  ]
                                                                  
                                                                     
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               f
                                                               
                                                                  (
                                                                  
                                                                     x
                                                                     ,
                                                                     y
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               n
                                                               
                                                                  (
                                                                  
                                                                     x
                                                                     ,
                                                                     y
                                                                  
                                                                  )
                                                               
                                                               ≥
                                                               0
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               f
                                                               
                                                                  (
                                                                  
                                                                     x
                                                                     ,
                                                                     y
                                                                  
                                                                  )
                                                               
                                                               ·
                                                               n
                                                               
                                                                  (
                                                                  
                                                                     x
                                                                     ,
                                                                     y
                                                                  
                                                                  )
                                                               
                                                               <
                                                               0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 f
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 ∇
                                 (
                                 
                                    G
                                    σ
                                 
                                 ×
                                 I
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 )
                              
                           .

The scalar product gives high values for the filtered image gradients that have the desired directions and low values for the filtered image gradients that have different directions. Thus, a new directional boundary map is defined to highlight the desired edges and eliminate the unwanted edges with the help of the 2D vector field n(x, y).


                           Step 5: In this step, a refined CN-AEGGVF vector field is built by the gradient vectors of this new edge map fnew
                           (x, y). Because the initial contour found in the first step is near the real boundaries, the CN-AEGGVF field can drive the snake until it converges to boundaries, which is more precise than the approximate contour obtained in Step 1.


                           Step 6: Select multiple cycles for solving boundary image depending on the complexity of image background. Generally, the cycle just needs to be performed once (we just set multiple times in advance).

In this section, the performance of the proposed multi-step directional decision model based on CN-AEGGVF is compared with the existing GVF [10], GGVF [14], NGVF [15], NBGVF [17], CN-GGVF [18]. Firstly, we discuss the parameters that are involved in our method, and then we will demonstrate some desirable properties of our proposed snake model CN-AEGGVF in terms of narrow and deep concavity convergence, noise robustness, and edge preserving. Finally, we carry out experiments on ten nature images which are selected from the Complex Scene Saliency Dataset (CSSD) [29] to verify the effect of proposed of CN-AEGGVF and Visual Studio 2008 is used as the implement environment of the multi-step decision model based on CN-AEGGVF to reduce time.

Our algorithm relies on several parameters that must be set. In this section, we describe each parameter and how they may be estimated directly from data. The main parameters in our method include {α, β, σ, τ, r, R}. Although the method contains many parameters, most of these parameters can be set to fixed values (e.g. 
                           
                              α
                              =
                              0.8
                           
                        ,
                           
                              β
                              =
                              0.1
                           
                        , time step
                           
                              τ
                              =
                              1
                           
                        ). Parameter σ is the standard deviation of the Gaussian kernel Gσ
                         for controlling the smoothness of the external force field. The higher the image noise the larger σ should be. Parameter r is the non-negative parameter controlling the decline rate of distance weighting function, we can choose an appropriate value according to Fig. 5, in this experiment, we set 
                           
                              r
                              =
                              4
                           
                        .

Parameter R is a critical parameter that determines the contrast of the edges to be preserved and should be tuned for a particular application. If the boundaries are weaker, the value of R is relatively smaller. On the contrary, the value of R is higher, which can be appropriately adjusted based on different features of image boundaries. We choose this parameter by trial and error according to the mentioned reference [18]. Therefore, we test the range of R by a cardiac CT image with weak border and a “U-shape” image with strong edge. As is shown in Fig. 7
                        , R bounded in the interval [0.03, 0.07] can give us good results for the cardiac CT, In contrast, the “ U-shape” image gives us a wide range of the parameter R.

We use a concavity of 9-pixel width and 62-pixel depth to verify the concavity performance of the CN-AEGGVF snake model (see Fig. 8
                           ). Fig. 8 is a comparison of GVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    2
                                    )
                                 
                              
                           , GGVF
                              
                                 (
                                 k
                                 =
                                 0
                                 
                                    .
                                    05
                                    )
                                 
                              
                           , NGVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    2
                                    )
                                 
                              
                           , NBGVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    2
                                    ,
                                 
                                 k
                                 =
                                 0
                                 
                                    .
                                    04
                                    )
                                 
                              
                           , CN-GGVF
                              
                                 (
                                 k
                                 =
                                 0
                                 
                                    .
                                    05
                                    )
                                 
                              
                           , and CN-AEGGVF
                              
                                 (
                                 R
                                 =
                                 0
                                 
                                    .
                                    2
                                    )
                                 
                              
                            after 80 iterations.

We can see that CN-AEGGVF and CN-GGVF have similar properties that can enter into the concave region successfully and extract the object correctly, while the GVF, GGVF, NGVF, NBGVF active models are all failed.

In this experiment, we choose a synthetic torus image [28] that the upper left part is blurred and the edge of the outer circle is weak while the inner circle is strong to demonstrate the properties of weak edge preserving. A comparison of GVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    03
                                    )
                                 
                              
                           , GGVF
                              
                                 (
                                 k
                                 =
                                 0
                                 
                                    .
                                    03
                                    )
                                 
                              
                           , NGVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    03
                                    )
                                 
                              
                           , NBGVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    03
                                    ,
                                 
                                 k
                                 =
                                 0
                                 
                                    .
                                    00009
                                    )
                                 
                              
                           , CN-GGVF
                              
                                 (
                                 k
                                 =
                                 0
                                 
                                    .
                                    03
                                    )
                                 
                              
                           , and CN-AEGGVF
                              
                                 (
                                 R
                                 =
                                 0
                                 
                                    .
                                    03
                                    )
                                 
                              
                            is shown in Fig. 9
                           . The parameter σ for active contour is set as 
                              
                                 σ
                                 =
                                 1
                              
                           .

We can find the active contour models except the CN-AEGGVF model are driven to move across week edges to the strong neighboring ones from Fig. 9.
                        


                           Fig. 10
                           (a) with strong speckle noise is used to test whether the snake model can extract the object correctly under the strong noise interference. The parameter σ for active contour models is set as 
                              
                                 σ
                                 =
                                 2
                              
                           . Fig. 9(b)–(g) show clearly the difference among GVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    2
                                    )
                                 
                              
                           , GGVF
                              
                                 (
                                 k
                                 =
                                 0
                                 
                                    .
                                    4
                                    )
                                 
                              
                           , NGVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    2
                                    )
                                 
                              
                           , NBGVF
                              
                                 (
                                 u
                                 =
                                 0
                                 
                                    .
                                    2
                                    ,
                                 
                                 k
                                 =
                                 0
                                 
                                    .
                                    04
                                    )
                                 
                              
                           , CN-GGVF
                              
                                 (
                                 k
                                 =
                                 0
                                 
                                    .
                                    4
                                    )
                                 
                              
                            and CN-AEGGVF
                              
                                 (
                                 R
                                 =
                                 0
                                 
                                    .
                                    2
                                    )
                                 
                              
                           . Experimental results reflect that CN-AEGGVF and NBGVF have the better noise robustness than others. Furthermore, CN-AEGGVF is slight better than NBGVF in segmentation results.

We compare our method with the existing GVF [10], GGVF [14], NGVF [15], NBGVF [17], CN-GGVF [18] by carrying out experiments on ten nature images which are selected from the Complex Scene Saliency Dataset (CSSD) [29] and analyze experimental results in turn. For convenience, we name the ten images in Table 1
                         .The sequence is from top to bottom according to Fig. 11
                        . The basic parameters of all methods are 
                           
                              α
                              =
                              0.8
                              ,
                              β
                              =
                              0
                              
                                 .
                                 1
                              
                           
                        . In GVF snake model, 
                           
                              μ
                              =
                              0.2
                           
                        , which can be found in [10]. The new parameter R in our method has different values according to the image features as mentioned above.

Ten cases are shown in Fig. 11 with the initialized contour for all approaches, ground truth and their segmented results. The ground truth images are available in the CSSD [29]. The proposed method performs very well in comparison to the other methods in the presence of strong textured backgrounds. For instance, in the “Mushroom” image, the other methods have difficulty extracting the border of “Mushroom”, due to the strong structural variations created by the leaves in the background. This leads the other methods to attract to wrong borders. A similar example can be found in the “Goose” image where the background has many structural details created by small white flowers.

Another situation where other methods show difficulty is in the presence of textures regions with strong structural features. Within these textures, strong structural variation can be found and these approaches attract to these local minima. In the image of “Cat”, “Mandarin-duck” and “Hawk” shown in Fig. 11, most methods are found to both over-segment the image in the presence of the cluttered background as well as under-segment within the object due to the initial pattern.

The proposed method has revealed potential for image segmentation due to its self-adaptive characteristic according to different image feature which allows it to outperform the compared active contour models in different images. In spite of this, our method still has limitations, where the directional information and edge gradient are not enough to distinguish the ROI form a cluttered background. As shown in Fig. 11, the curves are unable to converge to the correct boundary in “Car” and “Goose”, because the roadbed is too close with the wheels and the small white flowers are cluttered compared with the weak edge of the goose.

The subjective evaluation about algorithm performance has some limitations. Precision, recall and F1 measure [30] are adopted to evaluate the segmentation results objectively. We briefly present the definition and method of application when these three criteria are used in image segmentation. Imagining an image I, the segmentation result using a certain method is denoted as Mseg
                        . The ground truth is denoted as Gseg
                        . The overlapping region of Mseg
                         and Gseg
                         is defined as Oseg
                        .

So the precision can be represented as the following equation:

                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             P
                                             =
                                             
                                                
                                                   
                                                      M
                                                      
                                                         s
                                                         e
                                                         g
                                                      
                                                   
                                                   ∩
                                                   
                                                      G
                                                      
                                                         s
                                                         e
                                                         g
                                                      
                                                   
                                                
                                                
                                                   M
                                                   
                                                      s
                                                      e
                                                      g
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Similarly, the recall can be defined as

                           
                              (38)
                              
                                 
                                    
                                       
                                          
                                             R
                                             =
                                             
                                                
                                                   
                                                      M
                                                      
                                                         s
                                                         e
                                                         g
                                                      
                                                   
                                                   ∩
                                                   
                                                      G
                                                      
                                                         s
                                                         e
                                                         g
                                                      
                                                   
                                                
                                                
                                                   G
                                                   
                                                      s
                                                      e
                                                      g
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

F1 measure gives a comprehensive evaluation considering precision and recall. F1 measure is defined as follows:

                           
                              (39)
                              
                                 
                                    
                                       
                                          
                                             F
                                             =
                                             
                                                
                                                   2
                                                   ×
                                                   P
                                                   ×
                                                   R
                                                
                                                
                                                   P
                                                   +
                                                   R
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The detailed comparison charts of different methods applying on ten images are displayed in Fig. 12(a)–(j). The average values of the three criteria using different methods are given in Fig. 12(k). It is obviously that the proposed method has much better accuracy of segmentation than the other methods.

To consider the computation time in multi-step decision model based on CN-AEGGVF, we note that all the simulation are implemented in Visual Studio 2008 on the 3.40GHz computer that CPU is Intel Core™ i7-3770. Table 2
                         presents the details about the computation time in multi-step decision model based on CN-AEGGVF. As observed in Table 2, our proposed model take much time in obtaining two contours by CN-AEGGVF, we also find that the computation of the distance function spends less time, since we adopt narrow band method to calculate the signed distance. Table 3
                         shows the computation time of other methods, so we can see that our approach on time performance is slightly worse than other methods.

@&#CONCLUSION@&#

In this paper, we have proposed a multi-step decision model based on CN-AEGGVF for the object with complex boundary and cluttered background. Firstly, we demonstrated the performance of our CN-AEGGVF active contour model, against the GVF, GGVF, NGVF, NBGVF, CN-GGVF. In general, the CN-AEGGVF model has strong ability of narrow and deep concavity convergence, and it is much more robust toward detecting and preserving the locations of weak edges, even with much noises. Then, we presented a multi-step decision model based on CN-AEGGVF, and the nature image dataset with a complex boundary and cluttered background is used to evaluate our method. Besides the visual evaluation, precision, recall and F1 measure are adopted to evaluate our method objectively.

Experimental results demonstrate that the proposed method has effectively addressed the incorrect convergence problem in nature image with cluttered background and complex border structure. According to the compassion with other snake model, our method has more accurate segmentation results. However, our algorithm has the relatively more computation time than other methods. The future work is to extend our method to 3D model.

@&#ACKNOWLEDGEMENT@&#

This research is funded by the National Natural Science Foundation of China (NSFC) under grant No. 61375025, No. 61075011 and No. 60675018, and also the Scientific Research Foundation for the Returned Overseas Chinese Scholars from the State Education Ministry of China.

@&#REFERENCES@&#

