@&#MAIN-TITLE@&#Dual-mode production planning for manufacturing with emission constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model a dual-mode production planning problem for manufacturing with two types of emission constraints.


                        
                        
                           
                           The structure of the model is carefully investigated and some analytical properties are proven.


                        
                        
                           
                           The subproblem of choosing the optimal mix of production modes is addressed.


                        
                        
                           
                           A polynomial dynamic programming algorithm is developed to solve the problem optimally.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in environment and climate change

Emission constraints

Dual modes

Production planning

Polynomial algorithm

@&#ABSTRACT@&#


               
               
                  We study a dual-mode production planning problem with emission constraints, where a manufacturer produces a single product with two optional technologies. The manufacturer is equipped with the regular and green technologies to comply with emission limitations, and either one or both can be adopted for production. We first investigate the problem under a mandatory emission-cap policy and then extend it to consider emission trading under an emission cap-and-trade scheme. Based on the structural properties of the problem and a multi-level decomposition approach, a polynomial dynamic programming algorithm is developed to solve the models optimally. Our analysis shows that the manufacturer should only use a mix of both technologies when the emission cap is a binding constraint. Numerical results show that the manufacturer’s decisions and benefits are significantly affected by the emission cap under the mandatory emission-cap policy, especially when the cap is at a relatively low level. However, the carbon price may not remarkably affect the manufacturer’s cost because its influence could be abated through the flexible technology switch under the emission cap-and-trade scheme.
               
            

@&#INTRODUCTION@&#

Environmental issues are a serious global concern because the climate change caused by increasing carbon and pollution emissions has adversely affected social and economic development worldwide (Barreto & Kypreos, 2004). Governments all over the world have been trying to reach a consensus on carbon emission reduction, and some are volunteering to implement emission-reduction policies. For example, in December 2009, the government of Canada committed to a national greenhouse gas reduction target of 17 percent below 2005 levels by 2020 (Canada-Gazette, 2011). The Chinese government also committed to cut its CO2 emissions per unit of GDP by 40–45 percent by 2020 (Yi, Zou, Guo, Wang, & Wei, 2011). To achieve these reduction targets, a series of regulation policies are adopted by governments. For example, three major policies for carbon emission reduction, including mandatory emission cap, emission cap-and-trade scheme, and emission tax, were introduced by the Congressional Budget Office of Congress of the United States (CBO, 2008).

In this paper, we consider two types of emission regulation policies, namely, the mandatory emission-cap policy and the emission cap-and-trade scheme. The former is a regulatory instrument that regulates firm emissions through mandatory emission caps, whereas the latter is a market-based mechanism that enables firms to relax their emission limitations by trading emission permits. A mandatory emission-cap policy is favored by governments and has been widely applied for its simple design and ease of handling. For example, many local governments in China control the carbon emissions of their regions for adherence to the national goal of the central government and thus limit local firm emissions through mandatory emission permits. In the United States, many states employ similar regulatory instruments (Stavins, 1997). However, market-based emission cap-and-trade scheme is becoming increasingly popular. Two typical examples are the EU Emissions Trading Scheme (EU ETS) (European-Commission, 2012) and the Sulfur Dioxide (SO2) emissions trading scheme in the United States (Rico, 1995). Moreover, some countries or regions adopt both instruments simultaneously. In China, aside from mandatory regulations, some cities and provinces such as Beijing, Shanghai, and Guangdong, initiated emission trading programs in early 2012 (Xinhuanet, 2013). In the United States, California built an emission trading system in 2012, and other western states have also been planning their emission trading schemes (Burtraw, McLaughlin, & Szambelan, 2012).

As the direct executors of emission reduction, regulations may have significant effects on firms with production that yields carbon emissions. Therefore, a credible emission control strategy is becoming an essential component of business success, especially for companies in industries that typically generate a large amount of pollution. These industries include the thermal power, petroleum, steel, and cement industries. In practice, an increasing number of companies are becoming conscious of the challenges placed on production and operations management under emission constraints. Such firms are now paying greater attention to how to plan production, how to arrange production technology, and how to manage inventory, among others. In other words, manufacturers should strike a good balance between emissions and costs to comply with emission constraints and to control costs by determining their production planning appropriately.

We focus on the manufacturer’s dual-mode production planning problem with emission constraints, which corresponds to the emission-reduction policies imposed by the government. To comply with the constraints, the manufacturer is equipped with two production technologies, namely, a regular technology and a green technology. The green technology yields fewer emissions but costs more than the regular one. Some practical examples for the differences in the emissions and costs of regular and green technologies are provided by Gong and Zhou (2013). The manufacturer provides customers with a single product by adopting dual-mode production with two optional technologies. The manufacturer can adopt either one or both of these technologies for production. For each production run, a setup cost is required, as discussed in many production planning and lot sizing problems (Florian & Klein, 1971; Wagner & Whitin, 1958). Under a mandatory emission-cap policy, the manufacturer’s production emissions are limited by a mandatory cap for a certain duration (e.g., a production period). Facing such an emission cap, the manufacturer has to adopt the green technology to comply with emission constraints because the use of regular technology alone can no longer adhere to the emission limitation. Under an emission cap-and-trade scheme, the manufacturer receives some tradable initial emission allowances. The manufacturer has to reduce emissions or purchase carbon credits when anticipating a shortage of emission allowances. It can, however, also sell or bank its allowances when anticipating a surplus. In this research, the manufacturer is assumed to be compelled to surrender sufficient allowances to cover all of its emissions for each production cycle and then sells off all spare allowances at the end of the planning horizon. Notice that, the “cap” in these two policies has different meanings. In the mandatory emission-cap policy, the cap represents the emission permit that limits the manufacturer’s emissions. By contrast, in the emission cap-and-trade scheme, the cap represents the total initial emission allowances that could be used or traded in the market.

We first investigate the problem with a mandatory emission-cap policy. A mathematical model is formulated to provide optimal dual-mode production planning for a manufacturer, with an objective of minimal total cost over a finite horizon. We decompose the original problem into two subproblems, namely, the technology selection problem and the production planning problem. The technology selection problem is solved analytically, whereas the production planning problem is solved by some further decompositions. On the basis of the structural property of a subplan, we first decompose a production plan into a series of subplans and then further decompose a subplan into two smaller subintervals. Based on the multi-level decomposition, a dynamic programming algorithm is developed to solve the problem optimally in polynomial time. The problem is then extended to consider an emission cap-and-trade scheme. The extended problem is analyzed by the same approach and is proven to be polynomially solvable by the same algorithm developed for the model without emission trading. Numerical examples are employed to test the efficiency of our algorithm and to explore the impacts of emission constraints on the firm’s operational decisions.

The application of the results of this work is extensive in practice, although it focuses on a deterministic problem. In the real world, manufactures usually use safety stock or rolling horizon to deal with stochastic problems. In a rolling horizon scenario, a real time and deterministic algorithm is required to obtain the optimal production planning, because the computation should be repeated many times. The polynomial algorithm developed in this paper can help firms to solve the problem efficiently.

The remainder of this paper is organized as follows. Section 2 reviews the literature related to our work. Section 3 studies the problem under a mandatory emission-cap policy and mathematically formulates such problem. Section 4 develops a polynomial dynamic programming algorithm to solve the problem. Section 5 extends the problem by considering the emission cap-and-trade scheme. Section 6 presents some numerical examples and investigate the impacts of emission constraints on the manufacturer’s operational decisions. Section 7 concludes this paper.

@&#LITERATURE REVIEW@&#

Two streams of research are closely related to our work. We review, on the one hand, the operations management problem with a focus on emission constraints. On the other hand, our work is related to capacitated single-item lot sizing problems. In what follows, we review studies relevant to each stream and highlight the differences between our work and existing research.

The first stream of research is mainly focused on operational decision problems with emission constraints, such as lot sizing problem, inventory management, and transportation, among others. Many studies in this stream focus on single-period problems and contribute significantly to optimizing firm operational decisions and exploring the impacts of emission constraints on these decisions (Hua, Cheng, & Wang, 2011; Letmathe & Balakrishnan, 2005; Song & Leng, 2012; Zhang & Xu, 2013).

For multi-period problems, Benjaafar, Li, and Daskin (2012) propose a series of traditional lot sizing models to illustrate the impacts of carbon emission concerns on the operational decisions of procurement and production planning. Their results show that operational adjustments may result in a significant reduction in emissions without significant increases in costs. Hoen, Tan, Fransoo, and Van Houtum (2012) evaluate the effects of different emission constraints on the companies’ transport mode selection strategies on the basis of trade-offs among inventory, transport, and emission costs. Their numerical results show that even though significant emission reduction can be achieved through transportation mode selection, the choice of the optimal emission reduction strategy depends on regulation policies. Rosič and Jammernegg (2013) formulate a dual-sourcing newsvendor model with consideration of the environmental effects of transport. They investigate two types of emission regulation policies and emphasize that an emission trade scheme is preferred to an emission tax policy for firms. Gong and Zhou (2013) investigate a production planning problem with emission trading, where two technologies can be adopted for production satisfying stochastic demands. They do not consider either the setup cost or the emission capacity, while both of which are involved in our study.

Some studies consider multiple modes in lot sizing problems. Absi, Dauzère-Pérès, Kedad-Sidhoum, Penz, and Rapine (2013) present a group of multi-mode lot sizing models considering four different types of emission constraints: periodic carbon emission constraint, cumulative carbon emission constraint, rolling carbon emission constraint, and global carbon emission constraint. A polynomial algorithm is developed for identifying optimal solutions for the model with periodic carbon emission constraint. Absi, Dauzère-Pérès, Kedad-Sidhoum, Penz, and Rapine (2015) extend their work (Absi et al., 2013) to considering fixed carbon emission in each period and proposed polynomial dynamic programming algorithms to solve their models. However, production capacity in each period is not considered in these works. Romeijn, Morales, Romero, Heuvel, and Wilco (2014) study the complexity of biobjective lot sizing models where only one mode is adopted for production. Recently, Retel Helmrich, Jans, van den Heuvel, and Wagelmans (2015) extend the work of Romeijn et al. (2014) and present a multi-mode lot sizing model involving an emission constraint, which limits firm’s emissions in production and inventory over a production planning horizon. Our work is different from Absi et al. (2013, 2015) and Retel Helmrich et al. (2015) in that the production quantity in each period is constrained by a stationary emission cap. This brings difficulties in methodology solution.

The second stream of research is related to capacitated single-item lot sizing problems (CLSP), which are characterized by the fact that the production quantity is limited in each period. The complexity of CLSP is investigated by Florian, Lenstra, and Rinnooy Kan (1980) and Bitran and Yanasse (1982). According to Bitran and Yanasse (1982), the complexity of the CLSP depends mainly on the parameter structure α/β/γ/δ, where α, β, γ and δ specify the structures of the setup cost, holding cost, production cost and capacity, respectively. The values of α, β, γ and δ are identified by G, C, ND, N and Z that represent general structure, constant, non-decreasing (over time), non-increasing (over time) and zero, respectively.

Generally, the problem is NP-hard (Bitran & Yanasse, 1982; Florian et al., 1980), although some special cases can be solved polynomially, such as G/G/G/C, NI/G/NI/ND, NI/G/NI/C, C/Z/C/G, and ND/Z/ND/NI. However, it is not NP-hard in strong sense and pseudo-polynomial algorithm is developed for general case by Chen, Hearn, and Lee (1994). For special cases, dynamic programming is the most common approach to solve problem in polynomial time. For the G/G/G/C case, the general problem was solved by Florian and Klein (1971) using an O(T
                        4) algorithm. Hoesel and Wagelmans (1996) improve the result to O(T
                        3) when the production costs are concave and the holding costs are concave piecewise linear instead of linear. Bitran and Yanasse (1982) show the cases of NI/G/NI/ND, NI/G/NI/C, C/Z/ND/NI and ND/Z/ND/NI can be solve by O(T
                        4), O(T
                        3), O(TlogT) and O(T) algorithms. Chung and Lin (1988) and Heuvel and Wagelmans (2006) independently improve the complexity of the NI/G/NI/ND case to O(T
                        2).

Besides special cases cited above, plenty of polynomial algorithms are developed for the variants of the standard CLSP. Jaruphongsa, Çetinkaya, and Lee (2004) study a two-echelon dynamic lot-sizing model with demand time windows. They respectively consider the effects of backlogging to the model and provide O(T
                        3) and O(T
                        5) algorithms to solve the models without or with backlogging. Hwang, Jaruphongsa, Çetinkaya, and Lee (2010) investigate a capacitated single item lot-sizing problem with production time windows, in which n types of demands are involved in production. They propose an O(nT
                        3) dynamic programming algorithm to solve the model. A series of polynomial algorithms are developed to solve lot sizing problems with limited inventory by Chu and Chu (2007, 2008) and Chu, Chu, Zhong, and Yang (2013); Chu, Chu, Zhou, Chen, and Shen (2012). Okhrin and Richter (2011) explore a capacitated single-item lot sizing problem considering minimum order quantity. The production and inventory costs are linear. An O(T
                        3) dynamic programming algorithm is developed to find optimal solutions. Different from Okhrin and Richter (2011), Hellion, Mangione, and Penz (2012) consider a similar problem but the production and inventory costs are concave. They propose an O(T
                        3) algorithm to solve the problem optimally. In this paper, we investigate a CLSP with two production modes and stationary emission constraint, which is polynomially solved by a dynamic programming algorithm in O(T
                        6) time.

A manufacturer produces a single product yielding carbon emissions to satisfy customer demands, which are assumed to be deterministic over a finite planning horizon with T periods, indexed by 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     . The demand of period t is denoted by dt
                     . The manufacturer carries on a dual-mode production with two technologies under a mandatory emission-cap policy. In each period, on-hand inventory is used to smooth production. The inventory-holding cost is linear, and no shortage is allowed. Without loss of generality, the initial and ending inventory levels are assumed to be zero (i.e., 
                        
                           
                              I
                              0
                           
                           =
                           
                              I
                              T
                           
                           =
                           0
                        
                     ).

Under a mandatory emission-cap policy, its emissions in each period are limited by an emission cap μ set by the government. To comply with the emission constraint, the manufacturer has equipped itself with two technologies, namely, regular and green technologies (denoted by technologies r and g). The production of a unit of product using the green technology yields fewer emissions than regular one. Compared with regular technology, however, green technology costs more in terms of unit production cost and setup cost. These relationships are denoted by eg
                      < er, sg
                      > sr
                      and pg
                      > pr
                     , where er, eg, pr, pg, sr
                     , and sg
                      are the unit production emissions, the unit production costs, and the setup costs of the regular and green technologies, respectively. Notice that the other scenario sg
                      < sr
                      and pg
                      > pr
                      is also practical and can be analyzed similarly to obtain a production cost function having a structure similar to that of the former and is thus omitted here. Either one or both scenarios can be adopted for production in each period, such that the manufacturer has to make a trade-off between emissions and costs by appropriately arranging the technologies for production. That is, the manufacturer should optimally determine the quantity to produce with each technology (denoted by xtr
                      and xtg
                      ) in each period.

For convenience of analysis and modeling, we further let 
                        
                           
                              x
                              t
                           
                           =
                           
                              x
                              
                                 t
                                 r
                              
                           
                           +
                           
                              x
                              
                                 t
                                 g
                              
                           
                        
                      be the total production quantity of period t and denote 
                        x
                     
                     
                        r
                     , 
                        x
                     
                     
                        g
                     , and 
                        x
                      as the vectors of xtr
                     ’s, xtg
                     ’s, and xt
                     ’s, respectively. Note that the production quantity xt
                      is real number here. However, the algorithm we will show can be used to deal with the case where xt
                      is integer, provided that demand quantities are integer. By a variable substitution 
                        
                           
                              x
                              t
                           
                           =
                           
                              x
                              
                                 t
                                 r
                              
                           
                           +
                           
                              x
                              
                                 t
                                 g
                              
                           
                           ,
                        
                      we have 
                        
                           
                              x
                              
                                 t
                                 g
                              
                           
                           =
                           
                              x
                              t
                           
                           −
                           
                              x
                              
                                 t
                                 r
                              
                           
                        
                     . Then, the problem is mathematically formulated as Model P.


                     Model P
                     
                        
                           (1)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          Minimize
                                          
                                          
                                          F
                                          (
                                          x
                                          ,
                                          
                                             x
                                             r
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                          
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             T
                                          
                                          
                                             
                                             [
                                             
                                                s
                                                r
                                             
                                             δ
                                             
                                                (
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             
                                             +
                                             
                                             
                                                s
                                                g
                                             
                                             δ
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                
                                                −
                                                
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             
                                             +
                                             
                                             
                                                p
                                                r
                                             
                                             
                                                x
                                                
                                                   t
                                                   r
                                                
                                             
                                             
                                             +
                                             
                                             
                                                p
                                                g
                                             
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                
                                                −
                                                
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             
                                             ]
                                          
                                          
                                          +
                                          
                                          
                                          
                                             ∑
                                             
                                                t
                                                =
                                                1
                                             
                                             T
                                          
                                          
                                             
                                                h
                                                t
                                             
                                             
                                                I
                                                t
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          Subject
                                          
                                          to
                                          
                                          
                                             I
                                             t
                                          
                                          +
                                          
                                             d
                                             t
                                          
                                          =
                                          
                                             I
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                          +
                                          
                                             x
                                             t
                                          
                                          ,
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             e
                                             r
                                          
                                          
                                             x
                                             
                                                t
                                                r
                                             
                                          
                                          +
                                          
                                             e
                                             g
                                          
                                          
                                             (
                                             
                                                x
                                                t
                                             
                                             −
                                             
                                                x
                                                
                                                   t
                                                   r
                                                
                                             
                                             )
                                          
                                          ≤
                                          μ
                                          ,
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             I
                                             0
                                          
                                          =
                                          
                                             I
                                             T
                                          
                                          =
                                          0
                                          ,
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          0
                                          ≤
                                          
                                             x
                                             
                                                t
                                                r
                                             
                                          
                                          ≤
                                          
                                             x
                                             t
                                          
                                          ,
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             I
                                             t
                                          
                                          ≥
                                          0
                                          ,
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           δ
                           (
                           
                              x
                              
                                 t
                                 r
                              
                           
                           )
                           =
                           1
                        
                      (resp., δ(xtg
                     )), if xtr
                      > 0 (resp., xtg
                      > 0 ), and 0 otherwise; ht
                      is the inventory cost rate in period t. Constraint (2) ensures that the inventory is balanced. Constraint (3) limits the production emissions in each period. Different from that of the periodic carbon emission constraint considered by Absi et al. (2013, 2015), the production in our model is constrained by the emission cap in each period. Constraint (4) sets the initial and ending inventories of a planning horizon to be zero. The bounds of the variables are constrained by Eqs. (5) and (6).

The cost function (1) is degenerated into a capacitated single item lot sizing problem with stationary capacities (Florian & Klein, 1971), if only one technology is optional. However, determining two technology-related variables xtr
                      and xtg
                      (or xtr
                      and xt
                     ) simultaneously is difficult. In what follows, we try to derive some properties of the problem and explore the structure of optimal solutions, in order to develop a polynomial algorithm to solve the problem.

In this section, we first investigate structural properties of the problem and decompose the original problem into two subproblems, namely, a technology selection problem and a production planning problem on the basis of the structural properties of the model. For the decomposed production planning problem, we decompose a production plan into a series of subplans, each of which is further decomposed into two smaller subintervals. With the multi-level decomposition approach, we finally develop a polynomial dynamic algorithm to optimally solve the problem.

From Model P, we find that xtr
                        ’s only appear in the first term of the objective function (1) and in Constraints (3) and (5). Thus, at any optimal solution, for any given xt
                        , the value of xtr
                         must be such that the sum of the first term of the objective function is minimized, and Constraints (3) and (5) are satisfied. Consequently, we directly address a proposition indicating the structural property of the problem as follows.
                           Proposition 1
                           
                              The problem can be decomposed into two subproblems:
                              
                                 
                                    (i)
                                    
                                       The first subproblem is to compute the optimal value of xtr for any given xt, such that the sum of the first term of the objective function is minimized while satisfying Constraints 
                                       
                                          (3)
                                        
                                       and 
                                       
                                          (5)
                                       
                                       .
                                    


                                       The second subproblem is to compute the optimal values of xt’s.
                                    

In fact, the first subproblem is a technology selection problem that determines the production quantity of each technology (xtr
                         and xtg
                        ) when the total production quantity (xt
                        ) is given, whereas the second subproblem is a production planning problem that determines the production quantity of each period. Note that the technology selection problem is parameterized by xt
                        , whereas xt
                         is a decision variable in the production planning problem. More specifically, we formulate these two subproblems as follows.

The technology selection problem P-S:


                        Model P-S
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             g
                                             (
                                             
                                                x
                                                t
                                             
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   
                                                      
                                                         
                                                            0
                                                            ≤
                                                            
                                                               x
                                                               
                                                                  t
                                                                  r
                                                               
                                                            
                                                            ≤
                                                            
                                                               x
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               e
                                                               r
                                                            
                                                            
                                                               x
                                                               
                                                                  t
                                                                  r
                                                               
                                                            
                                                            +
                                                            
                                                               e
                                                               g
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  t
                                                               
                                                               −
                                                               
                                                                  x
                                                                  
                                                                     t
                                                                     r
                                                                  
                                                               
                                                               )
                                                            
                                                            ≤
                                                            μ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                [
                                             
                                             
                                                s
                                                r
                                             
                                             δ
                                             
                                                (
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                s
                                                g
                                             
                                             δ
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                −
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                p
                                                r
                                             
                                             
                                                x
                                                
                                                   t
                                                   r
                                                
                                             
                                             +
                                             
                                                p
                                                g
                                             
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                −
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             
                                                ]
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The production planning problem P-P:


                        Model P-P
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             Minimize
                                             
                                             
                                             
                                             F
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                g
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                
                                                   h
                                                   t
                                                
                                                
                                                   I
                                                   t
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             Subject
                                             
                                             to
                                             
                                             0
                                             ≤
                                             
                                                x
                                                t
                                             
                                             ≤
                                             μ
                                             /
                                             
                                                e
                                                g
                                             
                                             ,
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             C
                                             o
                                             n
                                             s
                                             t
                                             r
                                             a
                                             i
                                             n
                                             t
                                             s
                                             (
                                             2
                                             )
                                             ,
                                             (
                                             4
                                             )
                                             ,
                                             a
                                             n
                                             d
                                             (
                                             6
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The problem P-S is period-independent. For convenience, we drop subscript t and further simplify xtr
                         into z. As a consequence, Model P-S can be further rewritten as
                           
                              (10)
                              
                                 
                                    g
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       min
                                       
                                          
                                             
                                                
                                                   0
                                                   ≤
                                                   z
                                                   ≤
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                      r
                                                   
                                                   z
                                                   +
                                                   
                                                      e
                                                      g
                                                   
                                                   
                                                      (
                                                      x
                                                      −
                                                      z
                                                      )
                                                   
                                                   ≤
                                                   μ
                                                
                                             
                                          
                                       
                                    
                                    
                                       [
                                       
                                          s
                                          r
                                       
                                       δ
                                       
                                          (
                                          z
                                          )
                                       
                                       +
                                       
                                          s
                                          g
                                       
                                       δ
                                       
                                          (
                                          x
                                          −
                                          z
                                          )
                                       
                                       +
                                       
                                          p
                                          r
                                       
                                       z
                                       +
                                       
                                          p
                                          g
                                       
                                       
                                          (
                                          x
                                          −
                                          z
                                          )
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        
                     

Note that g(x) is defined only when 0 ≤ x ≤ μ/eg
                        , since otherwise it is impossible to simultaneously satisfy the constraints 0 ≤ z ≤ x and 
                           
                              
                                 e
                                 r
                              
                              z
                              +
                              
                                 e
                                 g
                              
                              
                                 (
                                 x
                                 −
                                 z
                                 )
                              
                              ≤
                              μ
                           
                        . Furthermore, we have 
                           
                              g
                              (
                              0
                              )
                              =
                              0
                           
                         by definition. In the remainder, therefore, we only consider the case 0 < x ≤ μ/eg
                        .

Before presenting the technology selection policy, we depict the structural property of the production cost function g(x) by the following theorem. Please find the explicit expression of g(x) and its proof in Appendix A.
                           Theorem 1
                           
                              The production cost g(x) is a non-decreasing piecewise concave linear function.
                           

From the proof of Theorem 1, we can directly address the following proposition that provides the optimal technology selection policy for each production period.
                           Proposition 2
                           
                              If the production quantity of a period is x, define
                              
                                 
                                    
                                       x
                                       ˜
                                    
                                    =
                                    μ
                                    /
                                    
                                       e
                                       g
                                    
                                    −
                                    
                                       s
                                       r
                                    
                                    
                                       (
                                       
                                          e
                                          r
                                       
                                       −
                                       
                                          e
                                          g
                                       
                                       )
                                    
                                    /
                                    
                                       [
                                       
                                          e
                                          g
                                       
                                       
                                          (
                                          
                                             p
                                             g
                                          
                                          −
                                          
                                             p
                                             r
                                          
                                          )
                                       
                                       ]
                                    
                                    ,
                                 
                               
                              the optimal technology selection policy for this period is given by
                              
                                 
                                    (1)
                                    
                                       When
                                       
                                          
                                             μ
                                             /
                                             
                                                e
                                                r
                                             
                                             <
                                             
                                                x
                                                ˜
                                             
                                             <
                                             μ
                                             /
                                             
                                                e
                                                g
                                             
                                             ,
                                          
                                        
                                       three subcases are included for technology selection.
                                       
                                          
                                             (i)
                                             
                                                If 0 < x ≤ μ/er, only the regular technology is used for production. The optimal production quantity of each technology is
                                                
                                                   
                                                      
                                                         x
                                                         r
                                                         *
                                                      
                                                      =
                                                      x
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         g
                                                         *
                                                      
                                                      =
                                                      0
                                                   
                                                
                                                ;
                                             


                                                If
                                                
                                                   
                                                      μ
                                                      /
                                                      
                                                         e
                                                         r
                                                      
                                                      <
                                                      x
                                                      <
                                                      
                                                         x
                                                         ˜
                                                      
                                                      ,
                                                   
                                                 
                                                the two technologies are used for production. The optimal production quantity of each technology is
                                                
                                                   
                                                      
                                                         x
                                                         r
                                                         *
                                                      
                                                      =
                                                      
                                                         (
                                                         μ
                                                         −
                                                         
                                                            e
                                                            g
                                                         
                                                         x
                                                         )
                                                      
                                                      /
                                                      
                                                         (
                                                         
                                                            e
                                                            r
                                                         
                                                         −
                                                         
                                                            e
                                                            g
                                                         
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         g
                                                         *
                                                      
                                                      =
                                                      
                                                         (
                                                         
                                                            e
                                                            r
                                                         
                                                         x
                                                         −
                                                         μ
                                                         )
                                                      
                                                      /
                                                      
                                                         (
                                                         
                                                            e
                                                            r
                                                         
                                                         −
                                                         
                                                            e
                                                            g
                                                         
                                                         )
                                                      
                                                   
                                                
                                                ;
                                             


                                                If
                                                
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      ≤
                                                      x
                                                      ≤
                                                      μ
                                                      /
                                                      
                                                         e
                                                         g
                                                      
                                                      ,
                                                   
                                                 
                                                only the green technology is used for production. The optimal production quantity of each technology is
                                                
                                                   
                                                      
                                                         x
                                                         r
                                                         *
                                                      
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         g
                                                         *
                                                      
                                                      =
                                                      x
                                                   
                                                
                                                .
                                             


                                       When
                                       
                                          
                                             
                                                x
                                                ˜
                                             
                                             ≤
                                             μ
                                             /
                                             
                                                e
                                                r
                                             
                                          
                                        
                                       or
                                       
                                          
                                             
                                                x
                                                ˜
                                             
                                             ≥
                                             μ
                                             /
                                             
                                                e
                                                g
                                             
                                             ,
                                          
                                        
                                       two subcases are included for technology selection.
                                       
                                          
                                             (i)
                                             
                                                If 0 < x ≤ μ/er, only the regular technology is used for production. The optimal production quantity of each technology is
                                                
                                                   
                                                      
                                                         x
                                                         r
                                                         *
                                                      
                                                      =
                                                      x
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         g
                                                         *
                                                      
                                                      =
                                                      0
                                                   
                                                
                                                ;
                                             


                                                If μ/er
                                                 < x ≤ μ/eg, only the green technology is used for production. The optimal production quantity of each technology is
                                                
                                                   
                                                      
                                                         x
                                                         r
                                                         *
                                                      
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         g
                                                         *
                                                      
                                                      =
                                                      x
                                                   
                                                
                                                .
                                             


                        Fig. 1
                         illustrates the production cost curves of g(x) and the optimal technology selection policy for a given x. For example, in Fig. 1(a), if x falls into portion I, it is optimal to produce x units of products only using the regular technology; for x in portion II, it is optimal to produce 
                           
                              
                                 (
                                 μ
                                 −
                                 
                                    e
                                    g
                                 
                                 x
                                 )
                              
                              /
                              
                                 (
                                 
                                    e
                                    r
                                 
                                 −
                                 
                                    e
                                    g
                                 
                                 )
                              
                           
                         and 
                           
                              
                                 (
                                 
                                    e
                                    r
                                 
                                 x
                                 −
                                 μ
                                 )
                              
                              /
                              
                                 (
                                 
                                    e
                                    r
                                 
                                 −
                                 
                                    e
                                    g
                                 
                                 )
                              
                           
                         units of products using the regular and green technologies, respectively; for x in portion III, it is optimal to produce x units of products only using the green technology. The other scenario can be similarly illustrated by Fig. 1(b).

In addition, from the technology selection policy, we find the following interesting relationships between the emission cap and the technology selection.
                           Proposition 3
                           
                              In an optimal technology selection policy,
                              
                                 
                                    (i)
                                    
                                       Only one technology (either regular or green technology) is used if the production emissions are less than the mission cap.
                                    


                                       The production emissions are equal to the emission cap if both technologies are used.
                                    

This proposition indicates the manufacturer should arrange its production at an emission level on the emission cap when both technologies are used simultaneously in a period, otherwise only one technology should be used. Observe the production cost function g(x) is non-continuous. In general, the production planning problem P-P becomes difficult to solve (Keha, de Farias, & Nemhauser, 2006). However, we develop a polynomial dynamic programming algorithm to optimally solve Model P.

In this section, we first decompose a production plan into a series of subplans. Then, a subplan is further decomposed into two smaller subintervals which are proven to be solvable in polynomial time with a dynamic programming approach.

For convenience, we first give some necessary definitions that will be helpful in analyzing the problem.


                           
                              Normal period : If xt
                            ∈ {0, μ/er, μ/eg
                           }, we call t a normal period. In a normal period, either no production occurs, or a single technology is used for production and emissions are equal to the emission cap.
                        


                           
                              Singular period : If xt
                            ∉ {0, μ/er, μ/eg
                           }, we call t a singular period.
                        


                           
                              Zero-inventory point : If
                           
                              
                                 
                                    I
                                    t
                                 
                                 =
                                 0
                                 ,
                              
                            
                           we call t a zero-inventory point. At least two zero-inventory periods exist for any feasible production plan because
                           
                              
                                 
                                    I
                                    0
                                 
                                 =
                                 
                                    I
                                    T
                                 
                                 =
                                 0
                              
                            
                           is assumed.
                        


                           
                              Subplan : A production plan (0, T) can be decomposed into a series of subplans (i, k), 0 ≤ i < k ≤ T, in which periods i and k are two adjacent zero-inventory points. A subplan begins with a production period and ends with a zero-inventory period from
                           
                              
                                 i
                                 +
                                 1
                              
                            
                           to k, satisfying the demands
                           
                              
                                 
                                    d
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    d
                                    k
                                 
                              
                           
                           .
                        

Notice that all periods, except the last one, have positive inventory. The concept of subplan (i.e., subproblem) is important in developing our algorithm because only such subproblems need to be considered in a dynamic programming approach. Now, let us consider an optimal subplan (i, k) that satisfies the demands 
                              
                                 
                                    d
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    d
                                    k
                                 
                              
                            with minimal cost. Let C(i, k) denote the minimal cumulative production and inventory costs of the subplan, and F(k) denote the minimal total cost of satisfying the demands 
                              
                                 
                                    d
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    d
                                    k
                                 
                              
                            such that the inventory level at the end of period k is zero. Then, the proposed model can be solved by a dynamic programming approach as follows.

By the definition of subplans, we have the following recursive equations:
                              
                                 (11)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   F
                                                   (
                                                   0
                                                   )
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   F
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   =
                                                   
                                                      min
                                                      
                                                         0
                                                         ≤
                                                         i
                                                         ≤
                                                         k
                                                      
                                                   
                                                   
                                                      {
                                                      F
                                                      (
                                                      i
                                                      )
                                                      +
                                                      C
                                                      (
                                                      i
                                                      ,
                                                      k
                                                      )
                                                      }
                                                   
                                                   ,
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   T
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

With the recursive equations, the optimal solutions can be obtained by F(T) in O(T
                           2) time after all C(i, k)’s are known. Therefore, the challenge and critical work in solving the problem is to calculate all possible C(i, k)’s efficiently. In what follows, we show how to calculate the cumulative costs of subplans in polynomial time and develop a polynomial dynamic programming algorithm to solve the model.

Let us first discuss the structure of a subplan included in an optimal production plan. With Theorem 1 and Fig. 1, we know that even though the production cost function is not continuous, it is piecewise concave; i.e., the production cost in each continuous portion is a concave function. According to the theorem proposed by Swoveland (1975), we can obtain the following structural property of a subplan considered in this research.
                              Theorem 2
                              
                                 An optimal solution exists, such that each subplan contains at most one singular period.
                              

With this theorem, we can further decompose a subplan into two smaller subintervals, of which the cost can be calculated polynomially. Consequently, the cumulative cost of a subplan can be calculated in polynomial time. In the remainder, we will show how to decompose a subplan into subintervals and how to calculate the cumulative costs of the subintervals polynomially.

We consider the case in which exactly one singular period exists in a subplan. In other words, an optimal solution exists, such that all production periods in each subplan are normal periods except for one singular period. On the basis of the structural property of subplans, we decompose a subplan into two polynomially solvable subintervals as introduced below.

Let us consider a subplan (i, j, k) with j as a single singular period, such that 0 ≤ i < j ≤ k ≤ T. In other words, all production periods from 
                              
                                 i
                                 +
                                 1
                              
                            to 
                              
                                 j
                                 −
                                 1
                              
                            and from 
                              
                                 j
                                 +
                                 1
                              
                            to k are normal periods, and period j is a singular period. That is, such a subplan can be decomposed into two subintervals and a singular period j. For convenience, let 
                              
                                 (
                                 i
                                 ,
                                 j
                                 −
                                 1
                                 )
                              
                            and (j, k) denote these two subintervals. Note that a zero-inventory point does not exist in a subinterval, except for periods i and k. Some necessary definitions are given as follows.

For the subinterval 
                              
                                 (
                                 i
                                 ,
                                 j
                                 −
                                 1
                                 )
                                 ,
                              
                            let 
                              
                                 
                                    α
                                    
                                       i
                                       ,
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       r
                                    
                                    ,
                                    
                                       m
                                       g
                                    
                                    )
                                 
                              
                            denote the minimal cumulative production and inventory costs from period 
                              
                                 i
                                 +
                                 1
                              
                            to 
                              
                                 j
                                 −
                                 1
                                 ,
                              
                            
                           mr
                            and mg
                            be the number of normal periods when using the regular technology and the green technology, respectively.

For the subinterval (j, k), similarly, let β
                           
                              j, k
                           (nr, ng
                           ) denote the minimal cumulative production and inventory costs from period 
                              
                                 j
                                 +
                                 1
                              
                            to k, and let nr
                            and ng
                            be the number of normal periods using the regular technology and the green technology, respectively.

For the singular period j, let Y
                           
                              i, j, k
                           (mr, mg, nr, ng
                           ) denote the production and inventory costs of period j, knowing that mr
                            and mg
                            (resp. nr
                            and ng
                           ) normal periods exist with the regular technology and the green technology, respectively, between periods 
                              
                                 i
                                 +
                                 1
                              
                            and 
                              
                                 j
                                 −
                                 1
                              
                            (resp. 
                              
                                 j
                                 +
                                 1
                              
                           –k). The production quantity xj
                            and the inventory level Ij
                            correspond to the numbers of normal periods in the two subintervals.

Then, the cumulative cost, denoted by c(i, j, k), of the subplan (i, j, k) can be obtained by 
                              
                                 c
                                 
                                    (
                                    i
                                    ,
                                    j
                                    ,
                                    k
                                    )
                                 
                                 =
                                 
                                    α
                                    
                                       i
                                       ,
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       r
                                    
                                    ,
                                    
                                       m
                                       g
                                    
                                    )
                                 
                                 +
                                 
                                    β
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       n
                                       r
                                    
                                    ,
                                    
                                       n
                                       g
                                    
                                    )
                                 
                                 +
                                 
                                    Y
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       r
                                    
                                    ,
                                    
                                       m
                                       g
                                    
                                    ,
                                    
                                       n
                                       r
                                    
                                    ,
                                    
                                       n
                                       g
                                    
                                    )
                                 
                              
                           . The remaining work therefore is to calculate the minimal costs of subplans.


                           
                              A. Minimal cumulative cost of the two subintervals
                        

We first analyze the computation of the minimal cumulative cost of subinterval 
                              
                                 (
                                 i
                                 ,
                                 j
                                 −
                                 1
                                 )
                                 ,
                              
                            i.e., 
                              
                                 
                                    α
                                    
                                       i
                                       ,
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       r
                                    
                                    ,
                                    
                                       m
                                       g
                                    
                                    )
                                 
                              
                           . Let α
                           
                              i, s
                           (mr, mg
                           ) denote the minimal cumulative production and inventory costs from period 
                              
                                 i
                                 +
                                 1
                              
                            to s, with mr
                            and mg
                            normal periods using technology-r and technology-g, respectively. We have the following relationships:
                              
                                 (12)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      m
                                                      r
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                      g
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ≤
                                                   
                                                      m
                                                      r
                                                   
                                                   +
                                                   
                                                      m
                                                      g
                                                   
                                                   ≤
                                                   s
                                                   −
                                                   i
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    m
                                    r
                                 
                                 +
                                 
                                    m
                                    g
                                 
                                 =
                                 0
                              
                            implies 
                              
                                 i
                                 =
                                 s
                                 ,
                              
                            and the subinterval is not included in a subplan, because 
                              
                                 i
                                 +
                                 1
                              
                            should be a production period.

The inventory level at the end of period s is 
                              
                                 
                                    I
                                    s
                                 
                                 =
                                 
                                    m
                                    r
                                 
                                 μ
                                 /
                                 
                                    e
                                    r
                                 
                                 +
                                 
                                    m
                                    g
                                 
                                 μ
                                 /
                                 
                                    e
                                    g
                                 
                                 −
                                 
                                    D
                                    
                                       i
                                       ,
                                       s
                                    
                                 
                                 ,
                              
                            where D
                           
                              i, s
                            is the cumulative demand from period 
                              
                                 i
                                 +
                                 1
                              
                            to period s, i.e., 
                              
                                 
                                    D
                                    
                                       i
                                       ,
                                       s
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       t
                                       =
                                       i
                                       +
                                       1
                                    
                                    s
                                 
                                 
                                    d
                                    t
                                 
                                 .
                              
                            We should have Is
                            > 0 since shortage is not allowed and zero-inventory points only exist at periods i and k.

First, we initialize the minimal cumulative cost of subinterval (i, s) by the definition of α
                           
                              i, s
                           (mr, mg
                           ), as follows:
                              
                                 (13)
                                 
                                    
                                       
                                          α
                                          
                                             i
                                             ,
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             m
                                             r
                                          
                                          ,
                                          
                                             m
                                             g
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         m
                                                         r
                                                      
                                                      =
                                                      
                                                         m
                                                         g
                                                      
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      +
                                                      ∞
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      o
                                                      t
                                                      h
                                                      e
                                                      r
                                                      w
                                                      i
                                                      s
                                                      e
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Then, α
                           
                              i, s
                           (mr, mg
                           ) can be calculated by the following forward recursive equations:
                              
                                 (14)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   α
                                                   
                                                      i
                                                      ,
                                                      s
                                                   
                                                
                                                
                                                   (
                                                   
                                                      m
                                                      r
                                                   
                                                   ,
                                                   
                                                      m
                                                      g
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               +
                                                               ∞
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  I
                                                                  s
                                                               
                                                               ≤
                                                               0
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               min
                                                               
                                                                  {
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 h
                                                                                 s
                                                                              
                                                                              
                                                                                 I
                                                                                 s
                                                                              
                                                                              
                                                                              +
                                                                              
                                                                              
                                                                                 α
                                                                                 
                                                                                    i
                                                                                    ,
                                                                                    s
                                                                                    
                                                                                    −
                                                                                    
                                                                                    1
                                                                                 
                                                                              
                                                                              
                                                                                 (
                                                                                 
                                                                                    m
                                                                                    r
                                                                                 
                                                                                 ,
                                                                                 
                                                                                    m
                                                                                    g
                                                                                 
                                                                                 )
                                                                              
                                                                              ,
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 h
                                                                                 s
                                                                              
                                                                              
                                                                                 I
                                                                                 s
                                                                              
                                                                              
                                                                              +
                                                                              
                                                                              
                                                                                 s
                                                                                 r
                                                                              
                                                                              
                                                                              +
                                                                              
                                                                              
                                                                                 p
                                                                                 r
                                                                              
                                                                              μ
                                                                              /
                                                                              
                                                                                 e
                                                                                 r
                                                                              
                                                                              
                                                                              +
                                                                              
                                                                              
                                                                                 α
                                                                                 
                                                                                    i
                                                                                    ,
                                                                                    s
                                                                                    
                                                                                    −
                                                                                    
                                                                                    1
                                                                                 
                                                                              
                                                                              
                                                                                 (
                                                                                 
                                                                                    m
                                                                                    r
                                                                                 
                                                                                 
                                                                                 −
                                                                                 
                                                                                 1
                                                                                 ,
                                                                                 
                                                                                    m
                                                                                    g
                                                                                 
                                                                                 )
                                                                              
                                                                              ,
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 h
                                                                                 s
                                                                              
                                                                              
                                                                                 I
                                                                                 s
                                                                              
                                                                              
                                                                              +
                                                                              
                                                                              
                                                                                 s
                                                                                 g
                                                                              
                                                                              
                                                                              +
                                                                              
                                                                              
                                                                                 p
                                                                                 g
                                                                              
                                                                              μ
                                                                              /
                                                                              
                                                                                 e
                                                                                 g
                                                                              
                                                                              
                                                                              +
                                                                              
                                                                              
                                                                                 α
                                                                                 
                                                                                    i
                                                                                    ,
                                                                                    s
                                                                                    
                                                                                    −
                                                                                    
                                                                                    1
                                                                                 
                                                                              
                                                                              
                                                                                 (
                                                                                 
                                                                                    m
                                                                                    r
                                                                                 
                                                                                 ,
                                                                                 
                                                                                    m
                                                                                    g
                                                                                 
                                                                                 
                                                                                 −
                                                                                 
                                                                                 1
                                                                                 )
                                                                              
                                                                              ,
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  }
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               o
                                                               t
                                                               h
                                                               e
                                                               r
                                                               w
                                                               i
                                                               s
                                                               e
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the first case of Eq. (14), if Is
                            ≤ 0, the solution is infeasible, and α
                           
                              i, s
                           (mr, mg
                           ) is set to be 
                              
                                 +
                                 ∞
                              
                           . The second case consists of three subcases, in which hsIs
                            is the inventory-holding cost of period s, and 
                              
                                 
                                    α
                                    
                                       i
                                       ,
                                       s
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    ·
                                    ,
                                    ·
                                    )
                                 
                              
                            is the minimal cumulative cost from period 
                              
                                 i
                                 +
                                 1
                              
                            to 
                              
                                 s
                                 −
                                 1
                              
                           . For the first subcase, no production occurs in period s. For the second subcase, s is a normal period when using the regular technology. For the third subcase, s is a normal period when using the green technology. We easily find that for any feasible mr, mg
                            and 0 ≤ i ≤ s ≤ T, all possible α
                           
                              i, s
                           (mr, mg
                           )’s can be obtained in a computation time of 
                              
                                 O
                                 (
                                 
                                    T
                                    4
                                 
                                 )
                              
                           .

With a similar approach, the subinterval (j, k) is solved backward recursively. The computation complexity is 
                              
                                 O
                                 (
                                 
                                    T
                                    4
                                 
                                 )
                              
                           . The detailed analysis is given in Appendix C.


                           
                              B. Cost of the singular period j: Y
                           
                              i, j, k
                           (mr, mg, nr, ng
                           )

The production quantity of period j is 
                              
                                 
                                    x
                                    j
                                 
                                 =
                                 
                                    D
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 −
                                 
                                    [
                                    
                                       (
                                       
                                          m
                                          r
                                       
                                       +
                                       
                                          n
                                          r
                                       
                                       )
                                    
                                    μ
                                    /
                                    
                                       e
                                       r
                                    
                                    +
                                    
                                       (
                                       
                                          m
                                          g
                                       
                                       +
                                       
                                          n
                                          g
                                       
                                       )
                                    
                                    μ
                                    /
                                    
                                       e
                                       g
                                    
                                    ]
                                 
                                 ,
                              
                            and the inventory level at the end of the period is 
                              
                                 
                                    I
                                    j
                                 
                                 =
                                 
                                    I
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    D
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 −
                                 
                                    [
                                    
                                       (
                                       
                                          m
                                          r
                                       
                                       +
                                       
                                          n
                                          r
                                       
                                       )
                                    
                                    μ
                                    /
                                    
                                       e
                                       r
                                    
                                    +
                                    
                                       (
                                       
                                          m
                                          g
                                       
                                       +
                                       
                                          n
                                          g
                                       
                                       )
                                    
                                    μ
                                    /
                                    
                                       e
                                       g
                                    
                                    ]
                                 
                                 −
                                 
                                    d
                                    j
                                 
                              
                            and should be Ij
                            > 0 if j ≠ k.


                           Y
                           
                              i, j, k
                           (mr, mg, nr, ng
                           ) can be calculated by the equivalent production cost function g(xj
                           ) (see Eq. (22)), and the related production quantity of each technology can be obtained by Proposition 
                           
                              2
                           . If the constraints are not satisfied, the solution is infeasible, and the cumulative cost is set to be 
                              
                                 +
                                 ∞
                              
                           .

Consequently, the cost of period j is given by
                              
                                 (15)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   Y
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   
                                                      m
                                                      r
                                                   
                                                   ,
                                                   
                                                      m
                                                      g
                                                   
                                                   ,
                                                   
                                                      n
                                                      r
                                                   
                                                   ,
                                                   
                                                      n
                                                      g
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                                  j
                                                               
                                                               
                                                                  I
                                                                  j
                                                               
                                                               +
                                                               g
                                                               
                                                                  (
                                                                  
                                                                     x
                                                                     j
                                                                  
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               ≤
                                                               
                                                                  x
                                                                  j
                                                               
                                                               ≤
                                                               μ
                                                               /
                                                               
                                                                  e
                                                                  g
                                                               
                                                               
                                                               a
                                                               n
                                                               d
                                                               
                                                               
                                                                  I
                                                                  j
                                                               
                                                               >
                                                               0
                                                               
                                                               
                                                                  (
                                                                  j
                                                                  ≠
                                                                  k
                                                                  )
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               +
                                                               ∞
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               o
                                                               t
                                                               h
                                                               e
                                                               r
                                                               w
                                                               i
                                                               s
                                                               e
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In subplan (i, j, k), ng
                            can be determined when mr, mg
                           , and nr
                            are known. Let 
                              
                                 Q
                                 =
                                 
                                    D
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 −
                                 
                                    [
                                    
                                       (
                                       
                                          m
                                          r
                                       
                                       +
                                       
                                          n
                                          r
                                       
                                       )
                                    
                                    μ
                                    /
                                    
                                       e
                                       r
                                    
                                    +
                                    
                                       m
                                       g
                                    
                                    μ
                                    /
                                    
                                       e
                                       g
                                    
                                    ]
                                 
                              
                            and 
                              
                                 P
                                 =
                                 μ
                                 /
                                 
                                    e
                                    g
                                 
                                 ,
                              
                            then we have 
                              
                                 
                                    n
                                    g
                                 
                                 =
                                 
                                    ⌊
                                    
                                       (
                                       Q
                                       /
                                       P
                                       )
                                    
                                    ⌋
                                 
                                 ,
                              
                            which always holds because the production in a singular period cannot exceed μ/eg
                           . We can thus compute all the possible Y
                           
                              i, j, k
                           (mr, mg, nr, ng
                           )’s in 
                              
                                 O
                                 (
                                 
                                    T
                                    6
                                 
                                 )
                              
                            time.


                           
                              C. Polynomial dynamic programming algorithm
                        

At this point, we have presented the polynomial methods to determine the minimal cumulative costs of the subintervals and the cost of the singular periods. Then, on the basis of these results, we can calculate the minimal cumulative cost of the subplan (i, j, k), 0 ≤ i < j ≤ k ≤ T.

For any given subplan (i, j, k), the minimal cumulative cost is
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                c
                                                (
                                                i
                                                ,
                                                j
                                                ,
                                                k
                                                )
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   min
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                                  r
                                                               
                                                               ,
                                                               
                                                                  m
                                                                  g
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                                  r
                                                               
                                                               ,
                                                               
                                                                  n
                                                                  g
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   {
                                                
                                                
                                                   α
                                                   
                                                      i
                                                      ,
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      m
                                                      r
                                                   
                                                   ,
                                                   
                                                      m
                                                      g
                                                   
                                                   )
                                                
                                                +
                                                
                                                   β
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   
                                                      n
                                                      r
                                                   
                                                   ,
                                                   
                                                      n
                                                      g
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   Y
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   
                                                      m
                                                      r
                                                   
                                                   ,
                                                   
                                                      m
                                                      g
                                                   
                                                   ,
                                                   
                                                      n
                                                      r
                                                   
                                                   ,
                                                   
                                                      n
                                                      g
                                                   
                                                   )
                                                
                                                
                                                   }
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where mr, mg, nr
                           , and ng
                            are constrained by Eqs. (12) and (30), 
                              
                                 0
                                 ≤
                                 
                                    m
                                    r
                                 
                                 +
                                 
                                    m
                                    g
                                 
                                 +
                                 
                                    n
                                    r
                                 
                                 +
                                 
                                    n
                                    g
                                 
                                 ≤
                                 k
                                 −
                                 i
                                 ,
                              
                            and the relationship 
                              
                                 
                                    n
                                    g
                                 
                                 =
                                 
                                    ⌊
                                    
                                       (
                                       Q
                                       /
                                       P
                                       )
                                    
                                    ⌋
                                 
                              
                           . Given that 
                              
                                 
                                    α
                                    
                                       i
                                       ,
                                       j
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       m
                                       r
                                    
                                    ,
                                    
                                       m
                                       g
                                    
                                    )
                                 
                              
                            and β
                           
                              j, k
                           (nr, ng
                           ) can be calculated in 
                              
                                 O
                                 (
                                 
                                    T
                                    4
                                 
                                 )
                              
                            time and Y
                           
                              i, j, k
                           (mr, mg, nr, ng
                           ) can be computed in 
                              
                                 O
                                 (
                                 
                                    T
                                    6
                                 
                                 )
                              
                            time, all possible c(i, j, k)’s can be polynomially computed in 
                              
                                 O
                                 (
                                 
                                    T
                                    6
                                 
                                 )
                              
                            time.

Recall that the model can be solved by a dynamic programming approach with the recursive equations Eq. (11). We can thus develop a polynomial dynamic programming algorithm, namely Algorithm-PDP, using the computational results of c(i, j, k). The recursive equations Eq. (11) are reformulated as follows:
                              
                                 (17)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   F
                                                   (
                                                   0
                                                   )
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   F
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   =
                                                   
                                                      min
                                                      
                                                         0
                                                         ≤
                                                         i
                                                         <
                                                         j
                                                         ≤
                                                         k
                                                      
                                                   
                                                   
                                                      {
                                                      F
                                                      (
                                                      i
                                                      )
                                                      +
                                                      c
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      ,
                                                      k
                                                      )
                                                      }
                                                   
                                                   ,
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   T
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the new recursive equations, the optimal solution can be obtained by F(T) in 
                              
                                 O
                                 (
                                 
                                    T
                                    3
                                 
                                 )
                              
                            time after the computation of all possible c(i, j, k)’s, which requires 
                              
                                 O
                                 (
                                 
                                    T
                                    6
                                 
                                 )
                              
                            time. Therefore, the overall computation complexity to find the optimal solution is 
                              
                                 O
                                 (
                                 
                                    T
                                    6
                                 
                                 )
                              
                           .

This section extends the problem to considering an emission trading mechanism. The manufacturer’s production planning problem is investigated under an emission cap-and-trade scheme. Under such scheme, the manufacturer receive some tradable initial emission allowances to cover its emissions over a planning horizon. However, the manufacturer could either purchase carbon credits when its own allowances are insufficient or sell them when it has a surplus. We assume that the manufacturer sells all spare allowances at the end of a planning horizon. The buying and selling price of carbon is assumed to be the same (Yalabik & Fairchild, 2011; Zhang & Xu, 2013).

In particular, the maximal emissions that the environment can tolerate within a certain duration are limited because of some particular features of the environment, such as ultimate bearing capacity and irreversible degradation (Le Kama, Pommeret, & Prieur, 2010), especially for pollution emissions. That is, governments would regulate firm emissions with consideration of the environmental bearing capacity (denoted by Ω) of the area where they are located. Thus, we can naturally assume that μ < Ω.

The manufacturer receives an amount of initial emission allowances E at the beginning of the production planning horizon, and it may either buy/sell carbon credits from/to markets at a price of γ. Let Γ(η) denote the cost/revenue of buying/selling η units of carbon credit, then we have 
                           
                              Γ
                              (
                              η
                              )
                              =
                              γ
                              η
                           
                        . The trading allowances in the planning horizon is 
                           
                              η
                              =
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 T
                              
                              
                                 (
                                 
                                    e
                                    r
                                 
                                 
                                    x
                                    
                                       t
                                       r
                                    
                                 
                                 +
                                 
                                    e
                                    g
                                 
                                 
                                    x
                                    
                                       t
                                       g
                                    
                                 
                                 )
                              
                              −
                              E
                              ,
                           
                         which implies that the allowance-trade strategy depends on the production planning. As a consequence, the allowance-trade decision variable η is omitted and replaced by the variables xtr
                        ’s and xtg
                        ’s.

We then formulate the problem as a model called Model PE.


                        Model PE
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             Minimize
                                             
                                             
                                             
                                             F
                                             (
                                             x
                                             ,
                                             
                                                x
                                                r
                                             
                                             )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                [
                                             
                                             
                                                s
                                                r
                                             
                                             δ
                                             
                                                (
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             
                                             +
                                             
                                             
                                                s
                                                g
                                             
                                             δ
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                
                                                −
                                                
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                p
                                                r
                                             
                                             
                                                x
                                                
                                                   t
                                                   r
                                                
                                             
                                             
                                             +
                                             
                                             
                                                p
                                                g
                                             
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                
                                                −
                                                
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                h
                                                t
                                             
                                             
                                                I
                                                t
                                             
                                             
                                                ]
                                                +
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                (
                                                
                                                   e
                                                   r
                                                
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                +
                                                
                                                   e
                                                   g
                                                
                                                
                                                   x
                                                   
                                                      t
                                                      g
                                                   
                                                
                                                )
                                             
                                             γ
                                             −
                                             E
                                             γ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             Subject
                                             
                                             to
                                             
                                             
                                                e
                                                r
                                             
                                             
                                                x
                                                
                                                   t
                                                   r
                                                
                                             
                                             +
                                             
                                                e
                                                g
                                             
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                −
                                                
                                                   x
                                                   
                                                      t
                                                      r
                                                   
                                                
                                                )
                                             
                                             ≤
                                             Ω
                                             ,
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             C
                                             o
                                             n
                                             s
                                             t
                                             r
                                             a
                                             i
                                             n
                                             t
                                             s
                                             (
                                             2
                                             )
                                             --
                                             (
                                             6
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the second term of the objective function (18), let 
                           
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 T
                              
                              
                                 (
                                 
                                    e
                                    r
                                 
                                 
                                    x
                                    
                                       t
                                       r
                                    
                                 
                                 +
                                 
                                    e
                                    g
                                 
                                 
                                    x
                                    
                                       t
                                       g
                                    
                                 
                                 )
                              
                              γ
                           
                         denote the emission cost. Eγ in the objective function is a constant independent of the decision variables, and hence, can be removed. We then integrate the emission cost into the production cost function g(x), and obtain a cost function f(x), which consists of the production and emission costs and is called the actual production cost. Under the new cost structure, the manufacturer pays costs for all its production emissions, but all initial emission allowances received are regarded as revenues. The actual unit production costs of the regular and green technologies are 
                           
                              
                                 p
                                 r
                                 ′
                              
                              =
                              
                                 p
                                 r
                              
                              +
                              
                                 e
                                 r
                              
                              γ
                           
                         and 
                           
                              
                                 p
                                 g
                                 ′
                              
                              =
                              
                                 p
                                 g
                              
                              +
                              
                                 e
                                 g
                              
                              γ
                           
                        .

Similar to the scenario without emission trading, the problem can be decomposed into two subproblems: a technology selection problem and a production planning problem. Consequently, we identify that the production cost function f(x) has a similar structure as g(x). The structural property of f(x) is presented by the following theorem. Please find the explicit expression of f(x) and its proof in Appendix B.
                           Theorem 3
                           
                              For either scenario (
                              
                                 
                                    
                                       p
                                       r
                                       ′
                                    
                                    <
                                    
                                       p
                                       g
                                       ′
                                    
                                 
                               
                              or
                              
                                 
                                    
                                       p
                                       r
                                       ′
                                    
                                    ≥
                                    
                                       p
                                       g
                                       ′
                                    
                                 
                              
                              ), the production cost f(x) is a non-decreasing piecewise concave linear function.
                           

The optimal technology selection strategy is similar to that for the non-trade scenario (see Proposition 2). We give a proposition to identify the necessary conditions under which both technologies should be used for production.
                           Proposition 4
                           
                              For any production period, both technologies are used simultaneously only when
                              
                                 
                                    
                                       p
                                       r
                                       ′
                                    
                                    <
                                    
                                       p
                                       g
                                       ′
                                    
                                    ,
                                 
                              
                              
                                 
                                    Ω
                                    /
                                    
                                       e
                                       r
                                    
                                    <
                                    x
                                    ≤
                                    
                                       
                                          x
                                          ˜
                                       
                                       ′
                                    
                                    ,
                                 
                               
                              and
                              
                                 
                                    Ω
                                    /
                                    
                                       e
                                       r
                                    
                                    <
                                    
                                       
                                          x
                                          ˜
                                       
                                       ′
                                    
                                    <
                                    Ω
                                    /
                                    
                                       e
                                       g
                                    
                                    ,
                                 
                               
                              where
                              
                                 
                                    
                                       
                                          x
                                          ˜
                                       
                                       ′
                                    
                                    =
                                    Ω
                                    /
                                    
                                       e
                                       g
                                    
                                    −
                                    
                                       s
                                       r
                                    
                                    
                                       (
                                       
                                          e
                                          r
                                       
                                       −
                                       
                                          e
                                          g
                                       
                                       )
                                    
                                    /
                                    
                                       [
                                       
                                          e
                                          g
                                       
                                       
                                          (
                                          
                                             p
                                             g
                                             ′
                                          
                                          −
                                          
                                             p
                                             r
                                             ′
                                          
                                          )
                                       
                                       ]
                                    
                                 
                              . The optimal production quantity of each technology is
                              
                                 
                                    
                                       x
                                       r
                                       *
                                    
                                    =
                                    
                                       (
                                       Ω
                                       −
                                       
                                          e
                                          g
                                       
                                       x
                                       )
                                    
                                    /
                                    
                                       (
                                       
                                          e
                                          r
                                       
                                       −
                                       
                                          e
                                          g
                                       
                                       )
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       x
                                       g
                                       *
                                    
                                    =
                                    
                                       (
                                       
                                          e
                                          r
                                       
                                       x
                                       −
                                       Ω
                                       )
                                    
                                    /
                                    
                                       (
                                       
                                          e
                                          r
                                       
                                       −
                                       
                                          e
                                          g
                                       
                                       )
                                    
                                 
                              
                              . Otherwise, only one technology (either regular or green technology) should be adopted for production.
                           

With the cost transformation, the unit production cost and emission cost are integrated into the actual cost function f(x). As a consequence, the objective function (18) can be reformulated as
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             F
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                f
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                T
                                             
                                             
                                                
                                                   h
                                                   t
                                                
                                                
                                                   I
                                                   t
                                                
                                             
                                             −
                                             E
                                             γ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Observe that Eγ is a constant, all constraints are the same as in Model P and f(x) has a similar structure as g(x) (see Theorem 3). Thus, we can solve the model by using Algorithm-PDP developed in the previous section. In other words, the proposed model, considering the emission cap-and-trade scheme, can be also solved in polynomial time.

We consider an example of a manufacturer that needs to plan production for a 12-period/month planning horizon. The demand of each month is shown in Table 1. The monthly production of the company is regulated by a carbon emission cap 
                           
                              μ
                              =
                              20
                           
                         thousand tons. Some other parameters are given below.

The setup costs are 
                           
                              
                                 s
                                 r
                              
                              =
                              90
                           
                         and 
                           
                              
                                 s
                                 g
                              
                              =
                              200
                           
                         thousand dollars per setup. The unit production costs are 
                           
                              
                                 p
                                 r
                              
                              =
                              60
                           
                         and 
                           
                              
                                 p
                                 g
                              
                              =
                              80
                           
                         thousand dollars per ton. The emissions of unit production are 
                           
                              
                                 e
                                 r
                              
                              =
                              2
                           
                         and 
                           
                              
                                 e
                                 g
                              
                              =
                              1
                           
                         ton CO2 per ton products. The inventory holding cost is 
                           
                              
                                 h
                                 t
                              
                              =
                              2
                           
                         dollars per ton per month.

According to the computation, the minimal cost is 11.56 million dollars, whereas the total carbon emissions in one year are 216.00 thousand tons. Some other results are given in Table 2
                        
                        . The results show that the emission regulation is not very tight for the manufacturer. Table 2 shows that the regular technology and green technology are used seven and five times, respectively. Note that both technologies are used simultaneously in period 6. The regular technology is used more frequently than the green technology.

In what follows, we extend the example to consider emission trading, i.e., investigating the manufacturer’s decision problem under an emission cap-and-trade scheme as studied in Section 5. In the example, we set all manufacturer-related parameters to be the same values as those under a mandatory emission-cap policy. The emission capacity is 
                           
                              Ω
                              =
                              25
                           
                         thousand tons. The values of some other parameters involved in Model PE are given below.

The initial emission allowances for a planning horizon are E = 200 thousand tons. The carbon price is γ = 15 dollars per ton CO2. The actual unit production costs are 
                           
                              
                                 p
                                 r
                                 ′
                              
                              =
                              
                                 p
                                 r
                              
                              +
                              
                                 e
                                 r
                              
                              γ
                              =
                              90
                           
                         thousand dollars per ton, 
                           
                              
                                 p
                                 g
                                 ′
                              
                              =
                              
                                 p
                                 g
                              
                              +
                              
                                 e
                                 g
                              
                              γ
                              =
                              95
                           
                         thousand dollars per ton.

The results show that the minimal total cost is 11.66 million dollars, whereas the related total carbon emissions are 271.00 thousand tons. The manufacturer needs to buy 71.00 thousand tons worth of carbon credits from the market to satisfy its production. Some other related results are given in Table 3
                        .

The results reveal that the emission regulation is easy (or not tight) for the manufacturer, that is, the carbon price is at a low level. As shown in Table 3, the green technology is only used once in a 12-period production planning. The manufacturer buys 71.00 thousand tons carbon credits from the market to satisfy demands instead of using the green technology more frequently.

In this section, we investigate the impacts of emission constraints on the manufacturer’s production planning. The emission cap and the carbon price play important roles in regulating emissions under the mandatory emission-cap policy and the emission cap-and-trade scheme. Thus, we will explore the impacts of these two parameters in the related regulation policies.

The emission
                            cap may have significant influences on the operational decisions of production planning. From the perspective of policy-making, such policy is a critical instrument for the government to regulate carbon emissions. With respect to the base example, we change the setting of the emission cap and explore the impacts.

We change the emission cap μ from 15 (a low level) to 55 (a high level) thousand tons. Note that, an emission cap that is more than 53 thousand tons cannot constrain the manufacturer’s production emissions anymore (i.e., it is equivalent to setting 
                              
                                 μ
                                 =
                                 +
                                 ∞
                              
                           )). As shown in Fig. 2, the emission cap has significant impacts on the decisions regarding technology selection strategy, costs, and emissions.

From the results, we draw some conclusions as follows:
                              
                                 (1)
                                 The curves of both the total actual emissions and the total cost are not smooth as shown in Fig. 2(a) and (b). This is caused by the discontinuity of the cost function.

The emission cap has influences on the production planning and the total cost, especially when it is at a relatively low level (i.e., the emission regulation policy is at a severe situation). As shown in Fig. 2(a), the manufacturer can no longer produce when the emission cap is lower than 15 thousand tons. When the emission cap increases from 15 to 25 thousand tons, the total cost decreases drastically by 
                                       
                                          (
                                          13.26
                                          --
                                          10.39
                                          )
                                          /
                                          13.26
                                          =
                                          21.64
                                       
                                     percent.

The manufacturer always tries to use up the permitted emissions when the emission cap is relatively tight. From the results in Fig. 2(b), we find that the total emissions are close to the emission cap when it is less than 25 thousand tons. However, the emission cap will be ineffective when it becomes extremely high. As shown in Fig. 2(a) and (b), the cost can no longer be reduced when the emission cap is more than 53 thousand tons, and the total emissions do not change when the emission cap exceeds 29 thousand tons. An interesting observation is that the total emissions do not increase anymore while the costs are still decreasing when increasing the cap. The cost reduction benefits from the relaxation of the emission cap (i.e., the production capacity), while the minimal cost is achieved when the cap does not limit the production anymore, in such a case the best trade-off between the inventory cost and production cost is obtained. However, the relaxation of cap does not result in more emissions when only the regular technology is adopted for production as shown in Fig. 2(c).

Under an emission cap-and-trade scheme, the carbon price may significantly affect the manufacturer’s decisions on production planning because the actual unit production cost depends on the carbon price. To investigate its impacts, we perform some sensitivity analyses on the carbon price and change it from 10 to 50 dollars per ton. The computation results are given in Fig. 3.

From the results shown in Fig. 3, we draw some interesting observations.
                              
                                 (1)
                                 The results show that the emissions and technology selection strategy may remain the same when changing the carbon price (see Fig. 3(a)). The reason is the setup cost: when the increase in carbon price is insufficient, the cost of switching to green technology (i.e., incurring higher setup cost) is higher than the cost of buying carbon credits even when the carbon price goes up.

The carbon price may not affect the manufacturer’s cost remarkably. When the carbon price increases from 10 to 50 dollars per ton, a 400 percent increase, the cost of the manufacturer only varies in a narrow range from 10.07 to 12.08 million dollars, a percentage of 11.42 percent, as shown in Fig. 3(b). This finding can be attributed to the fact that the manufacturer uses the green technology more frequently when the carbon price increases (see Fig. 3(a)) to reduce the quantity of carbon credits to buy and may even sell its spare emission allowances when the carbon price goes up to a high level (see Fig. 3(c)). In other words, the manufacturer has more flexibility in planning its production under an emission trade mechanism than under a mandatory emission-cap policy.

The manufacturer’s emissions may be reduced drastically when the carbon price goes up. When the carbon price increases from 10 to 50 dollars per ton, the manufacturer’s emissions decrease by 45.39 percent from 271 to 148 thousand tons, as shown in Fig. 3(b). Note particularly, as shown in Fig. 3(c), that when the carbon price increases from 14 to 24 dollars per ton, the emissions decrease sharply by 26.15 percent from 218 to 161 thousand tons. The reason is that the green technology should be adopted more frequently to reduce emissions when the carbon price goes up to avoid the high cost of buying carbon credits or to obtain more revenues from selling more emission allowances. As shown in Fig. 3(a), the number of periods of using green technology increases remarkably from one to five times when the carbon price increases from 14 to 22 dollars per ton.

@&#CONCLUSION@&#

In this paper, we study a manufacturer’s dual-mode production planning problem with emission constraints. The manufacturer is equipped with two technologies and produces a single product yielding carbon emissions to satisfy deterministic market demands. The green technology is cleaner than the regular one but is more expensive in terms of unit production cost and setup cost. In each period, the manufacturer may adopt either one or both of them for production. We consider two types of emission regulation policies, namely, a mandatory emission-cap policy and an emission cap-and-trade scheme.

We formulate the problem mathematically with an objective of minimizing the total cost over a finite planning horizon. Based upon the structural property of the model, we decompose the problem into two subproblems: a technology selection problem and a classical production planning problem. The production cost function is reformulated as a non-continuous but piecewise concave function by analytically solving the technology selection problem. Meanwhile, the optimal technology selection policy is presented. For the production planning problem, we decompose a production plan into a series of subplans, each of which is further decomposed into two smaller subintervals. With such a multi-level decomposition approach, we develop a dynamic programming algorithm to solve the problem optimally in polynomial time. The manufacturer’s decision problems under both policy scenarios are proven to be optimally solvable by the proposed algorithm in 
                        
                           O
                           (
                           
                              T
                              6
                           
                           )
                        
                      time.

Some numerical examples are computed to illustrate the applications of the models and algorithm proposed in this study, as well as to reveal the impacts of the emission constraints on the manufacturer’s operational decisions. The results reveal that a best balance between emissions and costs under emission constraints can be determined through production planning optimization. The example data also supports the expectation that a mandatory emission-cap policy has more significant impacts on a manufacturer’s operational decisions than an emission cap-and-trade scheme. This is because the manufacturer is more flexible in planning production under a market-based mechanism. Such mechanism enables a manufacturer to control emissions and cost/revenue through allowance trading.

@&#ACKNOWLEDGMENTS@&#

The authors are grateful for the constructive comments of the two anonymous referees. This research is supported by the National Science Foundation of China (NSFC) for Distinguished Youth Scholars (No. 71225002), some other NSFC grants with nos: 71401067, 71472079, 71520107002, 71110107024 and 71471168, and grants of Fundamental Research Funds for the Central Universities with nos: 15LZUJBWZD014 and 14LZUJBWZY075.


                     
                        Proof
                        Let 
                              
                                 ℓ
                                 
                                    (
                                    x
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    s
                                    r
                                 
                                 δ
                                 
                                    (
                                    z
                                    )
                                 
                                 +
                                 
                                    s
                                    g
                                 
                                 δ
                                 
                                    (
                                    x
                                    −
                                    z
                                    )
                                 
                                 +
                                 
                                    p
                                    r
                                 
                                 z
                                 +
                                 
                                    p
                                    g
                                 
                                 
                                    (
                                    x
                                    −
                                    z
                                    )
                                 
                                 ,
                              
                            with 0 ≤ z ≤ x. Whenever 
                              
                                 
                                    e
                                    r
                                 
                                 z
                                 +
                                 
                                    e
                                    g
                                 
                                 
                                    (
                                    x
                                    −
                                    z
                                    )
                                 
                                 >
                                 μ
                              
                            or z ∉ [0, x], ℓ(x, z) is set to be 
                              
                                 +
                                 ∞
                                 ,
                              
                            without loss of generality. Particularly, we have 
                              
                                 ℓ
                                 
                                    (
                                    x
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    r
                                 
                                 z
                                 +
                                 
                                    p
                                    g
                                 
                                 
                                    (
                                    x
                                    −
                                    z
                                    )
                                 
                                 ,
                              
                            when 0 < z < x.

With the definition of g(x), it is reformulated as
                              
                                 (21)
                                 
                                    
                                       g
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       min
                                       
                                          {
                                          ℓ
                                          
                                             (
                                             x
                                             ,
                                             x
                                             )
                                          
                                          ,
                                          
                                          
                                             min
                                             
                                                
                                                   
                                                      
                                                         0
                                                         <
                                                         z
                                                         <
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         z
                                                         ≤
                                                         
                                                            (
                                                            μ
                                                            −
                                                            
                                                               e
                                                               g
                                                            
                                                            x
                                                            )
                                                         
                                                         /
                                                         
                                                            (
                                                            
                                                               e
                                                               r
                                                            
                                                            −
                                                            
                                                               e
                                                               g
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ℓ
                                          
                                             (
                                             x
                                             ,
                                             z
                                             )
                                          
                                          ,
                                          ℓ
                                          
                                             (
                                             x
                                             ,
                                             0
                                             )
                                          
                                          }
                                       
                                       ,
                                    
                                 
                              
                           where the three terms in the braces on the right side of Eq. (21) represent minimal production costs when only the regular technology, both technologies, and only the green technology are adopted for production, respectively.

In what follows, we analyze how to choose technology for production and how to determine the production quantity of each selected technology to minimize the production cost g(x) at different values of x.

If 0 < x ≤ μ/er
                           , we have 
                              
                                 ℓ
                                 
                                    (
                                    x
                                    ,
                                    x
                                    )
                                 
                                 =
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    p
                                    r
                                 
                                 x
                                 ,
                              
                           
                           
                              
                                 ℓ
                                 
                                    (
                                    x
                                    ,
                                    0
                                    )
                                 
                                 =
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    g
                                 
                                 x
                                 >
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    p
                                    r
                                 
                                 x
                              
                            and 
                              
                                 ℓ
                                 
                                    (
                                    x
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    g
                                 
                                 x
                                 −
                                 
                                    (
                                    
                                       p
                                       g
                                    
                                    −
                                    
                                       p
                                       r
                                    
                                    )
                                 
                                 z
                                 >
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    g
                                 
                                 x
                                 −
                                 
                                    (
                                    
                                       p
                                       g
                                    
                                    −
                                    
                                       p
                                       r
                                    
                                    )
                                 
                                 x
                                 =
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    r
                                 
                                 x
                                 >
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    p
                                    r
                                 
                                 x
                                 ,
                              
                            when 0 < z < x. Therefore, it must be 
                              
                                 g
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    p
                                    r
                                 
                                 x
                                 ,
                              
                            and 
                              
                                 z
                                 =
                                 x
                              
                           .

If μ/er
                            < x ≤ μ/eg
                           , we have 
                              
                                 ℓ
                                 (
                                 x
                                 ,
                                 x
                                 )
                                 =
                                 +
                                 ∞
                                 ,
                              
                           
                           
                              
                                 ℓ
                                 
                                    (
                                    x
                                    ,
                                    0
                                    )
                                 
                                 =
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    g
                                 
                                 x
                              
                            and 
                              
                                 ℓ
                                 
                                    (
                                    x
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    g
                                 
                                 x
                                 −
                                 
                                    (
                                    
                                       p
                                       g
                                    
                                    −
                                    
                                       p
                                       r
                                    
                                    )
                                 
                                 z
                              
                            is a decreasing function of z, when 0 < z < x. The second term of g(x), i.e., 
                              
                                 
                                    
                                       min
                                       
                                          
                                             
                                                
                                                   0
                                                   <
                                                   z
                                                   <
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                
                                                   z
                                                   ≤
                                                   
                                                      (
                                                      μ
                                                      −
                                                      
                                                         e
                                                         g
                                                      
                                                      x
                                                      )
                                                   
                                                   /
                                                   
                                                      (
                                                      
                                                         e
                                                         r
                                                      
                                                      −
                                                      
                                                         e
                                                         g
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ℓ
                                    
                                       (
                                       x
                                       ,
                                       z
                                       )
                                    
                                    ,
                                 
                              
                            gets the minimal value when z gets the maximal value, i.e., 
                              
                                 z
                                 =
                                 
                                    (
                                    μ
                                    −
                                    
                                       e
                                       g
                                    
                                    x
                                    )
                                 
                                 /
                                 
                                    (
                                    
                                       e
                                       r
                                    
                                    −
                                    
                                       e
                                       g
                                    
                                    )
                                 
                                 ,
                              
                            which gives 
                              
                                 g
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    s
                                    g
                                 
                                 +
                                 min
                                 
                                    {
                                    
                                       p
                                       g
                                    
                                    x
                                    ,
                                    
                                       s
                                       r
                                    
                                    −
                                    
                                       
                                          
                                             p
                                             g
                                          
                                          −
                                          
                                             p
                                             r
                                          
                                       
                                       
                                          
                                             e
                                             r
                                          
                                          −
                                          
                                             e
                                             g
                                          
                                       
                                    
                                    μ
                                    +
                                    
                                       
                                          
                                             p
                                             g
                                          
                                          
                                             e
                                             r
                                          
                                          −
                                          
                                             p
                                             r
                                          
                                          
                                             e
                                             g
                                          
                                       
                                       
                                          
                                             e
                                             r
                                          
                                          −
                                          
                                             e
                                             g
                                          
                                       
                                    
                                    x
                                    }
                                 
                              
                           . Therefore, let 
                              
                                 
                                    x
                                    ˜
                                 
                                 =
                                 μ
                                 /
                                 
                                    e
                                    g
                                 
                                 −
                                 
                                    s
                                    r
                                 
                                 
                                    (
                                    
                                       e
                                       r
                                    
                                    −
                                    
                                       e
                                       g
                                    
                                    )
                                 
                                 /
                                 
                                    [
                                    
                                       e
                                       g
                                    
                                    
                                       (
                                       
                                          p
                                          g
                                       
                                       −
                                       
                                          p
                                          r
                                       
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                            we have 
                              
                                 g
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    s
                                    g
                                 
                                 +
                                 
                                    p
                                    g
                                 
                                 x
                              
                            when 
                              
                                 
                                    x
                                    ˜
                                 
                                 ≤
                                 x
                                 ≤
                                 μ
                                 /
                                 
                                    e
                                    g
                                 
                                 ,
                              
                            and 
                              
                                 
                                    s
                                    r
                                 
                                 +
                                 
                                    s
                                    g
                                 
                                 −
                                 
                                    
                                       
                                          p
                                          g
                                       
                                       −
                                       
                                          p
                                          r
                                       
                                    
                                    
                                       
                                          e
                                          r
                                       
                                       −
                                       
                                          e
                                          g
                                       
                                    
                                 
                                 μ
                                 +
                                 
                                    
                                       
                                          p
                                          g
                                       
                                       
                                          e
                                          r
                                       
                                       −
                                       
                                          p
                                          r
                                       
                                       
                                          e
                                          g
                                       
                                    
                                    
                                       
                                          e
                                          r
                                       
                                       −
                                       
                                          e
                                          g
                                       
                                    
                                 
                                 x
                              
                            otherwise.

From the analysis above, it can be seen that the production cost g(x) is a non-continuous piecewise linear function of x on [0, μ/eg
                           ]. As a consequence, the equivalent production cost function g(x) is given by
                              
                                 (22)
                                 
                                    
                                       g
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         g
                                                         
                                                            (
                                                            a
                                                            )
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      μ
                                                      /
                                                      
                                                         e
                                                         r
                                                      
                                                      <
                                                      
                                                         x
                                                         ˜
                                                      
                                                      <
                                                      μ
                                                      /
                                                      
                                                         e
                                                         g
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         g
                                                         
                                                            (
                                                            b
                                                            )
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      o
                                                      t
                                                      h
                                                      e
                                                      r
                                                      w
                                                      i
                                                      s
                                                      e
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    x
                                    ˜
                                 
                                 =
                                 μ
                                 /
                                 
                                    e
                                    g
                                 
                                 −
                                 
                                    s
                                    r
                                 
                                 
                                    (
                                    
                                       e
                                       r
                                    
                                    −
                                    
                                       e
                                       g
                                    
                                    )
                                 
                                 /
                                 
                                    [
                                    
                                       e
                                       g
                                    
                                    
                                       (
                                       
                                          p
                                          g
                                       
                                       −
                                       
                                          p
                                          r
                                       
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                            
                           g
                           (a)(x) and g
                           (b)(x) are given by Eqs. (23) and (24) as follows:
                              
                                 (23)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   g
                                                   
                                                      (
                                                      a
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               =
                                                               0
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  r
                                                               
                                                               +
                                                               
                                                                  p
                                                                  r
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               <
                                                               x
                                                               ≤
                                                               μ
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  r
                                                               
                                                               +
                                                               
                                                                  s
                                                                  g
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           g
                                                                        
                                                                        −
                                                                        
                                                                           p
                                                                           r
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           e
                                                                           r
                                                                        
                                                                        −
                                                                        
                                                                           e
                                                                           g
                                                                        
                                                                     
                                                                  
                                                               
                                                               μ
                                                               +
                                                               
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           g
                                                                        
                                                                        
                                                                           e
                                                                           r
                                                                        
                                                                        −
                                                                        
                                                                           p
                                                                           r
                                                                        
                                                                        
                                                                           e
                                                                           g
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           e
                                                                           r
                                                                        
                                                                        −
                                                                        
                                                                           e
                                                                           g
                                                                        
                                                                     
                                                                  
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               μ
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               <
                                                               x
                                                               <
                                                               
                                                                  x
                                                                  ˜
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  g
                                                               
                                                               +
                                                               
                                                                  p
                                                                  g
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  x
                                                                  ˜
                                                               
                                                               ≤
                                                               x
                                                               ≤
                                                               μ
                                                               /
                                                               
                                                                  e
                                                                  g
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∞
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               o
                                                               t
                                                               h
                                                               e
                                                               r
                                                               w
                                                               i
                                                               s
                                                               e
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   g
                                                   
                                                      (
                                                      b
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               =
                                                               0
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  r
                                                               
                                                               +
                                                               
                                                                  p
                                                                  r
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               <
                                                               x
                                                               ≤
                                                               μ
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  g
                                                               
                                                               +
                                                               
                                                                  p
                                                                  g
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               μ
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               <
                                                               x
                                                               ≤
                                                               μ
                                                               /
                                                               
                                                                  e
                                                                  g
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∞
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               o
                                                               t
                                                               h
                                                               e
                                                               r
                                                               w
                                                               i
                                                               s
                                                               e
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For the function above, it can be seen that the production cost is non-decreasing linear and piecewise concave.□


                     
                        Proof
                        The problem cannot be solved by simply replacing μ, pg
                           , and pr
                            with Ω, 
                              
                                 
                                    p
                                    r
                                    ′
                                 
                                 ,
                              
                            and 
                              
                                 p
                                 g
                                 ′
                              
                            because it is possible that 
                              
                                 
                                    p
                                    r
                                    ′
                                 
                                 ≥
                                 
                                    p
                                    g
                                    ′
                                 
                                 ,
                              
                            due to the value of γ, whereas pg
                            > pr
                            is a necessary assumption when solving the previous problem.

However, the same method presented in Section 4 can be used to analyze the technology selection problem for the case 
                              
                                 
                                    p
                                    r
                                    ′
                                 
                                 ≥
                                 
                                    p
                                    g
                                    ′
                                 
                              
                           . As a consequence, we obtain the function f(x) as follows:

If 
                              
                                 
                                    p
                                    r
                                    ′
                                 
                                 <
                                 
                                    p
                                    g
                                    ′
                                 
                                 ,
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       f
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            a
                                                            )
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      Ω
                                                      /
                                                      
                                                         e
                                                         r
                                                      
                                                      <
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         ′
                                                      
                                                      <
                                                      Ω
                                                      /
                                                      
                                                         e
                                                         g
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            b
                                                            )
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      o
                                                      t
                                                      h
                                                      e
                                                      r
                                                      w
                                                      i
                                                      s
                                                      e
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

If 
                              
                                 
                                    p
                                    r
                                    ′
                                 
                                 ≥
                                 
                                    p
                                    g
                                    ′
                                 
                                 ,
                              
                           
                           
                              
                                 (26)
                                 
                                    
                                       f
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            c
                                                            )
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         ′
                                                      
                                                      ≤
                                                      Ω
                                                      /
                                                      
                                                         e
                                                         r
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                         
                                                            (
                                                            b
                                                            )
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      o
                                                      t
                                                      h
                                                      e
                                                      r
                                                      w
                                                      i
                                                      s
                                                      e
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       x
                                       ˜
                                    
                                    ′
                                 
                                 =
                                 Ω
                                 /
                                 
                                    e
                                    g
                                 
                                 −
                                 
                                    s
                                    r
                                 
                                 
                                    (
                                    
                                       e
                                       r
                                    
                                    −
                                    
                                       e
                                       g
                                    
                                    )
                                 
                                 /
                                 
                                    [
                                    
                                       e
                                       g
                                    
                                    
                                       (
                                       
                                          p
                                          g
                                          ′
                                       
                                       −
                                       
                                          p
                                          r
                                          ′
                                       
                                       )
                                    
                                    ]
                                 
                                 ,
                              
                            
                           f
                           (a)(x), f
                           (b)(x), and f
                           (c)(x) are given by Eqs. (27)–(29) as follows:
                              
                                 (27)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   f
                                                   
                                                      (
                                                      a
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               =
                                                               0
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  r
                                                               
                                                               +
                                                               
                                                                  p
                                                                  r
                                                                  ′
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               <
                                                               x
                                                               ≤
                                                               Ω
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  r
                                                               
                                                               +
                                                               
                                                                  s
                                                                  g
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           g
                                                                           ′
                                                                        
                                                                        −
                                                                        
                                                                           p
                                                                           r
                                                                           ′
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           e
                                                                           r
                                                                        
                                                                        −
                                                                        
                                                                           e
                                                                           g
                                                                        
                                                                     
                                                                  
                                                               
                                                               Ω
                                                               +
                                                               
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           g
                                                                           ′
                                                                        
                                                                        
                                                                           e
                                                                           r
                                                                        
                                                                        −
                                                                        
                                                                           p
                                                                           r
                                                                           ′
                                                                        
                                                                        
                                                                           e
                                                                           g
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           e
                                                                           r
                                                                        
                                                                        −
                                                                        
                                                                           e
                                                                           g
                                                                        
                                                                     
                                                                  
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               Ω
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               <
                                                               x
                                                               <
                                                               
                                                                  
                                                                     x
                                                                     ˜
                                                                  
                                                                  ′
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  g
                                                               
                                                               +
                                                               
                                                                  p
                                                                  g
                                                                  ′
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                     ˜
                                                                  
                                                                  ′
                                                               
                                                               ≤
                                                               x
                                                               ≤
                                                               Ω
                                                               /
                                                               
                                                                  e
                                                                  g
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∞
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               o
                                                               t
                                                               h
                                                               e
                                                               r
                                                               w
                                                               i
                                                               s
                                                               e
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   f
                                                   
                                                      (
                                                      b
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               =
                                                               0
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  r
                                                               
                                                               +
                                                               
                                                                  p
                                                                  r
                                                                  ′
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               <
                                                               x
                                                               ≤
                                                               Ω
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  g
                                                               
                                                               +
                                                               
                                                                  p
                                                                  g
                                                                  ′
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               Ω
                                                               /
                                                               
                                                                  e
                                                                  r
                                                               
                                                               <
                                                               x
                                                               ≤
                                                               Ω
                                                               /
                                                               
                                                                  e
                                                                  g
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∞
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               o
                                                               t
                                                               h
                                                               e
                                                               r
                                                               w
                                                               i
                                                               s
                                                               e
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   f
                                                   
                                                      (
                                                      c
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                               =
                                                               0
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  r
                                                               
                                                               +
                                                               
                                                                  p
                                                                  r
                                                                  ′
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               <
                                                               x
                                                               ≤
                                                               
                                                                  
                                                                     x
                                                                     ˜
                                                                  
                                                                  ′
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                                  g
                                                               
                                                               +
                                                               
                                                                  p
                                                                  g
                                                                  ′
                                                               
                                                               x
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                     ˜
                                                                  
                                                                  ′
                                                               
                                                               <
                                                               x
                                                               ≤
                                                               Ω
                                                               /
                                                               
                                                                  e
                                                                  g
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∞
                                                               ,
                                                            
                                                         
                                                         
                                                            
                                                               o
                                                               t
                                                               h
                                                               e
                                                               r
                                                               w
                                                               i
                                                               s
                                                               e
                                                               .
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For readability, the actual production cost function is described by the curves as shown in Fig. 4.

From the function and its curves, we find that the production cost function is linear and piecewise concave in either scenario.□

By the definition, β
                     
                        t, k
                     (nr, ng
                     ) is the cumulative production and inventory costs from period 
                        
                           t
                           +
                           1
                        
                      to k, with nr
                      and ng
                      normal periods using technology-r and technology-g, respectively. For any period t, 0 ≤ j ≤ t ≤ k ≤ T, we have the following relationships of nr
                      and ng
                     :
                        
                           (30)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                n
                                                r
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                n
                                                g
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                n
                                                r
                                             
                                             +
                                             
                                                n
                                                g
                                             
                                             ≤
                                             k
                                             −
                                             t
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Different from the subinterval (i, s), there may be no production in (t, k), i.e., 
                        
                           
                              n
                              r
                           
                           +
                           
                              n
                              g
                           
                        
                      may equal to 0.

The inventory level at the end of period t is 
                        
                           
                              I
                              t
                           
                           =
                           
                              D
                              
                                 t
                                 ,
                                 k
                              
                           
                           −
                           
                              n
                              r
                           
                           μ
                           /
                           
                              e
                              r
                           
                           −
                           
                              n
                              g
                           
                           μ
                           /
                           
                              e
                              g
                           
                        
                     . Then, we can calculate all possible β
                     
                        t, k
                     (nr, ng
                     )’s recursively. The initial and recursive equations are given by Eqs. (31) and (32) as follows:
                        
                           (31)
                           
                              
                                 
                                    β
                                    
                                       k
                                       ,
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       n
                                       r
                                    
                                    ,
                                    
                                       n
                                       g
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                0
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   r
                                                
                                                =
                                                
                                                   n
                                                   g
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                +
                                                ∞
                                                ,
                                             
                                          
                                          
                                             
                                                o
                                                t
                                                h
                                                e
                                                r
                                                w
                                                i
                                                s
                                                e
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (32)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             β
                                             
                                                t
                                                ,
                                                k
                                             
                                          
                                          
                                             (
                                             
                                                n
                                                r
                                             
                                             ,
                                             
                                                n
                                                g
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          =
                                          
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         +
                                                         ∞
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                            t
                                                         
                                                         <
                                                         0
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         min
                                                         
                                                            {
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                           t
                                                                        
                                                                        
                                                                           I
                                                                           t
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           β
                                                                           
                                                                              t
                                                                              
                                                                              +
                                                                              
                                                                              1
                                                                              ,
                                                                              k
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              n
                                                                              r
                                                                           
                                                                           ,
                                                                           
                                                                              n
                                                                              g
                                                                           
                                                                           )
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                           t
                                                                        
                                                                        
                                                                           I
                                                                           t
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           s
                                                                           r
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           p
                                                                           r
                                                                        
                                                                        μ
                                                                        /
                                                                        
                                                                           e
                                                                           r
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           β
                                                                           
                                                                              t
                                                                              
                                                                              +
                                                                              
                                                                              1
                                                                              ,
                                                                              k
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              n
                                                                              r
                                                                           
                                                                           
                                                                           −
                                                                           
                                                                           1
                                                                           ,
                                                                           
                                                                              n
                                                                              g
                                                                           
                                                                           )
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                           t
                                                                        
                                                                        
                                                                           I
                                                                           t
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           s
                                                                           g
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           p
                                                                           g
                                                                        
                                                                        μ
                                                                        /
                                                                        
                                                                           e
                                                                           g
                                                                        
                                                                        
                                                                        +
                                                                        
                                                                        
                                                                           β
                                                                           
                                                                              t
                                                                              
                                                                              +
                                                                              
                                                                              1
                                                                              ,
                                                                              k
                                                                           
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              n
                                                                              r
                                                                           
                                                                           ,
                                                                           
                                                                              n
                                                                              g
                                                                           
                                                                           
                                                                           −
                                                                           
                                                                           1
                                                                           )
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                               
                                                            
                                                            }
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         o
                                                         t
                                                         h
                                                         e
                                                         r
                                                         w
                                                         i
                                                         s
                                                         e
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the first case of Eq. (32), if It
                      < 0, the solution is infeasible and β
                     
                        t, k
                     (nr, ng
                     ) is set to be 
                        
                           +
                           ∞
                        
                     . The second case consists of three subcases, in which htIt
                      is the inventory-holding cost of period t and 
                        
                           
                              β
                              
                                 t
                                 +
                                 1
                                 ,
                                 k
                              
                           
                           
                              (
                              ·
                              ,
                              ·
                              )
                           
                        
                      is the minimal cumulative cost from period 
                        
                           t
                           +
                           1
                        
                      to k. The three subcases correspond to period 
                        
                           t
                           +
                           1
                        
                      being non production period, normal period using the regular technology and normal period using the green technology, respectively.

With the recursive equations, all possible β
                     
                        t, k
                     (nr, ng
                     )’s can be computed in 
                        
                           O
                           (
                           
                              T
                              4
                           
                           )
                        
                      time.

@&#REFERENCES@&#

