@&#MAIN-TITLE@&#Tradeoff between energy and user experience for multimedia cloud computing

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We investigate the trade-off of QoE and energy in multimedia cloud.


                        
                        
                           
                           A QoE quantifying model is proposed based on objective factor.


                        
                        
                           
                           We develop a theoretic model by applying Lyapunov optimization method.


                        
                        
                           
                           An approximate online algorithm (EUE-RP) is proposed with the explicitly provable performance upper bound.


                        
                        
                           
                           The proposed method flexibly manages the trade-off between QoE and energy for cloud-based multimedia services.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quality of experience

Energy

Resource provisioning

Multimedia cloud

@&#ABSTRACT@&#


               
               
                  Cloud computing provides an effective approach to deliver multimedia services to end users with the desired user quality of experience (QoE). However, cloud-based multimedia applications require many of servers and consume huge energy. To reduce energy consumption, a multimedia service provider (MSP) should balance the energy and QoE. In this paper, a theoretic model is developed to explore the trade-off between energy consumption and QoE for multimedia cloud. Based on objective factor, a QoE quantifying model is proposed. Employing Lyapunov Optimization techniques, an optimal control framework is designed and analyzed to make energy and QoE decisions in MSPs. An approximate online algorithm (EUE-RP) is proposed with the explicitly provable performance upper bound. Extensive experiments have been conducted to verify the effectiveness of EUE-RP algorithm in the practical settings. The algorithm can guarantee desired QoE and reduce energy consumption, even without any information about the future fluctuation of user demands.
               
            

@&#INTRODUCTION@&#

Multimedia computing has emerged as a noteworthy technology to provide rich media services, such as video surveillance, real-time access of medical images and video, photo and video sharing. Multimedia applications and services typically require intensive computation and/or storage resources, which are burdens to devices of end users. Recently, cloud computing has been regarded as a promising infrastructure to provide desired resources and provisioning QoS for multimedia services. Multimedia cloud [1] is a specific cloud computing paradigm, focusing on how cloud can effectively support multimedia services. In the cloud-based multimedia system, users are able to process and store multimedia applications in the cloud and alleviate requirement of multimedia software installed in users’ devices. The elastic and on-demand features of resource provisioning in cloud effectively meet the intensive resource demands of multimedia processing.

Multimedia cloud confronts new critical issues. In addition to a large of computational resources, another important factor for multimedia services is the stringent Quality of User Experience (QoE) requirement. Due to poor users’ experience, users maybe resort to a competitor’s services and affect their perception of the company’s products and the company itself. QoE as perceived by users has the potential to become the guiding paradigm for managing quality in the cloud environment. Ensuring that the users’ experience remains as good as it was before adoption will be one of the key factors in promoting new cloud services and migrations of existing ones [2]. Although multimedia QoE has been studied for a long time, there are open issues for which no answers is yet available, especially when considered in the cloud environment [2].

Multimedia applications always require a mass of servers and consume a great portion of energy in cloud computing. With the presence of unpredictable and burst application demands, the objectives of such a Multimedia Service Providers (MSP) are two-fold: (1) maximize the QoE of end users to improve its competitiveness in the market; (2) minimize power consumption of servers to reduce operation cost. There is a clear trade-off between the energy cost of computational resources and the achieved QoE of end users. Such trade-off is due to the fact that minimizing data center’s energy cost is achieved essentially by turning off some servers, scaling down CPU clocks, or migrating some workload, which can all potentially lead to degrading the QoE offered by MSPs and consequently its income, considering the stochastic nature of workload. In this paper, our purpose is to provide guidelines for MSPs on how to minimize the power consumption while still guarantee QoE of users when processing user requests in order to improve their competitiveness in the market. Since the multimedia cloud application operates is randomly changing over time and the distribution of the underlying stochastic process is often unknown a priori, it is a challenge for MSPs to perform a desired trade-off.

In this paper, a theoretic model is developed to explore the trade-off between the energy consumption and the achieved QoE for cloud-based multimedia streaming application. The problem is formulated into an optimization problem of system energy consumption and user QoE. This paper aims to optimize the time average of the energy consumption and the achieved QoE of end users. By using the Lyapunov optimization framework [3], a new optimal online control framework is designed and analyzed to make all two decisions in MSPs. An approximate online algorithm, called EUE-RP, is proposed with the explicitly provable performance upper bound. The proposed algorithm also has low complexity by exploiting the structural properties of the optimal solution. Extensive experiments have been conducted to verify the effectiveness of our proposed EUE-RP algorithm in the practical settings. The algorithm can guarantee desired QoE and reduce energy consumption, even without any information about the future fluctuation of user demands.

The rest of this paper is organized as follows. Related work is reviewed in Section 2. Section 3 describes the system model. In Section 4, we develop a provably-efficient online resource provisioning algorithm to balance user experience and energy consumption. Experiment results are shown in Section 5 and finally, concluding remarks are offered in Section 6.

@&#RELATED WORK@&#

In this section, we review the existing related works from three perspectives: multimedia cloud service, energy-aware studies in multimedia cloud and studies of QoE.

Multimedia services have strong demands for cloud computing and cloud-based multimedia services have been widely studied in recent years. Nan et al. [4] proposed optimal resource allocation policies for multimedia cloud in both single class service case and multiple-class service case based on queuing model. In each case, the response time minimization problem and resource cost minimization problem is formulated and solved, respectively. Compared with this work, our paper focuses on how to assure the QoE of end users keeping at a reasonable level. Sujit and Wang [5] proposed an approach which enables multi-player games on mobile devices, called cloud mobile gaming. In cloud mobile gaming, the computation intensive tasks, like three-dimensional model rendering, are executed on cloud servers in response to the control commands from players, and the rendered frames are compressed and streamed to mobile devices as video streaming. Ref. [6] proposed a novel cloud multimedia streaming architecture, which provides dynamic adjustable streaming services. Considering mobile device resources, multimedia codec characteristics and the current network environment, a stream dispatcher is designed with the adaptable codec approach to calculate the most suitable segment for mobile devices in time. Aggarwal et al. [7] seeked to lower a provider’s costs for real-time IPTV services through a virtualized IPTV architecture and through intelligent time-shifting of selected services.

With more and more multimedia services on cloud, there is an upsurge of research interest in energy consumption for cloud-based multimedia services. Ren and van der Schaar [8] explored a cloud-based stream mining system, which the mobile devices send via wireless links unclassified media streams to the cloud for classification. In order to minimize the affine combination of classification cost and energy consumption at the cloud, an online algorithm is developed. The cloud operator can dynamically adjust its resource provisioning, and the mobile devices can adapt their transmission rates to the instantaneous channel conditions. Compared with this paper, our approach focuses on the study of the trade-off between QoE of user and the system energy consumption. Ghamkhari and Mohsenian-Rad [9] proposed a systematic approach to maximize green data center’s profit. The model incorporates various other factors such as availability of local renewable power generation at data centers and the stochastic nature of data centers’ workload. A novel optimization-based profit maximization strategy is proposed for data centers for two different cases, without and with behind-the-meter renewable generators. Xiao et al. [10] presented an energy-efficiency enhanced virtual machine (VM) scheduling policy, with the purpose to reduce the energy-efficiency losses caused by I/O virtualization. The proposed scheduler allows VMs to reclaim extra CPU shares in certain conditions in order to increase CPU utilization. Specially, it separates I/O-intensive VMs from CPU-intensive ones and schedules them in a collective manner, hence it could reduce the context-switching cost when scheduling mixed workloads. Ref. [11] emphasized the role of communication fabric and presented a scheduling solution, named e-STAB, considering traffic requirements of cloud applications to provide energy efficient job allocation and implement traffic load balancing in data center networks. In [12], ordinal optimization using rough models and fast simulation is introduced to obtain suboptimal solutions in a much shorter timeframe. While the scheduling solution for each period may not be the best, ordinal optimization can be processed fast in an iterative and evolutionary way to capture the details of big data workload dynamism. [13] presented an assignment scheme between the interacting components of an application and the computing nodes of a cloud system in order to minimize the total amount of resources consumed by the respective application. The paper proposes a fully distributed algorithm (called DRA) to overcome scalability issues. DRA takes decisions concerning the transition from one assignment scheme to another in a dynamic way, based solely on local information. Gao et al. [14] proposed a dynamic resource management scheme. This scheme takes advantage of both dynamic voltage/frequency scaling and server consolidation to achieve energy efficiency and desired service level agreements in cloud data centers. The novelty of the proposed scheme is to integrate timing analysis, queuing theory, integer programming, and control theory techniques.

If the service can achieve success, the user’s satisfaction is necessary, thus it is of great importance to know how users have perceived the quality of service and offer the end user with good satisfaction. Fajardo et al. [15] performed analysis of mobile multimedia services, focusing on current media resolutions for mobile handsets. This paper analyzes the service performance from an end-to-end perspective, taking into account the several agents involved in the service provision. Ref. [16] presented the results of several cloud QoE studies performed for different cloud-based services, ranging from services with low requirements in terms of latency and interactivity, multimedia On-Demand services, communication and telepresence to highly interactive services. An optimal bandwidth allocation framework [17] has been developed that is based on some network-specific constraints and by incorporating an accurate video quality metric, the total weighted quality of experience of some competing video sources has been optimized bases on cross-layer design techniques. Energy-based fair queuing [18] was proposed as a pivotal instrument to maximize the user experience in this type of system. It is a novel class of energy-aware scheduling algorithms that support proportional energy use, effective time constraint compliance and a flexible trade-off between them. The resource allocation problem with incomplete information where the realized mean opinion score can only be observed over time, but the underlying QoE model and playout time are unknown. They consider two variants of this problem: (1) the form of the QoE model is known but the parameters are unknown; (2) both the form and the parameters of the QoE model are unknown. For both cases, this paper developed dynamic resource allocation schemes based on online test-optimization strategy. Ref. [19] investigated the trade-off between the cost incurred by VM instance procurement and the achieved QoE of end users under Amazon EC2’s pricing models, and formulated the VM instance provisioning and procurement problem into a constrained stochastic optimization problem. Our research in this paper investigates the relation of QoE and system energy consumption in Multimedia Cloud environment.

From the mentioned works above, we can reach a conclusion that although many of works focus on QoE of multimedia, there are few works related with multimedia cloud environment. Specially, few of these works have considered multimedia cloud systems operating in random environments with unknown distributions. Moreover, it is critical to achieve a flexible tradeoff between the energy consumption and user experience in order to reduce power cost of MSP while still guaranteeing the desired QoE. In this paper, we shall explore a cloud-based video streaming and address these issues.

Cloud computing relies on the data centers as their primary backend computing infrastructure. An overview of a multimedia cloud datacenter is described in Fig. 1
                        . The datacenter consists of M homogeneous server S
                        ={1,2,…,
                        M}, serving N users accessing video streaming service. In this paper, we consider a time-slotted system with time slots of equal length indexed by t
                        =0,1,…, each one with length 
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                           
                        , e.g., Tp
                        
                        =5min. The number of launched servers is updated only at the beginning of each time slot. We assume 
                           
                              n
                              (
                              t
                              )
                           
                         servers to serve video streaming application on time slot t. 
                           
                              
                                 
                                    K
                                 
                                 
                                    min
                                 
                              
                           
                         represents the minimum number of servers at all times to accommodate a sudden spike in request arrivals.

In this paper, we consider Chunk-based video streaming due to its popularity. The video streaming can be a video segment in HTTP streaming. The whole video is divided into multiple chunks, and each video chunk can be viewed immediately after being downloaded. There are N users accessing multimedia streams from the multimedia cloud. At time slot t, each user senses the scene of interest and accesses a video streaming. We assume each user experience independent network channel, for 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                           
                         and 
                           
                              t
                              =
                              1
                              ,
                              2
                              ,
                              …
                           
                        . Each user can vary its video stream quality by adapting its playback rate, We denote the playback rate selected by user 
                           
                              i
                           
                         by 
                           
                              
                                 
                                    pr
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              ∈
                              [
                              0
                              ,
                              
                                 
                                    pr
                                 
                                 
                                    i
                                    ,max
                                 
                              
                              ]
                           
                        , where 
                           
                              
                                 
                                    pr
                                 
                                 
                                    i
                                    ,max
                                 
                              
                           
                         is the maximum playback rate that user 
                           
                              i
                           
                         can select. Considering resource-constrained users and network conditions, we impose a average playback rate constraint, denoted by 
                           
                              
                                 
                                    PR
                                 
                                 
                                    i
                                 
                              
                           
                        , for each user 
                           
                              i
                           
                        .

The QoE of multimedia streaming perceived by a user is influenced by the network condition, content quality, user’s preference on the content, and the context in which the user is viewing a video. It is a subjective metric. From current research status of evaluation method, we can observe that the subjective method based on user survey can reflect the experience of user more directly and match well to the feeling of user. However, this kind of method has several problems, such as, it requires special environment and equipments, and it needs a mass of people to participate the test. In conclusion, subjective video quality measurement cannot provide real-time and in-service quality monitoring for real time video applications. Therefore the application of the method is limited and objective quality tests such as [20,21], are studied to try to estimate human perception. Aimed at quantifying QoE, we are interested in translating the impact of this objective quality metric into a subjective quality one. Objective quality tests are studied to try to estimate human perception based on: models of human video perception, video signal parameters, network impairment parameters, or the duration of the impairment in the video signal. As shown in Fig. 2
                        , the QoE would mainly rely on the subjective factors: response time, smoothness, and sharpness. The response time refers to the total delay from the user control command occurring to the corresponding video frame displaying. The subjective factors are affected by a number of objective factors, which can be categorized into two groups: video settings and network parameters. All these objective factors affect the video response time, smoothness and sharpness in a complex manner. To ensure feasibility, we decided to formulate the QoE function based on the objective factors in Fig. 2.

We define User Experience Degree (UED) as a measurement metric for user experience of video streaming service. By deriving the objective, perceptual index, we are able to quantify the relative impact of packet loss (PL), delay (D), jitter (J), bandwidth (BW) on video streaming, and etc. These QoS parameters are network related quality factors which are recommended by the standardization organizations like ITU-T and IETF. The weight of the QoS parameters should be assigned by considering the relative importance degree of the QoS parameter related to the video QoE.

The QoS of video streaming of user i can be calculated through Eq. (1), and reflects the network condition. In Eq. (1), the constant k represents the whole QoS quality determinant which is selected according to the type of the transmission system for the video streaming service [20].
                           
                              (1)
                              
                                 
                                    
                                       QoS
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 k
                                 (
                                 wl
                                 ×
                                 
                                    
                                       PL
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 wj
                                 ×
                                 
                                    
                                       J
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 wd
                                 ×
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 wb
                                 ×
                                 
                                    
                                       BW
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     

With MSP, users are typically serviced for each of its transaction or request at slot t. A user request specifies a delay constraint Di
                        . We use a generic expression that the results should be quite close to the actual perception of multimedia users. In such a way, we distinguish two intervals in this function. Denote 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         as actual delay of user i. The UED of a user i is defined by the function:
                           
                              (2)
                              
                                 
                                    
                                       UED
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         (
                                                         1
                                                         -
                                                         
                                                            
                                                               QoS
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     QoS
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ×
                                                               A
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Qr
                         is the upper bound of the video quality of experience according to the network type. Next, the QoS
                           i
                         is the normalized QoS value which is calculated by Eq. (1), and is determined by quality parameters of the network layer. The constant A expresses the subscribed service class such as SDTV and HDTV.

Until now we have depicted subjective quality in a per-user basis by means of a delay-constrained UED utility function. For each user i, we define the time averaged 
                           
                              
                                 
                                    UED
                                 
                                 
                                    i
                                 
                              
                           
                         as:
                           
                              (3)
                              
                                 
                                    
                                       UED
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          t
                                          →
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          0
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                 
                                 E
                                 
                                    
                                       
                                          
                                             
                                                UED
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          τ
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

A job queue is maintained at the multimedia cloud to store the unfinished requests by the users. Mathematically, we denote 
                           
                              n
                              (
                              t
                              )
                              ⩾
                              0
                           
                         as the total provided computational resource at time t. We define the queue backlog 
                           
                              Q
                              (
                              t
                              )
                           
                         of the 
                           
                              n
                              (
                              t
                              )
                           
                         servers as the total sizes of all the requests that are waiting in the queue at the beginning of time slot t (Initially, 
                           
                              Q
                              (
                              0
                              )
                              =
                              0
                           
                        ). The corresponding service rate of a queue in time slot t can be quantified as 
                           
                              n
                              (
                              t
                              )
                           
                         and use 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                           
                         to quantify the input/arrival rate to the job queue for each user i, respectively. So we can capture the following queuing dynamics over time for 
                           
                              n
                              (
                              t
                              )
                           
                         server in a datacenter:
                           
                              (4)
                              
                                 Q
                                 (
                                 t
                                 +
                                 1
                                 )
                                 =
                                 
                                    max
                                 
                                 [
                                 Q
                                 (
                                 t
                                 )
                                 -
                                 n
                                 (
                                 t
                                 )
                                 ,
                                 0
                                 ]
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                              
                           
                        
                     

To address the responsiveness in multimedia cloud, we shall show later that the average queue length, which is closely related to the delay, is upper bounded and the queue length can be shortened at the expense of increasing the energy cost or decreasing user QoE.

When dealing with video streaming services, the MSP incurs various operational costs. The total amount of power consumption in a data center is obtained by adding the total power consumption at the computer servers to the total power consumption at the facility, e.g., for cooling, lighting, etc. For a data center, power usage effectiveness (PUE), denoted by 
                           
                              
                                 
                                    E
                                 
                                 
                                    usage
                                 
                              
                           
                        , is defined as the ratio of the data center’s total power consumption to the data center’s power consumption at the computer servers. The PUE is considered as a measure for data center’s energy efficiency.

The multimedia cloud houses a limited, albeit possibly large, number of servers, each with a maximum processor speed. The total computational resource that can be provided by the multimedia cloud satisfies 
                           
                              n
                              (
                              t
                              )
                              ⩽
                              M
                              ,
                              
                              t
                              ∈
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              …
                              }
                           
                        . Let 
                           
                              
                                 
                                    P
                                 
                                 
                                    idle
                                 
                              
                           
                         denote the average idle power draw of a single server and denote 
                           
                              
                                 
                                    P
                                 
                                 
                                    busy
                                 
                              
                           
                         the average peak power when a server is handling a service request. The total electric power consumption associated with the data center can be obtained as [22,11,9]:
                           
                              (5)
                              
                                 P
                                 (
                                 t
                                 )
                                 =
                                 n
                                 (
                                 t
                                 )
                                 [
                                 
                                    
                                       P
                                    
                                    
                                       idle
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       usage
                                    
                                 
                                 -
                                 1
                                 )
                                 
                                    
                                       P
                                    
                                    
                                       busy
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       busy
                                    
                                 
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       idle
                                    
                                 
                                 )
                                 U
                                 (
                                 t
                                 )
                                 ]
                              
                           
                        where 
                           
                              U
                              (
                              t
                              )
                           
                         is the CPU utilization of servers.

Let 
                           
                              λ
                              (
                              t
                              )
                           
                         denote the average rate of receiving service requests within time slot t. Within time interval 
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                           
                        , each turned on server handles
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             p
                                          
                                       
                                       ∗
                                       λ
                                       (
                                       t
                                       )
                                    
                                    
                                       n
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        service requests. By dividing the total CPU busy time by 
                           
                              
                                 
                                    T
                                 
                                 
                                    p
                                 
                              
                           
                        , the CPU utilization for each server is obtained as
                           
                              (7)
                              
                                 U
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       λ
                                       (
                                       t
                                       )
                                    
                                    
                                       n
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     

Replacing Eq. (7) in Eq. (5), the power consumption associated with the data center at the time slot t of interest is obtained as:
                           
                              (8)
                              
                                 P
                                 (
                                 t
                                 )
                                 =
                                 n
                                 (
                                 t
                                 )
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                idle
                                             
                                          
                                          +
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                usage
                                             
                                          
                                          -
                                          1
                                          )
                                          
                                             
                                                P
                                             
                                             
                                                busy
                                             
                                          
                                          +
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                busy
                                             
                                          
                                          -
                                          
                                             
                                                P
                                             
                                             
                                                idle
                                             
                                          
                                          )
                                          
                                             
                                                λ
                                                (
                                                t
                                                )
                                             
                                             
                                                n
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In this section, we first formulate the problem of dynamic resource provisioning and user experience subject to the desired playback rate for each user. Then, we develop a provably-efficient online algorithm, which can be implemented in a distributed fashion.

The cloud operator’s computational resource provisioning and the desired playback rate of user are made at the beginning of each time slot t. Specially, the users will independently choose their own playback rates and then the cloud operator chooses the resource provisioning strategy.

We define 
                           
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    lim
                                 
                                 
                                    t
                                    →
                                    ∞
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    =
                                    0
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              E
                              [
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              τ
                              )
                              ]
                              ,
                              
                                 
                                    n
                                 
                                 
                                    ¯
                                 
                              
                              =
                              
                                 
                                    lim
                                 
                                 
                                    t
                                    →
                                    ∞
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    =
                                    0
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              E
                              [
                              n
                              (
                              τ
                              )
                              ]
                              ,
                              
                                 
                                    
                                       
                                          pr
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    lim
                                 
                                 
                                    t
                                    →
                                    ∞
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    =
                                    0
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              E
                              [
                              
                                 
                                    pr
                                 
                                 
                                    i
                                 
                              
                              (
                              τ
                              )
                              ]
                              ,
                           
                         as time averaged 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    pr
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                         respectively.

Form Eq. (3), the metric 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    UED
                                 
                                 
                                    i
                                 
                              
                           
                         is the overall UED of users that is expected to be maximized. From Eq. (8), the metric 
                           
                              P
                              (
                              t
                              )
                           
                         is the overall power consumption of all turned on servers, hopefully being minimized. Then, the objective can be defined as the following constrained stochastic optimization problem (CSOP):
                           
                              (9)
                              
                                 max
                                 
                                 g
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       UED
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 -
                                 β
                                 P
                                 (
                                 t
                                 )
                              
                           
                        
                     

Subject to
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             pr
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       PR
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       n
                                    
                                    
                                       ¯
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 n
                                 (
                                 t
                                 )
                                 ⩽
                                 M
                              
                           
                        
                        
                           
                              (13)
                              
                                 n
                                 (
                                 t
                                 )
                                 ⩾
                                 
                                    
                                       K
                                    
                                    
                                       min
                                    
                                 
                              
                           
                        where the constraint (10) is the average playback rate constraint for the users, and (11) guarantees the mean-rate queue stability. 
                           
                              β
                           
                         is a tunable parameter which represents the tradeoff between the energy consumption and the UED. (12) ensures that the number of operating servers never exceeds the total number of servers. (13) forces the operator to operate at least 
                           
                              
                                 
                                    K
                                 
                                 
                                    min
                                 
                              
                           
                         servers at all times in the cluster to accommodate normal request arrivals.

Based on Caratheodory’s theorem, there exists a stationary and randomized offline control policy solving the online problem. Given the probability distribution of 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                           
                        , which represents the actual number of request arrivals during time slot t, the solution to Problem CSOP can be obtained through linear programming. Ref. [3] has proved that the optimal stationary randomized algorithm solving Problem CSOP is superior to any online algorithm. Hence, we regard the optimal stationary algorithm as a baseline when analyzing the performance of online algorithm. We present the minimum energy required to stabilize all queues of the system as described above. The capacity region Λ is defined as the closure of the set of all input rate vectors stabilizable under some resource provisioning algorithm that conforms to the delay constraint. A particular stationary and randomized offline control algorithm for this system is characterized by probabilities 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . A cost function is defined as 
                           
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                              
                              (
                              ς
                              (
                              t
                              )
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    UED
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              -
                              β
                              ·
                              P
                              (
                              t
                              )
                           
                        . Denote 
                           
                              Δ
                           
                         as the capacity region of optimal problem, which means that for any 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              ∈
                              Δ
                           
                        , there exist feasible solutions to Problem CSOP. Denote 
                           
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              (
                              ε
                              )
                           
                         as the optimal results of Problem CSOP with 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              ∈
                              Δ
                           
                         being replaced by 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              +
                              ε
                              ∈
                              Δ
                              ,
                           
                         and 
                           
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                           
                         is the optimal value when 
                           
                              ε
                              =
                              0
                              .
                           
                         
                        
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              (
                              ε
                              )
                           
                         is the time average cost under the optimal stationary randomized algorithm, and 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              (
                              ε
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    t
                                 
                                 
                                    ∗
                                 
                              
                              (
                              ε
                              )
                           
                        .

Nevertheless, it requires the full knowledge of system statistics and it is challenging to obtain the optimal control policy explicitly. Hence, we resort to the development of a practical and online algorithm that is provably-efficient compared to the optimal offline algorithm.

Due to the queue stability constraint in (11), we use the actual job queue length, which follows Eq. (4), to guide the resource provisioning decision made by the MSP. For each playback rate constraint in (10), we also define a virtual queue and then apply the virtual queue lengths to guide the user’s playback rate selection decision to choose different version, such as Smooth, SD and HD, of the same video streaming.

We define the video quality deficit queue for user 
                           
                              i
                           
                         as 
                           
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                           
                        , which starts from 
                           
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              (
                              0
                              )
                              =
                              0
                           
                         and evolves as:
                           
                              (14)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 +
                                 1
                                 )
                                 =
                                 
                                    max
                                 
                                 [
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 -
                                 
                                    
                                       PR
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 0
                                 ]
                                 +
                                 
                                    
                                       pr
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    pr
                                 
                                 
                                    i
                                 
                              
                           
                         is the real playback rate of user 
                           
                              i
                           
                         at time slot t, 
                           
                              
                                 
                                    PR
                                 
                                 
                                    i
                                 
                              
                           
                         is the average playback rate constraint for user i. The virtual queue is used to assure the average playback rate constraint for user. Next, we combine the actual job queue at the multimedia cloud with the virtual video quality queues. Let 
                           
                              H
                              (
                              t
                              )
                              =
                              (
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              )
                              ,
                           
                         represent the matrix of the virtual queues. We apply the vectorial expression 
                           
                              Θ
                              (
                              t
                              )
                              =
                              [
                              Q
                              (
                              t
                              )
                              ,
                              H
                              (
                              t
                              )
                              ]
                           
                         to denote the combined matrix of all the actual queues and virtual queues. Then, we define a Lyapunov function 
                           
                              L
                              (
                              Θ
                              (
                              t
                              )
                              )
                           
                        :
                           
                              (15)
                              
                                 L
                                 (
                                 Θ
                                 (
                                 t
                                 )
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                Z
                                             
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          
                                             
                                                Q
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

Note that the quadratic Lyapunov function in (15) is a scalar representation of the actual job queue length and virtual delay queue lengths. We define the one-slot conditional Lyapunov drift:
                           
                              (16)
                              
                                 (
                                 Δ
                                 Θ
                                 (
                                 t
                                 )
                                 )
                                 
                                    
                                       
                                          
                                       
                                    
                                    
                                       Δ
                                    
                                 
                                 E
                                 
                                    
                                       
                                          L
                                          (
                                          Θ
                                          (
                                          t
                                          +
                                          1
                                          )
                                          )
                                          -
                                          L
                                          (
                                          Θ
                                          (
                                          t
                                          )
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

Due to the fact 
                           
                              max
                              
                                 
                                    [
                                    q
                                    -
                                    b
                                    ,
                                    0
                                    ]
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              
                                 
                                    (
                                    q
                                    -
                                    b
                                    )
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                         it can be shown following the Lyapunov optimization technique that
                           
                              (17)
                              
                                 (
                                 Δ
                                 Θ
                                 (
                                 t
                                 )
                                 )
                                 ⩽
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 E
                                 
                                    
                                       
                                          
                                             
                                                pr
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          t
                                          )
                                          -
                                          
                                             
                                                PR
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 +
                                 Q
                                 (
                                 t
                                 )
                                 E
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          t
                                          )
                                          -
                                          n
                                          (
                                          t
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        
                        B
                        1 is a finite constant satisfying
                           
                              (18)
                              
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ⩾
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 E
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      PR
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      pr
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 E
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                n
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 -
                                 E
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          ·
                                          
                                             min
                                          
                                          [
                                          Q
                                          (
                                          t
                                          )
                                          ,
                                          n
                                          (
                                          t
                                          )
                                          ]
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        for any 
                           
                              t
                              =
                              0
                              ,
                              1
                              ,
                              …
                           
                        .

Next, we choose a parameter 
                           
                              V
                              >
                              0
                           
                         as an indicator of how close the average benefit achieved by the online algorithm is to that by the optimal offline algorithm. By subtracting 
                           
                              VE
                              [
                              g
                              (
                              t
                              )
                              |
                              Θ
                              (
                              t
                              )
                              ]
                           
                         on both sides of (17), we can obtain the following inequality:
                           
                              (19)
                              
                                 Δ
                                 (
                                 Θ
                                 (
                                 t
                                 )
                                 )
                                 -
                                 VE
                                 [
                                 g
                                 (
                                 t
                                 )
                                 |
                                 Θ
                                 (
                                 t
                                 )
                                 ]
                                 ⩽
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 VE
                                 [
                                 g
                                 (
                                 t
                                 )
                                 |
                                 Θ
                                 (
                                 t
                                 )
                                 ]
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 E
                                 
                                    
                                       
                                          
                                             
                                                PR
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                pr
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          t
                                          )
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 -
                                 Q
                                 (
                                 t
                                 )
                                 E
                                 
                                    
                                       
                                          n
                                          (
                                          t
                                          )
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          t
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

Expanded as
                           
                              (20)
                              
                                 Δ
                                 (
                                 Θ
                                 (
                                 t
                                 )
                                 )
                                 -
                                 VE
                                 
                                    
                                       
                                          g
                                          (
                                          t
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 VE
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                UED
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          t
                                          )
                                          -
                                          β
                                          P
                                          (
                                          t
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 t
                                 )
                                 E
                                 
                                    
                                       
                                          
                                             
                                                PR
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                pr
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          t
                                          )
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 -
                                 Q
                                 (
                                 t
                                 )
                                 E
                                 
                                    
                                       
                                          n
                                          (
                                          t
                                          )
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                R
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          t
                                          )
                                          |
                                          Θ
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        where the left-hand side is the (one-slot) drift subtracting UED-energy cost. Instead of directly minimizing the drift minus cost which requires the knowledge of statistics, we minimize its infimum bound shown on the right-hand side of (20).

Denote the algorithm that can achieve the optimal solution to the above described problem as EUE-RP, which is the abbreviation of approximate Energy-efficient and QoE Resource Provisioning strategy. Details of the EUE-RP algorithm can be found in Algorithm EUE-RP.

In Algorithm EUE-RP, the control decisions are chosen to minimize the right-hand size of (20) based on the currently available information without knowing the distribution of the underlying processes. The choice of playback rate can be performed either by the multimedia service provider or by each individual user. The job queue at the multimedia cloud will guide the MSP to select its resource provisioning strategy. As each user only needs to observe its local information, Algorithm EUE-RP can be easily implemented in a distributed fashion.
                           
                              
                                 
                                 
                                    
                                       Algorithm EUE-RP Online Algorithm for MSP and Users
                                    
                                 
                                 
                                    
                                       1: At the start of each time slot t, watch the actual queue length Q(t) of video streaming application and the current user’s virtual queue lengths 
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          .
                                    
                                    
                                       2: Each user selects its video streaming playback rate, and maximize
                                    
                                    
                                       
                                          
                                             
                                                (21)
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         pr
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   -
                                                   
                                                      
                                                         VUED
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   +
                                                   Q
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       3: The cloud operator chooses n(t) to minimize
                                    
                                    
                                       
                                          
                                             
                                                (22)
                                                
                                                   -
                                                   Q
                                                   (
                                                   t
                                                   )
                                                   n
                                                   (
                                                   t
                                                   )
                                                   +
                                                   v
                                                   β
                                                   P
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       where 
                                             
                                                P
                                                (
                                                t
                                                )
                                             
                                           is the power consumption associated with providing 
                                             
                                                n
                                                (
                                                t
                                                )
                                             
                                           servers.
                                    
                                    
                                       4: Update the job queue 
                                             
                                                Q
                                                (
                                                t
                                                )
                                             
                                           and virtual queues 
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                           according to (4) and (14), respectively.
                                    
                                 
                              
                           
                        
                     

In this section, we evaluate the proposed resource provisioning method by extensive experiments. It is significant for the MSP to obtain the dynamic demands from users and accordingly determine the optimal resource provisioning, which can simultaneously satisfy QoE requirements and minimize the energy consumption. We conduct extensive experiments to evaluate our online control algorithm EUE-RP under a real cloud environment.

Our experiment environment is based on the real cloud environment within our institution, which is built and used for a research oriented environment. There is a small cluster in our lab. The cluster is composed by 100 nodes equipped with two Intel Core processors, with the possibility to support four threads, 4 GB of RAM and a Disk of 1TB. In order to measure the multimedia stream service, we deploy ViMP [23], which is a high value video content management system allowing us to run our own video portal. ViMP can be provided as a complete SaaS solution or “on premise” on our own server. The HP LoadRunner is employed [24] as a simulator to create users to access video streaming application. Virtual User Generator component of HP LoadRunner can simulate thousands of users to access multimedia application and support media stream protocol. We apply network emulation package called NISTNET [25] to analyze the network quality parameters such as delay, jitter and packet loss. NISTNET is simple, free and easily mastered. It allows a single Linux PC set up as a router to be deployed in real experiment environment. Furthermore, it can emulate a wide variety of network conditions, such as s packet loss, duplication or delay, router congestion and bandwidth limitations.

Because the QoE of a cloud service depends heavily on the delay between the end user and the service the user accesses, our approach focuses on the study of the delay as a main cause in current networks, while taking into account other metrics such as packet loss ratio, jitter, and bandwidth. Experiments are performed such that packet loss rate is between 0% and 1%, and jitter is max 60ms. Define the set of available playback rates as 200kb/s. The playback delay of a video is 8s.

To make the simulation be more realistic, we conduct extensive experiments to verify the proposed resource provisioning strategy. The number of users range from 30 to 300. The experiment time remains 10h. Each video stream includes the user ID, the user arrival time, and the requested video ID, etc. By dividing the one period into a series of 5min time slots and aggregating the number of user requests in each time slot, we can plot the evolution of user request pattern in Fig. 3
                        .


                        Fig. 4
                         illustrates the time average QoE per user. From Fig. 4, we can see QoE of end user range from 3.5 to 4.5. When the number of user request increases, the QoE of end user decreases.

In this subsection, we discuss three sets of experiment results.
                           
                              (1)
                              Different values of V: We show in Fig. 5
                                  the average queue length, average UED and energy at the multimedia cloud, given different values of V.

From Fig. 5, we can see in that as V increases, the UED decreases, whereas the average queue length at the multimedia cloud increases. This is because, by increasing V, the MSP tends to reduce the energy consumption by queuing up the jobs. The results in Fig. 5 also show the flexible tradeoff between the UED-energy cost and the queue length. In Fig. 5 we vary the value of V, and observe that when its value increases, the energy consumption decreases while the UED drops.


                        Fig. 6
                         illustrates the time-average energy consumption and UED when varying the value of V. We take 8 different values in the interval [1000,3000].

In Fig. 6, we can see that the energy consumption and the UED exhibit concave relationship. When V is large (i.e., larger than 1800), the UED will fast decrease and there is no significant reduction of energy consumption. If V is small (i.e., close to 1500), the UED can hardly increase because it has approached the maximum value. V
                        =1400 is a sweet spot for the real system configuration.
                           
                              (2)
                              Different values of 
                                    
                                       β
                                    
                                 : The parameter 
                                    
                                       β
                                    
                                  governs the relative importance of energy cost compared to the UED. In particular, when increasing 
                                    
                                       β
                                    
                                 , the MSP tends to care more about its power consumption.

Thus, by choosing a larger value of 
                           
                              β
                           
                        , we expect that the average energy cost will decrease. The result in Fig. 7
                        (a) shows that when 
                           
                              β
                           
                         increases, the average queue length is increased. The result in Fig. 7(b) shows that when 
                           
                              β
                           
                         increases, the average UED is reduced. The result in Fig. 7(c) shows that when 
                           
                              β
                           
                         increases, the average energy consumption is reduced. From Fig. 7(c), we also can observe that it needs to launch minimal number servers to meet the base request. Thus, the proposed algorithm provides a flexible tradeoff between the energy consumption and UED. By appropriately tuning the value of 
                           
                              β
                           
                        , we can achieve a desired performance balancing the energy consumption and UED.
                           
                              (3)
                              EUE-RP versus optimal algorithm

As request arrival rates are arbitrary in our system, it is difficult to find the global minimum, with which to compare the time-averaged energy consumption achieved by our proposed algorithm. Therefore, we compare with a local optimum algorithm, which is the optimal (objective function) value of a similar energy consumption minimization problem within known information. The optimal algorithm can be obtained through linear programming. Linear program can be solved by optimization tool kits such as GLPK.

We first analyze the energy consumption of all provisioned servers. Fig. 8
                        (a) illustrates the cumulative total energy consumption of servers. Algorithm EUE-RP provisions more servers than the optimal algorithm, while EUE-RP can guarantee a higher time-average QoE, which is illustrated in Fig. 8(b). In Fig. 8, the value of V and 
                           
                              β
                           
                         is 1200 and 0.01 respectively.

From Fig. 8, we can observe that when the number of user request is small, the Optimal algorithm need more servers than EUE-RP algorithm and consume more energy, the UED of end users that Optimal algorithm provisions is similar to that of EUE-RP algorithm. While, when the numbers of user request is large, EUE-RP algorithm consumes more energy and the UED of end users is higher than Optimal algorithm, this is because the EUE-RP algorithm can assure the QoE of end user and need more servers.

To handle unpredictable user requests from various multimedia applications served by a cloud datacenter, an optimal online control framework is designed and analyzed to balance the trade-off between the user experience and energy consumption for dealing with user requests. The objectives of resource provisioning include: (1) maximizing the user experience when serving various multimedia applications with unpredictable user requests, and (2) minimizing the energy consumption when processing user requests. We formulate the problem into a constrained stochastic optimization problem of resource provisioning and energy decreasing under user experience variety and demand dynamics. By employing Lyapunov optimization method, we develop a theoretic model to explore the trade-off between energy cost and the achieved user QoE for cloud-based multimedia applications. An approximate online algorithm, called EUE-RP, is proposed with the explicitly provable performance upper bound. The proposed algorithm also has low complexity by exploiting the structural properties of the optimal solution. Extensive experiments have been conducted to verify the effectiveness of our proposed EUE-RP algorithm in the practical settings. The algorithm can guarantee desired QoE and reduce energy consumption, even without any information about the future fluctuation of user demands. In our future work, we will investigate optimal resource allocation based on queue model to improve users’ experience. We are also interested in the optimization of the energy cost under other energy-saving methods.

@&#ACKNOWLEDGMENTS@&#

The authors thank the editors and the anonymous reviewers for their helpful comments and suggestions. The work was supported by the National Natural Science Foundation (NSF) under Grants (Nos. 61472294, 61171075), Key Natural Science Foundation of Hubei Province (No. 2014CFA050), Applied Basic ResearchProjectof WuHan (No.
                  2015010101010021), National Key Basic Research Program of China (973 Program) under Grant No. 2011CB302601, Program for the High-end Talents of Hubei Province.

@&#REFERENCES@&#

