@&#MAIN-TITLE@&#The mixed capacitated general routing problem under uncertainty

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Probabilistically constrained formulation.


                        
                        
                           
                           Deterministic formulation where uncertain parameters follow a normal distribution.


                        
                        
                           
                           Branch-and-cut algorithm and an efficient heuristic algorithm.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Routing problem

Mixed graph

Neighborhood search

Probabilistic constraints

@&#ABSTRACT@&#


               
               
                  We study the General Routing Problem defined on a mixed graph and with stochastic demands. The problem under investigation is aimed at finding the minimum cost set of routes to satisfy a set of clients whose demand is not deterministically known. Since each vehicle has a limited capacity, the demand uncertainty occurring at some clients affects the satisfaction of the capacity constraints, that, hence, become stochastic. The contribution of this paper is twofold: firstly we present a chance-constrained integer programming formulation of the problem for which a deterministic equivalent is derived. The introduction of uncertainty into the problem poses severe computational challenges addressed by the design of a branch-and-cut algorithm, for the exact solution of limited size instances, and of a heuristic solution approach exploring promising parts of the search space. The effectiveness of the solution approaches is shown on a probabilistically constrained version of the benchmark instances proposed in the literature for the mixed capacitated general routing problem.
               
            

@&#INTRODUCTION@&#

An important operative issue in the context of the distributive logistics consists in planning the delivery routes performed by a fleet of vehicles to satisfy the requests of a set of elements of a network, namely required vertices, edges and arcs. In mathematical terms, the problem is modeled as Mixed Capacitated General Routing Problem (MCGRP): it basically consists in finding a set of routes on a mixed graph, beginning and ending at the same vertex (depot), with minimum total cost, satisfying demands located at links and vertices and with a capacity restriction on the demand satisfied by each route. The MCGRP generalizes many vehicle routing problems that have been widely studied in the last forty years and for which hundreds of papers have been written, either to give exact or heuristic procedures for their resolution or to provide lower bounds. Despite the practical importance of the mixed general routing problem, relatively few studies have been published on it. Most works deal with the uncapacitated case. Corberán, Letchford, and Sanchis (2001, 2003, 2005) studied the feasible polyhedron starting from an integer programming formulation solved through an efficient cutting-plane algorithm. Blais and Laporte (2003) proposed a different approach based on the transformation of the original problem into an equivalent Traveling Salesman Problem or Rural Postman Problem which are solved in turn through available exact algorithms.

With respect to the capacitated case, Bosco, Laganà, Musmanno, and Vocaturo (2013) proposed a novel integer programming formulation and a branch-and-cut algorithm (B&C) where surrogate inequalities, introduced for the Capacitated Arc Routing Problem, are extended to the MCGRP polyhedron.

The aim of this paper is the introduction of the uncertainty issue in this latter and more involved case, where each vehicle has a limited capacity. In effect, most of the real-world applications modeled as MCGRP are characterized by some uncertainty which affects the customers’ demand. For example, the operational plan of pickup routes in solid waste collection systems implies modeling the service by the means of required arcs or edges whenever the collection points are distributed along the streets, while some vertices are required if the collection is concentrated around specific points (e.g., hospitals, schools, and supermarkets). For generality, we shall also assume that the requests of random elements might be correlated to faithfully represent real situations. For example, in the garbage collection, the geographical nearness of some customers within the same regional district or along the same street suggests to consider a statistical correlation among their garbage productions.

Following these considerations, we bring the stochasticity into the MCGRP by adopting the paradigm of the probabilistic constraints defined within the general Stochastic Programming (SP) framework (Birge & Louveaux, 1997). This modeling paradigm is appropriate in many situations, where an operational plan is periodically updated over a long planning horizon, and hence, becomes crucial to design a set of a priori routes that will cover the uncertain requests with a high reliability level. In particular, we formally introduce a stochastic formulation of the MCGRP where the stochastic capacity constraints are re-formulated in terms of probabilistic constraints. The explicit inclusion of the uncertainty within an already proved NP-hard problem, poses additional challenges, calling for the design of tailored solution approaches. This represents the second core contribution of the present paper. We develop a branch-and cut (B&C) algorithm for solving small instances and we design a large neighborhood search heuristic for the solution of instances of larger size where the B&C algorithm is used, in turn, to perform an exact local search on a portion of the overall feasible region.

To put our contribution in the right perspective, we should precise that the adoption of the SP framework to model routing problems under uncertainty is not completely new. For an extensive survey, the readers are referred to Dror and Trudeau (1986) and Gendreau, Laporte, and Seguin (1996).

Within this stream, most of the contributions rely on the two-stage paradigm and different recourse policies have been proposed in the literature. Bertsimas (1992) and Bertsimas and Simchi-Levi (1994) focused their researches on simple recourse policies that are separable by vehicle. A different policy has been presented by Ak and Erera (2007), that proposed a two-vehicle sharing recourse policy. During the last decades various heuristic and exact optimization approaches have been proposed and analyzed for constructing a set of tours minimizing expected costs given this recourse policy. Gendreau, Laporte, and Seguin (1995) proposed an exact solution for an a priori optimization model based on an integer L-shaped method. Laporte, Louveaux, and van Hamme (2002) presented an improved method where strong lower bounds at the root node contribute significantly to speed up the solution times. Gendreau, Laporte, and Seguin (1996) applied local search concepts embedded into a tabu search scheme to solve the a priori model presented in Gendreau et al. (1995). More recently, Laporte, Musmanno, and Vocaturo (2010) studied the capacitated arc-routing problem with stochastic demands in the context of garbage collection and proposed an adaptive large neighborhood search heuristic.

Scant attention has been devoted to the formulation of routing problems with probabilistic constraints. Stewart and Golden (1983) presented a model able to find minimum cost routes with a threshold constraint on the probability of a route failure, whereas Laporte, Louveaux, and Mercure (1989) proposed a chance-constrained model for location-routing problems. A chance constrained version of the vehicle routing problem, solved to optimality by algorithms similar to those developed for the deterministic case, has been presented in Dror, Laporte, and Louveaux (1993).

Besides the stochastic programming approach, the robust optimization framework has been adopted to deal with routing problems involving uncertain parameters where the probability distributions are not known. Amongst the recent contributions, we cite Sungur, Ordóñez, and Dessouky (2008), who analyze the case of uncertain customer demands and travel times. The goal is to determine vehicle routes which satisfy the capacity constraints and the specified time windows if all the uncertain parameters attain the worst case realizations simultaneously. The problem can be simplified to a deterministic model, which is attractive from a computational standpoint. Gounaris, Wiesemann, and Floudas (2013) (see also the references therein) investigate the case of capacitated vehicle routing problem. Robust optimization counterparts of several deterministic formulations of the problem are derived and numerically compared. Robust rounded capacity inequalities are developed, which can be separated efficiently for two broad classes of demand supports. Finally, the authors analyze the relation between the robust models and the chance constrained counterparts. Lee, Lee, and Park (2004) considered two types of uncertainty sets for the possible realizations of travel times and demands. The authors propose a column generation algorithm which encapsulates the robustness in the pricing problem cast as a robust version of the shortest path with resource constraints.

In this paper we study the Mixed Capacitated General Routing Problem with Probabilistic Constraints MCGRPPC. In Section 2, we introduce the problem and we provide a chance-constrained integer linear programming formulation for the MCGRPPC. In Section 3 we define the B&C algorithm for solving small instances of the MCGRPPC. In Section 4 we present a tailored heuristic search to solve larger MCGRPPC instances. In Section 5, we present the results of our computational study. Finally, in Section 6, we give our conclusions and discuss future perspectives in this area.

The MCGRPPC is defined over a mixed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           ,
                           E
                           )
                        
                     , where 
                        
                           V
                           =
                           {
                           1
                           ,
                           …
                           ,
                           n
                           }
                        
                      represents the set of vertices, where vertex 1 represents the depot, and 
                        
                           A
                           =
                           {
                           (
                           i
                           ,
                           j
                           )
                           
                           ⊆
                           
                           V
                           ×
                           V
                           }
                        
                      is the set of arcs, whereas 
                        
                           E
                           =
                           {
                           (
                           i
                           ,
                           j
                           )
                           
                           ⊆
                           
                           V
                           ×
                           V
                           :
                           i
                           <
                           j
                           }
                        
                      is the set of edges.

In the following, we shall denote by 
                        
                           L
                           =
                           A
                           
                           ∪
                           
                           E
                        
                     , the set of links and we shall indicate by 
                        
                           
                              
                                 c
                              
                              
                                 ij
                              
                           
                        
                      a non-negative cost coefficient associated with each link 
                        
                           (
                           i
                           ,
                           j
                           )
                        
                     . We assume that the service activity may occur at some vertices 
                        
                           
                              
                                 V
                              
                              
                                 R
                              
                           
                           
                           ⊆
                           
                           V
                        
                     , named required vertices, arcs 
                     
                        
                           
                              
                                 A
                              
                              
                                 R
                              
                           
                           
                           ⊆
                           
                           A
                        
                      and/or edges 
                     
                        
                           
                              
                                 E
                              
                              
                                 R
                              
                           
                           
                           ⊆
                           
                           E
                        
                     , named required arcs and required edges, respectively. Thus, 
                        
                           
                              
                                 L
                              
                              
                                 R
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 R
                              
                           
                           
                           ∪
                           
                           
                              
                                 E
                              
                              
                                 R
                              
                           
                        
                      denotes the set of required links of G and all the required vertices and links will be referred to as required elements and indicated by R.

For each subset 
                        
                           S
                           ⊂
                           V
                        
                      of vertices, or its complementary set 
                        
                           
                              
                                 S
                              
                              
                                 ‾
                              
                           
                           (
                           
                              
                                 S
                              
                              
                                 ‾
                              
                           
                           =
                           V
                           ⧹
                           S
                           )
                        
                     , we define the following sets:
                        
                           (a)
                           
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    ∈
                                    S
                                    ∧
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    }
                                 
                              ,


                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    A
                                    :
                                    i
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    ∧
                                    j
                                    ∈
                                    S
                                    }
                                 
                              ,


                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                R
                                             
                                          
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          R
                                       
                                    
                                    :
                                    i
                                    ∈
                                    S
                                    ∧
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    }
                                 
                              ,


                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                R
                                             
                                          
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          R
                                       
                                    
                                    :
                                    i
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    ∧
                                    j
                                    ∈
                                    S
                                    }
                                 
                              ,


                              
                                 
                                    δ
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    E
                                    :
                                    i
                                    ∈
                                    S
                                    ∧
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    
                                    or
                                    
                                    i
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    ∧
                                    j
                                    ∈
                                    S
                                    }
                                 
                              ,


                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          E
                                       
                                       
                                          R
                                       
                                    
                                    :
                                    i
                                    ∈
                                    S
                                    ∧
                                    j
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    ,
                                    
                                    or
                                    
                                    i
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          ‾
                                       
                                    
                                    ∧
                                    j
                                    ∈
                                    S
                                    }
                                 
                              ,


                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          L
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    δ
                                    (
                                    S
                                    )
                                 
                              ,


                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                R
                                             
                                          
                                       
                                       
                                          +
                                       
                                    
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                R
                                             
                                          
                                       
                                       
                                          -
                                       
                                    
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                 
                              ,


                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    S
                                    ∩
                                    
                                       
                                          V
                                       
                                       
                                          R
                                       
                                    
                                 
                              ,


                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          A
                                       
                                       
                                          R
                                       
                                    
                                    :
                                    i
                                    ∈
                                    S
                                    ∧
                                    j
                                    ∈
                                    S
                                    }
                                 
                              ,


                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    S
                                    )
                                    =
                                    {
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          E
                                       
                                       
                                          R
                                       
                                    
                                    :
                                    i
                                    ∈
                                    S
                                    ∧
                                    j
                                    ∈
                                    S
                                    }
                                 
                              ,


                              
                                 
                                    R
                                    (
                                    S
                                    )
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    
                                       
                                          E
                                       
                                       
                                          R
                                       
                                    
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    
                                       
                                          S
                                       
                                       
                                          R
                                       
                                    
                                 
                              .

The previous notation remains valid as long as S is replaced by v, and 
                        
                           
                              
                                 S
                              
                              
                                 ‾
                              
                           
                        
                      by 
                        
                           
                              
                                 v
                              
                              
                                 ‾
                              
                           
                        
                     , or 
                        
                           V
                           ⧹
                           {
                           v
                           }
                        
                     . We denote by 
                        
                           
                              
                                 G
                              
                              
                                 R
                              
                           
                        
                      the graph induced on G by all the required links and vertices. Generally, this graph is non-connected. The vertex sets corresponding to connected components of 
                        
                           
                              
                                 G
                              
                              
                                 R
                              
                           
                        
                      are called R-sets. The subgraphs of G induced by the R-sets define the so-called R-connected components of G. An isolated required vertex represents itself an R-connected component of G.

In real settings, the service demand associated with all but a subset of required elements is seldom, if ever, known at the time routes have to be designed. Thus, with the aim of more realistically modeling general routing problems, one should deal with the stochastic nature of the input parameters. In the following, we shall assume that the set of required elements is partitioned into two subsets 
                        
                           
                              
                                 R
                              
                              
                                 C
                              
                           
                        
                      and 
                        
                           
                              
                                 R
                              
                              
                                 U
                              
                           
                        
                      to differentiate between elements with known and uncertain demands, respectively. Following the stochastic programming modeling framework, we shall assume that the uncertain demands are represented in terms of random variables defined on a given probability space 
                        
                           (
                           Ω
                           ,
                           F
                           ,
                           
                              P
                           
                           )
                        
                     . Thus, we shall denote by 
                        
                           
                              
                                 d
                              
                              
                                 i
                              
                           
                           (
                           ω
                           )
                        
                      and 
                        
                           
                              
                                 d
                              
                              
                                 ij
                              
                           
                           (
                           ω
                           )
                        
                      the random demands associated with the “stochastic” required vertices and links, respectively. Deterministic demands are denoted analogously but without explicating the dependence on 
                        
                           ω
                        
                     . The introduction of the random variables within the mathematical formulation makes the classical criterion of feasibility, introduced for the deterministic case, no longer valid, since it may happen that the stochastic capacity constraints are satisfied for some elements 
                        
                           ω
                           ∈
                           Ω
                        
                     , but not for all. To deal with this issue, we adopt the paradigm of probabilistic constraints, determining a set of a priori routes of minimum cost satisfying the random demands with a fixed reliability level 
                        
                           α
                        
                     . In the next subsection, we shall introduce the mathematical formulation.

For each required link 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    R
                                 
                              
                           
                         and each vehicle 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              m
                           
                        , we denote by 
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                                 
                                    k
                                 
                              
                           
                         the binary variable equal to 1 if 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         is serviced by vehicle k which travels from vertex i to vertex j and 0 otherwise, and by 
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                                 
                                    k
                                 
                              
                           
                         the non-negative variable representing the number of deadheading traversals from vertex i to vertex j by vehicle k, i.e., the number of times that link 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    R
                                 
                              
                           
                         is traversed from vertex i to vertex j by vehicle k without being serviced.

Moreover, for each required vertex 
                           
                              i
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    R
                                 
                              
                           
                         and each vehicle k, we denote by 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         the binary variable equal to 1 if i is serviced by k and 0 otherwise.

The following constraints hold:
                           
                              (1a)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 1
                                 ,
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       R
                                    
                                 
                              
                           
                        
                        
                           
                              (1b)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       R
                                    
                                 
                              
                           
                        
                        
                           
                              (1c)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 i
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       R
                                    
                                 
                              
                           
                        
                        
                           
                              (1d)
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         U
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                          
                                          (
                                          ω
                                          )
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ji
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         U
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                          
                                          (
                                          ω
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         U
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          ω
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ji
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          ⩽
                                          Q
                                       
                                    
                                 
                                 ⩾
                                 α
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                              
                           
                        
                        
                           
                              (1e)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                +
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          j
                                          ,
                                          i
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             
                                                -
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          j
                                          ,
                                          i
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                -
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          δ
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          :
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          δ
                                          (
                                          i
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 i
                                 ∈
                                 V
                              
                           
                        
                        
                           
                              (1f)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          j
                                          ,
                                          i
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             
                                                -
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                +
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          j
                                          ,
                                          i
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                -
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          δ
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ⩾
                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         uv
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         vu
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   ,
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                   ∈
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         uv
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   v
                                                   )
                                                   ∈
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         h
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   h
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 S
                                 
                                 ⊆
                                 
                                 V
                                 ⧹
                                 {
                                 1
                                 }
                              
                           
                        
                        
                           
                              (1g)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       R
                                    
                                 
                                 
                                 ∪
                                 
                                 
                                    
                                       E
                                    
                                    
                                       R
                                    
                                 
                              
                           
                        
                        
                           
                              (1h)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       R
                                    
                                 
                              
                           
                        
                        
                           
                              (1i)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 A
                                 
                                 ∪
                                 
                                 E
                              
                           
                        
                        
                           
                              (1j)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 E
                              
                           
                        
                        
                           
                              (1k)
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                 
                                 i
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       R
                                    
                                 
                                 .
                              
                           
                        
                     

Constraints (1a)–(1c) ensure that each request is serviced exactly once by exactly one vehicle (assignment constraints). Constraints (1d) are the probabilistic capacity constraints imposing, for each route, that the probability of not exceeding the vehicle capacity should be greater than or equal to a reliability level 
                           
                              α
                           
                        . Inequalities (1e) represent flow constraints. They model the symmetry conditions at each vertex. Note that, together with the integrality conditions, such constraints also imply parity conditions at each vertex.

Constraints (1f) are connectivity constraints. They impose that for each subset of vertices (excluding the depot) containing a required link or vertex serviced by a vehicle, at least two links incident to the subset must be used to visit it (deadheaded or serviced); they also eliminate subtours not connected with the depot.

The selection of the optimal route is guided by the minimization of the total cost, expressed by the sum of the total service cost 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                           
                         and the total deadheading cost 
                           
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                           
                        :
                           
                              (2)
                              
                                 Min
                                 
                                 f
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ji
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      E
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ji
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      A
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   ij
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The feasibility region of model (1) can be rewritten in a compact form as:
                           
                              
                                 X
                                 =
                                 
                                    
                                       
                                          x
                                          ∈
                                          
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                                (
                                                |
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      R
                                                   
                                                
                                                |
                                                +
                                                2
                                                |
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      R
                                                   
                                                
                                                |
                                                +
                                                |
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      R
                                                   
                                                
                                                |
                                                )
                                                ×
                                                m
                                             
                                          
                                          ,
                                          y
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                             
                                                (
                                                |
                                                A
                                                |
                                                +
                                                2
                                                |
                                                E
                                                |
                                                )
                                                ×
                                                m
                                             
                                          
                                          |
                                          x
                                          ,
                                          
                                          y
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             P
                                          
                                          (
                                          D
                                          (
                                          ω
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          ⩽
                                          Q
                                          )
                                          ⩾
                                          α
                                          ,
                                          k
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          m
                                       
                                    
                                 
                                 .
                              
                           
                        Here 
                           
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                           
                         is the feasible set defined by the deterministic constraints (1a)-(1f), where D denotes a row vector having the following structure:
                           
                              
                                 D
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                                  (
                                                                  ω
                                                                  )
                                                                  …
                                                               
                                                               
                                                                  ︸
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ∩
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  U
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                                  (
                                                                  ω
                                                                  )
                                                                  …
                                                               
                                                               
                                                                  ︸
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ∩
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  U
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 d
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           (
                                                                           ω
                                                                           )
                                                                           …
                                                                        
                                                                        
                                                                           ︸
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                     ∈
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           R
                                                                        
                                                                     
                                                                     ∩
                                                                     
                                                                        
                                                                           R
                                                                        
                                                                        
                                                                           U
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                                  …
                                                               
                                                               
                                                                  ︸
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  E
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ∩
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                                  …
                                                               
                                                               
                                                                  ︸
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ∩
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  …
                                                               
                                                               
                                                                  ︸
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ∩
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The formulation introduced above imposes individual chance constraints on each vehicle. This condition provides a guarantee that any individual route is feasible (with a reliability level 
                           
                              α
                           
                        ), but it does not account for the performance of the entire fleet. Such an issue could be addressed by means of the joint probabilistic constraints, posing additional theoretical and computational challenges. Our formulation may constitute a safe approximation of the joint case by setting appropriately the values of the reliability parameter. Indeed, by Bonferroni’s inequality, a sufficient condition for ensuring feasibility in the joint chance constrained problem, is to divide the joint probability level 
                           
                              ∊
                           
                         among the m individual chance constraints and letting, for instance, 
                           
                              α
                              =
                              ∊
                              /
                              m
                           
                         (Nemirovski & Shapiro, 2006).

Notwithstanding the individual nature of the chance constraints, the proposed model poses several challenges since it belongs to the class of integer problems under probabilistic constraints, for which the literature is rather scarce. Problems involving discrete random variables, arising either directly or as empirical approximation of the continuous ones, have been studied by Beraldi and Ruszczyński (2002), Beraldi and Ruszczyński (2002), Beraldi and Ruszczyński (2005), Beraldi and Bruni (2010), Beraldi, Bruni, and Violi (2012), and Bruni, Beraldi, and Laganà (2013). Here both exact and heuristic approaches have been proposed and tested.

The case of general continuous random variables is even less investigated. In Fortz and Poss (2010) deterministic reformulations are analyzed for the case of independently distributed random variables, whereas in Klopfenstein (2010) the author studies valid inequalities for the problem with individual probabilistic constraints with uncertainty in both sides.

In this paper, we assume that the random variables follow a multivariate normal distribution. While this assumption might appear restrictive, it often provides an accurate approximation of different probabilistic assumption, because of the well-known Central Limit Theorem and its variants. Under the above assumption, the chance constraints can be equivalently rewritten as second-order cone constraints. In the next subsection, we introduce our derivations.

Let 
                           
                              
                                 
                                    d
                                 
                                 
                                    e
                                 
                              
                              ,
                              
                              e
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    U
                                 
                              
                           
                         denote the random demands which assume normally distributed with mean 
                           
                              
                                 
                                    μ
                                 
                                 
                                    e
                                 
                              
                           
                        , variance 
                           
                              
                                 
                                    σ
                                 
                                 
                                    e
                                 
                                 
                                    2
                                 
                              
                           
                        , and let 
                           
                              
                                 
                                    θ
                                 
                                 
                                    e
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         denote the covariance between e and 
                           
                              
                                 
                                    e
                                 
                                 
                                    ′
                                 
                              
                           
                        . The probabilistic constraints can be rewritten as (see, e.g. Section 4 of Fortz & Poss (2010))
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                U
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                C
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       Φ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 α
                                 )
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             e
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   U
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             e
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ⩽
                                 Q
                              
                           
                        where
                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   e
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   x
                                                
                                                
                                                   ji
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             if
                                             
                                             e
                                             =
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             
                                                
                                                   E
                                                
                                                
                                                   R
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   e
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             if
                                             
                                             e
                                             =
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             
                                                
                                                   A
                                                
                                                
                                                   R
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   e
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                             
                                             if
                                             
                                             e
                                             =
                                             i
                                             ∈
                                             
                                                
                                                   V
                                                
                                                
                                                   R
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        By assuming that 
                           
                              
                                 
                                    d
                                 
                                 
                                    e
                                 
                              
                              =
                              
                                 
                                    μ
                                 
                                 
                                    e
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    e
                                 
                              
                              =
                              0
                           
                         whenever 
                           
                              e
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    C
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    e
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              0
                           
                         when either 
                           
                              e
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    C
                                 
                              
                           
                         or 
                           
                              
                                 
                                    e
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    C
                                 
                              
                           
                        , we can simplify the above relation as follows:
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          R
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       e
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       Φ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 α
                                 )
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             e
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             e
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 ⩽
                                 Q
                                 ,
                              
                           
                        that is equivalent to:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         R
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         e
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ⩽
                                                   Q
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     Φ
                                                                  
                                                                  
                                                                     -
                                                                     1
                                                                  
                                                               
                                                               (
                                                               α
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  e
                                                                  ∈
                                                                  R
                                                               
                                                            
                                                            
                                                               
                                                                  σ
                                                               
                                                               
                                                                  e
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  e
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  (
                                                                  e
                                                                  ,
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  )
                                                                  ∈
                                                                  
                                                                     
                                                                        R
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  |
                                                                  e
                                                                  ≠
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  θ
                                                               
                                                               
                                                                  e
                                                                  ,
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  e
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  
                                                                     
                                                                        e
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                               -
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     e
                                                                     ∈
                                                                     R
                                                                  
                                                               
                                                               
                                                                  
                                                                     μ
                                                                  
                                                                  
                                                                     e
                                                                  
                                                               
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Since 
                           
                              
                                 
                                    z
                                 
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                           
                        , are binary variables, the latter inequality can be linearized using classical techniques (see also Section 4 in Beraldi & Ruszczyński (2005)), so that (3) can be rewritten as:
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       z
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       |
                                       R
                                       |
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   e
                                                   ∈
                                                   R
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                e
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                e
                                             
                                             
                                                k
                                             
                                          
                                          ⩽
                                          Q
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          R
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      (
                                                      α
                                                      )
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                e
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   2
                                                   Q
                                                   -
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                e
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          e
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          e
                                          ≠
                                          
                                             
                                                e
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                e
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      (
                                                      α
                                                      )
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                e
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       e
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       e
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       e
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       w
                                    
                                    
                                       e
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 1
                                 ,
                                 
                                 (
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 e
                                 
                                 ≠
                                 
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                    
                                       k
                                    
                                 
                                 
                                 if
                                 
                                 e
                                 =
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       R
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       k
                                    
                                 
                                 
                                 if
                                 
                                 e
                                 =
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       A
                                    
                                    
                                       R
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       z
                                    
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       k
                                    
                                 
                                 
                                 if
                                 
                                 e
                                 =
                                 i
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       R
                                    
                                 
                                 }
                                 .
                              
                           
                        where the binary variables 
                           
                              
                                 
                                    w
                                 
                                 
                                    e
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                         act to linearize 
                           
                              
                                 
                                    z
                                 
                                 
                                    e
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                           
                        . As a result, an equivalent deterministic integer programming formulation of the MCGRPPC is obtained by replacing each probabilistic constraint (1d) with the set of additional variables and constraints given by (6). More precisely, it is 
                           
                              
                                 
                                    (
                                    |
                                    R
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    -
                                    |
                                    R
                                    |
                                    )
                                 
                                 
                                    2
                                 
                              
                              +
                              |
                              R
                              |
                           
                         variables and 
                           
                              2
                              +
                              
                                 
                                    3
                                 
                                 
                                    2
                                 
                              
                              (
                              |
                              R
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              -
                              |
                              R
                              |
                              )
                              +
                              |
                              R
                              |
                           
                         constraints. The complexity of the above model increases quickly with the number of vehicles and the number of uncertain required elements.
                           Remark 1
                           The reformulation (5) and the successive derivations also hold for the significant class of radial distribution (Calafiore & El Ghaoui, 2006), for which the probability constraints can be converted explicitly into convex second-order cone constraints of type (5). It is worth to highlight also the close relation that exists between the constraints (5) and the explicit deterministic counterparts of distributionally robust chance constraints, which are enforced over an entire family of probability distributions. In particular, for the family composed of all distributions having given mean and covariance, the distributionally robust constraint can be converted, once again, into an explicit second-order cone constraint of the type (5). This broadens the applicability of the approach presented in this paper to several interesting contexts.

In the following section we present a branch-and-cut algorithm to optimally solve instances with a small number of vehicles and a limited number of required elements.

In this section, we present the branch and cut algorithm designed to optimally solve the MCGRPPC. We mainly focus on the crucial aspects of (i) the determination of an initial feasible solution to use as upper bound and (ii) the definition of valid inequalities. The outline of the algorithm is provided by Algorithm 1 in Appendix A.

In order to design an efficient branch-and-cut algorithm, it is also important also to have a good initial solution, that we built on the basis of the “partition-first-route-next” paradigm. A first attempt to obtain a good feasible partition relies on solving a probabilistic version of the capacitated concentrator location-based problem (see Gouveia & Saldanha-da Gama, 2006; Correia, Gouveia, & Saldanha-da Gama, 2010) with stochastic demands, in which several required elements are selected as concentrator locations, named “seeds”, and the remaining required elements are aggregated around each seed, while respecting, amongst the other deterministic constraints reported in Gouveia and Saldanha-da Gama (2006) also the probabilistic capacity constraints. The number of required elements selected as concentrators must be equal to m, initially set to 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   T
                                                
                                             
                                             (
                                             α
                                             )
                                          
                                          
                                             Q
                                          
                                       
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    d
                                 
                                 
                                    T
                                 
                              
                              (
                              α
                              )
                           
                         represents the 
                           
                              α
                           
                        -quantile of the random variables representing the total demand of the required elements. If the model is infeasible because m is inadequate, then m is increased to ensure feasibility.

The goal consists in minimizing the total assignment cost of all the required elements to the selected seeds computed as the average of all the costs associated with the shortest paths linking the endpoints of two required elements.

The solution of the above model returns a set of clusters defining a partition of all the required elements. Each cluster represents an instance of the mixed general routing problem that is solved through the B&C algorithm.

This partitioning model does not adequately take into account the routing cost associated with each cluster. To improve the routing cost estimation an iterative scheme is designed, in which a set of diversification constraints is added dynamically to the partitioning model with the aim of selecting other seeds around which different clusters are generated and possible better routes are built. Such diversification constraints aim at exploring more promising portions of the search space according to the classical Variable Neighborhood Search (VNS) scheme (see, e.g. Fischetti, Polo, & Scantamburlo, 2004). More precisely, given a feasible partition of all the required elements, we identify the seed generating the cluster with the highest routing cost and we impose that such a seed cannot be selected for the next 
                           
                              ζ
                           
                         consecutive iterations. We solve again the probabilistic version of the capacitated concentrator location-based problem with this additional constraint and repeat the diversification procedure by exiting with the best cost solution obtained within a maximum number of iterations, say 
                           
                              I
                           
                        . Observe that all the required elements that are prevented to become a seed can be selected again as a concentrator after 
                           
                              ζ
                           
                         iterations. In our implementation we set 
                           
                              I
                           
                         as the minimum between the number of all the required elements and a threshold equal to 10, while 
                           
                              ζ
                              =
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        .

Alternatively, a feasible partition can be built heuristically as follows:
                           
                              (a) a set of seeds is defined by identifying at each step the one that is the unclustered required element farthest from the depot and the other seeds;

(b) a cluster of required elements closest to each seed is generated in such a way that the overall demand associated with this cluster satisfies the probabilistic capacity constraint.

The routing of the required elements collected in each cluster is obtained by using the B&C algorithm. In order to define a starting number of vehicles, we set m equal to the number of vehicles in the minimum cost solution chosen between the best solutions returned by both heuristic procedures.

The initial LP relaxation includes Eqs. (1a)–(1c), (6), (1e), one connectivity inequality (1f) for each R-set, and some additional connectivity and R-odd cut inequalities that are identified according to the Sequence of edge cutsets procedure described by Belenguer and Benavent (2003). The separation problem associated with connectivity inequalities is solvable heuristically through a modification of the heuristic procedure presented by Fischetti, Salazar, and Toth (1997), and to optimality by means of polynomial time max-flow calculations.

Besides these well-known cuts, we also derive some additional cuts exploiting the reformulation of the problem, which take as a basis the capacity inequalities proposed by Belenguer and Benavent (2003).
                           
                              (8)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 ⩾
                                 2
                                 
                                    
                                       
                                          
                                             
                                                D
                                                (
                                                R
                                                (
                                                S
                                                )
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                                )
                                             
                                             
                                                Q
                                             
                                          
                                       
                                    
                                 
                                 -
                                 |
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                                 (
                                 S
                                 )
                                 |
                                 ,
                                 
                                 S
                                 
                                 ⊆
                                 
                                 V
                                 ⧹
                                 {
                                 1
                                 }
                                 ,
                              
                           
                        where 
                           
                              D
                              (
                              R
                              (
                              S
                              )
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          R
                                       
                                    
                                 
                              
                              (
                              S
                              )
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    e
                                    ∈
                                    R
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    e
                                 
                              
                           
                         with
                           
                              
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ji
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

These inequalities can be adapted to our problem as follows:
                           
                              (9)
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          2
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                         (
                                                         R
                                                         (
                                                         S
                                                         ,
                                                         ω
                                                         )
                                                         ,
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         ,
                                                         ω
                                                         )
                                                         )
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          |
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          S
                                          )
                                          |
                                       
                                    
                                 
                                 ⩾
                                 α
                                 ,
                                 
                                 S
                                 
                                 ⊆
                                 
                                 V
                                 ⧹
                                 {
                                 1
                                 }
                                 ,
                              
                           
                        where 
                           
                              D
                              (
                              R
                              (
                              S
                              ,
                              ω
                              )
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          R
                                       
                                    
                                 
                              
                              (
                              S
                              ,
                              ω
                              )
                              )
                           
                         represents the demand associated with the stochastic and deterministic required elements inside S denoted by 
                           
                              R
                              (
                              S
                              ,
                              ω
                              )
                           
                        , and 
                           
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          R
                                       
                                    
                                 
                              
                              (
                              S
                              ,
                              ω
                              )
                           
                         indicates the stochastic and deterministic required links with one endpoint in S and the other outside of S.

To the best of our knowledge, no polynomial algorithm exists to exactly solve the separation problem (8). However, a max-flow algorithm can be used to solve the separation problem of the so-called fractional capacity inequalities (see Belenguer & Benavent, 2003). In our context,we have to deal with the separation problem of the following probabilistic fractional capacity inequalities:
                           
                              (10)
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          2
                                          
                                             
                                                D
                                                (
                                                R
                                                (
                                                S
                                                ,
                                                ω
                                                )
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                ,
                                                ω
                                                )
                                                )
                                             
                                             
                                                Q
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          |
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          S
                                          )
                                          |
                                       
                                    
                                 
                                 ⩾
                                 α
                                 ,
                                 
                                 S
                                 
                                 ⊆
                                 
                                 V
                                 ⧹
                                 {
                                 1
                                 }
                                 ,
                              
                           
                        that can be transformed in the following way:
                           
                              (11a)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 ⩾
                                 2
                                 
                                    
                                       D
                                       (
                                       R
                                       (
                                       S
                                       )
                                       ,
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                       (
                                       S
                                       )
                                       )
                                    
                                    
                                       Q
                                    
                                 
                                 -
                                 |
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                                 (
                                 S
                                 )
                                 |
                                 ,
                                 
                                 and
                              
                           
                        
                        
                           
                              (11b)
                              
                                 
                                    
                                       4
                                    
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             (
                                             α
                                             )
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   e
                                                   ∈
                                                   R
                                                   (
                                                   S
                                                   )
                                                   
                                                   ∪
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                e
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   e
                                                   ,
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   ∈
                                                   
                                                      
                                                         (
                                                         R
                                                         (
                                                         S
                                                         )
                                                         
                                                         ∪
                                                         
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                   e
                                                   ≠
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                e
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 2
                                 
                                    
                                       
                                          |
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          S
                                          )
                                          |
                                          -
                                          2
                                          
                                             
                                                D
                                                (
                                                R
                                                (
                                                S
                                                )
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                                )
                                             
                                             
                                                Q
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             2
                                             
                                                
                                                   D
                                                   (
                                                   R
                                                   (
                                                   S
                                                   )
                                                   ,
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                   )
                                                
                                                
                                                   Q
                                                
                                             
                                             -
                                             |
                                             
                                                
                                                   δ
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                             (
                                             S
                                             )
                                             |
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                      (
                                                      S
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   η
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 S
                                 
                                 ⊆
                                 
                                 V
                                 ⧹
                                 {
                                 1
                                 }
                              
                           
                        
                     

The following property holds.
                           Property 3.1
                           
                              For 
                              
                                 
                                    S
                                    
                                    ⊆
                                    
                                    V
                                    ⧹
                                    {
                                    1
                                    }
                                 
                              
                              , if the following linear inequalities hold:
                              
                                 
                                    
                                       
                                          
                                             (
                                             l
                                             1
                                             )
                                          
                                        
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                
                                             
                                             
                                                
                                                   η
                                                
                                                
                                                   ij
                                                
                                             
                                             ⩾
                                             2
                                             
                                                
                                                   D
                                                   (
                                                   R
                                                   (
                                                   S
                                                   )
                                                   ,
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                   )
                                                
                                                
                                                   Q
                                                
                                             
                                             -
                                             |
                                             
                                                
                                                   δ
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                             (
                                             S
                                             )
                                             |
                                          
                                       , and


                                       
                                          
                                             (
                                             l
                                             2
                                             )
                                          
                                        
                                       
                                          
                                             
                                                
                                                   4
                                                
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                         (
                                                         α
                                                         )
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            e
                                                            ∈
                                                            R
                                                            (
                                                            S
                                                            )
                                                            
                                                            ∪
                                                            
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  
                                                                     
                                                                        L
                                                                     
                                                                     
                                                                        R
                                                                     
                                                                  
                                                               
                                                            
                                                            (
                                                            S
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            e
                                                            ,
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  (
                                                                  R
                                                                  (
                                                                  S
                                                                  )
                                                                  
                                                                  ∪
                                                                  
                                                                  
                                                                     
                                                                        δ
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              L
                                                                           
                                                                           
                                                                              R
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  (
                                                                  S
                                                                  )
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            |
                                                            e
                                                            ≠
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            e
                                                            ,
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ⩽
                                             2
                                             
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      S
                                                      )
                                                      |
                                                      -
                                                      2
                                                      
                                                         
                                                            D
                                                            (
                                                            R
                                                            (
                                                            S
                                                            )
                                                            ,
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  
                                                                     
                                                                        L
                                                                     
                                                                     
                                                                        R
                                                                     
                                                                  
                                                               
                                                            
                                                            (
                                                            S
                                                            )
                                                            )
                                                         
                                                         
                                                            Q
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                
                                             
                                             
                                                
                                                   η
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             2
                                             
                                                
                                                   
                                                      
                                                         2
                                                         
                                                            
                                                               D
                                                               (
                                                               R
                                                               (
                                                               S
                                                               )
                                                               ,
                                                               
                                                                  
                                                                     δ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           L
                                                                        
                                                                        
                                                                           R
                                                                        
                                                                     
                                                                  
                                                               
                                                               (
                                                               S
                                                               )
                                                               )
                                                            
                                                            
                                                               Q
                                                            
                                                         
                                                         -
                                                         |
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                         |
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       ,

From (
                                 
                                    l
                                    1
                                 
                              ), (
                                 
                                    l
                                    2
                                 
                              ), and for any 
                                 
                                    S
                                    
                                    ⊆
                                    
                                    V
                                    ⧹
                                    {
                                    1
                                    }
                                 
                              , it follows that:
                                 
                                    (12)
                                    
                                       
                                          
                                             4
                                          
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   α
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         R
                                                         (
                                                         S
                                                         )
                                                         
                                                         ∪
                                                         
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      e
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         e
                                                         ,
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               (
                                                               R
                                                               (
                                                               S
                                                               )
                                                               
                                                               ∪
                                                               
                                                               
                                                                  
                                                                     δ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           L
                                                                        
                                                                        
                                                                           R
                                                                        
                                                                     
                                                                  
                                                               
                                                               (
                                                               S
                                                               )
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         |
                                                         e
                                                         ≠
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      e
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       2
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                                |
                                                -
                                                2
                                                
                                                   
                                                      D
                                                      (
                                                      R
                                                      (
                                                      S
                                                      )
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      S
                                                      )
                                                      )
                                                   
                                                   
                                                      Q
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      L
                                                   
                                                
                                                (
                                                S
                                                )
                                             
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             
                                                
                                                   2
                                                   
                                                      
                                                         D
                                                         (
                                                         R
                                                         (
                                                         S
                                                         )
                                                         ,
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                         )
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   -
                                                   |
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                   |
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       2
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                                |
                                                -
                                                2
                                                
                                                   
                                                      D
                                                      (
                                                      R
                                                      (
                                                      S
                                                      )
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      S
                                                      )
                                                      )
                                                   
                                                   
                                                      Q
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      L
                                                   
                                                
                                                (
                                                S
                                                )
                                             
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   2
                                                   
                                                      
                                                         D
                                                         (
                                                         R
                                                         (
                                                         S
                                                         )
                                                         ,
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                         )
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   -
                                                   |
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                   |
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   2
                                                   
                                                      
                                                         D
                                                         (
                                                         R
                                                         (
                                                         S
                                                         )
                                                         ,
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                         )
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   -
                                                   |
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                   |
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ⩽
                                       2
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                                |
                                                -
                                                2
                                                
                                                   
                                                      D
                                                      (
                                                      R
                                                      (
                                                      S
                                                      )
                                                      ,
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      S
                                                      )
                                                      )
                                                   
                                                   
                                                      Q
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      L
                                                   
                                                
                                                (
                                                S
                                                )
                                             
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  L
                                                               
                                                            
                                                            (
                                                            S
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                              that is inequality (11b). □

Observe that (l1) and (l2) are sufficient but not necessary conditions to ensure that the probabilistic inequality (10) holds. An example of violation of the condition is provided in Appendix A. Observe that, whenever all the demands are deterministic, the probabilistic inequality (10) reduces to the deterministic fractional capacity inequality expressed by (11a). In such a case, condition (l1) is necessary and sufficient to ensure that (10) holds.

The following theorem states that conditions expressed by Property (3.1) are sufficient to ensure that inequality (10) holds. Hence, no violation of (10) occurs if no violations of (
                           
                              l
                              1
                           
                        ) and (
                           
                              l
                              2
                           
                        ) are checked.
                           Theorem 3.1
                           
                              For any 
                              
                                 
                                    S
                                    
                                    ⊆
                                    
                                    V
                                    ⧹
                                    {
                                    1
                                    }
                                 
                              
                              , let 
                              
                                 
                                    ∊
                                    =
                                    2
                                    
                                       
                                          D
                                          (
                                          R
                                          (
                                          S
                                          )
                                          ,
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          S
                                          )
                                          )
                                       
                                       
                                          Q
                                       
                                    
                                    -
                                    |
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                    |
                                    ⩾
                                    0
                                 
                               
                              be the fractional minimum number of deadheading traversals in the cutset 
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                 
                               
                              to service the overall average demand in 
                              
                                 
                                    R
                                    (
                                    S
                                    )
                                    
                                    ∪
                                    
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                 
                              
                              , then the probabilistic inequality 
                              
                                 (10)
                               
                              is valid for the MCGRPPC if conditions 
                              
                                 
                                    (
                                    l
                                    1
                                    )
                                 
                               
                              and 
                              
                                 
                                    (
                                    l
                                    2
                                    )
                                 
                               
                              are satisfied.
                           

From condition (l2), it follows that:
                                 
                                    
                                       
                                          
                                             4
                                          
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   α
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         R
                                                         (
                                                         S
                                                         )
                                                         
                                                         ∪
                                                         
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      e
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         e
                                                         ,
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               (
                                                               R
                                                               (
                                                               S
                                                               )
                                                               
                                                               ∪
                                                               
                                                               
                                                                  
                                                                     δ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           L
                                                                        
                                                                        
                                                                           R
                                                                        
                                                                     
                                                                  
                                                               
                                                               (
                                                               S
                                                               )
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         |
                                                         e
                                                         ≠
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      e
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       -
                                       2
                                       ∊
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      L
                                                   
                                                
                                                (
                                                S
                                                )
                                             
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             ∊
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              Condition 
                                 
                                    (
                                    l
                                    1
                                    )
                                 
                               implies that 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          S
                                          )
                                       
                                    
                                    
                                       
                                          η
                                       
                                       
                                          ij
                                       
                                    
                                    ⩾
                                    ∊
                                    ⩾
                                    0
                                 
                              , therefore the following inequalities hold
                                 
                                    
                                       
                                          
                                             4
                                          
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   (
                                                   α
                                                   )
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         e
                                                         ∈
                                                         R
                                                         (
                                                         S
                                                         )
                                                         
                                                         ∪
                                                         
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                         
                                                         (
                                                         S
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      e
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         (
                                                         e
                                                         ,
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         )
                                                         ∈
                                                         
                                                            
                                                               (
                                                               R
                                                               (
                                                               S
                                                               )
                                                               
                                                               ∪
                                                               
                                                               
                                                                  
                                                                     δ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           L
                                                                        
                                                                        
                                                                           R
                                                                        
                                                                     
                                                                  
                                                               
                                                               (
                                                               S
                                                               )
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         |
                                                         e
                                                         ≠
                                                         
                                                            
                                                               e
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      e
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       -
                                       2
                                       ∊
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      L
                                                   
                                                
                                                (
                                                S
                                                )
                                             
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             ∊
                                          
                                          
                                             2
                                          
                                       
                                       ⩽
                                       -
                                       2
                                       ∊
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      L
                                                   
                                                
                                                (
                                                S
                                                )
                                             
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             ∊
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  L
                                                               
                                                            
                                                            (
                                                            S
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              Hence, inequality (10) is valid for the MCGRPPC. □

If 
                           
                              ∊
                              <
                              0
                           
                        , then 
                           
                              (
                              l
                              2
                              )
                           
                         is satisfied for a given value of 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ∈
                                    
                                       
                                          δ
                                       
                                       
                                          L
                                       
                                    
                                    (
                                    S
                                    )
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    ij
                                 
                              
                           
                        .

A heuristic procedure to identify violations of the probabilistic capacity inequalities is applied at every node of the branch and cut tree, consisting in identifying 
                           
                              
                                 
                                    S
                                 
                                 
                                    ∗
                                 
                              
                           
                         such that (
                           
                              l
                              1
                           
                        ) is checked for possible violations. If a violation occurs, then 
                           
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ij
                                 
                              
                              ,
                              
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              
                                 
                                    δ
                                 
                                 
                                    L
                                 
                              
                              (
                              
                                 
                                    S
                                 
                                 
                                    ∗
                                 
                              
                              )
                           
                         is computed according to the LP optimal solution, and the condition (
                           
                              l
                              2
                           
                        ) verified. Hence, the following inequality is added to the LP
                        relaxation:
                           
                              (11m)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          
                                             
                                                δ
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       ij
                                    
                                 
                                 ⩾
                                 2
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                                Q
                                             
                                          
                                       
                                    
                                 
                                 -
                                 |
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 |
                                 ,
                              
                           
                        where
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ‾
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          e
                                          ∈
                                          R
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                          
                                          ∪
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       e
                                    
                                 
                                 +
                                 
                                    
                                       Φ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 α
                                 )
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             e
                                             ∈
                                             R
                                             (
                                             
                                                
                                                   S
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                             
                                             ∪
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   S
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             e
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                             ∈
                                             
                                                
                                                   (
                                                   R
                                                   (
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                   
                                                   ∪
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               R
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             |
                                             e
                                             ≠
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             e
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

As usual in the branch-and-cut method, a cut pool is maintained with some cuts generated so far in the algorithm. When the cut pool has grown to a certain size (50 cuts in our implementation), it is permanently deleted.

In this section we describe a neighborhood search algorithm for the MCGRPPC. It relies on an outer diversification scheme, where different types of diversification methods are tested for different rates, followed by both heuristic and exact intensification phases. The diversification rate indicates the number of required elements modified in the current solution, while the diversification type specifies how to diversify the solution. After a solution is found in the outer loop, new solutions are explored through an intensification phase, after which an exact local search procedure based on the B&C algorithm is performed with the aim of finding the best solution in a given neighborhood.

In the next subsections we provide a detailed description of the main procedures briefly discussed above. Algorithm 2 reported in Appendix A provides a pseudocode of the overall heuristic scheme.

The diversification phase consists of removing some required elements from a solution s, and reinserting them to the modified solution 
                           
                              
                                 
                                    s
                                 
                                 
                                    ̃
                                 
                              
                           
                        . The rationale is that the solutions obtained by diversification represent the entry point to explore more promising portion of the feasible space.

A lot of freedom arises in designing the strategy for selecting the customers to remove from the solution, and reallocating them into 
                           
                              
                                 
                                    s
                                 
                                 
                                    ̃
                                 
                              
                           
                         (see. e.g. Shaw, 1998; Russell, 1995; Franceschi, Fischetti, & Toth, 2006; Pisinger & Ropke, 2007).

We implemented some of the removal and insertion heuristics presented by Pisinger and Ropke (2007), but without using statistics from the search to guide the choice. A detailed description of the removal and insertion procedures is provided below:
                           
                              •
                              randomRemove
                                    
                                       (
                                       p
                                       ,
                                       s
                                       )
                                    
                                  selects 
                                    
                                       p
                                       %
                                    
                                  required elements at random and removes them from the solution.

worstRemove
                                    
                                       (
                                       p
                                       ,
                                       s
                                       )
                                    
                                  removes 
                                    
                                       p
                                       %
                                    
                                  of the required elements from solution s by selecting the ones whose removal returns the maximum saving.

demandOrientedRemove
                                    
                                       (
                                       p
                                       ,
                                       s
                                       )
                                    
                                  removes 
                                    
                                       p
                                       %
                                    
                                  of the required elements from solution s according to a distance defined on the basis of the demands of these elements. More precisely, let 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       ‖
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             j
                                          
                                       
                                       ‖
                                    
                                  be the metric associated with the required elements i and j with demands 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             j
                                          
                                       
                                    
                                 , respectively. (for random elements we have considered the mean value). The first required element to remove is randomly chosen, while the second is selected as the nearest to the first, the third as the nearest to the second and so on until 
                                    
                                       p
                                       %
                                    
                                  of the required elements are removed from s.

All the removal procedures return the list 
                           
                              Γ
                           
                         of the required elements removed from s (see Algorithm 3 in Appendix A).

Concerning the insertion heuristics, the following procedures are used in combination with the removal ones:
                           
                              •
                              randomInsert 
                                    
                                       (
                                       Γ
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                  randomly inserts in 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  the elements extracted from 
                                    
                                       Γ
                                    
                                 . More precisely, for each element 
                                    
                                       e
                                       ∈
                                       Γ
                                    
                                 , a route 
                                    
                                       r
                                       ∈
                                       
                                          
                                             s
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  is selected randomly among the routes such that the total demand associated with the already serviced required elements satisfies (1d). A random position 
                                    
                                       π
                                    
                                  is chosen inside r where e will be inserted and serviced. Whenever e is already deadheaded in r, no attempt is made to select its position.

regretInsert 
                                    
                                       (
                                       Γ
                                       ,
                                       
                                          
                                             s
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                  inserts into 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                  the elements extracted from 
                                    
                                       Γ
                                    
                                 , with the aim of maximizing the regret associated with each element. We use the regret objective proposed by Pisinger and Ropke (2007), with 
                                    
                                       k
                                       =
                                       3
                                    
                                 , and verify (1d).

Current solutions provided by the diversification phase represent a good starting point to address the search towards the construction of improved MCGRPPC solutions. Several neighborhoods are explored according to the basic Variable Neighborhood Descent (VND) strategy described by Hansen, Mladenovic, and Gerad (2003) until no further improvement can be found. All these neighborhoods are searched within a mechanism allowing a restart of the search from the first neighborhood at each improving solution found. The main features of the neighborhood moves are summarized as follows:
                           
                              (m1) merge: for each couple of routes r and 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  in the current solution s, an attempt is made in order to merge these routes by servicing all the required elements of 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             ′
                                          
                                       
                                    
                                  after the required elements serviced in r.

(m2) 
                                    
                                       λ
                                    
                                 -interchange: this move is similar to the one defined by Osman (1993), and the CROSS-exchange move proposed by Taillard, Badeau, Gendreau, Guertin, and Potvin (1997). In the computational experiments, we used 
                                    
                                       λ
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       4
                                       ,
                                       5
                                       }
                                    
                                 .

(m3) interchangeInterRoute: this move is the same introduced by Savelsbergh (1992) and consists of reinserting a single required element at a time in an alternate route.

(m4) interchangeInterRouteNewPath: this move creates a new empty route in which a single required element is inserted.

(m5) twoOptPlusInterRoute: this move corresponds to the 2-opt∗ move defined by Potvin and Rousseau (1995).

Each move is applied with the best-accept strategy. Whenever a move generates a solution with one or more empty routes, such routes are dropped from the solution. In order to escape from local optima, we accept also infeasible solutions, penalized in the objective function by a constraint violation penalty factor (see Cordeau, Gendreau, & Laporte, 1997; Toth & Vigo, 2003).

More precisely, solutions with a number of vehicles larger than m are m-infeasible (alternatively, m-feasible), whereas the ones in which one route at least (alternatively, no route) violates (1d) are Q-infeasible (alternatively, Q-feasible). Given a solution, let 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    [
                                    m
                                    (
                                    s
                                    )
                                    -
                                    m
                                    ]
                                 
                                 
                                    +
                                 
                              
                           
                         be the number of routes in solution s exceeding m, and
                           
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       Q
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                       (
                                       s
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      Q
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            [
                                                            
                                                               
                                                                  Φ
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            α
                                                            )
                                                            ]
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            (
                                                            Q
                                                            -
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    [
                                    .
                                    ]
                                 
                                 
                                    +
                                 
                              
                              =
                              max
                              {
                              0
                              ,
                              .
                              }
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                           
                         are the mean and variance of the random demand associated with the required elements serviced by the kth vehicle, respectively. Then, the penalty cost associated with such a solution is defined as 
                           
                              
                                 
                                    υ
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    ξ
                                 
                                 
                                    m
                                 
                              
                              +
                              
                                 
                                    υ
                                 
                                 
                                    Q
                                 
                              
                              
                                 
                                    ξ
                                 
                                 
                                    Q
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    υ
                                 
                                 
                                    m
                                 
                              
                           
                         and 
                           
                              
                                 
                                    υ
                                 
                                 
                                    Q
                                 
                              
                           
                         are the unit penalties associated with the m-infeasibility or Q-infeasibility, or both. The modified objective function becomes 
                           
                              
                                 
                                    f
                                 
                                 
                                    ̃
                                 
                              
                              =
                              f
                              +
                              
                                 
                                    υ
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    ξ
                                 
                                 
                                    m
                                 
                              
                              +
                              
                                 
                                    υ
                                 
                                 
                                    Q
                                 
                              
                              
                                 
                                    ξ
                                 
                                 
                                    Q
                                 
                              
                           
                        . Penalty 
                           
                              
                                 
                                    υ
                                 
                                 
                                    m
                                 
                              
                           
                         is decreased by setting 
                           
                              
                                 
                                    υ
                                 
                                 
                                    m
                                 
                              
                              =
                              max
                              
                                 
                                    
                                       
                                          
                                             υ
                                          
                                          
                                             m
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                          
                                             υ
                                          
                                          
                                             m
                                          
                                       
                                       ·
                                       
                                          
                                             υ
                                          
                                          
                                             m
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                           
                         if, after 
                           
                              τ
                           
                         consecutive iterations, all the generated solutions are m-feasible, whereas it is increased by setting 
                           
                              
                                 
                                    υ
                                 
                                 
                                    m
                                 
                              
                              =
                              min
                              
                                 
                                    
                                       
                                          
                                             υ
                                          
                                          
                                             m
                                          
                                          
                                             max
                                          
                                       
                                       ,
                                       
                                          
                                             υ
                                          
                                          
                                             m
                                          
                                       
                                       ·
                                       
                                          
                                             υ
                                          
                                          
                                             m
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                           
                         whenever these solutions are m-infeasible. Similarly, penalty 
                           
                              
                                 
                                    υ
                                 
                                 
                                    Q
                                 
                              
                           
                         is decreased by setting 
                           
                              
                                 
                                    υ
                                 
                                 
                                    Q
                                 
                              
                              =
                              max
                              
                                 
                                    
                                       
                                          
                                             υ
                                          
                                          
                                             Q
                                          
                                          
                                             min
                                          
                                       
                                       ,
                                       
                                          
                                             υ
                                          
                                          
                                             Q
                                          
                                       
                                       ·
                                       
                                          
                                             υ
                                          
                                          
                                             Q
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                           
                        , and it is increased by setting 
                           
                              
                                 
                                    υ
                                 
                                 
                                    Q
                                 
                              
                              =
                              min
                              
                                 
                                    
                                       
                                          
                                             υ
                                          
                                          
                                             Q
                                          
                                          
                                             max
                                          
                                       
                                       ,
                                       
                                          
                                             υ
                                          
                                          
                                             Q
                                          
                                       
                                       ·
                                       
                                          
                                             υ
                                          
                                          
                                             Q
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                           
                         in the opposite case. The overall algorithm is detailed in Algorithms 4 and 5 reported in Appendix A.

The B&C algorithm presented in Section 3 cannot be used to solve real-life instances directly because of prohibitive computational times, but it can effectively solve instances with a number of vehicles not greater than six. This suggests that the B&C algorithm may be used successfully to improve portions of the solution. In particular, a route optimization search relying on integer programming is used as a neighborhood search scheme. With respect to other applications of this idea (see Savelsbergh & Song, 2008; Song & Furman, 2013), in our implementation the B&C is used to recover the feasibility of the schedules of some required elements. We select such schedules in a subset of couples and triplet of routes of the solution returned by the intensification phase, and we solve a restricted problem, where the schedules of the remaining routes are kept fixed. Several strategical decisions are adopted to make efficient the proposed approach. How do we select the two or three vehicles whose routes define the neighborhood? Which is the criterion to stop the neighborhood search? We choose a simple and straightforward scheme. Let 
                           
                              
                                 
                                    L
                                 
                                 
                                    dd
                                 
                              
                              (
                              k
                              )
                           
                         be the set of links deadheaded by vehicle k in route 
                           
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                           
                        . Among the subsets of two vehicles that have not been selected before, we select the couple of vehicles 
                           
                              (
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         with the following rules:
                           
                              (a) 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      dd
                                                   
                                                
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ∩
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      dd
                                                   
                                                
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                  is maximum. In case of multiple couples, we select

(b) the couple for which the maximum violation of (1d) is checked. If no violation of (1d) takes place, then we select the two vehicles with the maximal residual capacity. If more couples still exist, then

(c) we choose randomly the couple of vehicles with the maximum value of 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      dd
                                                   
                                                
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                ∩
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      dd
                                                   
                                                
                                                (
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                  and the maximum violation of (1d) or the maximal residual capacity.

We stop after evaluating 30% of all the couples. This scheme has been evaluated on a subset of tuning instances with a number of vehicles equal to or less than six, and it was able to find the optimal solution provided by the B&C algorithm, or a near optimal solution. However, to deal with instances with a number of vehicles larger than six, we enlarged the neighborhood size by considering the schedules of the required elements serviced by three vehicles, and optimizing the triple selected in accordance with the above rules. To maintain tractability with respect to the computational times, we optimized a triple every 
                           
                              
                                 
                                    
                                       factor
                                       ·
                                       
                                          
                                             n
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                              
                           
                         couples of routes, where 
                           
                              factor
                              =
                              0.2
                           
                         and 
                           
                              
                                 
                                    n
                                 
                                 
                                    c
                                 
                              
                           
                         is the total number of couples to be examined.

In order to test the efficiency of the proposed approaches, we used a dataset of randomly generated instances with probability level 
                        
                           α
                           ∈
                           {
                           0.85
                           ,
                           0.95
                           }
                        
                     . Each instance is built starting from the corresponding mggdb instance with 
                        
                           β
                           =
                           0.25
                        
                      of the dataset designed by Bosco et al. (2013) for the MCGRP. For each required element 
                        
                           e
                           ∈
                           R
                        
                      with demand 
                        
                           
                              
                                 d
                              
                              
                                 e
                              
                           
                        
                     , a random binary number is extracted to decide if 
                        
                           
                              
                                 d
                              
                              
                                 e
                              
                           
                        
                      is affected by uncertainty or not. Then, a random value from the discrete uniform distribution over 
                        
                           {
                           1
                           ,
                           …
                           ,
                           coef
                           ×
                           
                              
                                 d
                              
                              
                                 e
                              
                           
                           }
                           ,
                           
                           coef
                           =
                           5
                        
                     , is selected as variance of the random variable 
                        
                           
                              
                                 d
                              
                              
                                 e
                              
                           
                           (
                           ω
                           )
                        
                     . All the stochastic required elements in the neighborhood of the end vertices of each stochastic required link are considered to define a negative or positive correlation with this link. Correlation 
                        
                           ρ
                        
                      is selected randomly in the interval 
                        
                           [
                           -
                           1
                           ,
                           1
                           ]
                        
                     . Whenever the correlation between 
                        
                           e
                           ,
                           
                           
                              
                                 e
                              
                              
                                 ′
                              
                           
                           ∈
                           R
                           ,
                           
                           e
                           
                           ≠
                           
                           
                              
                                 e
                              
                              
                                 ′
                              
                           
                        
                     , is not zero, then the relevant entry in the covariance matrix is set as 
                        
                           
                              
                                 θ
                              
                              
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           ρ
                           
                              
                                 σ
                              
                              
                                 e
                              
                           
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                     . Finally, if no non-zero correlation occurs, then an other attempt is made by forcing some stochastic required elements close to the end vertices of the stochastic links to have a covariance with such links. The new instances are named mggdbsd, where sd stands for stochastic demand.

Computational experiments have been carried out on a PC equipped with 2 Intel Xeon Quad Core CPUs @3.0gigahertz, with 6gigabytes RAM. The heuristic and the B&C algorithm have been coded in java. The B&C has been implemented by using ILOG CPLEX library, release 12.2, where all the standard CPLEX cuts are activated. We have run each heuristic for 5 times by using the same parameter configuration.

In the tuning phase, we experimented a large range of diversification rates. We removed from 5 up to 90% of all the requests in each iteration. Due to the weakness of the insertion heuristics, the improvements obtained with the lowest and highest rates were very limited. Consequently we decided to reduce the range from 15 up to 60. More precisely, we observed that for small instances the best efficiency in removing requests relies on rates chosen in the set 
                        
                           {
                           15
                           ,
                           25
                           ,
                           35
                           }
                        
                     , while for larger instances the best rates are the ones selected in the set 
                        
                           {
                           50
                           ,
                           60
                           }
                        
                     . To ensure consistency, we used the same set of rates for all the instances, that is 
                        
                           {
                           15
                           ,
                           25
                           ,
                           35
                           ,
                           50
                           ,
                           60
                           }
                        
                     .

@&#RESULTS@&#

The comparison between the results achieved by the proposed heuristic, named HSGR, and those provided by the B&C algorithm (with a time limit of four hours) is reported in Tables 1 and 2
                        
                        . The column headings are defined as follows:
                           
                              •
                              Name: instance name;


                                 m: number of vehicles in the upper bound solution;


                                 
                                    
                                       |
                                       V
                                       |
                                    
                                 : number of vertices;


                                 
                                    
                                       |
                                       A
                                       |
                                    
                                 : number of arcs;


                                 
                                    
                                       |
                                       E
                                       |
                                    
                                 : number of edges;


                                 
                                    
                                       |
                                       
                                          
                                             V
                                          
                                          
                                             R
                                          
                                       
                                       |
                                    
                                 : number of required vertices;


                                 
                                    
                                       |
                                       
                                          
                                             A
                                          
                                          
                                             R
                                          
                                       
                                       |
                                    
                                 : number of required arcs;


                                 
                                    
                                       |
                                       
                                          
                                             E
                                          
                                          
                                             R
                                          
                                       
                                       |
                                    
                                 : number of required edges;


                                 
                                    
                                       |
                                       
                                          
                                             V
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   U
                                                
                                             
                                          
                                       
                                       |
                                    
                                 : number of vertices with stochastic demand;


                                 
                                    
                                       |
                                       
                                          
                                             A
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   U
                                                
                                             
                                          
                                       
                                       |
                                    
                                 : number of arcs with stochastic demand;


                                 
                                    
                                       |
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   U
                                                
                                             
                                          
                                       
                                       |
                                    
                                 : number of edges with stochastic demand;

UB: upper bound corresponding to the initial solution value;

CON: number of added connectivity inequalities;

CAP: number of added capacity inequalities (11m);

cost: cost of the best solution provided by the B&C algorithm within a time limit of four hours (optimal values are marked by an asterisk);

GAP: percentage gap between upper and lower bounds at the termination of the B&C algorithm;

veh.: number of vehicles in the best solution returned by the B&C;

time: computational time (in seconds) of the B&C
                                 algorithm (the time limit is denoted by –);

avg. cost: average solution value provided by the heuristic (over 5 experiments);

avg. veh.: average number of vehicles provided by HSGR
                                 (over 5 experiments).

best cost: cost of the best solution provided by heuristic (over 5 experiments). Whenever this cost is equal to the optimal cost, it is labeled with an asterisk, while the costs in bold are those outperforming the upper bounds returned by the B&C within the time limit.

best veh.: number of vehicles of the best solution returned by the heuristic (over 5 experiments);

avg. gap: percentage improving gap computed as 
                                    
                                       
                                          
                                             100
                                             [
                                             avg
                                             .
                                             cost
                                             –
                                             cost
                                             ]
                                          
                                          
                                             cost
                                          
                                       
                                    
                                 ;

avg. time: computational time (in seconds) spent by HSGR
                                 (over 5 experiments) to perform one experiment.

The row Avg. averages key columns, while NumB indicates the number of best solutions found by the B&C and HSGR, respectively.

Several observations may be pointed out according to different criteria based on the number of vehicles, the prevalence in the total number of required links with respect to the total number of the required vertices, the distribution of the uncertainty within the stochastic required elements. Looking at the number of vehicles only, HSGR
                        outperforms the B&C when the number of vehicles increases for the growing difficulty in solving the mathematical model. This emerges from instances in which the number of vehicles is greater than 6, as comfirmed by the percentage gaps reported in columns GAP in Tables 1 and 2. From routing point of view, we observe that when the number of required links makes the problem more “arc” than “node” routing based, the performance of the B&C is very poor compared with the proposed heuristic, and deteriorates quickly with the increase in the reliability level and the number of vehicles, as shown in instance mggdbsd2 in which the number of required links is more than twice the number of required vertices, the number of vehicles is greater than 10 and the improvement achieved by HSGR
                        increases with 
                           
                              α
                           
                        . Such a behavior is motivated by the increase in the performance of the exact route optimization strategy that has more chances to improve portions of the feasibility region due to the link-based nearness between the couple of routes to be optimized. Moreover, when the uncertainty affects only links, as for instance mggdbsd4, HSGR performs much better than the B&C
                        regardless the reliability level, confirming our conjecture.

Looking at Tables 1 and 2, only in three instances the B&C provides an optimal solution within a limited computational time for the considered reliability levels. This happens when the number of required edges is less than the number of required arcs and vertices, since modeling a required edge through pairs of binary variables increases the difficulty in solving the mathematical model. Finally, we observe that the performance of HSGR varies with the distribution of uncertainty within the same number of required elements. For example, if we consider instances mggdbsd1 and mggdbsd6 having the same total number of stochastic elements but a different number of stochastic vertices and links, we remark that HSGR produces better results when the number of stochastic vertices is comparable with the number of stochastic links. This behavior seems reducing when the reliability level decreases as shown in Table 2. We argue that, in general, the reliability levels impact on the hardness of the problem regardless of the distribution of the uncertainty amongst the required elements.

@&#CONCLUSIONS@&#

We studied the mixed capacitated general routing problem under uncertainty and we proposed a probabilistically constrained formulation where capacity constraints are imposed to hold with a given reliability value. We provided a deterministic equivalent formulation under the assumption that the uncertain parameters follow a normal distribution. We designed a B&C algorithm for the optimal solution of instances of limited size and an efficient heuristic approach. Extensive numerical experiments have been carried out on a set of stochastic instances of benchmark test problems proposed in the literature for the deterministic case. The analysis of the numerical results has shown the efficiency of the proposed approaches. The proposed approach can be extended to deal with other general routing problems in which operative constraints come into play.

Hereafter is reported an example showing that conditions (l1) and (l2) are not necessary to ensure that the probabilistic inequality (10) holds. Consider, for example the instance defined by the mixed graph G depicted in Fig. 1
                     , where all the required elements are marked in bold and their demands are defined through pairs 
                        
                           
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          e
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          e
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      that represent the corresponding mean and variance, respectively. Suppose 
                        
                           
                              
                                 Φ
                              
                              
                                 -
                                 1
                              
                           
                           (
                           α
                           )
                           =
                           1.645
                        
                      and 
                        
                           Q
                           =
                           3
                        
                     . Edge costs are not shown as they are not relevant to the example. Let 
                        
                           S
                           =
                           {
                           6
                           ,
                           7
                           }
                        
                      be a subset of vertices not connected with the depot such that 
                        
                           D
                           (
                           R
                           (
                           S
                           )
                           ,
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       R
                                    
                                 
                              
                           
                           (
                           S
                           )
                           )
                           =
                           2
                           ,
                           
                           |
                           
                              
                                 δ
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       R
                                    
                                 
                              
                           
                           (
                           S
                           )
                           |
                           =
                           1
                        
                     , and 
                        
                           
                              
                                 ∑
                              
                              
                                 (
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       (
                                       R
                                       (
                                       S
                                       )
                                       
                                       ∪
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                       (
                                       S
                                       )
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 e
                                 ≠
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           
                              
                                 θ
                              
                              
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           0.5
                        
                     . The minimum number of deadheading traversals in the cutset 
                        
                           
                              
                                 δ
                              
                              
                                 L
                              
                           
                           (
                           S
                           )
                        
                      to satisfy (10) must be equal to 3. In fact:
                        
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       
                                          
                                             δ
                                          
                                          
                                             L
                                          
                                       
                                       (
                                       S
                                       )
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    ij
                                 
                              
                              =
                              3
                              >
                              0.333
                              =
                              2
                              
                                 
                                    D
                                    (
                                    R
                                    (
                                    S
                                    )
                                    ,
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                    (
                                    S
                                    )
                                    )
                                 
                                 
                                    Q
                                 
                              
                              -
                              |
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          R
                                       
                                    
                                 
                              
                              (
                              S
                              )
                              |
                              ,
                           
                        
                     the left hand side of inequality (11b) is equal to:
                        
                           
                              
                                 
                                    4
                                 
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                Φ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          α
                                          )
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                e
                                                ∈
                                                R
                                                (
                                                S
                                                )
                                                
                                                ∪
                                                
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                             
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             e
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                (
                                                e
                                                ,
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                                ∈
                                                
                                                   
                                                      (
                                                      R
                                                      (
                                                      S
                                                      )
                                                      
                                                      ∪
                                                      
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      S
                                                      )
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                e
                                                ≠
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             e
                                             ,
                                             
                                                
                                                   e
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              3.006
                              ,
                           
                        
                     while the right hand side becomes:
                        
                           
                              2
                              
                                 
                                    
                                       |
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                       (
                                       S
                                       )
                                       |
                                       -
                                       2
                                       
                                          
                                             D
                                             (
                                             R
                                             (
                                             S
                                             )
                                             ,
                                             
                                                
                                                   δ
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                             (
                                             S
                                             )
                                             )
                                          
                                          
                                             Q
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       
                                          
                                             δ
                                          
                                          
                                             L
                                          
                                       
                                       (
                                       S
                                       )
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    ij
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          2
                                          
                                             
                                                D
                                                (
                                                R
                                                (
                                                S
                                                )
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                                )
                                             
                                             
                                                Q
                                             
                                          
                                          -
                                          |
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          S
                                          )
                                          |
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   (
                                                   S
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              7.111
                              .
                           
                        
                     On the other hand, since
                        
                           
                              2
                              
                                 
                                    
                                       |
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   R
                                                
                                             
                                          
                                       
                                       (
                                       S
                                       )
                                       |
                                       -
                                       2
                                       
                                          
                                             D
                                             (
                                             R
                                             (
                                             S
                                             )
                                             ,
                                             
                                                
                                                   δ
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                             (
                                             S
                                             )
                                             )
                                          
                                          
                                             Q
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       
                                          
                                             δ
                                          
                                          
                                             L
                                          
                                       
                                       (
                                       S
                                       )
                                    
                                 
                              
                              
                                 
                                    η
                                 
                                 
                                    ij
                                 
                              
                              +
                              2
                              
                                 
                                    
                                       
                                          2
                                          
                                             
                                                D
                                                (
                                                R
                                                (
                                                S
                                                )
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                
                                                (
                                                S
                                                )
                                                )
                                             
                                             
                                                Q
                                             
                                          
                                          -
                                          |
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                          (
                                          S
                                          )
                                          |
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              -
                              1.777
                              ,
                           
                        
                     condition 
                        
                           (
                           l
                           2
                           )
                        
                      is violated.
                        Algorithm 1
                        The general scheme of the heuristic 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   diversification
                                                   
                                                   rates
                                                   =
                                                   {
                                                   15
                                                   ,
                                                   25
                                                   ,
                                                   35
                                                   ,
                                                   50
                                                   ,
                                                   60
                                                   }
                                                
                                             .
                                       
                                       
                                          
                                             
                                                
                                                   diversification
                                                   
                                                   types
                                                   =
                                                   {
                                                   RANDOM
                                                   ,
                                                   WORST
                                                   ,
                                                   DEMAND
                                                   _
                                                   ORIENTED
                                                   }
                                                
                                             .
                                       
                                       
                                          Initial solution: 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             . Best solution: 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   =
                                                   ∅
                                                
                                             . Current solution: 
                                                
                                                   s
                                                   =
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             if 
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                              is feasible then
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             end if
                                          
                                       
                                       
                                          
                                             for 
                                             
                                                
                                                   rate
                                                   ∈
                                                   diversificationRates
                                                
                                              
                                             do
                                          
                                       
                                       
                                          
                                             
                                             ITERATION
                                          
                                       
                                       
                                          
                                             Local best solution: 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   =
                                                   ∅
                                                
                                             .
                                       
                                       
                                          
                                             
                                             for 
                                             
                                                
                                                   type
                                                   ∈
                                                   diversificationTypes
                                                
                                              
                                             do
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   =
                                                   diversification
                                                   (
                                                   rate
                                                   ,
                                                   type
                                                   ,
                                                   s
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                              is feasible and 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   )
                                                   <
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   )
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   =
                                                   Intensificationphase
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         D
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   =
                                                   ExactLocalSearch
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                              is feasible and 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                   <
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   )
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   =
                                                   ∅
                                                
                                              or 
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   )
                                                   <
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   )
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         I
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             end for
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   s
                                                   =
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         L
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             end for
                                          
                                       
                                       
                                          return 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         B
                                                      
                                                   
                                                
                                             .
                                       
                                    
                                 
                              
                           
                        

Diversification procedure: 
                              
                                 diversification
                                 (
                                 rate
                                 ,
                                 type
                                 ,
                                 s
                                 )
                              
                            
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             if 
                                             
                                                
                                                   type
                                                   =
                                                   RANDOM
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   Γ
                                                
                                             
                                             =randomRemove
                                                
                                                   (
                                                   rate
                                                   ,
                                                   s
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             =randomInsert
                                                
                                                   (
                                                   Γ
                                                   ,
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             return 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             end if
                                          
                                       
                                       
                                          
                                             if 
                                             
                                                
                                                   type
                                                   =
                                                   WORST
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   Γ
                                                
                                             
                                             =worstRemove
                                                
                                                   (
                                                   rate
                                                   ,
                                                   s
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             =regretInsert
                                                
                                                   (
                                                   Γ
                                                   ,
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             return 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             end if
                                          
                                       
                                       
                                          
                                             if 
                                             
                                                
                                                   type
                                                   =
                                                   DEMAND
                                                   _
                                                   ORIENTED
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   Γ
                                                
                                             
                                             =demandOrientedRemove
                                                
                                                   (
                                                   rate
                                                   ,
                                                   s
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             =regretInsert
                                                
                                                   (
                                                   Γ
                                                   ,
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             return 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             end if
                                          
                                       
                                    
                                 
                              
                           
                        


                           
                              
                                 Intensificationphase
                                 (
                                 s
                                 )
                              
                            Part I 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   moves
                                                   =
                                                   {
                                                   merge
                                                   ,
                                                   λ
                                                
                                             -intechange, with 
                                                
                                                   λ
                                                   =
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   5
                                                
                                             , interchangeInterRoute,
                                       
                                       
                                          interchangeInterRouteNewPath, twoOptPlusInterRoute7
                                                
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          Set 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   s
                                                
                                             . Set 
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   =
                                                   ,
                                                   
                                                   τ
                                                   =
                                                   10
                                                   ,
                                                   
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         m
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                   =
                                                   1
                                                   ,
                                                   
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         Q
                                                      
                                                      
                                                         min
                                                      
                                                   
                                                   =
                                                   1
                                                
                                             , 
                                                
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         m
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   =
                                                   1000
                                                
                                             ,
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         Q
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   =
                                                   1000
                                                   ,
                                                   
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         m
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   =
                                                   0.7
                                                   ,
                                                   
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         Q
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   =
                                                   0.7
                                                   ,
                                                   
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         m
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   =
                                                   1.5
                                                   ,
                                                   
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         Q
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   =
                                                   1.5
                                                
                                             .
                                       
                                       
                                          Set 
                                                
                                                   NS
                                                   
                                                   iterations
                                                   =
                                                   0
                                                
                                             .
                                       
                                       
                                          
                                             for all 
                                             
                                                
                                                   i
                                                   =
                                                   0
                                                   ;
                                                   
                                                   i
                                                   <
                                                   moves
                                                   .
                                                   size
                                                   ;
                                                   
                                                   i
                                                   =
                                                   i
                                                   +
                                                   1
                                                
                                              
                                             do
                                          
                                       
                                       
                                          
                                             Apply the ith move to s:
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   =
                                                   move
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   moves
                                                   [
                                                   i
                                                   ]
                                                   )
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                              is 
                                                
                                                   m
                                                   -
                                                
                                             infeasible then
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                              is 
                                                
                                                   Q
                                                
                                             -infeasible then
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   NS
                                                   
                                                   iterations
                                                   =
                                                   NS
                                                   
                                                   iterations
                                                   +
                                                   1
                                                
                                             .
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   NS
                                                   
                                                   iterations
                                                   ⩾
                                                   τ
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             Update unit penalties:
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   =
                                                   0
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   =
                                                   max
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  m
                                                               
                                                               
                                                                  min
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  m
                                                               
                                                               
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                    
                                 
                              
                           
                        


                           
                              
                                 Intensificationphase
                                 (
                                 s
                                 )
                              
                            Part II 
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   =
                                                   NS
                                                   
                                                   iterations
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   =
                                                   min
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  m
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  m
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   =
                                                   0
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   =
                                                   max
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  Q
                                                               
                                                               
                                                                  min
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  Q
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  Q
                                                               
                                                               
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   =
                                                   NS
                                                   
                                                   iterations
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         υ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   =
                                                   min
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  Q
                                                               
                                                               
                                                                  max
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  Q
                                                               
                                                            
                                                            ·
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  Q
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   NS
                                                   
                                                   iterations
                                                   =
                                                   0
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             
                                             if 
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   )
                                                   <
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                              
                                             then
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             Restart from the first move: 
                                                
                                                   i
                                                   =
                                                   -
                                                   1
                                                
                                             .
                                       
                                       
                                          
                                             
                                             end if
                                          
                                       
                                       
                                          
                                             end for
                                          
                                       
                                       
                                          return 
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             .
                                       
                                    
                                 
                              
                           
                        

@&#REFERENCES@&#

