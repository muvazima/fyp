@&#MAIN-TITLE@&#A novel level set model with automated initialization and controlling parameters for medical image segmentation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Only one parameter needs to be changed manually for different images in our model.


                        
                        
                           
                           We propose a novel adaptive mean shift clustering method to guide the evolution of level set.


                        
                        
                           
                           The results of clustering can automatically generate an initial contour of level set evolution.


                        
                        
                           
                           The controlling parameters of level set evolution can be automatically estimated.


                        
                        
                           
                           We use reaction diffusion method in our model to avoid re-initialization.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Medical image segmentation

Adaptive mean shift clustering

Level set method

Automated initialization

Reaction diffusion method

@&#ABSTRACT@&#


               
               
                  In this paper, a level set model without the need of generating initial contour and setting controlling parameters manually is proposed for medical image segmentation. The contribution of this paper is mainly manifested in three points. First, we propose a novel adaptive mean shift clustering method based on global image information to guide the evolution of level set. By simple threshold processing, the results of mean shift clustering can automatically and speedily generate an initial contour of level set evolution. Second, we devise several new functions to estimate the controlling parameters of the level set evolution based on the clustering results and image characteristics. Third, the reaction diffusion method is adopted to supersede the distance regularization term of RSF-level set model, which can improve the accuracy and speed of segmentation effectively with less manual intervention. Experimental results demonstrate the performance and efficiency of the proposed model for medical image segmentation.
               
            

@&#INTRODUCTION@&#

The purpose of medical image segmentation is to separate the components of the interested region from their background. The result can be used to assist doctors to treat their patients by making a diagnosis. Since the real medical image is mostly limited by poor resolution, weak contrast and intensity inhomogeneity [1], it is difficult to segment accurately by traditional segmentation method, such as the threshold or region growing method. In recent years, level set methods have become increasingly popular for medical image segmentation [2,3]. There are several advantages of the level set method [4]. For example, its numerical computations involving curves and surfaces can be performed on a fixed Cartesian grid. Moreover, it is able to represent contours with complex topological changes [5].

The level set methods can be categorized into edge-based models and region-based models [6,7]. Edge-based models use the local edge information to drive the active contour toward the object boundaries. However, the edge-based models are usually quite sensitive to the initial conditions and easily suffer from boundary leakage problems in images with weak object boundaries [8]. Region-based models aim to identify each interested region by using a certain region descriptor to guide the motion of the active contour [9]. Nevertheless, defining a certain region descriptor is difficult for images with intensity inhomogeneity or weak contrast. Being different from classical methods based on assumption of intensity homogeneity, a level set model based on local region information, which is called region-scalable fitting (RSF) level set model, was proposed by Li et al. [13]. It uses RSF energy term to guide the motion of the contour. This method is able to segment the images with intensity inhomogeneity. However, all these methods are sensitive to the initialization of the contour and need to set controlling parameters manually.

In traditional level set models, the periodical re-initialization is necessary to maintain stable evolution of the zero level set curves [10]. However, it may cause undesirable results for image segmentation and add unnecessary computation cost. Then, Li et al. proposed a classical method which is called distance regularized level set evolution (DRLSE) [11] which regularizes the level set function during evolution. Therefore, the re-initialization procedure can be eliminated. Subsequently, this method is used in many new or classical level set models [12,13]. However, DRLSE method still has the drawbacks such as limited anti-leakage capability for weak boundaries and sensitivity to noise. Recently, a new method was proposed for remit the re-initialization of the level set evolution, which is called reaction-diffusion (RD) method. This method has much better performance on weak boundary anti-leakage, and the implementation of the RD equation is very simple and it is more robust to noise. These advantages of RD method have been verified by applying it to the classical level set model, geodesic active contours (GAC) model and Chan–Vese (C–V) model.

In this paper, we propose a novel level set model for medical image segmentation. Compared to some previous models, our model has significant contributions in the following aspects. First, we improve the mean shift clustering method by a new adaptive bandwidth algorithm which makes the clustering more accurate and faster. Furthermore, this improvement also solves the problem that the previous mean shift algorithm is quite sensitive to the setting of bandwidth. Second, the novel mean shift clustering method is used to obtain the initial contour of RSF-level set evolution close to the genuine boundaries of objects and estimate the controlling parameters of the level set model. Third, we apply the reaction diffusion method instead of the previous distance regularized method to avoid the re-initialization of RSF-level set evolution. It makes this algorithm's iteration faster and more robust to noise.

This paper is structured into the following sections. Section 2 describes the background and related works. Section 3 presents the novel level set model. Experimental results and the relevant discussions are shown in Section 4. The final section of the paper offers some conclusions.

Mean shift clustering is a simple iterative procedure that shifts each data point to the mean of data points in its assigned neighborhood [14], and it is widely used in computer vision and image processing field [15,16].

The image segmentation with mean shift clustering is a straightforward extension of the discontinuity preserving smoothing algorithm. Each pixel associates with a significant mode of the joint domain density located in its neighborhood [17].

Given n data points 
                           
                              
                                 
                                    X
                                 
                                 i
                              
                              
                                 
                                    i
                                    =
                                    1,2
                                    ,
                                    …
                                    ,
                                    n
                                 
                              
                           
                         in a d-dimensional Euclidian space R
                        
                           d
                         and a symmetric positive definite d
                        ×
                        d bandwidth matrix 
                           H
                        
                        , which is proportional to the identity matrix, i.e., 
                           H
                        
                        =
                        h
                        2
                        I, where h
                        >0 is a bandwidth parameter. The multivariate kernel density estimator with bandwidth matrix 
                           H
                         is given by the following equation:
                           
                              (1)
                              
                                 
                                    
                                       
                                          f
                                          ˆ
                                       
                                       
                                          h
                                          ,
                                          K
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    =
                                    
                                       
                                          
                                             c
                                             
                                                k
                                                ,
                                                d
                                             
                                          
                                       
                                       
                                          n
                                          
                                             h
                                             d
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       κ
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               −
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  i
                                                               
                                                            
                                                            h
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where c
                        
                           k,d
                         denotes a positive normalization constant, 
                           
                              κ
                              
                                 x
                              
                           
                         indicates the function called the profile of the kernel, only for x
                        ≥0.

We define a function 
                           
                              g
                              
                                 x
                              
                              =
                              −
                              
                                 κ
                                 ′
                              
                              
                                 x
                              
                           
                        . Then, we assume the derivative of the kernel profile 
                           
                              κ
                              
                                 x
                              
                           
                         exists for all 
                           
                              x
                              ∈
                              
                                 
                                    0
                                    ,
                                    ∞
                                    )
                                 
                              
                           
                        , except for a finite set of points, the kernel 
                           
                              G
                              
                                 x
                              
                           
                         can be redefined as:
                           
                              (2)
                              
                                 
                                    G
                                    
                                       x
                                    
                                    =
                                    
                                       c
                                       
                                          g
                                          ,
                                          d
                                       
                                    
                                    g
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where c
                        
                           g,d
                         denotes the corresponding normalization constant.

According to the linearity of Eq. (1) and introducing 
                           
                              g
                              
                                 x
                              
                           
                         into it, the density gradient estimator is obtained as the gradient of the density estimator as follows:
                           
                              (3)
                              
                                 
                                    
                                       ∇
                                       ˆ
                                    
                                    
                                       f
                                       
                                          h
                                          ,
                                          G
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             c
                                             
                                                k
                                                ,
                                                d
                                             
                                          
                                       
                                       
                                          n
                                          
                                             h
                                             
                                                d
                                                +
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           X
                                                                        
                                                                        i
                                                                     
                                                                  
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   n
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                
                                                
                                                   
                                                      X
                                                   
                                                   i
                                                
                                                g
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 X
                                                                              
                                                                              −
                                                                              
                                                                                 
                                                                                    X
                                                                                 
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     /
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   n
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                
                                                g
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 X
                                                                              
                                                                              −
                                                                              
                                                                                 
                                                                                    X
                                                                                 
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     /
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             X
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              
                                 g
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               −
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      /
                                                      h
                                                   
                                                
                                             
                                          
                                          2
                                       
                                    
                                 
                              
                           
                         is assumed to be a positive number. This condition is easy to satisfy for all the profiles met in practice. From Eq. (3), the first term is proportional to the density estimate at X computed with the kernel:
                           
                              (4)
                              
                                 
                                    
                                       
                                          f
                                          ˆ
                                       
                                       
                                          h
                                          ,
                                          G
                                       
                                    
                                    
                                       
                                          X
                                       
                                    
                                    =
                                    
                                       
                                          
                                             c
                                             
                                                g
                                                ,
                                                d
                                             
                                          
                                       
                                       
                                          n
                                          
                                             h
                                             d
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       g
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               −
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  i
                                                               
                                                            
                                                            h
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

and the second term is the popular mean shift vector:
                           
                              (5)
                              
                                 
                                    
                                       m
                                       
                                          h
                                          ,
                                          G
                                          
                                             
                                                x
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                i
                                             
                                             g
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           −
                                                                           
                                                                              
                                                                                 X
                                                                              
                                                                              i
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  /
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             n
                                             
                                                i
                                                =
                                                1
                                             
                                          
                                          g
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           X
                                                                        
                                                                        −
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               /
                                                               h
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    −
                                    
                                       X
                                    
                                 
                              
                           
                        
                     

Eq. (5) shows that the mean shift vector computed with kernel 
                           
                              G
                              
                                 x
                              
                           
                         is proportional to the normalized density gradient obtained with kernel 
                           
                              K
                              
                                 x
                              
                           
                         at location X. The mean shift vector always points to the direction of maximum increase in the density. The first step of the mean shift procedures is to compute the mean shift vector 
                           
                              
                                 m
                                 
                                    h
                                    ,
                                    G
                                    
                                       
                                          x
                                       
                                    
                                 
                              
                           
                        . Then, translate the kernel 
                           
                              G
                              
                                 x
                              
                           
                         by 
                           
                              
                                 m
                                 
                                    h
                                    ,
                                    G
                                    
                                       
                                          x
                                       
                                    
                                 
                              
                           
                        . At the end of the procedure, it is guaranteed to converge at a nearby point until some convergence criterions are satisfied.

The evolution of the classical level set function 
                           
                              ϕ
                              
                                 
                                    t
                                    ,
                                    x
                                    ,
                                    y
                                 
                              
                           
                         can be expressed as follows:
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            ϕ
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      +
                                                      F
                                                      
                                                         
                                                            ∇
                                                            ϕ
                                                         
                                                      
                                                      =
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                      
                                                         
                                                            t
                                                            =
                                                            0
                                                            ,
                                                            x
                                                            ,
                                                            y
                                                         
                                                      
                                                      =
                                                      
                                                         ϕ
                                                         0
                                                      
                                                      
                                                         
                                                            x
                                                            ,
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where F indicates the speed function that controls the motion of the contour. 
                           
                              
                                 
                                    ∇
                                    ϕ
                                 
                              
                           
                         denotes the normal direction, and 
                           
                              
                                 ϕ
                                 0
                              
                              
                                 
                                    x
                                    ,
                                    y
                                 
                              
                           
                         is the initial contour.

During evolution, the traditional level set function may become too flat or too steep near the zero level set, causing serious numerical errors. Therefore, a procedure called re-initialization is periodically employed to keep it to be a signed distance function (SDF). Unfortunately, this re-initialization method is very time-consuming and may fail when the LSF deviates much from SDF.

To eliminate the re-initialization procedure, some formulations have been proposed in recent years. One of the most common methods is distance regularized level set evolution [10,11]. The authors propose a signed distance penalizing energy term as follows:
                           
                              (7)
                              
                                 
                                    P
                                    
                                       ϕ
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       ∫
                                       Ω
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         ϕ
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                   −
                                                   1
                                                
                                             
                                          
                                          2
                                       
                                    
                                    d
                                    x
                                 
                              
                           
                        
                     

Recently, a novel means has been put forward to avoid re-initialization by reaction diffusion function [18].

By adding a diffusion term εΔ∅ into the level set equation in Eq. (6), RD function for level set model can be defined as:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                         t
                                                      
                                                      =
                                                      ε
                                                      
                                                         Δ
                                                      
                                                      ∅
                                                      +
                                                      
                                                         1
                                                         ε
                                                      
                                                      F
                                                      
                                                         
                                                            ∇
                                                            ϕ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                      
                                                         
                                                            0
                                                            ,
                                                            x
                                                            ,
                                                            ε
                                                         
                                                      
                                                      =
                                                      
                                                         ϕ
                                                         0
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ε represents a small positive constant, and Δ indicates the Laplacian operator. The diffusion term εΔ∅ gradually regularizes the LSF to be a piecewise constant in each segment domain, and the reaction term 
                           
                              
                                 
                                    
                                       1
                                       /
                                       ε
                                    
                                 
                              
                              F
                              
                                 
                                    ∇
                                    ϕ
                                 
                              
                           
                         forces the final stable solution of Eq. (8) to 
                           
                              F
                              
                                 
                                    ∇
                                    ϕ
                                 
                              
                              =
                              0
                           
                        .

The equilibrium solution of Eq. (8) is a piecewise constant as ε
                        →0+, which is the characteristic of phase transition. However, RD equation has the intrinsic problem of phase transition, which is the stiff parameter ε
                        −1 that makes Eq. (8) difficult to implement. Therefore, a splitting method has been presented to reduce the side effect of the stiff parameter, which is called two-step splitting method (TSSM).

In the first step of TSSM, we solve the reaction term 
                           
                              
                                 ϕ
                                 t
                              
                              =
                              
                                 
                                    
                                       1
                                       /
                                       ε
                                    
                                 
                              
                              F
                              
                                 
                                    ∇
                                    ϕ
                                 
                              
                           
                         with 
                           
                              ϕ
                              
                                 
                                    0
                                    ,
                                    x
                                    ,
                                    ε
                                 
                              
                              =
                              
                                 ∅
                                 n
                              
                           
                         to obtain the intermediate solution. The diffusion equation ϕ
                        
                           t
                        
                        =
                        εΔ∅ with 
                           
                              ϕ
                              
                                 
                                    t
                                    =
                                    0
                                    ,
                                    x
                                 
                              
                              =
                              
                                 ∅
                                 
                                    
                                       
                                          
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       /
                                       2
                                    
                                 
                              
                           
                         is solved to ensure the smoothness of the level set function and keep zero level set not to be moved.

By choosing small time steps Δt
                        1 and Δt
                        2, the above operation will be discretely approximated as 
                           
                              
                                 ∅
                                 
                                    
                                       
                                          
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       /
                                       2
                                    
                                 
                              
                              =
                              
                                 ∅
                                 n
                              
                              +
                              
                                 Δ
                              
                              
                                 t
                                 1
                              
                              F
                              
                                 
                                    ∇
                                    ϕ
                                 
                              
                           
                         and 
                           
                              
                                 ∅
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 ∅
                                 
                                    
                                       
                                          
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       /
                                       2
                                    
                                 
                              
                              +
                              
                                 Δ
                              
                              
                                 t
                                 2
                              
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       ∅
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                             
                                             /
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        . Obviously, the parameter ε can be integrated into the time steps Δt
                        1 and Δt
                        2 as 
                           
                              
                                 Δ
                              
                              
                                 t
                                 1
                              
                              ←
                              
                                 Δ
                              
                              
                                 t
                                 1
                              
                              
                                 
                                    −
                                    
                                       ε
                                       
                                          −
                                          1
                                       
                                    
                                 
                              
                           
                         and Δt
                        2
                        ←Δt
                        2
                        ε. Therefore, we only need to consider the two time steps to keep numerical stability.

The RD method has been applied to the classical level set model, GAC model and C–V model [18]. The segmentation experiments prove the property superiority of RD method such as robust to noise and high computational efficiency.

The RSF-level set model has several desirable advantages such as flexible initialization and effective solving scheme. In addition, it has a unique advantage in coping with intensity inhomogeneity. Nevertheless, the initial contour and evolution controlling parameters have to be set manually. To reduce the unnecessary manual intervention and improve efficiency of the algorithm, a novel automated level set model is thereby proposed for medical image segmentation. It automates the initialization and parameter configuration of the level set method which includes integrating adaptive mean shift clustering and RD method with the RSF-Level set model.

The mean shift clustering is a general nonparametric method, which is based on the global image information without any prior knowledge. However, the accuracy and efficiency of this method are sensitive to the manual setting of bandwidth parameter h. To solve this problem, we propose an adaptive formulation for bandwidth parameter selection as follows:
                        
                           (9)
                           
                              
                                 
                                    h
                                    n
                                 
                                 =
                                 
                                    h
                                    
                                       max
                                    
                                 
                                 
                                    
                                       1
                                       −
                                       
                                          c
                                          h
                                       
                                       
                                          e
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        m
                                                                        n
                                                                     
                                                                     −
                                                                     
                                                                        m
                                                                        
                                                                           n
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            /
                                                            
                                                               
                                                                  m
                                                                  n
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where m
                     
                        n
                      represents the mean of total pixel values in current search region, c
                     
                        h
                      is weighted coefficients, and h
                     max is the predefined maximum bandwidth. Obviously, a larger bandwidth parameter will be chosen when the pixel value distributes more uniform. Conversely, a smaller bandwidth parameter will be chosen.

Benefitting from the flexible initialization of RSF-level set model, the initial contour 
                        
                           
                              ϕ
                              0
                           
                           
                              x
                           
                        
                      can be defined as the following equation:
                        
                           (10)
                           
                              
                                 
                                    ϕ
                                    0
                                 
                                 
                                    x
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   C
                                                   ,
                                                
                                             
                                             
                                                
                                                   x
                                                   ∈
                                                   
                                                      Ω
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                   ,
                                                
                                             
                                             
                                                
                                                   x
                                                   ∈
                                                   Ω
                                                   −
                                                   
                                                      Ω
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where Ω
                     0 denotes a subset in the image domain Ω, and C is a constant. Eq. (10) shows that the evolution of the level set function can start from an arbitrary binary region. In traditional level set model, the initial contour with a regular shape, such as a circle or a rectangle, must be manually obtained.

In our model, we implement the adaptive mean shift clustering first, 
                        
                           
                              B
                           
                           
                              x
                           
                        
                      is the results of clustering. Then a two-value matrix 
                        
                           
                              D
                           
                           
                              x
                           
                        
                      is obtained from the clustering result by a simple thresholding:
                        
                           (11)
                           
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      x
                                                   
                                                   >
                                                   
                                                      t
                                                      0
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   other
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where t
                     0 is a constant threshold which is suggested to be 1 in our model.

To match with the initial contours defined in Eq. (10), a regulation process should be installed as follows:
                        
                           (12)
                           
                              
                                 
                                    ϕ
                                    0
                                 
                                 
                                    
                                       x
                                       ,
                                       y
                                    
                                 
                                 =
                                 −
                                 6
                                 
                                    
                                       0.5
                                       −
                                       
                                          D
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                           
                        
                     
                  

By using Eq. (11), we obtain a two-value matrix 
                        
                           
                              ϕ
                              0
                           
                           
                              x
                           
                        
                      ranged from −3 to 3. It satisfies the initial contour demands in the RSF-level set model [13].

In order to improve the robust to noise and computational efficiency of our model, we apply the reaction diffusion method instead of the previous distance regularized method to avoid the re-initialization of RSF-level set evolution. The novel level set function is defined as follows:
                        
                           (13)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      t
                                                   
                                                   =
                                                   λ
                                                   δ
                                                   
                                                      ϕ
                                                   
                                                   div
                                                   
                                                      
                                                         
                                                            
                                                               ∇
                                                               ϕ
                                                            
                                                            
                                                               
                                                                  
                                                                     ∇
                                                                     ϕ
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   δ
                                                   
                                                      ϕ
                                                   
                                                   
                                                      
                                                         
                                                            β
                                                            1
                                                         
                                                         
                                                            e
                                                            1
                                                         
                                                         
                                                            x
                                                         
                                                         −
                                                         
                                                            β
                                                            2
                                                         
                                                         
                                                            e
                                                            2
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                   
                                                      
                                                         t
                                                         =
                                                         0
                                                         ,
                                                         x
                                                      
                                                   
                                                   =
                                                   −
                                                   6
                                                   
                                                      
                                                         0.5
                                                         −
                                                         
                                                            D
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Through the comparison with previous RSF-level set function, it is obvious that the signed distance penalizing energy term is no longer required. Therefore, the calculation cost will be reduced to some extent, and the parameter μ can be removed. It will reduce the manual operation of level set evolution.

With this proposed model, the parameters β
                     1 and β
                     2 can be set as 1 without the loss of segmentation accuracy because the regularized clustering results approximate the genuine boundaries well. However, the evolution controlling parameter λ and scale parameter σ of Gaussian kernel used to compute 
                        
                           
                              e
                              1
                           
                           
                              x
                           
                        
                      
                     
                        
                           
                              e
                              2
                           
                           
                              x
                           
                        
                      in Eq. (13) still have significant influence on the segmentation result. Hence, we propose following formulas to estimate the parameters λ and σ in our model.

The evolution controlling parameter λ can be estimated from the result of mean shift clustering and characteristics of the segmented image as follows:
                        
                           (14)
                           
                              
                                 λ
                                 =
                                 
                                    
                                       
                                          h
                                          
                                             max
                                          
                                       
                                       +
                                       
                                          h
                                          f
                                       
                                    
                                    
                                       2
                                       
                                          n
                                          2
                                       
                                    
                                 
                                 ×
                                 max
                                 
                                    
                                       I
                                    
                                 
                              
                           
                        
                     where n represents the subclass number of the adaptive mean shift clustering, which is obtained automatically during the adaptive mean shift clustering procedure. h
                     
                        f
                      denotes the bandwidth which is calculated in the last iteration of adaptive mean shift clustering, and h
                     max is the maximum bandwidth set manually.

The scale parameter σ in the definition of K
                     
                        σ
                      is difficult to be set in the RSF-level set method. When a small σ is chosen, the segmentation will be more sensitive to the initial contour. However, if we choose a large σ, more robust initial contour can be obtained, but the computational cost and segmentation accuracy will have a negative effect [15]. We propose an automated parameter estimation formula to find an appropriate scale parameter σ for our model. First, we defined the length l and the area s by
                        
                           (15)
                           
                              
                                 l
                                 =
                                 ∫
                                 
                                    δ
                                    
                                       
                                          
                                             ϕ
                                             0
                                          
                                       
                                    
                                    d
                                    x
                                 
                              
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 s
                                 =
                                 ∫
                                 
                                    H
                                    
                                       
                                          
                                             ϕ
                                             0
                                          
                                       
                                    
                                    d
                                    x
                                 
                              
                           
                        
                     where ϕ
                     0 is the initial contours, 
                        
                           δ
                           
                              
                                 
                                    ϕ
                                    0
                                 
                              
                           
                        
                      indicates Dirac function slightly smoothed, and 
                        
                           H
                           
                              
                                 
                                    ϕ
                                    0
                                 
                              
                           
                        
                      is Heaviside function as:
                        
                           (17)
                           
                              
                                 H
                                 
                                    
                                       
                                          ϕ
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                      0
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                      0
                                                   
                                                   <
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Then, the scale parameter σ is estimated by
                        
                           (18)
                           
                              
                                 σ
                                 =
                                 
                                    c
                                    σ
                                 
                                 
                                    l
                                    
                                       n
                                       s
                                    
                                 
                              
                           
                        
                     where n is the subclass number of the adaptive mean shift clustering. c
                     
                        σ
                      is the regulating parameter, and we use it with c
                     
                        σ
                     
                     =500 for all the experiments in this paper.

In the proposed model, only one parameter, the maximum bandwidth in the mean shift clustering needs to be set manually, and it is not necessary to be selected very accurately. In addition, a more efficient method to avoid re-initialization has been introduced into our model. Undoubtedly, those improvements have several practical benefits, such as making the segmentation more efficient and higher accuracy.

The proposed model was implemented with Matlab R2010a on PC with Intel Core i3-3240 CPU 3.4GHz and 8GB RAM. The operation system is Windows 7 service pack 1. The experiments and performance evaluation were carried on synthetic images and real medical images from different modalities. Unless otherwise specified, we used the parameters c
                     
                        h
                     
                     =0.5, c
                     
                        σ
                     
                     =500, β
                     1
                     =
                     β
                     2
                     =1, and time steps Δt
                     1
                     =0.1 and Δt
                     2
                     =0.05 for all the experiments in this paper.

The first experiment is designed to evaluate the usefulness of adaptive mean shift clustering for level set segmentation. We used previous RSF-level set model with manual initialization for a real image of T-shaped object and an ultrasound image of vessel transverse section, respectively. Meanwhile our novel method was used to segmentation of the same images. The segmentation results, the number of level set iterations and the computation time were recorded as the indexes of measuring the algorithm efficiency.


                     Fig. 1
                      shows the segmentation procedures of the two test images using the RSF-level set model with different initial contours, respectively. The first column images (Fig. 1a, d, g, and j) show the manual initial contours denoted with rectangles. The second column images show the segmentation results after 50 iterations, and the third column images show the final segmentation results. The RSF-level set method achieves satisfied segmentation result for the T-shaped object image with 320 iterations (Fig. 1c), but fails to achieve satisfied segmentation result for the ultrasound image of vessel transverse section over 500 iterations (Fig. 1i). With another initial contour, the RSF-level set method cannot correctly segment the objects (Fig. 1f and l). The computation time of four segmentation procedures are 9.48s, 9.33s, 19.30s, 18.63s, respectively.


                     Fig. 2
                      illustrates the segmentation procedures of our novel model applied to the same images as Fig. 1. It is not difficult to see that satisfactory segmentation results (Fig. 2d and h) of both test images were obtained. Benefiting from the appropriate initialization, our novel method successfully extracts the boundaries of interesting objects. The computation times needed to segment the T-shape object and ultrasound image are 1.65s and 4.52s. Apparently, the computational cost of our model is significantly reduced.

According to the above results comparison between segmentation results of RSF-level set model and the model proposed in this paper, we find that the new algorithm in the aspect of the computing efficiency and the accuracy of segmentation is superior to the traditional RSF-level set model. The primary reasons have the following aspects. First, RSF-level set model is very sensitive to the initialization of the contour, so that the final result is largely influenced by the initial contour. However, initial contour of level set evolution is an automatic contour which is automatically generated by mean shift clustering results in our model. Second, the equation evolution is just driven by employing the local region information of image, which is easily affected by noise and weak edges. In comparison, since mean shift algorithm in our model is based on the global region information, more comprehensive image information is utilized for image segmentation. Third, the computation speed of adaptive mean shift algorithm is much faster than RSF-level set model. Level set evolution in our algorithm is starting from the mean shift clustering results which are approached object contour, rather than the manual initial contour, so that the overall computation time of the algorithm is reduced significantly.

The target of the second experiment was to evaluate the effectiveness of RD method to avoid the re-initialization in level set evolution. A synthetic image and an X-ray image of vessel were segmented by our model with two different avoid re-initialization methods which are traditional DRLSE method and RD method, respectively. The comparing of the segmentation results is shown in Fig. 3
                     .


                     Fig. 3 illustrates the performance of different methods to avoid the re-initialization in our model. The synthetic image and X-ray image segmentation procedures of our model with DRLSE method were shown in the first and third row, and the same images segmentation procedures of our model with RD method were shown in the second and fourth row. The fourth column images are the final results, and their computation times are 5.90s, 5.49s, 1.48s and 1.34s, respectively.

The validity of the improvement in the way to avoid the re-initialization for our model is proved by the second experiment. Although DRLSE method can effectively avoid the tedious processing of re-initialization for the RSF-level set evolution. However, as we can see from Fig. 3d and l, DRLSE method causes the segmentation results of RSF-level set model to be more sensitive to noise. Hence, a new way to avoid the re-initialization is introduced to our model, which improves noise-resistibility and further enhances the computing efficiency. This improvement brings about a satisfactory segmentation effect, as shown in Fig. 3h and p.

In the third experiment, we compare our model with four different level set methods, including two classical level set models and two kinds of automatic initialization level set models which are GAC model, C–V model, fuzzy level set model [19] and MS-RSF model [20], respectively. GAC model is a classical edge-based level set model. The convergence of active contour curve in GAV model is driven by the image gradient. C–V model is also called active contour without edges, which is driven by region information. GAC model and C–V model need to set initial contour and controlling parameters manually. Fuzzy level set model applies spatial fuzzy clustering to extract global region information, and the clustering results are utilized for initial level set function. The clustering number needs to set in advance. MS-RSF model is another level set method without manual initial contour. However in this method, most controlling parameters still need to set manually, and it uses DRLSE method to avoid the re-initialization.


                     Fig. 4
                      shows the segmentation results for suprasellar section CT image; Fig. 5
                      shows the segmentation results for sellar section CT image and Fig. 6
                      shows the segmentation results for transverse metacarpal bones CT image. The above figures from the column (a) to column (e) are GAC model, C–V model, fuzzy level set model, MS-RSF model and our model, respectively. The brain images come from our cooperative hospital. They are two CT slice images from two different patients. The metacarpal image is in an open dataset which comes from the Institute of Sport and Exercise Medicine, North University of China. It is a left hand CT image from a volleyball athlete. Table 1
                      shows the computation times and iteration numbers of these segmentation results, including initialization times (t
                     0) and overall segmentation times (t). Because the GAC model and C–V model need to initialize manually, the initialization times cannot be recorded.

By observing Figs. 4–6, we can discover that the segmentation results of other four methods are imprecise. The GAC model only can segment one interested boundary contour which is not sufficiently precise. A high precision could be obtained with C–V model and MS-RSF model, but they are easy to generate excess boundary contour. The final contour of fuzzy level set method cannot penetrate the deeper concave part of object boundary. Nevertheless, segmentation results of our model have greatly improved for the accuracy of segmentation, and are not apt to generate pseudo boundary. As we can see from Table 1, for the above tested three images, our model is the fastest. On the other side, by comparing the generating speed of the initial contour between our model and MS-RSF model, the effectiveness of adaptive bandwidth algorithm we proposed is demonstrated.

In order to quantitative measuring the segmentation accuracy of our model, we use the Dice coefficient and the Hausdorff distance as standard. The segmentation results by human are used as the golden standard, which are shown in Fig. 7
                     , and then the Dice coefficient and the Hausdorff distance of five different models’ segmentation results are computed, and the Hausdorff distance is in pixel. For larger dice coefficients and smaller Hausdorff distance, the higher segmentation accuracy is obtained. As we can see from the comparing results of Table 2
                     , our algorithm has the highest accuracy.

Medical images make it difficult to be segmented precisely, since they have their own inherent deficiencies, such as poor resolution, serious noise and intensity inhomogeneities. The images which were used in our experiments have their own different characteristics. The ultrasound image of vessel transverse section has serious noise and obvious weak boundary, the X-ray images are typical images with intensity inhomogeneities, and the CT images have more complex object boundaries. However, the above experiments verify that our model yields significant performance advantages in computational efficiency and segmentation results with both manual initialization level set model and automatic initialization level set model. It is worth mentioning that our model is a level set model with automated initialization and controlling parameters, and reduces the influence of manual intervention on the algorithm distinctly.

To integrate a novel adaptive mean shift with the RSF-level set model, the key issues are matching the clustering results with the initial contours of the level set evolution and ensuring the positive effects of our model. Above experimental results demonstrate the effectiveness of the binarization processing, regulation operation, and parameter estimation equation in our model. Moreover, by using the RD method that we used to avoid re-initialization in our model, the level set evolution becomes faster and more robust to noise.

@&#CONCLUSION@&#

A novel level set model was proposed for automated medical image segmentation in this paper. Our model began with the mean shift clustering which was modified by adaptive bandwidth algorithm, and utilized the results of this clustering to initiate the level set formulation. The clustering results could be the initial contour which approximated the boundaries of interest region by binarization processing and regulation operation. The controlling parameters of the level set evolution also could be automatically estimated from the result of mean shift clustering and characteristics of the segmented image by the function we proposed. Moreover, in order to enhance the robust to noise and computing efficiency, RD method was used to be the new way to eliminate re-initialization in our model. The experimental results presented in this study validate the accuracy and the effectiveness of our model with all these improvements for segmenting medical images automatically. However, our method does exist some limitations. This method still cannot completely eliminate the manual intervention in the processing of segmentation and h
                     max still needs be chosen according to experience. In future studies, we will investigate better method of the automated initialization for level set model. We will also explore more effective methods to drive the evolution of the level set curves according to the characteristics of medical images.

@&#ACKNOWLEDGEMENTS@&#

We would like to thank the helpful comments and suggestions from the anonymous reviewers. This work was supported by the National Natural Science Foundation of China (No. 61471225), the National Natural Science Foundation of China (No. 61571275); the National Science Foundation of Shandong province, China (No. ZR2014FM039).

@&#REFERENCES@&#

