@&#MAIN-TITLE@&#ADRC or adaptive controller – A simulation study on artificial blood pump

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An Active Disturbance Rejection Controller was developed for a rotary blood pump.


                        
                        
                           
                           The performance of ADRC was studied in activity and pathology variation.


                        
                        
                           
                           ADRC was easy to design and tune.


                        
                        
                           
                           ADRC demonstrated robust performance with excellent disturbance rejection.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Active disturbance rejection control

Adaptive control

Physiological controller

Rotary blood pump

Left ventricular assist device

@&#ABSTRACT@&#


               
               
                  Active disturbance rejection control (ADRC) has gained popularity because it requires little knowledge about the system to be controlled, has the inherent disturbance rejection ability, and is easy to tune and implement in practical systems. In this paper, the authors compared the performance of an ADRC and an adaptive controller for an artificial blood pump for end-stage congestive heart failure patients using only the feedback signal of pump differential pressure. The purpose of the control system was to provide sufficient perfusion when the patients’ circulation system goes through different pathological and activity variations. Because the mean arterial pressure is equal to the total peripheral flow times the total peripheral resistance, this goal was converted to an expression of making the mean aortic pressure track a reference signal. The simulation results demonstrated that the performance of the ADRC is comparable to that of the adaptive controller with the saving of modeling and computational effort and fewer design parameters: total peripheral flow and mean aortic pressure with ADRC fall within the normal physiological ranges in activity variation (rest to exercise) and in pathological variation (left ventricular strength variation), similar to those values of adaptive controller.
               
            

@&#INTRODUCTION@&#

Rotary blood pump (RBP) is a mechanical pump to restore the perfusion for end-stage heart failure patients. Some studies have showed that the passive variation of pump flow at a fixed speed due to the change of cardiovascular parameters could not match the physiological demands of patients [33]. Physiological controller, which adjusts the pump flow automatically, is critical for the permanent application of RBP and provides better life quality of patients [1]. The controller needs to adjust the pump flow properly for different patients in the situations such as: patients sleep, rest, or exercise slightly (e.g. walking or climbing stairs); and when the recipient’s sick heart gets better or worse. In these conditions, some properties of human circulatory system may change dramatically such as the total peripheral resistance, so is the body need for blood [2]. Many physiological controllers have been proposed for RBP to achieve the robust performance at the presence of large disturbance. The algorithms of those controllers can be classified as two types, model-based controller, and model free controller. Model-based controller design use a simplified mathematical model of plant (i.e. RBP plus cardiovascular system) [3,22,24–28]. Some models include time-varying parameters to accommodate the large variations of circulation system in different physiological conditions with the cost of online computational effort [3]. Because of the dependence on model, the performance of model-based controller is also contingent upon the accuracy of the model. Model-free controllers, use only the input (e.g. pump speed, pump current) and the output (e.g. pump flow, pump pressure rise, heart rate, etc.) information of the RBP plus cardiovascular system, but typically needs extensive tuning of controller in advance because of the nature of the implemented fuzzy logic [28–30]. The exception is the model free adaptive controller proposed by Gao and Chang [31,32], which has four design parameters that are special to the structure of the controller. All these model-based or model-free controllers have demonstrated robust performance at the presence of large disturbance in numerical simulation and/or in-vitro experiments. However, their dependence on model [3,22,24–28], extensive tuning in advance [28–30], multiple design parameters [31,32], or intensive computational effort [3] present challenge for clinical application.

Active disturbance rejection controller (ADRC) was proposed by Han [4–6], further simplified and parameterized by Gao [7,8]. The effectiveness of ADRC is evident in many case studies, where the technique is employed to solve a number of benchmark problems in various industrial problems with promising results [9–19]. The applications demonstrate that ADRC provides a very simple controller design but achieves high performance in tracking and disturbance rejection for various complex control problems. The basic idea of ADRC is to use an extended state observer (ESO) to estimate the internal and external disturbances, which can be named as the total disturbance, in real time. The estimated total disturbance is then canceled in the controller in real time. Through disturbance rejection, the originally complex and uncertain plant dynamics is reduced to a simple cascaded integral plant, which can be easily controlled by a PD controller. Three important features of ADRC are: (1) it requires very little model information of the system; (2) it achieves excellent disturbance rejection performance; and (3) it requires only two tuning parameters: controller bandwidth and observer bandwidth. ADRC can be classified as a model-free controller. The focus of this paper is to compare the performance of the designed ADRC and a model-based adaptive controller on artificial blood pump.

In this paper, we first give the introduction of human circulation system and artificial blood pump, together with the objectives of the controller. The design of adaptive controller and ADRC controller is presented later, followed by their simulation results in a variety of physiological scenarios.

Human circulation system is composed of heart (with four chambers), peripheral arterial system, capillary, peripheral venous system, pulmonary arterial system and pulmonary vein system. The blood circulates from left ventricle to peripheral arterial system, through capillary, peripheral venous system, to right atrium, then to right ventricle, then through pulmonary arterial and venous system, to left atrium, then back to left ventricle. The authors have developed a lumped parameter computational model for human circulation system interacting with RBP functioning as left ventricular assist device (LVAD). Its electrical analog is shown in 
                        Fig. 1 
                        [2]. The detail explanation of each element of this model is listed in the Appendix.

In the human circulation system, the heart rate, the contractility of the heart, the resistance of peripheral blood vessels, the resistance of pulmonary blood vessels may change dramatically in different pathological or activity levels [2]. There are also one way cardiac valves to make sure that the blood can only flow in one direction. In summary, human circulation system is a time-varying nonlinear system with large system uncertainty and disturbance.

The rotary blood pump is a centrifugal or axial flow pump driven by a small electrical motor. The pump is usually used to aid the more frequently failed left ventricle, with the inlet connected to the left ventricle, and the outlet connected to the aorta, indicated as left ventricular assist device (LVAD) in Fig. 1. So the pressure across the pump is equal to the aortic pressure 
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                         minus the left ventricular pressure 
                           
                              
                                 P
                              
                              
                                 LV
                              
                           
                        .

The pump used in this study is Nimbus pump [23], a blood pump with contact bearing. Its hydrodynamic parameters and motor equations are described by
                           
                              (1a)
                              
                                 ∆
                                 P
                                 =
                                 
                                    h
                                    0
                                 
                                 Q
                                 +
                                 
                                    h
                                    1
                                 
                                 
                                    Q
                                    ̇
                                 
                                 +
                                 
                                    h
                                    2
                                 
                                 
                                    ω
                                    2
                                 
                              
                           
                        
                        
                           
                              (1b)
                              
                                 
                                    J
                                    
                                       ω
                                       ̇
                                    
                                    =
                                    K
                                    I
                                    −
                                    B
                                    ω
                                    −
                                    
                                       
                                          g
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          ω
                                       
                                       3
                                    
                                    −
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    Q
                                    
                                       
                                          ω
                                       
                                       2
                                    
                                 
                              
                           
                        where I is the applied current, ω is the pump rotational speed, Q is the volume flow rate of the pump, ΔP is the pressure difference across the pump, i.e.
                           
                              
                                 
                                    
                                 
                                 (
                              
                              
                                 
                                    P
                                 
                                 
                                    A
                                 
                              
                              
                                 −
                              
                              
                                 
                                    P
                                 
                                 
                                    LV
                                 
                              
                              
                                 )
                              
                           
                        , J is the inertia of pump. K, B, h
                        
                           i
                         (i=0, 1, 2) and g
                        
                           j
                         (j=0, 1) are constants identified through experiment. If ignoring the small inertia effect of the pump and linearizing Eqs. (1a) and (1b) around the nominal operating speed, we can get:
                           
                              (1c)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       =
                                    
                                    
                                       
                                          β
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ∆
                                    
                                    
                                       P
                                    
                                    
                                       +
                                    
                                    
                                       
                                          β
                                       
                                       
                                          2
                                       
                                    
                                    
                                       I
                                    
                                 
                              
                           
                        with some linear coefficients β
                        1 and β
                        2 
                        [1].

The computational model of Fig. 1 was realized in Matlab/Simulink (Mathworks, Navick, MA). This model has been demonstrated to be able to simulate the response of circulation system and rotary blood pump in different activities and different levels of heart failure [2]. Fig. 1 was used as the simulation environment for this paper.

The ultimate goal of the physiological controller is to provide sufficient perfusion (i.e. total peripheral flow). Since the total peripheral flow is equal to the mean aortic pressure divided by the total peripheral resistance, this goal can be converted to maintaining the proper mean aortic pressure. However, due to the fact that the available pressure senor is not reliable in long term, aortic pressure cannot be directly obtained [22], but indirectly approximated by Eq. (2) from the pump differential pressure.

The aortic pressure 
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                         is proposed to be derived from differential pressure across RBP (ΔP) indirectly by the following equation:
                           
                              (2)
                              
                                 
                                    
                                       P
                                       ¯
                                    
                                    A
                                 
                                 ≈
                                 Δ
                                 
                                    P
                                    modified
                                 
                              
                           
                        where 
                           
                              
                                 P
                                 ¯
                              
                              A
                           
                         is the mean aortic pressure, 
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       P
                                    
                                 
                                 
                                    modified
                                 
                              
                           
                         is the processed function of the diastolic portion of ΔP. An example of ΔP
                        
                           modified
                         as compared to 
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 LV
                              
                           
                         is shown in 
                        Fig. 2. Eq. (2) is based on the following facts. RBP is connected to the left ventricle at the inlet, and the aorta at the outlet. The differential pressure across RBP (ΔP), i.e. 
                           
                              (
                           
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                           
                              −
                           
                           
                              
                                 P
                              
                              
                                 LV
                              
                           
                           
                              )
                           
                        , is accessible through other long term reliable signal, such as the position of the impeller of a magnetically suspended blood pump [1], or through the speed and the current measurement together [23]. The left ventricular pressure varies greatly from the systole to the diastole, typically at a much larger magnitude than the aortic pressure. In diastole, particularly at the beginning of diastole, the left ventricular pressure is very small, so 
                           
                              (
                           
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                           
                              −
                           
                           
                              
                                 P
                              
                              
                                 LV
                              
                           
                           
                              )
                           
                         at this instance is very close to the value of 
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                        . The combination of an upper limit of 
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       P
                                    
                                 
                                 
                              
                           
                         and a lower limit of ΔP was found to be able to extract the diastolic portion [3] ΔP
                        
                           diastole
                        . The resultant ΔP
                        
                           diastole
                         was processed through a 10-point moving-average filter to obtain a continuous signal ΔP
                        
                           modified
                        . Because of the delay effect of moving average filter, a lag is expected in this feedback signal as compared to 
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                        . So, in this paper, the objective of physiological controller is formed as a tracking problem, to make the mean aortic pressure 
                           
                              
                                 P
                              
                              
                                 A
                              
                           
                         obtained through ΔP
                        
                           modified
                         to track a specified reference signal. The beating of natural heart is viewed as the disturbance to the circulation system. The magnitude of this disturbance is determined by the heart rate and the contractility (i.e. strength) of the natural heart.

In this paper, the reference signal is assumed to be constant, equal to 90mmHg. This value is selected based on previous simulation study of heart failure patient in rest condition considering three factors: (i) within the normal physiological range, between 80mmHg and 120mmHg, (ii) the resulting total peripheral flow falls within the normal physiological range, between 5L/min to 6L/min, and (iii) the aortic flow from the sick natural heart is small, but not equal to 0 to avoid the fusion of aortic valve due to the closure for extended period. Since the focus of this paper is to compare the performance between the adaptive controller and ADRC, constant reference signal was selected to for the purpose of simplification. In reality, the blood pressure of a healthy person may be changing in different scenarios, such as sleep, or exercise.

In summary, the objective of the physiological controller in this paper is to regulate the pump current I so that ΔP
                        
                           modified
                         will track the reference value. The feedback signal used by the controller is ΔP
                        
                           modified
                        .

The authors have developed a linear state space model of the human circulation system with the assistance of RBP [1] to approximate the response of human circulation system, which is given as follows:
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             x
                                             ̇
                                          
                                          =
                                          A
                                          x
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          Q
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                P
                                             
                                          
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          Γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          y
                                          =
                                          C
                                          x
                                       
                                    
                                 
                              
                           
                        where
                           
                              
                                 
                                    A
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  L
                                                                  V
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            ׳
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  L
                                                                  V
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            ׳
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            ׳
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            T
                                                            P
                                                            R
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      −
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  
                                                                     
                                                                        C
                                                                     
                                                                     
                                                                        L
                                                                        V
                                                                     
                                                                     
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  
                                                                     
                                                                        C
                                                                     
                                                                     
                                                                        A
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  A
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  L
                                                                  V
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            ׳
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  V
                                                               
                                                            
                                                            ׳
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    
                                       
                                          B
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            L
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    C
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        
                     

This model was demonstrated to track the average value of aortic pressure, but not the instantaneous value. Also, in this model, the peripheral resistance TPR is a time-varying parameter, which may change by more than 50%.

In this model, the system elements are: C
                        
                           d
                        
                        
                           LV
                        , compliance of left ventricle during diastole; C
                        
                           A
                        , compliance of systemic arteries; C
                        
                           V
                        , compliance of systemic vein and right atrium; TPR, total peripheral resistance (equivalent resistance accounting for all resistance from the aorta to the systemic vein and right atrium in Fig. 1); L, blood inertia in peripheral circulation; R
                        
                           V
                        
                        
                           ’
                        , equivalent resistance of pulmonary vein and left atrium, an artificial parameter which is related to true resistance of pulmonary vein and the pathological and exercise status of natural heart; δ
                        
                           m
                        , the pressure disturbance generated by the muscle pump function in exercise [2]; δ
                        
                           P
                        , pressure disturbance generated by pulmonary circulation; Q, the pump flow to the circulation system; and 
                           
                              Γ
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        , the flow from the natural heart. The states are defined as: x
                        1=P
                        
                           LV
                         − P
                        
                           A
                        , x
                        2=P
                        
                           V
                         − P
                        
                           A
                        , x
                        3=TPF where P
                        
                           LV
                         is the left ventricular pressure; P
                        
                           A
                         is the aortic pressure; P
                        
                           V
                         is the central venous pressure; and TPF is the total flow rate to the circulation system.

Eqs. (3) and (1c) together form a 3rd order state space model representation of the circulation system plus RBP used for adaptive estimator and controller design.
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             x
                                             ̇
                                          
                                          =
                                          (
                                          A
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          C
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          x
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                2
                                             
                                          
                                          *
                                          I
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          ׳
                                          
                                             
                                                δ
                                             
                                             
                                                P
                                             
                                          
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                B
                                             
                                             
                                                1
                                             
                                          
                                          Γ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          .
                                       
                                    
                                    
                                       
                                          y
                                          =
                                          C
                                          x
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (4), TPR can change dramatically by more than 50% in different exercise states, R
                        
                           V
                        
                        
                           ’
                         value may also change within 20% [1]. The rest of the parameters in Eq. (4) are fixed. δ
                        
                           m
                        , the pressure disturbance generated by muscle pump function in exercise, is only present in exercise; δ
                        
                           P
                         is the pressure disturbance generated by the pulmonary circulation system. δ
                        
                           P
                        , δ
                        
                           m
                         and 
                           
                              Γ
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              )
                           
                         are not accessible. This state space model represented by Eq. (4) is used to develop the adaptive controller, whose scheme is shown in 
                        Fig. 3. It is worth pointing out that all states of Eq. (4) have physiological meaning, thus may be useful for medical purpose.

To regulate the pump current I to meet the proper perfusion, an adaptive estimator was developed online for the time-varying parameter TPR.
                           
                              1.
                              
                                 Parameter estimation: From Eq. (4), it follows that:
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                y
                                             
                                             
                                                (
                                                
                                                   s
                                                
                                                )
                                             
                                             
                                                =
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                I
                                             
                                             
                                                (
                                                
                                                   s
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (5)
                                       
                                          
                                          
                                             +
                                             
                                                (
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         20
                                                      
                                                      
                                                         P
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   P
                                                
                                             
                                             
                                                (
                                                
                                                   s
                                                
                                                )
                                             
                                             
                                                +
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   δ
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                (
                                                
                                                   s
                                                
                                                )
                                             
                                             
                                                +
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                Γ
                                             
                                             
                                                (
                                                
                                                   s
                                                
                                                )
                                             
                                          
                                       
                                    
                                 for some coefficients a
                                 
                                    i
                                  and b
                                 
                                    i
                                 , b
                                 
                                    i
                                 
                                 
                                    p
                                  and b
                                 
                                    i
                                 
                                 
                                    m
                                 , i=0, 1, 2. The coefficients of b
                                 
                                    i
                                  are determined by the value of TPR. In Eq. (5), δ
                                 
                                    P
                                 , δ
                                 
                                    m
                                  and 
                                    
                                       Γ
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                  are ignored in the final controller design and the estimation of TPR because they are not accessible.

Filtering both sides of Eq. (5) by a 3rd order low-pass filter F(s)=1/Λ(s) with the cutoff frequency of 5rad/s, and arranging the resulting terms, we can derive the parametric equation
                                    
                                       (6)
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   *
                                                
                                             
                                             
                                                ∅
                                                (
                                             
                                             
                                                s
                                             
                                             
                                                )
                                                =
                                             
                                             
                                                z
                                             
                                             
                                                (
                                             
                                             
                                                s
                                             
                                             
                                                )
                                             
                                          
                                       
                                    
                                 for 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             *
                                          
                                       
                                       
                                          =
                                          TPR
                                       
                                    
                                  and some functions 
                                    
                                       ∅
                                       (
                                       s
                                       )
                                    
                                  and 
                                    
                                       z
                                       (
                                       s
                                       )
                                    
                                  whose denominators are Λ(s) and numerators are the combinations of y(s) and I(s).

The estimation error , where θ(t) is the estimator of θ*, and use the following adaptive law to update the estimate θ(t):


                                 
                                    
                                       (7)
                                       
                                          
                                          
                                             
                                                θ
                                                ̇
                                             
                                             
                                                (
                                                
                                                   t
                                                
                                                )
                                             
                                             
                                                =
                                                −
                                             
                                             
                                                
                                                   
                                                      γ
                                                      ϵ
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                      
                                                      )
                                                   
                                                   
                                                      ∅
                                                   
                                                   
                                                      (
                                                      
                                                         t
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                         
                                                         
                                                            
                                                               ∅
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             
                                                
                                             
                                             
                                                γ
                                             
                                             
                                                >
                                                0
                                             
                                          
                                       
                                    
                                 
                              


                                 State observer: The state observer structure for the estimate 
                                    
                                       
                                          x
                                       
                                       ^
                                    
                                  of 
                                    
                                       x
                                       =
                                    
                                    
                                       
                                          
                                             [
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ]
                                          
                                       
                                       
                                          T
                                       
                                    
                                  in Eq. (4) is a standard one, as given in Eq. (8), with all parameters but TPR known, and δ
                                 
                                    m
                                 , δ
                                 
                                    P
                                 , and 
                                    
                                       Γ
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                  in Eq. (4) ignored.
                                    
                                       (8)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      ̇
                                                   
                                                   =
                                                   (
                                                   A
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   C
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                   
                                                      x
                                                      ^
                                                   
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   *
                                                   I
                                                   +
                                                   L
                                                   (
                                                   y
                                                   −
                                                   
                                                      y
                                                      ⌢
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      ^
                                                   
                                                   =
                                                   C
                                                   
                                                      x
                                                      ^
                                                   
                                                
                                             
                                          
                                       
                                    
                                 The adaptive estimate of TPR obtained online from the previous parameter estimation procedure is used to update the value of TPR in Eq. (8), leading to an adaptive observer.


                                 Optimal PI controller: The controller developed here is a PI type of controller, as given by


                        K
                        
                           I
                         and K (integral gain, feedback gain vector) both were calculated from an optimal control design procedure to minimize the energy of a weighted function of control output and tracking error, given as 
                           
                              W
                              =
                           
                           
                              ∫
                           
                           
                              
                                 
                                    (
                                    e
                                 
                                 
                                    2
                                 
                              
                           
                           
                              S
                              +
                           
                           
                              
                                 I
                              
                              
                                 2
                              
                           
                           
                              R
                              )
                              dt
                           
                        . S and R are the selected weighting factors for the ΔP tracking error and the control current I, respectively. The estimate of TPR is used to replace the unknown TPR in the optimal control and the state observation, leading to an adaptive control scheme.

The tuning parameters for the Adaptive controller include the adaptive gain γ in Eq. (7), weighting factor ratio S/R, desired poles locations for the observer (3 by 1 vector) in Eq. (8), totally 5 design/tuning parameters. The implementation of the adaptive controller algorithm requires the solution of Riccati equation and inverse of 3 by 3 matrix in each time step, both of which require intense computation.

ADRC offers a new and inherently robust controller building block that requires very little information of the plant. By using the extended state observer, this control algorithm actively estimates and compensates for the total disturbance, including internal dynamics and external disturbances, in real time. The estimated information is then canceled in the control law such that the system behaves as a cascade integrator. Such strategy leads to the ditching of the prevailing model requirement in the current design. That is, instead of depending on the model of the plant, the controller draws the information needed to control the plant from the ESO. The ADRC-based control design is shown in 
                     Fig. 4.

Consider expressing human circulation system with RPB in the frame work of ADRC as
                        
                           (10)
                           
                              
                                 
                                    y
                                    ⃛
                                 
                                 =
                                 f
                                 (
                                 t
                                 ,
                                 y
                                 ,
                                 
                                    y
                                    ̇
                                 
                                 ,
                                 
                                    y
                                    ¨
                                 
                                 ,
                                 
                                    I
                                    ̇
                                 
                                 ,
                                 
                                    I
                                    ¨
                                 
                                 ,
                                 w
                                 )
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       d
                                    
                                 
                                 I
                              
                           
                        
                     where y is the output (i.e. ΔP); I is the control signal; and b
                     
                        d
                      is the coefficient of the control signal. The value of b
                     
                        d
                      is set to the nominal value of b
                     0 in Eq. (5) using the value of TPR in rest condition. w is an disturbance, which accounts for the total effect of ignored pump dynamics in Eq. (1c), δ
                     
                        P
                     
                     , δ
                     
                        m
                     , the disturbance caused by the beating of natural heart 
                        
                           Γ
                           (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           )
                        
                     , and the variation of b
                     0 due to change of TPR in Eq. (5). 
                        
                           f
                           (
                           t
                           ,
                           y
                           ,
                           
                              y
                              ̇
                           
                           ,
                           
                              y
                              ¨
                           
                           ,
                           
                              I
                              ̇
                           
                           ,
                           
                              I
                              ¨
                           
                           ,
                           w
                           )
                        
                      accounts for all other factors in Eq. (5) except the control signal. Eq. (10) demonstrates a third order dynamic relation between the input I and the output ΔP, which is consistent with the dynamic relation described by the third order state space model in Eq. (4).

Let 
                        
                           
                              ξ
                              1
                           
                           =
                           y
                           ,
                           
                              ξ
                              2
                           
                           =
                           
                              y
                              ̇
                           
                           ,
                           
                              ξ
                              3
                           
                           =
                           
                              y
                              ¨
                           
                           ,
                           
                           
                              ξ
                              4
                           
                           =
                           f
                           (
                           t
                           ,
                           y
                           ,
                           
                              y
                              ̇
                           
                           ,
                           
                              y
                              ¨
                           
                           ,
                           
                              I
                              ̇
                           
                           ,
                           
                              I
                              ¨
                           
                           ,
                           w
                           )
                        
                      and 
                        
                           ξ
                           =
                           
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              T
                           
                        
                     . Assuming f is differentiable, the augmented state space form of (9) is
                        
                           (11)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                ξ
                                                ̇
                                             
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   d
                                                
                                             
                                             ξ
                                             +
                                             
                                                
                                                   B
                                                
                                                
                                                   d
                                                
                                             
                                             I
                                             +
                                             
                                                
                                                   E
                                                
                                                
                                                   d
                                                
                                             
                                             h
                                          
                                       
                                       
                                          
                                             y
                                             =
                                             
                                                
                                                   C
                                                
                                                
                                                   d
                                                
                                             
                                             ξ
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 A
                              
                              
                                 d
                              
                           
                           =
                           
                           
                              [
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          1
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ]
                           
                           ,
                           
                           
                           
                              
                                 B
                              
                              
                                 d
                              
                           
                           =
                           
                              [
                              
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                              ]
                           
                           ,
                           
                           
                              
                                 C
                              
                              
                                 d
                              
                           
                           =
                           
                           
                              [
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              ]
                           
                           ,
                        
                      and 
                        
                           
                           
                              
                                 E
                              
                              
                                 d
                              
                           
                           =
                           
                           
                              [
                              
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          1
                                       
                                    
                                 
                              
                              ]
                           
                           .
                        
                     
                  

In contrast to Eq.(4) whose states all have physiological meaning, the states of Eq. (11) do not have direct physiological meaning except for ξ
                     1. ξ
                     1 is the difference between the aortic pressure and left ventricular pressure, ξ
                     2 is the speed of change of ξ
                     1, ξ
                     3 is the acceleration of change of ξ
                     1, ξ
                     4 is the combined effects of everything else of cardiovascular system. The introduction of ξ
                     2, 
                     ξ
                     3, 
                     ξ
                     4 is necessary for the framework of ADRC controller design, but they do not need to be monitored.

Note that 
                        
                           
                              
                                 ξ
                              
                              
                                 4
                              
                           
                           =
                           f
                           (
                           t
                           ,
                           y
                           ,
                           
                              y
                              ̇
                           
                           ,
                           
                              y
                              ¨
                           
                           ,
                           
                              I
                              ̇
                           
                           ,
                           
                              I
                              ¨
                           
                           ,
                           w
                           )
                        
                      is the augmented state and 
                        
                           h
                           =
                           
                              f
                              ̇
                           
                           (
                           t
                           ,
                           y
                           ,
                           
                              y
                              ̇
                           
                           ,
                           
                              y
                              ¨
                           
                           ,
                           
                              I
                              ̇
                           
                           ,
                           
                              I
                              ¨
                           
                           ,
                           w
                           )
                        
                      is usually unknown but bounded. The idea is that, based on (11), a state observer
                        
                           (12)
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   ̇
                                                
                                             
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ^
                                                
                                             
                                             +
                                             
                                                
                                                   B
                                                
                                                
                                                   d
                                                
                                             
                                             I
                                             +
                                             
                                                
                                                   L
                                                
                                                
                                                   d
                                                
                                             
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   ^
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   ^
                                                
                                             
                                             =
                                             
                                                
                                                   C
                                                
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   ^
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           L
                           d
                        
                        =
                        
                           
                              
                                 
                                    
                                       
                                          l
                                          1
                                       
                                    
                                    
                                       
                                          l
                                          2
                                       
                                    
                                    
                                       
                                          l
                                          3
                                       
                                       
                                       
                                          l
                                          4
                                       
                                    
                                 
                              
                           
                           T
                        
                      is the observer gain vector, is designed. The observer gains are chosen such that the characteristic polynomial 
                        
                           
                              
                                 s
                              
                              4
                           
                           +
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                           
                              
                                 s
                              
                              3
                           
                           +
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                           
                              
                                 s
                              
                              2
                           
                           +
                           
                              
                                 l
                              
                              
                                 3
                              
                           
                           
                              
                                 s
                              
                              1
                           
                           +
                           
                              
                                 l
                              
                              
                                 4
                              
                           
                        
                      is Hurwitz. For tuning simplicity, all the observer poles are placed at 
                        
                           −
                           
                              
                                 ω
                              
                              
                                 o
                              
                           
                        
                     . It results in the characteristic polynomial of (12) to be
                        
                           (13)
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       o
                                    
                                 
                                 
                                    (
                                    s
                                    )
                                 
                                 =
                                 
                                    
                                       s
                                    
                                    4
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       s
                                    
                                    3
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       s
                                    
                                    2
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       s
                                    
                                    1
                                 
                                 +
                                 
                                    
                                       l
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       s
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    4
                                 
                              
                           
                        
                     where 
                        
                           
                              ω
                           
                           
                              o
                           
                        
                      is the observer bandwidth of the ESO and 
                        
                           
                              
                                 L
                              
                              
                                 d
                              
                           
                           =
                           
                              
                                 [
                                 
                                    4
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                    
                                    ,
                                    
                                    
                                    6
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    4
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          o
                                       
                                       
                                          4
                                       
                                    
                                 
                                 ]
                              
                              T
                           
                        
                     .

Generally, the larger the observer bandwidth is, the more accurate the estimation will be. However, a large observer bandwidth will increase noise sensitivity. Therefore a proper observer bandwidth should be selected in a compromise between the tracking performance and the noise tolerance.

With a well behaved observer, the observer state 
                        
                           
                              
                                 ξ
                                 ^
                              
                           
                           
                              4
                           
                        
                      will closely track 
                        
                           
                              ξ
                           
                           
                              4
                           
                        
                     . By canceling the effect of f using 
                        
                           
                              
                                 ξ
                                 ^
                              
                           
                           
                              4
                           
                        
                     , ADRC actively compensates for f in real time. The ADRC control law is given by
                        
                           (14)
                           
                              
                                 I
                                 =
                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             r
                                             −
                                             
                                                
                                                   
                                                      ξ
                                                      ^
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                r
                                                ̇
                                             
                                             −
                                             
                                                
                                                   
                                                      ξ
                                                      ^
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             k
                                          
                                          
                                             3
                                          
                                       
                                       
                                          (
                                          
                                             
                                                r
                                                ¨
                                             
                                             −
                                             
                                                
                                                   
                                                      ξ
                                                      ^
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                ξ
                                                ^
                                             
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          r
                                          ⃛
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                              
                           
                        
                     where r is the reference signal and 
                        
                           
                              k
                           
                           
                              1
                           
                        
                     
                     
                        
                           
                              k
                           
                           
                              2
                           
                        
                      as well as 
                        
                           
                              k
                           
                           
                              3
                           
                        
                      are the controller gain parameters selected to make 
                        
                           
                              
                                 s
                              
                              3
                           
                           +
                           
                              
                                 k
                              
                              
                                 3
                              
                           
                           
                              
                                 s
                              
                              2
                           
                           +
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                              
                                 s
                              
                              1
                           
                           +
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                        
                      Hurwitz. For simplicity, let 
                        
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 ω
                              
                              
                                 c
                              
                              
                                 3
                              
                           
                        
                     , 
                        
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           =
                           3
                           
                              
                                 ω
                              
                              
                                 c
                              
                              
                                 2
                              
                           
                        
                      and 
                        
                           
                              
                                 k
                              
                              
                                 3
                              
                           
                           =
                           3
                           
                              
                                 ω
                              
                              
                                 c
                              
                           
                        
                     , where 
                        
                           
                              ω
                           
                           
                              c
                           
                        
                      is the controller bandwidth. The closed-loop system for RBP becomes
                        
                           (15)
                           
                              
                                 
                                    y
                                    ⃛
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       r
                                       −
                                       
                                          
                                             
                                                ξ
                                                ^
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          r
                                          ̇
                                       
                                       −
                                       
                                          
                                             
                                                ξ
                                                ^
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          r
                                          ¨
                                       
                                       −
                                       
                                          
                                             
                                                ξ
                                                ^
                                             
                                          
                                          
                                             3
                                          
                                       
                                    
                                    )
                                 
                                 +
                                 (
                                 f
                                 −
                                 
                                    
                                       
                                          ξ
                                          ^
                                       
                                    
                                    
                                       4
                                    
                                 
                                 )
                                 +
                                 
                                    r
                                    ⃛
                                 
                                 .
                              
                           
                        
                     
                  

In (15), the term 
                        
                           (
                           f
                           −
                           
                              
                                 
                                    ξ
                                    ^
                                 
                              
                              
                                 4
                              
                           
                           )
                        
                      is almost negligible for the well-designed ESO and 
                        
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 r
                                 −
                                 
                                    
                                       
                                          ξ
                                          ^
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                              )
                           
                           +
                           
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    r
                                    ̇
                                 
                                 −
                                 
                                    
                                       
                                          ξ
                                          ^
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                              )
                           
                           +
                           
                              
                                 k
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    r
                                    ¨
                                 
                                 −
                                 
                                    
                                       
                                          ξ
                                          ^
                                       
                                    
                                    
                                       3
                                    
                                 
                              
                              )
                           
                           +
                           (
                           f
                           −
                           
                              
                                 
                                    ξ
                                    ^
                                 
                              
                              
                                 4
                              
                           
                           )
                           +
                           
                              r
                              ⃛
                           
                        
                      represents a PD controller with a feedforward term.

In practice, the controller bandwidth, 
                        
                           
                              ω
                           
                           
                              c
                           
                        
                     , is tuned based on how fast and steady we want the output to track the set point. A large controller bandwidth generally increases the response speed but it may push the system to its limit, leading to oscillations or even instability. Thus the controller bandwidth should be adjusted based on the competing requirements of performance and stability margin, together with noise sensitivity. In addition, a large controller bandwidth usually increases the magnitude and rate of change in control signal, and therefore the operation cost. The observer is tuned in a similar way: adjusting its bandwidth, 
                        
                           
                              ω
                           
                           
                              o
                           
                        
                     , for a tradeoff between tracking performance and noise sensitivity. For the RBP controller, 
                        
                           
                              ω
                           
                           
                              c
                           
                        
                      does not need to be high because the human circulation system responding speed is low.

The primary reason for this particular parameterization and tuning method is practicality: the observer and feedback gains must be easily tunable by most engineers, who are usually familiar with the concept and implications of bandwidth. It is advantageous that engineers could use a completely new design method without losing the critical insight gained from classical control: frequency response.

The convergence for the estimation error of the ESO and the closed-loop tracking error of ADRC is shown in [20,21].

@&#RESULTS AND DISCUSSION@&#


                     
                     
                     Figs. 5 and 6 show the simulation results of adaptive controller and ADRC in rest condition, when the heart rate and the total peripheral resistance were constant. It is worth pointing out that the nominal plant case does not imply the plant without disturbance or noise. It represents the cardiovascular system in a fixed physiological state. In this nominal plant, the disturbance caused by the natural heart still presents, at the fixed heart rate of 80 beats per minute. The simulation results with noise represent the cases when there is white measurement noise of the feedback signal ΔP up to ±5% of the actual value. The change of Emax represents the cases when the natural heart’s strength increases or decreases by 60% of its nominal value from 20s to 40s following a ramp function. The ADRC tuning parameters are: 
                        
                           ω
                           o
                        
                        =
                        10
                        
                        r
                        a
                        d
                        /
                        s
                        ,
                        
                        
                           ω
                           c
                        
                        =
                        1
                        
                        
                        r
                        a
                        d
                        /
                        s
                        .
                     The adaptive controller tuning parameters are: γ=5, S/R=100:1, desired poles for the observer are [−12.6;−12.6;−99.5]. Both controllers were switched on from a constant current when t=10s, thus only the response after 10s is of interest. Only the aortic pressure (P
                     
                        A
                     ) and TPF (total peripheral flow) of the system with 60% decrease of the contractility were shown in Figs. 5 and 6 for the purpose of clarity. TPF is the the summation of pump flow and aortic flow. P
                     
                        A
                      and TPF for nominal plant without noise from 0 to 20s are the same as the respective trajectories in Figs. 5 and 6. From 20s to 60s, the trajectories of P
                     
                        A
                      and TPF for nominal plant without noise are the repetition of their respective trajectory in Figs. 5 and 6 between 15s and 20s. The P
                     
                        A
                      and TPF trajectories with measurement noise are very close to their trajectories without noise. The numerical values of those variables are also summarized in 
                     Table 1.

As indicated in Table 1, in terms of the physiological variables, the aortic pressure P
                     
                        A
                      and TPF (total peripheral flow), the performance of ADRC and adaptive controller are almost identical except in the transition period. The maximal tracking error of ADRC in the transition period when Emax change is slightly larger. In reality, the change of natural heart strength occurs in months, or even years, much slower than the simulated scenario. So this slight difference between the two controllers is negligible. Note that the ADRC tuning parameters remain the same for all cases in Fig. 5. The tuning parameters of adaptive control also remain the same for all cases in Fig. 6. The above simulation results demonstrate excellent disturbance rejection ability and robustness performance of ADRC and adaptive controller in rest condition.


                     
                     
                     Figs. 7 and 8 show the simulation results of adaptive controller and ADRC in exercise condition. The numerical values of simulation results are also included in Table 1. The exercise was introduced at t=60s. From 60s to 80s, the heart rate increase linearly by 33% of the heart rate in rest condition (i.e. 80 beats per minute). The contractility of heart increases linearly by 20% of its rest value. TPR is decreased by 25% of its rest value. Those parameters were varied to simulate the light exercise, like walking. Compared to the rest condition, there is also an additional disturbance introduced to the simulation by the muscle pump effect, i.e., δ
                     
                        m
                      in Eq. (4), generated by the working muscle during exercise. This effect can contribute up to 10% of variation of cardiac output [2].

The tuning parameters of ADRC in Fig. 7 remain the same as those in Fig. 5. The tuning parameters of adaptive controller in Fig. 8 remain the same as those for Fig. 6. As demonstrated in Table 1, ADRC and adaptive controller demonstrate identical response except in the transition period from the rest to the exercise. The maximal tracking error of ADRC during transition period is slightly larger. Since the transition from rest to mild exercise for heart failure patients is unlikely to finish within the short time of 20s as the simulation study, this slight difference between the two controllers is unlikely to be significant. The above simulation results demonstrate excellent disturbance rejection ability and robustness performance of ADRC and adaptive controller in exercise condition.

@&#CONCLUSION@&#

In this paper, ADRC and adaptive controller are presented for a case study on artificial blood pump. The simulation results demonstrate that both ADRC and the adaptive control have excellent disturbance rejection ability and robustness. The ADRC performance is comparable to that of the adaptive controller, while saving the modeling effort. In addition, ADRC controller is implemented with only two tuning parameters: controller bandwidth and observer bandwidth, easily tunable by most engineers. Thus it is simpler to tune in clinical applications than other model-free controller with more parameters [31,32]. Last but not least, the implementation of ADRC requires no intense computation involved in the solution of Riccati equation and inverse of matrix required in adaptive controller. The unique benefit of adaptive controller is not in the control performance but in the estimation of states with real physiological meaning. Those state estimations may be useful for medical purposes. In summary, the simulation studies demonstrate that ADRC is a valuable tool for the design of physiological controller for RBP if estimating states with physiological meaning is of little importance. The reference value for mean aortic pressure in this study was kept constant. In reality, the blood pressure of a healthy person is different in different scenarios, such as sleep, or exercise. The updating of this reference value needs to be investigated further.

None declared.

Elements in Fig. 1. 
                     C
                     
                        LV
                     : capacitance of left ventricle; C
                     
                        RV
                     : capacitance of right ventricle; C
                     2: capacitance of aorta; C
                     3: capacitance of systemic artery; C
                     
                        O
                     : capacitance of vein for the non-muscular organs; C
                     
                        m
                     : capacitance of muscle vein; C
                     4: capacitance of central vein; C
                     6: capacitance of pulmonary artery; C
                     7: capacitance of pulmonary vein/left atrium; R
                     
                        AV
                     : resistance of aortic valve; R
                     
                        9
                     : resistance of peripheral vessels; R
                     
                        m_1
                     : skeletal muscle vascular resistance; R
                     
                        m_2
                     : skeletal muscle venous resistance; R
                     
                        O_1
                     : vascular resistance of non-muscular organs; RO_2
                     : venous resistance of non-muscular organs; R
                     11: resistance of systemic vein and right atrium; R
                     12: resistance of pulmonary great artery; L
                     9: inductance of blood in peripheral circulation; L
                     13: inductance of blood in pulmonary circulation; R
                     13: pulmonary vascular resistance; R
                     14: resistance of pulmonary vein and left atrium; D1: aortic valve; D
                     11: tricuspid valve; D
                     12: pulmonary valve; D
                     2: Mitral valve; Dm_1
                     , Dm_2
                     : venous valve on skeletal muscle; DO_1
                     , DO_2
                     : venous valve on non-muscular organs; TPF: total peripheral flow; Qm_1
                     : muscle vascular flow rate; Qm_2
                     : muscle venous flow rate. PLV: left ventricular pressure; P
                     2: aortic pressure; P
                     3: systemic arterial pressure; P
                     
                        O
                     : pressure of vein for the non-muscular organs; Pm
                     : pressure of muscle vein; P
                     4: central venous pressure; P
                     6: pulmonary arterial pressure; P
                     7: pulmonary venous pressure; P
                     
                        RV
                     :right ventricular pressure.

@&#REFERENCES@&#

