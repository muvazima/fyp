@&#MAIN-TITLE@&#Impact analysis of maritime cabotage legislations on liner hub-and-spoke shipping network design

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Consider maritime cabotage constraints and transit time constraints.


                        
                        
                           
                           Ship route design as a vehicle routing problem with pickup and delivery.


                        
                        
                           
                           Present a Lagrangian relaxation based solution method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Combinatorial optimization

Liner shipping

Hub-and-spoke

Maritime cabotage legislations

@&#ABSTRACT@&#


               
               
                  Maritime cabotage is a legislation published by a particular coastal country, which is used to conduct the cargo transportation between its two domestic ports. This paper proposes a two-phase mathematical programming model to formulate the liner hub-and-spoke shipping network design problem subject to the maritime cabotage legislations, i.e., the hub location and feeder allocation problem for phase I and the ship route design with ship fleet deployment problem for phase II. The problem in phase I is formulated as a mixed-integer linear programming model. By developing a hub port expanding technique, the problem in phase II is formulated as a vehicle routing problem with pickup and delivery. A Lagrangian relaxation based solution method is proposed to solve it. Numerical implementations based on the Asia–Europe–Oceania shipping services are carried out to account for the impact analysis of the maritime cabotage legislations on liner hub-and-spoke shipping network design problem.
               
            

@&#INTRODUCTION@&#

In International Law, “Cabotage” is identified with coasting – trade so that is means navigating and traveling along the coast between the ports thereof (Igbokwe, 2001). Cabotage has however come to be known as “coastal trade” or “coasting trade” or “coastwise shipping”, meaning carriage of goods and persons by ships between ports on or along the same coast or between ports within the same country and the exclusive rights of a country to operate sea traffic within its coasts, or to operate air traffic, road traffic or rail traffic within its territory (Igbokwe, 2001). In this regard, there is cabotage in different modes of transportation. This paper is concerned with the maritime cabotage.

A maritime cabotage law is a legislation published by a particular coastal country, to exclusively conduct its domestic shipping operations. The strict and relaxed maritime cabotage legislations (Igbokwe, 2001) have been used by different coastal countries in order to favor the national interests and to control local coastal trades. In the former legislation of a coastal country, the domestic shipping is strictly restricted to those ships built, owned and operated by citizens of this country. The latter one relaxed one or some of the above three restrictions. One example for the strict maritime cabotage legislation is known as “the Jones Act” (Whitehurst, 1985) implemented in the United States (US). The relaxed maritime cabotage legislations are applied in coastal countries, such as India, Philippines, Australia, and Malaysia.

In order to benefit from the economies of scale in ship size, large ships are deployed by liner shipping companies to serve the major or hub ports and small ships are used to consolidate cargoes (e.g., containers) from some feeder ports, leading to a hub-and-spoke (H& S) shipping manner. For example, Maersk line, which is the world’s largest liner shipping company, ordered 10 mega ships with the capacity of 18,000 twenty-foot equivalent units (TEUs) each in 2011 and these mega ships will be deployed on the Asia–Europe trade lane. Furthermore, the liner shipping company provides the maximal transit time between a pair of ports on the website as an important factor to evaluate the level of service, called the transit time constraints. The purpose of this study is to quantify the impact of the strict maritime cabotage legislation on a liner shipping company in designing its H& S shipping network subject to the transit time constraints by developing a proper mathematical model and a solution method.

@&#LITERATURE REVIEW@&#

Different maritime cabotage legislations have been implemented in different coastal countries, and there are a number of studies for its qualitative impact on maritime industry and economy of the coastal country. Aspinwall (1987) analyzed the impact of American cabotage law on the outer continental shelf operations. Francois, Arce, Reinert, and Flynn (1996) explored the effects of the Jones Act on welfare and on production, trade, and employment in important upstream and downstream sectors. Recently, Mak, Sheehey, and Toriki (2010) discussed the application of Passenger Vessel Services Act (PVSA) of 1886 to the US cruise ship industry. The PVSA is also a maritime cabotage law, which attempts to shield US maritime shipping from foreign competition. Cavana (1994) provided a brief review of the costal shipping industry in New Zealand and an overview of international cabotage laws. Later, Cavana (2004) discussed a qualitative analysis of reintroducing maritime cabotage legislation onto New Zealand’s coasts. The main conclusion drawn from the stakeholder analysis was that to reintroduce the maritime cabotage legislation onto New Zealand’s coast would appear to have an overall net negative impact on the New Zealand economy. This is mainly because: (i) maritime cabotage would result in increased domestic and international freight rates, reduction in competition and choice of transport services, job losses in the manufacturing and agricultural sectors, and loss of exports; (ii) there would be an overall increase in fuel usage and adverse effects on the environment since the international vessels were currently moving along the coast. Hohlfelder and Vann (2000) investigated the maritime cabotage legislation at Aperlae in ancient Lycia based on observations arising from the continuing survey of Aperlae. They concluded that the maritime cabotage legislation is the secondary port’s enduring lifeline. Similar to the maritime cabotage, Zou (2002) investigated the navigation of foreign vessels within Chinese jurisdictional waters. Giannopoulos and Aifandopoulou-Klimis (2004) gave a comprehensive review of the inland maritime transport system of Greece before the application of full liberalization in the provision of transport services and the lifting of maritime cabotage restrictions that existed until 2002. Very recently, Lazarus and Ukpere (2011) studied the maritime cabotage legislation, Cabotage Act of 2003, which came into force in 2004 and aimed at reserving the coastal shipping for Nigeria nationals.

There have been many studies on the network design of H& S operations in the literature. O’Kelly (1987) proposed the first recognized mathematical formulation given as a quadratic integer programming problem. Later, Campbell (1992, 1994) presented linear integer programming models for single and multiple allocation, respectively. Moreover, there are also many extended models for the H& S network design problem, such as Skorin-Kapov, Skorin-Kapov, and O’Kelly (1996), O’Kelly, Bryan, Skorin-Kapov, and Skorin-Kapov (1996), Ernst and Krishnamoorthy (1996), Sohn and Park (1998), Ebery (2001), Alumur, Kara, and Karasan (2009). For more studies, please refer to a review paper by Alumur and Kara (2008) and the references therein.

There are also many works on the H& S network design in liner shipping. Fagerholt (1999, 2004), Sambracos, Paravantis, Tarantilis, and Kiranoudis (2004), Karlaftis, Kepaptsoglou, and Sambracos (2009) focused on investigating a feeder ship route design problem, which can be formulated as a vehicle routing problem (VRP). Given two hub ports located at two regions, Imai, Nishimura, Papadimitriou, and Liu (2006, 2009) studied the H& S operations and multi-port-calling (MPC) operations. Based on a set of candidate ship routes, Meng and Wang (2011) formulated the liner shipping network design problem with combined H& S and MPC operations as a mixed-integer linear programming model, which can be efficiently solved by CPLEX. Recently, Gelareh, Nickel, and Pisinger (2010) investigated the liner H& S shipping network design problem under a competitive situation. Later, Gelareh and Pisinger (2011) introduced the ship fleet deployment into the liner H& S network design problem, where the discount of transportation cost is assumed to be dependent on the size of the deployed ship. Different from H& S network design, many studies have been carried out for ship routing and scheduling problems in liner shipping, please refer to some review papers such as Christiansen, Fagerholt, and Ronen (2004, 2013) and Meng, Wang, Andersson, and Thun (2013), and the references therein.

This paper quantifies the impact of maritime cabotage legislations on a liner shipping company in designing its H& S shipping network. It proposes a two-phase mathematical programming model for the liner H& S shipping network design problem subject to the maritime cabotage legislations and transit time constraints. The first phase determines the hub port location and feeder port allocation subject to the maritime cabotage legislations, by solving a mixed-integer linear programming model. The second phase designs main and feeder ship routes with ship fleet deployment subject to the transit time constraints, which is formulated as a vehicle routing problem with pickup and delivery (VRPPD). A Lagrangian relaxation based solution method is proposed to solve it.

The contributions of this paper are threefold. Firstly, a more practical liner H& S shipping network design problem subject to the maritime cabotage legislations is proposed. Secondly, a two-phase mathematical programming model is built for the proposed problem. Thirdly, an efficient solution method is developed to solve our problem.

The rest of this paper is organized as follows. Section 2 gives the notation and problem description. Section 3 proposes a two-phase mathematical programming model. Section 4 provides a Lagrangian relaxation based solution method. Section 5 carries out the numerical experiments based on Asia–Europe–Oceania shipping service. Finally, a summary is given in Section 6.

To incorporate maritime cabotage legislations, we assume that ships considered in this paper are built, owned and operated by citizens of a country a. We will implement different scenarios by considering different a. Let 
                           
                              P
                           
                         represent the set of ports, which can be further classified into two disjoint subsets: the set of hub ports denoted by 
                           
                              
                                 
                                    P
                                 
                                 
                                    H
                                 
                              
                           
                         and the set of feeder ports denoted by 
                           
                              
                                 
                                    P
                                 
                                 
                                    F
                                 
                              
                           
                        . The maritime cabotage legislations in liner H& S shipping network design can be simply described by introducing an indicator 
                           
                              
                                 
                                    δ
                                 
                                 
                                    ij
                                 
                                 
                                    a
                                 
                              
                           
                         for each pair of port i and port j (
                           
                              ∀
                              i
                              ,
                              j
                              ∈
                              P
                           
                        ). If ships of country a are allowed to directly transport containers from port i to port 
                           
                              j
                              ,
                              
                                 
                                    δ
                                 
                                 
                                    ij
                                 
                                 
                                    a
                                 
                              
                           
                         is equal to 1; otherwise 
                           
                              
                                 
                                    δ
                                 
                                 
                                    ij
                                 
                                 
                                    a
                                 
                              
                           
                         is 0. Let 
                           δ
                        
                        
                           a
                         denote the set of 
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ij
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                              
                              (
                              ∀
                              i
                              ,
                              j
                              ∈
                              P
                              )
                           
                        .

In order to take the maritime cabotage legislations of the different coastal countries into account, this paper assumes that China and Japan published the strict maritime cabotage legislations. We further assume that two liner shipping companies, i.e., COSCO in China and APL in Singapore will provide the shipping services, respectively. Due to the Japanese maritime cabotage legislation, COSCO cannot provide the direct shipping services among the ports in Japan. As for APL, both Chinese and Japanese maritime cabotage legislations will function for their local ports, respectively.

Generally, the liner shipping company publishes the regular shipping services among a group of ports. Each shipping service can be described as the port calling sequence by a ship, which is referred to as a ship route. Let 
                           
                              R
                           
                         denote the set of all feasible ship routes. Let 
                           
                              V
                           
                         denote the set of all available ships. Since not all ships can be deployed on a particular ship route due to some physical barriers (e.g., the restricted port draft), let 
                           
                              
                                 
                                    V
                                 
                                 
                                    r
                                 
                              
                              ⊆
                              V
                           
                         be the set of ships available for serving the ship route 
                           
                              r
                              ∈
                              R
                           
                        . From the practical point of view, we assume that each ship route maintains a weekly service.

The port calling sequence for a particular ship route 
                           
                              r
                              ∈
                              R
                           
                         can be described as the port rotation, shown below:
                           
                              (1)
                              
                                 
                                    
                                       p
                                    
                                    
                                       r
                                       1
                                    
                                 
                                 →
                                 
                                    
                                       p
                                    
                                    
                                       r
                                       2
                                    
                                 
                                 →
                                 ⋯
                                 →
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             rN
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 →
                                 
                                    
                                       p
                                    
                                    
                                       r
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             r
                                          
                                       
                                       +
                                       1
                                       )
                                    
                                 
                                 ≔
                                 
                                    
                                       p
                                    
                                    
                                       r
                                       1
                                    
                                 
                              
                           
                        where N
                        
                           r
                        
                        +1 is the number of ports to be called on ship route 
                           
                              r
                              ∈
                              R
                           
                        . Clearly, any ship route forms a loop. Any two consecutive ports on a ship route are referred to as a leg.

Liner H& S shipping network leads to two types of ship routes, i.e., main ship route and feeder ship route. The main ship route calls at some hub ports. Any hub port can be called by different main ship routes, and it can also be called by a main ship route for more than one time. A feeder ship route starts from a hub port and calls at some of its associated feeder ports and finally returns to this hub port.

For a particular ship route 
                           
                              r
                              ∈
                              R
                           
                         deployed by ship 
                           
                              v
                              (
                              ∀
                              v
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    r
                                 
                              
                              )
                           
                        , the round-trip time mainly includes two terms: sailing time for ship v at sea and berthing time for ship v at each port called by this ship route. Let s
                        
                           v
                         denote the speed for ship v when sailing at sea. Let γ
                        
                           iv
                         be the number of containers can be handled per hour for ship v at port i, which is called port productivity in liner shipping industry. The berthing time for ship v at port i is equal to the number of containers to be handled at port i divided by γ
                        
                           iv
                        .

The total weekly operating cost for a ship route 
                           
                              r
                              ∈
                              R
                           
                         deployed by ship 
                           
                              v
                              (
                              ∀
                              v
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    r
                                 
                              
                              )
                           
                         mainly consists of the following four terms: fixed weekly operating cost, bunker cost when sailing at sea, berthing charge at each port called by this ship route, and container handling cost at each called port. Let 
                           
                              
                                 
                                    c
                                 
                                 
                                    v
                                 
                                 
                                    fix
                                 
                              
                           
                         denote the fixed weekly operating cost for ship v, which comprises the ship maintenance cost, crew payment and insurance cost, but does not include the bunker cost. Let 
                           
                              
                                 
                                    c
                                 
                                 
                                    v
                                 
                                 
                                    bunker
                                 
                              
                           
                         be the bunker cost per hour for ship v when sailing at sea. The bunker cost for ship v is equal to the sailing time at sea multiplied by 
                           
                              
                                 
                                    c
                                 
                                 
                                    v
                                 
                                 
                                    bunker
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    c
                                 
                                 
                                    iv
                                 
                                 
                                    berth
                                 
                              
                           
                         represent the berth charge per hour for ship v when berthing at port i. The berthing charge for ship v at port i is equal to the berth time at this port multiplied by 
                           
                              
                                 
                                    c
                                 
                                 
                                    iv
                                 
                                 
                                    berth
                                 
                              
                           
                        . Let 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    handle
                                 
                              
                           
                         be the container handling cost for loading or discharging one TEU at port i. The container handling cost for ship v at port i is equal to the number of containers to be handled at this port multiplied by 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    handle
                                 
                              
                           
                        .

Let 
                           
                              W
                              =
                              {
                              (
                              o
                              ,
                              d
                              )
                              |
                              o
                              ∈
                              P
                              ,
                              d
                              ∈
                              P
                              }
                           
                         be the set of origin–destination (OD) port pairs with container demand, and q
                        
                           od
                         be the weekly number of containers to be transported for the OD port pair 
                           
                              ∀
                              (
                              o
                              ,
                              d
                              )
                              ∈
                              W
                           
                         over a seasonal planning horizon. A route used to transport containers from the origin port to the destination port is referred to as a container route. A container route may be associated with a few ship routes in terms of the transshipment operations at the hub ports. This paper assumes that the containers between any two ports cannot be transshipped for more than two times and no transshipment is allowed for containers between any two hub ports. This is a typical and practical assumption made in the H& S network design studies (e.g., Alumur & Kara, 2008; Meng & Wang, 2011).

Transit time for a particular container route is the total time spent for transporting containers from the origin port to the destination port along this container route. For each OD port pair, every liner shipping company will publish the maximum transit time on the website (e.g., http://www.apl.com; http://www.maerskline.com/appmanager/). This maximum transit time for each OD port pair published by a particular liner shipping company cannot be very large, otherwise the shippers will choose other liner shipping companies. Let T
                        
                           ij
                         denote the maximum transit time allowed for transporting containers from port i to port j 
                        
                           
                              (
                              ∀
                              i
                              ,
                              j
                              ∈
                              P
                              )
                           
                        , provided by the liner shipping company.

In order for distinguishing different container routes, following Meng and Wang (2011), the concept of segment is adopted, called the segment-based container route. A pair of ordered ports on the same ship route is defined as a segment. Assume that two feeder ports i and 
                           
                              j
                              (
                              ∀
                              i
                              ,
                              j
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    F
                                 
                              
                              )
                           
                         are allocated to two different hub ports denoted by ϕ(i) and ϕ(j), respectively. Then the segment-based container route from feeder port i to feeder port j can be described as follows:
                           
                              (2)
                              
                                 {
                                 <
                                 i
                                 ,
                                 ϕ
                                 (
                                 i
                                 )
                                 >
                                 +
                                 <
                                 ϕ
                                 (
                                 i
                                 )
                                 ,
                                 ϕ
                                 (
                                 j
                                 )
                                 >
                                 +
                                 <
                                 ϕ
                                 (
                                 j
                                 )
                                 ,
                                 j
                                 >
                                 }
                              
                           
                        
                     

The segment-based container route can also be simply rewritten as {<i,
                        ϕ(i),
                        ϕ(j),
                        j>}, which is similar to the four dimensional decision variable z
                        
                           ijkm
                         in the hub location and feeder allocation problem. Let S denote the set of segment-based container routes for all OD port pairs.

This paper aims to propose a methodology (model and algorithm) that can quantitatively evaluate the impact of the maritime cabotage legislations on liner H& S shipping network design problem, which is an NP hard problem (Fagerholt, 1999, 2004; Karlaftis et al., 2009; Sambracos et al., 2004). It is indeed a challenge to develop a model for our problem that can be solved exactly. In this section, a two-phase mathematical programming model is proposed: we determine the hub location and feeder allocation in phase I and design main and feeder ship routes in phase II. Note that the phase I must be solved before the phase II, as the results obtained in phase I are regarded as input for phase II.

The decision variables for the two-phase mathematical programming model are as follows:
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Z
                                          
                                             ij
                                          
                                       
                                       equals 1 if feeder port i is allocated to hub port j, and 0 otherwise. Z
                                          
                                             ii
                                           equals 1 if the port i is selected to be a hub port, and 0 otherwise.
                                    
                                    
                                       
                                          z
                                          
                                             ijkm
                                          
                                       
                                       fraction of the container demand from port i to port j that is routed via the first hub port k and then hub port m, leading to a segment-based container route {<i,
                                          k,
                                          m,
                                          j>}.
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                       equals 1 if arc (i,j) is used by ship v, and 0 otherwise.
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      iv
                                                   
                                                
                                             
                                          
                                       
                                       the number of containers on ship v after container handling operations at port i have been completed, i.e., leg flow.
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                       
                                       the time spent for transporting containers from port i to port j.
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                       the number of ships v to be deployed in order to maintain weekly service frequency of the ship route served by ship v.
                                    
                                 
                              
                           
                        
                     

In order to formulate the hub location and feeder allocation problem, let 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    ik
                                 
                              
                           
                         denote the transportation cost for shipping one TEU container from port i to port k, which is regarded as the parameter of the hub location and feeder allocation model. Generally, the transportation cost could be estimated from historical operating data. For simplicity, this paper assumes that the transportation cost is proportional to the travel distance, since the bunker cost proportional to the travel distance is a major component of the ship’s operating cost.

Given a coastal country a and the set 
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             ij
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                              
                              (
                              ∀
                              i
                              ,
                              j
                              ∈
                              P
                              )
                           
                         for the maritime cabotage legislations, the hub location and feeder allocation problem can be formulated as follows:
                           
                              (3)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijkm
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ik
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       km
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       mj
                                    
                                 
                                 )
                              
                           
                        subject to
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijkm
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ∈
                                 P
                                 
                                 and
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ij
                                    
                                 
                                 >
                                 0
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       ik
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ijkm
                                    
                                 
                                 ⩽
                                 
                                    
                                       Z
                                    
                                    
                                       kk
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 m
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       z
                                    
                                    
                                       ijkm
                                    
                                 
                                 ⩽
                                 
                                    
                                       Z
                                    
                                    
                                       mm
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 m
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijkm
                                    
                                 
                                 =
                                 
                                    
                                       Z
                                    
                                    
                                       ik
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijkm
                                    
                                 
                                 =
                                 
                                    
                                       Z
                                    
                                    
                                       jm
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ,
                                 m
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ik
                                    
                                 
                                 ⩽
                                 
                                    
                                       δ
                                    
                                    
                                       ik
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 k
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (11)
                              
                                 0
                                 ⩽
                                 
                                    
                                       z
                                    
                                    
                                       ijkm
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 m
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ik
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 k
                                 ∈
                                 P
                              
                           
                        where λ is a discount factor. The objective function (3) aims to minimize the total cost for transporting all containers from their origins to their destinations. Constraints (4) ensure that the container flow for each OD port pair is routed via hub ports. Constraints (5) state that each port has to be allocated to only one hub port, i.e., single allocation is considered in this paper. Constraints (6) and (7) mean that the container flow for each OD port pair can only be routed via the site where the hub port is opened. Constraints (8) assure that for every destination j, the container flow from the origin i to the destination j routed via all paths using the segment <i,
                        k> will be nonzero only if port i is allocated to hub port k. Similarly, constraints (9) assure that for every origin i, the container flow from the origin i to the destination j routed via all paths using the segment <m,
                        j> will be nonzero only if port j is allocated to hub port m. Constraints (10) are the maritime cabotage legislations. Constraints (11) and (12) denote z
                        
                           ijkm
                         and Z
                        
                           ik
                         as a fraction variable and a binary variable, respectively.

After solving the phase I, which is the hub location and feeder allocation model, the set of hubs, assignment of feeder ports and the set of the segment-based container routes are determined. These results obtained in phase I are used as input for phase II, which aims to design main and feeder ship routes.

The transit time constraints are very practical for designing ship routes. Most existing studies on liner shipping network design (e.g., Fagerholt, 1999, 2004; Imai et al., 2006, 2009; Karlaftis et al., 2009; Meng & Wang, 2011; Sambracos et al., 2004) do not consider transit time constraints. As a result, the designed shipping network may not be applicable, since the transit time of cargo is so long that customers would seek for shipping services provided by other companies. Furthermore, liner shipping network design problem with transit time constraints is difficult to address because of the coupling constraints on transit time.

When the transit time constraints are relaxed, the ship route design with ship fleet deployment (SRDSFD) in phase II can be decomposed into 
                           
                              |
                              
                                 
                                    P
                                 
                                 
                                    H
                                 
                              
                              |
                              +
                              1
                           
                         sub-problems, where 
                           
                              |
                              
                                 
                                    P
                                 
                                 
                                    H
                                 
                              
                              |
                           
                         denotes the number of hub ports. The 
                           
                              |
                              
                                 
                                    P
                                 
                                 
                                    H
                                 
                              
                              |
                           
                         sub-problems aim to design feeder ship routes and one sub-problem is for designing main ship routes.

In order to clearly calculate the time spent on different segments for each segment-based container route, we introduce 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                           
                         associated with ship v and port i. When port i is called by ship v, let 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                           
                         be the time spent before ship v calls at port i, i.e., the arrival time at a port. When port i is not visited by ship 
                           
                              v
                              ,
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                           
                         is assumed to be 0 and let 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                           
                         be the total time spent by ship v for serving all called ports. As shown later, 
                           
                              {
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    iv
                                 
                              
                              }
                           
                         (
                           
                              ∀
                              
                              i
                              ∈
                              P
                              ,
                              ∀
                              v
                              ∈
                              V
                           
                        ) are mainly used to determine the time spent for transporting containers between any feeder port and its associated hub port.

For each hub port 
                              
                                 k
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       H
                                    
                                 
                              
                           , we introduce two dummy hub ports denoted as 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                              
                           , which are regarded as the origin and destination of ships, respectively. Let 
                              
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       F
                                    
                                 
                              
                            denote the set of feeder ports allocated to hub port k. We assume that each feeder port in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       F
                                    
                                 
                              
                            can be served only once when designing feeder ship routes for a single SRDSFD sub-problem. This is a reasonable assumption from the practical point of view. Let 
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                            represent the number of containers picked up from and delivered to the port 
                              
                                 i
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       F
                                    
                                 
                                 ∪
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 ∪
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           , respectively. Before providing the SRDSFD sub-problem for feeder ship route design formulation, we show the cost 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       v
                                    
                                 
                              
                            for ship v traversing leg (i,
                           j), calculated as follows:
                              
                                 (13)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ij
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Dis
                                             
                                             
                                                ij
                                             
                                          
                                          ·
                                          
                                             
                                                c
                                             
                                             
                                                v
                                             
                                             
                                                bunker
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   iv
                                                
                                                
                                                   berth
                                                
                                             
                                             ·
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  iv
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             (
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                                
                                                   handle
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   jv
                                                
                                                
                                                   berth
                                                
                                             
                                             ·
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  jv
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                                
                                                   handle
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where Dis
                           
                              ij
                            is the distance between port i and port j, and s
                           
                              v
                            is the sailing speed for ship v. The cost 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                    
                                       v
                                    
                                 
                              
                            comprises three terms: the first term is the bunker cost for passing through this leg; the second and third term is the half of the berthing charge and the container handling cost at port i and port j, respectively.

Different from the feeder ports allocated to hub port k, the total containers picked up from and delivered to hub port k by a ship v depends on which feeder ports are called by this ship. This means that the Eq. (13) cannot be predetermined for the legs connecting to hub port k. As a result, our problem here becomes a nonlinear programming problem. In order to linearize our problem, we can assume that the fictitious pickup and delivery demands for the two dummy hub ports are zero, i.e., 
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                                 
                                    
                                       
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           . When a ship v is berthing at hub port k for picking up or delivering containers, the berthing charge and container handling cost should be additionally calculated
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          v
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   kv
                                                
                                                
                                                   berth
                                                
                                             
                                             ·
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  kv
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   k
                                                
                                                
                                                   handle
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The number of containers picked up from and delivered to hub port k by a ship v can be determined in terms of two leg flows (i.e., 
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       v
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             2
                                          
                                          
                                             k
                                          
                                       
                                       v
                                    
                                 
                              
                           ) as follows:
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          v
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ·
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                          v
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ·
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                        

Then the 
                              
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       H
                                    
                                 
                                 |
                              
                            SRDSFD sub-problems for feeder ship route design can be formulated as follows:
                              
                                 (17)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   v
                                                
                                                
                                                   fix
                                                
                                             
                                             ·
                                             
                                                
                                                   n
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   H
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                             ·
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   H
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          v
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   kv
                                                
                                                
                                                   berth
                                                
                                             
                                             ·
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  kv
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   k
                                                
                                                
                                                   handle
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           subject to
                              
                                 (18)
                                 
                                    
                                       
                                          
                                          
                                             
                                                (
                                                15
                                                )
                                                
                                                and
                                                
                                                (
                                                16
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               F
                                                            
                                                         
                                                         ∪
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              h
                                                                           
                                                                           
                                                                              ̃
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         v
                                                         ∈
                                                         V
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      v
                                                   
                                                
                                                =
                                                1
                                                ,
                                                
                                                ∀
                                                
                                                j
                                                ∈
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      F
                                                   
                                                
                                                ,
                                                
                                                ∀
                                                
                                                k
                                                ∈
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      H
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          i
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          im
                                       
                                       
                                          v
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          mj
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    m
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          v
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          v
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    +
                                    
                                       
                                          Dis
                                       
                                       
                                          ij
                                       
                                    
                                    /
                                    
                                       
                                          s
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    /
                                    
                                       
                                          γ
                                       
                                       
                                          iv
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          jv
                                       
                                    
                                    +
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    +
                                    
                                       
                                          Dis
                                       
                                       
                                          ij
                                       
                                    
                                    /
                                    
                                       
                                          s
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    /
                                    
                                       
                                          γ
                                       
                                       
                                          iv
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          jv
                                       
                                    
                                    -
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    +
                                    
                                       
                                          Dis
                                       
                                       
                                          ij
                                       
                                    
                                    /
                                    
                                       
                                          s
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    /
                                    
                                       
                                          γ
                                       
                                       
                                          iv
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jv
                                       
                                    
                                    +
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    +
                                    
                                       
                                          Dis
                                       
                                       
                                          ij
                                       
                                    
                                    /
                                    
                                       
                                          s
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    /
                                    
                                       
                                          γ
                                       
                                       
                                          iv
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          jv
                                       
                                    
                                    -
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                          v
                                       
                                    
                                    -
                                    M
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            F
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (30)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                          v
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩽
                                    M
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            F
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ij
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                2
                                             
                                             
                                                k
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                    ·
                                    168
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          jv
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    +
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   ji
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (34)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          jv
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    -
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   ji
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    j
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (35)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩽
                                    M
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ∀
                                                      j
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            F
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   ji
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (36)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩽
                                    
                                       
                                          Cap
                                       
                                       
                                          v
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (37)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ∼
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (39)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (40)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          v
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ,
                                    j
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          k
                                       
                                    
                                    }
                                    ∪
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (41)
                                 
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                    ∈
                                    
                                       
                                          Z
                                       
                                       
                                          +
                                       
                                    
                                    ∪
                                    {
                                    0
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           where M is a big number. The objective function (17) minimizes the total operating cost, which comprises: (i) the fixed weekly operating cost, (ii) the transportation cost, and (iii) the berthing charge and container handling cost at each hub port. Our problem here becomes a conventional VRPPD if the fixed weekly operating cost for each ship is split into all used legs. Constraints (18) and (19) ensure that every feeder port in a single SRDSFD sub-problem is served by exactly one ship. Constraints (20) and (21) mean that every ship starts from the dummy hub port 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                              
                            and ends at the dummy hub port 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       k
                                    
                                 
                              
                           . Constraints (22) are the flow conservation constraints. Constraints (23) and (24) state that the initial time before each ship starting from the dummy hub port 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       1
                                    
                                    
                                       k
                                    
                                 
                              
                            is regarded to be zero. Constraints (25)–(28) are the compatibility requirements for the arrival time of a particular ship when passing through two successive ports. Constraints (29)–(31) describe the two values for denoting the arrival time of a particular ship at a port which is not called by this ship. Constraints (32) maintain the weekly service frequency. Constraints (33) and (34) are the compatibility requirements for the number of containers transported by a particular ship when passing through two successive ports. Constraints (35) mean that the flow on a particular ship at a particular port which is not called by this ship, is regarded to be zero. Constraints (36) are the capacity constraints. Constraints (37)–(39) denote 
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       iv
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       iv
                                    
                                 
                              
                           and 
                              
                                 
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       iv
                                    
                                 
                              
                            as non-negative variables. Constraints (40) and (41) denote 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       v
                                    
                                 
                              
                            and n
                           
                              v
                            as a binary variable and a non-negative integer variable, respectively.

Based on constraints (29)–(31), the time spent for transporting containers between feeder port 
                              
                                 i
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                    
                                       F
                                    
                                 
                              
                            and its associated hub port k, can be calculated as follows:
                              
                                 (42)
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ki
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ∀
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          iv
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                           
                              
                                 (43)
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ik
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ∀
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   v
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                                
                                                   iv
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    i
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                       
                                          F
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    k
                                    ∈
                                    
                                       
                                          P
                                       
                                       
                                          H
                                       
                                    
                                 
                              
                           
                        

As compared with the SRDSFD sub-problem for feeder ship route design, it is more difficult to formulate and solve the SRDSFD sub-problem for designing main ship routes. This is because (i) each hub port transports many containers consolidated from different feeder ports, which means that the consolidated containers to be transported between any two hub ports belong to many different OD port pairs; (ii) the consolidated containers to be transported between any two hub ports may be carried by more than one ship. As a result, it becomes very difficult to identify which consolidated containers to be transported for any two hub ports called by a particular main ship route.

In order to formulate our sub-problem here, this paper develops a hub port expanding technique. Each hub port will be expanded to several new hub ports. The number of new hub ports for a particular hub port is equal to the number of the associated OD port pairs passing through this hub port.

Let 
                              
                                 
                                    
                                       W
                                    
                                    
                                       H
                                    
                                 
                              
                            denote the set of OD port pairs routed via two different hub ports, which can be obtained in phase I. Assume that the size of 
                              
                                 
                                    
                                       W
                                    
                                    
                                       H
                                    
                                 
                              
                            is n, i.e., 
                              
                                 |
                                 
                                    
                                       W
                                    
                                    
                                       H
                                    
                                 
                                 |
                                 =
                                 n
                              
                           . Let 
                              
                                 H
                              
                            be the set of all expanded hub ports. It is clear that 
                              
                                 |
                                 H
                                 |
                                 =
                                 2
                                 n
                              
                           . In addition, we use the mapping f(h
                           
                              i
                           ) to record the original hub port for each expanded hub port 
                              
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 H
                              
                           . For a particular OD port pair with its segment-based container route, the hub port is regarded as a pickup point if the origin port is allocated to this hub port, and it is a delivery point while the destination port is allocated to this hub port. For the i
                           th OD port pair in 
                              
                                 
                                    
                                       W
                                    
                                    
                                       H
                                    
                                 
                              
                           , its corresponding pickup point in set 
                              
                                 H
                              
                            is denoted as h
                           
                              i
                           , and the associated delivery point is denoted as 
                              
                                 
                                    
                                       h
                                    
                                    
                                       n
                                       +
                                       i
                                    
                                 
                                 ∈
                                 H
                              
                           . Let 
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                            be the number of containers to be transported for the i
                           th OD port pair in 
                              
                                 
                                    
                                       W
                                    
                                    
                                       H
                                    
                                 
                              
                           . Let 
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             n
                                             +
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                            denote the pickup and delivery demands, respectively.

In Fig. 1
                           , we show an example for illustrating the above hub port expanding technique. Two hub ports in Fig. 1(a) are finally expanded to be eight new hub ports as shown in Fig. 1(b). After applying the hub port expanding technique, we also introduce two dummy hub ports, i.e., 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           , which can be regarded as the origin and destination of all ships, respectively. Then the SRDSFD sub-problem for main ship route design can be formulated as follows:
                              
                                 (44)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   v
                                                
                                                
                                                   fix
                                                
                                             
                                             ·
                                             
                                                
                                                   n
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                             ·
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           subject to
                              
                                 (45)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    H
                                 
                              
                           
                           
                              
                                 (46)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                 
                              
                           
                           
                              
                                 (47)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (48)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (49)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             H
                                             ∪
                                             {
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          m
                                       
                                    
                                    ∈
                                    H
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (50)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             H
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             H
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                i
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          n
                                          +
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (51)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          v
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (52)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          Dis
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    /
                                    
                                       
                                          s
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    |
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    |
                                    /
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                          v
                                       
                                    
                                    +
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (53)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          Dis
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    /
                                    
                                       
                                          s
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    |
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    |
                                    /
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                          v
                                       
                                    
                                    -
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (54)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          Dis
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                i
                                             
                                          
                                       
                                    
                                    /
                                    
                                       
                                          s
                                       
                                       
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    /
                                    
                                       
                                          γ
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          n
                                          +
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (55)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    M
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ∀
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ∈
                                                      H
                                                      ∪
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (56)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                    ·
                                    168
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (57)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          v
                                       
                                    
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (58)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    +
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (59)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                          v
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    -
                                    M
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (60)
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    M
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      ∀
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ∈
                                                      H
                                                      ∪
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (61)
                                 
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    
                                       
                                          Cap
                                       
                                       
                                          v
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (62)
                                 
                                    0
                                    ⩽
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩽
                                    
                                       
                                          Cap
                                       
                                       
                                          v
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          n
                                          +
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (63)
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          v
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    }
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (64)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    ∈
                                    {
                                    0
                                    ,
                                    1
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    H
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    }
                                    ∪
                                    {
                                    
                                       
                                          
                                             
                                                h
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           
                           
                              
                                 (65)
                                 
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                    ∈
                                    
                                       
                                          Z
                                       
                                       
                                          +
                                       
                                    
                                    ∪
                                    {
                                    0
                                    }
                                    ,
                                    
                                    ∀
                                    
                                    v
                                    ∈
                                    V
                                 
                              
                           where the cost 
                              
                                 
                                    
                                       c
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                              
                            in the objective function (44) can be calculated as follows:
                              
                                 (66)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Dis
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          ·
                                          
                                             
                                                c
                                             
                                             
                                                v
                                             
                                             
                                                bunker
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        l
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         v
                                                      
                                                      
                                                         berth
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         v
                                                      
                                                   
                                                
                                             
                                             +
                                             |
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             |
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   handle
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   |
                                                   ·
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         v
                                                      
                                                      
                                                         berth
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         v
                                                      
                                                   
                                                
                                             
                                             +
                                             |
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             |
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                   handle
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The objective function (44) minimizes the total operating cost.Constraints (45) and (46) ensure that every expanded hub port is served by exactly one ship.Constraints (47) and (48) mean that every ship starts from the dummy hub port 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                            and ends at the dummy hub port 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           .Constraints (49) are the flow conservation constraints.Constraints (50) are the coupling constraints, which state that both the pickup point h
                           
                              i
                            and the delivery point h
                           
                              n+i
                            will be served by the same ship.Constraints (51) mean that the initial time before each ship starting from the dummy hub port 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                            is regarded to be zero.Constraints (52) and (53) are the compatibility requirements for the arrival time of a particular ship when passing through two successive expanded hub ports.Constraints (54) are the compatibility requirements for the arrival time of a particular ship when passing through a pair of the pickup and delivery points.Constraints (55) state that the arrival time of a particular ship at a particular expanded hub port which is not called by this ship, is regarded as zero.Constraints (56) maintain the weekly service frequency.Constraints (57) describe that each ship is empty when it starts from the dummy hub port 
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           .Constraints (58) and (59) are the compatibility requirements for the number of containers transported by a particular ship when passing through two successive expanded hub ports.Constraints (60) mean that the flow on a particular ship at a particular port which is not called by this ship, is regarded to be zero.Constraints (61) and (62) are the capacity constraints.Constraints (63)–(65) denote 
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                              
                            and n
                           
                              v
                            as a non-negative variable, a binary variable and a non-negative integer variable, respectively.

The time spent for transporting containers from the pickup hub port 
                              
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 H
                              
                            to the deliver hub port 
                              
                                 
                                    
                                       h
                                    
                                    
                                       n
                                       +
                                       i
                                    
                                 
                                 ∈
                                 H
                              
                           , can be calculated as follows
                              
                                 (67)
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ∀
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         n
                                                         +
                                                         i
                                                      
                                                   
                                                   v
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   v
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The SRDSFD for designing main and feeder ship routes subject to the transit time constraints can be formulated as follows:
                              
                                 (68)
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   v
                                                
                                                
                                                   fix
                                                
                                             
                                             ·
                                             
                                                
                                                   n
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            H
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            F
                                                         
                                                      
                                                      ∪
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            F
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           h
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      H
                                                      ∪
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ∈
                                                      H
                                                      ∪
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             ∈
                                             V
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   H
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ∪
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ̃
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          v
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   kv
                                                
                                                
                                                   berth
                                                
                                             
                                             ·
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                     
                                                                        ˆ
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  kv
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             ·
                                             
                                                
                                                   c
                                                
                                                
                                                   k
                                                
                                                
                                                   handle
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           subject to


                           (15), (16), (18)–(43), (45)–(64) and (67)
                           
                              
                                 (69)
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          f
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                k
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          f
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                k
                                             
                                          
                                          )
                                          ,
                                          j
                                       
                                    
                                    ⩽
                                    
                                       
                                          T
                                       
                                       
                                          ij
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    {
                                    <
                                    i
                                    ,
                                    f
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    ,
                                    f
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          n
                                          +
                                          k
                                       
                                    
                                    )
                                    ,
                                    j
                                    >
                                    }
                                    ∈
                                    S
                                 
                              
                           
                           
                              
                                 (70)
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    ⩽
                                    
                                       
                                          T
                                       
                                       
                                          ij
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                    {
                                    <
                                    i
                                    ,
                                    k
                                    ,
                                    k
                                    ,
                                    j
                                    >
                                    }
                                    ∈
                                    S
                                 
                              
                           
                        

The objective function (68) minimizes the total operating cost for designing main and feeder ship routes. Constraints (69) and (70) are the transit time constraints.

The size of the hub location and feeder allocation problem in phase I can be sharply reduced when introducing a proper set of candidate hub ports. For example, if the number of ports is 20, 5 of which are candidate hub ports, and the number of OD port pairs is 100, then the numbers of decision variables z
                     
                        ijkm
                      and Z
                     
                        ik
                      can be reduced from 100×18×18=32,400 to 100×5×5=2500 and from 20×20=400 to 20×5=100, respectively. For our case study with 46 ports, the hub location and feeder allocation problem after introducing 9 candidate hub ports can be efficiently solved by any mixed-integer linear programming solver such as CPLEX.

In phase II, the SRDSFD with transit time constraints is difficult to address because of the coupling constraints on transit time for each OD port pair. Fortunately, the Lagrangian relaxation based solution method provides an elegant application in solving the SRDSFD. According to the Lagrangian relaxation based solution method, the transit time constraints (69) and (70) can be relaxed, by introducing a set of the Lagrange multipliers. Hence, the SRDSFD can be decomposed into 
                        
                           |
                           
                              
                                 P
                              
                              
                                 H
                              
                           
                           |
                           +
                           1
                        
                      independent SRDSFD sub-problems.

The Lagrangian problem for the SRDSFD can be described as follows:
                           
                              (71)
                              
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                v
                                             
                                             
                                                fix
                                             
                                          
                                          ·
                                          
                                             
                                                n
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   ∪
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   ∪
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        h
                                                                     
                                                                     
                                                                        ̃
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∈
                                                   H
                                                   ∪
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   H
                                                   ∪
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          v
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                H
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                             
                                                F
                                             
                                          
                                          ∪
                                          {
                                          
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                1
                                             
                                             
                                                k
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                             
                                                F
                                             
                                          
                                          ∪
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                    
                                       v
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                kv
                                             
                                             
                                                berth
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  
                                                                     q
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               kv
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          (
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ·
                                          
                                             
                                                c
                                             
                                             
                                                k
                                             
                                             
                                                handle
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ∀
                                          {
                                          <
                                          i
                                          ,
                                          f
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          ,
                                          f
                                          (
                                          
                                             
                                                h
                                             
                                             
                                                n
                                                +
                                                k
                                             
                                          
                                          )
                                          ,
                                          j
                                          >
                                          }
                                          ∈
                                          S
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                ij
                                             
                                          
                                          ·
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         f
                                                         (
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               n
                                                               +
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         f
                                                         (
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               n
                                                               +
                                                               k
                                                            
                                                         
                                                         )
                                                         ,
                                                         j
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ∀
                                          {
                                          <
                                          i
                                          ,
                                          k
                                          ,
                                          k
                                          ,
                                          j
                                          >
                                          }
                                          ∈
                                          S
                                       
                                    
                                 
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       ij
                                    
                                 
                                 )
                                 ]
                              
                           
                        subject to


                        (15), (16), (18)–(43), (45)–(64) and (67)
                     

where u
                        
                           ij
                        (u
                        
                           ij
                        
                        ⩾0) is a Lagrange multiplier for each OD port pair 
                           
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              W
                           
                        . Let 
                           
                              U
                              =
                              {
                              
                                 
                                    u
                                 
                                 
                                    ij
                                 
                              
                              :
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              W
                              }
                           
                         denote a set of the Lagrange multipliers. For a particular 
                           
                              U
                           
                        , let 
                           
                              L
                              (
                              U
                              )
                           
                         denote the optimal objective function value of the Lagrangian problem. Then 
                           
                              L
                              (
                              U
                              )
                           
                         is a lower bound for the solution of the SRDSFD. The problem of finding the Lagrangian bound L can be defined as
                           
                              (72)
                              
                                 L
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          U
                                       
                                    
                                 
                                 L
                                 (
                                 U
                                 )
                              
                           
                        
                     

The best choice for 
                           
                              U
                           
                         can be obtained by implementing the subgradient method, which has become a very popular method for the Lagrangian problem (see Fisher, 1981, 2004; Kaskavelis & Caramanis, 1998; Holmberg & Yuan, 2000; Kiwiel, Larsson, & Lindberg, 2007; Imai, Nishimura, & Current, 2007).

Given an initial value 
                           
                              
                                 
                                    u
                                 
                                 
                                    ij
                                 
                                 
                                    0
                                 
                              
                           
                         (e.g., 
                           
                              
                                 
                                    u
                                 
                                 
                                    ij
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                           
                        ) for each OD port pair 
                           
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              W
                           
                        , a sequence 
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ij
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         is generated by using the subgradient method, given as follows:
                           
                              (73)
                              
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                f
                                                (
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      n
                                                      +
                                                      k
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                f
                                                (
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      n
                                                      +
                                                      k
                                                   
                                                
                                                )
                                                ,
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                T
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 {
                                 <
                                 i
                                 ,
                                 f
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 f
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       n
                                       +
                                       k
                                    
                                 
                                 )
                                 ,
                                 j
                                 >
                                 }
                                 ∈
                                 S
                              
                           
                        
                        
                           
                              (74)
                              
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                k
                                                ,
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                T
                                             
                                             
                                                ij
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 {
                                 <
                                 i
                                 ,
                                 k
                                 ,
                                 k
                                 ,
                                 j
                                 >
                                 }
                                 ∈
                                 S
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    f
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          h
                                       
                                       
                                          n
                                          +
                                          k
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    f
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          n
                                          +
                                          k
                                       
                                    
                                    )
                                    ,
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                    ,
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                         are obtained when solving the Lagrangian problem with respect to 
                           
                              
                                 
                                    U
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ij
                                          
                                          
                                             t
                                          
                                       
                                       :
                                       ∀
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       W
                                    
                                 
                              
                           
                         and λ
                        
                           t
                         is a positive scalar step size. The step size can be calculated as follows:
                           
                              (75)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             γ
                                          
                                          
                                             t
                                          
                                       
                                       ·
                                       (
                                       
                                          
                                             L
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       L
                                       (
                                       
                                          
                                             U
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ∀
                                             {
                                             <
                                             i
                                             ,
                                             f
                                             (
                                             
                                                
                                                   h
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ,
                                             f
                                             (
                                             
                                                
                                                   h
                                                
                                                
                                                   n
                                                   +
                                                   k
                                                
                                             
                                             )
                                             ,
                                             j
                                             >
                                             }
                                             ∈
                                             S
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         f
                                                         (
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               n
                                                               +
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         f
                                                         (
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               n
                                                               +
                                                               k
                                                            
                                                         
                                                         )
                                                         ,
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             ∀
                                             {
                                             <
                                             i
                                             ,
                                             k
                                             ,
                                             k
                                             ,
                                             j
                                             >
                                             }
                                             ∈
                                             S
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                         ,
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where γ
                        
                           t
                         is a scalar satisfying 0<
                        γ
                        
                           t
                        
                        ⩽2 and L
                        ∗ is an upper bound on the Lagrangian bound L. As is often done in the subgradient method, the sequence {γ
                        
                           t
                        } is determined by setting γ
                        0
                        =2 and halving γ
                        
                           t
                         whenever 
                           
                              L
                              (
                              U
                              )
                           
                         has failed to increase in some fixed number of iterations.

In order to obtain an upper bound, we can split the SRDSFD and gradually solve the SRDSFD sub-problems. Before designing main ship routes, each SRDSFD sub-problem for feeder ship route design is solved subject to the transit time constraints:
                           
                              (76)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   k
                                                
                                             
                                             ⩽
                                             
                                                
                                                   T
                                                
                                                
                                                   ik
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   k
                                                   ,
                                                   i
                                                
                                             
                                             ⩽
                                             
                                                
                                                   T
                                                
                                                
                                                   ki
                                                
                                             
                                             ,
                                             
                                             ∀
                                             
                                             i
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   k
                                                
                                                
                                                   F
                                                
                                             
                                             ,
                                             
                                             ∀
                                             
                                             k
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   H
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then the time spent for transporting containers between any feeder port and its associated hub port can be obtained. After that, the transit time constraints for designing main ship routes can be described as follows:
                           
                              (77)
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             n
                                             +
                                             k
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       f
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       f
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             n
                                             +
                                             k
                                          
                                       
                                       )
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 {
                                 <
                                 i
                                 ,
                                 f
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 f
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       n
                                       +
                                       k
                                    
                                 
                                 )
                                 ,
                                 j
                                 >
                                 }
                                 ∈
                                 S
                              
                           
                        
                     

In addition, in order to obtain a lower bound, we can further relax the transit time constraints (77) as follows:
                           
                              (78)
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             h
                                          
                                          
                                             n
                                             +
                                             k
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       f
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       f
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             n
                                             +
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 {
                                 <
                                 i
                                 ,
                                 f
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 f
                                 (
                                 
                                    
                                       h
                                    
                                    
                                       n
                                       +
                                       k
                                    
                                 
                                 )
                                 ,
                                 j
                                 >
                                 }
                                 ∈
                                 S
                              
                           
                        
                     

To the best of our knowledge, the algorithm of Baldacci, Bartolini, and Mingozzi (2011) is currently the best exact algorithm available in the literature for the pickup and delivery problem with time windows (PDPTW). The instances with up to approximately 500 requests (OD port pairs) can be solved. There are also many other studies on the exact algorithms, such as Dumas, Desrosiers, and Soumis (1991), Savelsbergh and Sol (1998), Lu and Dessouky (2004), Ropke, Cordeau, and Laporte (2007), and Ropke and Cordeau (2009). In this paper, each decomposed SRDSFD sub-problem is similar to a PDPTW.

If the size of each SRDSFD sub-problem for feeder ship route design is moderate (e.g., the number of feeder ports is not larger than 20), CPLEX can be used to efficiently solve it. Otherwise, the feeder ports can be clustered, following the clustering algorithms for PDPTW (Toth & Vigo, 2001).

Different from feeder ship routes, hundreds or thousands of OD port pairs are associated with main ship routes, even for a small or medium problem size. For example, if the number of ports is 20, 5 of which are hub ports, then the maximum number of OD port pairs may be up to 20×19=380. As a result, the number of the expanded hub ports should be up to 760, although the number of hub ports is only 5. However, the containers transported for the different OD port pairs routed via the same pair of hub ports can be aggregated with respect to the transit time constraints (77) for a user-specified tolerance ε (e.g., ε
                        =12h). Then the problem size can be greatly reduced. Take the above case for instance, the number of expanded hub ports after aggregation may be reduced from 760 to or less than 5×4=20. Take Fig. 1 for another example, the problem size after aggregation can be reduced from 8 to 2. In order to further reduce the problem size, we can also make use of the column generation technique to construct the practical candidate main ship routes, following the rules in Agarwal and Ergun (2008), such as (i) the number of ports visited by a ship route must not be too high (e.g., 10 or 15); (ii) the length (in weeks) of a ship route must be bounded by a suitable number (e.g., 10). Based on candidate ship routes, the VRPPD can be reduced to a container assignment problem (Bell, Liu, Angeloudis, Fonzone, & Hosseinloo, 2011; Meng & Wang, 2011), which can be solved by CPLEX.

Here we provide our computational results after introducing the data descriptions. Our algorithm is implemented in a Windows 7 environment. Numerical experiments are performed on a 3.4gigahertz Dual Core PC with 4giga bytes of RAM.

We conduct our computational experiments on the Asia–Europe–Oceania shipping service network consisting of 46 ports, as shown in Fig. 2
                        . MicroCity (http://microcity.sourceforge.net) is used to show the world map. All the parameters used here are derived from the realistic data with modification due to the commercial confidentiality. This study considers three different ship types: 1500-TEU, 3000-TEU and 5000-TEU. The ship type related cost and time parameters are shown in Table 1
                        . From the practical point of view, 9 ports (Rotterdam, Sokhna, Salalah, Colombo, Singapore, Hong Kong, Shanghai, Pusan and Yokohama) are selected as candidate hub ports.

As mentioned before, this paper assumes that China and Japan published the strict maritime cabotage legislations. Furthermore, two liner shipping companies, i.e., COSCO in China and APL in Singapore are assumed to provide the shipping services, respectively. Due to the Japanese maritime cabotage legislation, COSCO cannot provide the direct shipping services among the ports in Japan. For APL, both Chinese and Japanese maritime cabotage legislations will function for their local ports, respectively. We apply the two-phase mathematical programming model to the two cases in order to explore the impact of maritime cabotage legislations on liner H& S shipping network design.

After solving phase I, which is hub location and feeder allocation model subject to maritime cabotage legislations, the set of hub ports and the allocation of feeder ports can be determined. The results of phase I for two cases are shown in Tables 2 and 3
                        
                        , respectively. Due to the Japanese maritime cabotage legislation, the Japanese feeder ports are allocated to Pusan hub port, as shown in Table 2. Generally, a feeder port is assigned to its nearest hub port. This is because that the major component of the ship operating cost is bunker cost, which is proportional to the transportation distance. Yokohama is also opened as a hub port, although it does not serve any feeder port. This is because the container shipment demand of Yokohama is very high to cater for a big ship calling at it. Such kind of hub port is often termed as a main (or major) port in liner shipping industry. Similar results of phase I for the impact of both the Chinese and Japanese maritime cabotage legislations can be obtained in Table 3. Similar to Yokohama, Shanghai is also a hub port, which does not serve any feeder port. Due to the Chinese maritime cabotage legislation, the import and export container shipment demands at Dalian, Qingdao, Ningbo cannot be consolidated at Shanghai hub port. As a result, Dalian and Qingdao are allocated to Pusan hub port, and Ningbo is allocated to Hong Kong hub port.


                        Table 4
                         shows the results of phase II when COSCO operates the Asia–Europe–Oceania shipping services. In this case, only the Japanese maritime cabotage legislation works for its local ports. In Table 4, the column “number of ships” denotes the number of ships deployed to maintain a weekly service frequency, and the column “voyage flow” sums up all containers on each leg of the ship route. The associated hub port for each feeder ship route is also shown in Table 4. Clearly, two main ship routes and nine feeder ship routes are finally established, as shown in Fig. 3
                        . In the inset of Fig. 3, we show the port rotation of feeder ship route 6 in Table 4. Furthermore, large ships are also deployed on some feeder ship routes (feeder ship route 6 and 8). This is because these feeder ship routes serve some feeder ports with high container shipment demands.


                        Table 5
                         shows the results of phase II when APL provides the Asia–Europe–Oceania shipping services. In this case, both the Chinese and Japanese maritime cabotage legislations will work. All designed ship routes in this case are shown in Fig. 4
                        . Clearly, many ship routes are the same as those shown in Table 4 and Fig. 3. The number of the designed feeder ship routes in this case is smaller than that shown in Table 4 by one. This is because of the Chinese maritime cabotage legislation: no feeder shipping service operated by APL is allowed to transport containers from the Chinese feeder ports to Shanghai hub port. It also seems that the feeder ship route 5 associated with Shanghai hub port and the feeder ship route 7 associated with Pusan hub port shown in Table 4 are combined in this case, similar to a butterfly shipping service route often used in practice. Furthermore, the ship utilization can be improved and fewer ships are required to maintain a weekly service frequency. As a result, the total operating cost in this case is less than that shown in Table 4. However, our results do not mean that the Chinese maritime cabotage legislation is positive for APL. On the contrary, the Chinese maritime cabotage legislation is not helpful in this case to protect the national liner shipping companies for providing shipping services as the third-part logistics. This is mainly because the number of feeder ports near Shanghai hub port considered in this paper is only 3. A feeder ship route cannot benefit from economies of scale for only serving these feeder ports.

@&#CONCLUSIONS@&#

This paper has investigated the impact of maritime cabotage legislations on liner H& S shipping network design problem. It proposes a two-phase mathematical programming model to formulate the problem. In phase I, the hub location and feeder allocation subject to the maritime cabotage legislations is formulated as a mixed-integer linear programming problem. It can be efficiently solved by CPLEX when introducing the candidate hub ports. By developing a hub port expanding technique, the ship route design with ship fleet deployment subject to the transit time constraints in phase II is formulated as a vehicle routing problem with pickup and delivery. A Lagrangian relaxation based solution method is proposed to solve it.

Clearly, the maritime cabotage legislation of a particular coastal country has a direct impact on the allocation for its local feeder ports. In addition, the obtained results also show that the practical butterfly shipping service routes are proper to benefit from the economies of scale, reduce the number of ships to maintain a weekly service frequency, and improve the ship utilization.

@&#ACKNOWLEDGEMENTS@&#

We are indebted to two anonymous reviewers for helpful suggestions and comments. This study is supported by National Basic Research Program of China (2012CB725400), National Natural Science Foundation of China (71131001, 71222101) and NOL Fellowship Programme of Singapore (R-302-000-014-720, R-702-000-007-720).

@&#REFERENCES@&#

