@&#MAIN-TITLE@&#Cold supply chain design with environmental considerations: A simulation-optimization approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The cold supply chain design problem is modeled as a concave MIP.


                        
                        
                           
                           A new Lagrangian approach embedded in B&B is developed to solve it.


                        
                        
                           
                           Unknown inventory functions are estimated using simulation-optimization.


                        
                        
                           
                           The global warming impact of both CO2 and refrigerant gases is considered.


                        
                        
                           
                           Realistic cases with different characteristics are solved to optimality.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Inventory-location problem

Distribution

Simulation

@&#ABSTRACT@&#


               
               
                  In response to strict regulations and increased environmental awareness, firms are striving to reduce the global warming impact of their operations. Cold supply chains have high levels of greenhouse gas emissions due to the high energy consumption and refrigerant gas leakages. We model the cold supply chain design problem as a mixed-integer concave minimization problem with dual objectives of minimizing the total cost - including capacity, transportation, and inventory costs - and the global warming impact. Demand is modeled as a general distribution, whereas inventory is managed using a known policy but without explicit formulas for the inventory cost and maximum level functions. We propose a novel hybrid simulation-optimization approach to solve the problem. Lagrangian decomposition is used to compose the model into an integer programming subproblem and sets of single variable concave minimization subproblems that are solved using simulation-optimization. We provide closed-form expressions for the Lagrangian multipliers so that the Lagrangian bound is obtained in a single iteration. Furthermore, since the solution of the integer subproblem is feasible to the original problem an upper bound is obtained immediately. To close the optimality gap, the Lagrangian approach is embedded in a branch-and-bound framework. The approach is verified through extensive numerical testing on two realistic case studies from different industries, and some managerial insights are drawn.
               
            

Annual fixed cost for opening a warehouse

Annual fixed CO2-equivalent emissions from a warehouse

Unit shipping cost from a plant to a warehouse

Expected annual product demand from a retailer

CO2-equivalent emissions for shipping a product between a plant and a warehouse

Average CO2 emissions from shipping a product between a plant and a warehouse

Average HFC gas leakage for shipping a product between a plant and a warehouse

Volume-dependent capacity cost function

Annual CO2-equivalent emissions from a warehouse as a function of its volume

Global-warming potential of a HFC gas

Number of units shipped of a product

Number of shipments using a truck type

Annual CO2-equivalent emissions for serving a retailer from a warehouse

Annual cost of serving a customer from a warehouse

Maximum inventory function

Inventory cost function

Product volume

Volumetric capacity of a truck type

Binary decision variables for assigning retailers to warehouses

Number of products shipped from a plant to a warehouse

Binary decision variables for locating warehouses

@&#INTRODUCTION@&#

Global warming has become a pressing issue in the last few decades, particularly with the plethora of recent scientific research providing strong evidence for its existence and showing its severe negative effects (Solomon et al., 2007). Currently, specialists concur that the radioactive forcing attributed to the anthropogenic greenhouse gas (GHG) emissions is the main cause of the global warming phenomenon (NRC, 2005). Thus, many endeavors have been made by governments, organizations and firms around the world to reduce the emissions of GHG.

In many industries, supply chain operations are a significant source of GHG emissions. It was estimated that more than three quarters of the GHG emissions associated with many industrial sectors are attributed to supply chain activities (Huang, Weber, & Matthews, 2009). Companies have devoted considerable attention to reduce the environmental footprint of their supply chains, aiming to achieve their sustainability commitments, mitigate risk on their brand value, and satisfy their environmentally-conscious customers (EPA, 2010). Nowadays, several global companies including IBM, Johnson&Johnson and PepsiCo require their suppliers to report or control their GHG emissions, whereas other companies are taking steps to control their supply chain emissions. For example, Wal-Mart has recently announced that it is on track to reduce GHG emissions from its supply chain by 18 million metric tons by 2015 (WALMART).

In cold supply chains, products must be stored and transported at low temperatures near or below the freezing mark. This necessitates the use of refrigerated warehouses and trucks that consume large quantities of energy for refrigeration. Higher energy consumption is associated with higher carbon dioxide (CO2) emissions in power generation facilities. Furthermore, refrigeration systems utilize large quantities of HydroFluoroCarbon (HFC) gases that have high global warming potential (GWP) and very long lifetime in the atmosphere. Regular and catastrophic leakage of HFC gases from cold supply chain constitutes a significant component of their global warming impact. Therefore, these gases must be taken into account when determining the best design and operations of cold supply chains.

In this paper, we study the cold supply chain design problem and provide a mathematical model to represent its economic and environmental effects. The problem is formulated as a concave mixed-integer programming problem, where the objective is to minimize the expected total cost of the supply chain, including capacity, transportation and inventory costs, in addition to costs associated with the global warming impact due to GHG emissions. We consider the environmental effects of both CO2 emissions due to energy consumption and leakage of refrigerant gas in warehouses and vehicles.

To solve the model, we propose a novel Lagrangian approach embedded in a branch-and-bound framework. Unlike classical Lagrangian relaxation approaches that use iterative methods such as subgradient optimization or cutting plane methods, we are able to provide a closed-form expression for the best Lagrangian multipliers, so we get the Lagrangian bound in a single iteration. Since the solution of the main subproblem is feasible to the original problem, we also get an upper bound immediately. A branch-and-bound algorithm is used to close the optimality gap. The proposed approach requires the evaluation of the inventory cost and the maximum inventory level at the branching points. Since we address the case of general demand pattern and inventory policy where explicit formulas for the inventory functions are rarely available, we resort to a simulation-optimization algorithm to estimate these functions. Discrete-event simulation is embedded into a bisection search algorithm to find the best control parameters of the inventory system.

The rest of this paper is organized as follows: in the next section we review the recent literature in the area of environmentally-conscious supply chain design . Sections 3 and 4 discuss the economic and environmental aspects of cold supply chains. The mathematical formulation of the cold supply chain design problem is presented in Section 5. In Section 6, a solution method combining Lagrangian decomposition, branch-and-bound, and simulation-optimization is presented in detail. Numerical testing on two case studies from different industries are conducted and the results are presented in Section 7. Finally, conclusions are drawn in Section 8.

@&#LITERATURE REVIEW@&#

Until the last decade, little attention was given to the environmental impact of supply chains. As noted by Current, Min, and Schilling (1990), only a few supply chain network design papers have included environmental metrics in their objective functions. Furthermore, these were ad 
                     hoc models designed for specific applications and not generic ones. However, with the escalating pressure from both governments and consumers to reduce the environmental footprint, the interest in designing green supply chains has risen sharply in the last decade. Several aspects of green supply chains were considered in the literature, including reverse supply chains, green manufacturing and remanufacturing, and environmentally-conscious lot-sizing.

Incorporating environmental aspects in supply chain design necessarily entails a trade-off between economic and environmental objectives. However, as shown by Benjaafar, and Daskin (2013), by making minor operational changes, it is possible to achieve vast reductions in the environmental footprint of supply chains without significantly increasing the cost. A variety of supply chain design models that incorporated GHG emission minimization as an objective have appeared recently in the literature, each was based on certain assumptions and has a specific focus. Ramudhin, Chaabane, Kharoune, and Paquet (2008) proposed a green supply chain design model that integrates carbon trading considerations but assumed that facility locations and sizes are known in advance. Conversely, Diabat and Simchi-Levi (2009) considered a similar carbon-capped supply chain design problem that treats the manufacturing and storage capacity of the manufacturers as variables, but does not account for the possibility of carbon trading. Harris, Mumford, and Naim (2009) considered a multi-objective variant of the traditional uncapacitated facility location problem with economic and environmental objectives and implemented an evolutionary algorithm to find a set of non-dominated solutions. Bin and Jun (2009) presented a nonlinear MIP model for a green supply chain design, showing the positive economic and environmental effects of implementing e-commerce on the supply chain operations. A more detailed and sophisticated multi-objective model that embeds life-cycle assessment (LCA) concepts within the supply chain design process is presented by Bojarski, Lainez, Espuña, and Puigjaner (2009). The strategic decisions addressed in the model are facility location, processing technology selection and production/distribution planning. Trade-offs between the total cost and the environment influence is thoroughly studied by Wang, Lai, and Shi (2011), who applied a normalized normal constraint method to find a set of evenly distributed Pareto optimal solutions and studied their sensitivity to the problem parameters. The closed-loop supply chain design framework proposed by Chaabane, Ramudhin, and Paquet (2012) combined multiple aspects from the previous references, including LCA and emission trading. Their MIP model takes into account the economic and environmental costs of manufacturing, distribution, warehousing and recycling activities. For a recent survey on location models within a supply chain environment, the reader is referred to Melo, Nickel, and da Gama (2009).

Within the current literature, three observations are worth mentioning. First, most of the models address the strategic location-allocation decisions in isolation from tactical ones such as inventory and routing decisions; Therefore they fail to exploit the significant potential savings in economic and environmental costs that can be achieved by considering the two levels of decisions simultaneously. Second, with very few exceptions (e.g., Elhedhli & Merrick, 2012), the literature has assumed that the environmental impact of the supply chain is linearly proportional to its scale. A more accurate and realistic approach is to consider economies of scale inherent in supply chain operations, leading to non-linear models. A final critique of the supply chain design models that consider emissions is that they have a narrow focus on CO2 as the only GHG that deserves attention, ignoring the strong global warning impact of other GHGs. This impact is especially important in cold supply chains that use large quantities of refrigerant gases, which are known to have very high GWP.

In this paper, we tackle these issues through a mathematical model that combines strategic location-allocation and tactical inventory decisions. Moreover, our models takes into consideration the nonlinearities resulting from both economies of scale and the risk pooling effect. It also incorporates the global warming impact of other GHGs beside CO2.

The Kyoto protocol requires countries to commit to specific reductions in the emissions of six types of GHG. Although CO2, among them, contributes the most to global warming due to the vast quantities of its emissions resulting from fossil fuel use, other gases play an important role and may become a dominant factor in global warming in the near future. In particular, concentrations of many of the fluorine-containing GHGs (HFCs, PFCs, SF6) increased by a factor of 1.3–4.3 between 1998 and 2005, and their total radiative forcing is rapidly increasing by roughly 10 percent per year (Solomon et al., 2007). The global warming impact of a greenhouse gas is determined by two factors: its concentration in the atmosphere and its GWP, defined as the ratio of the time-integrated radiative forcing from the instantaneous release of 1 kilogram of this specific gas to that from the release of 1 kilogram of CO2. Despite the fact that the concentrations of these gases in the atmosphere are low compared to those of CO2, many of them have very high GWP. For example, HFC-134a, a haloalkane refrigerant commonly used in domestic refrigerators and automobile air conditioners, has a GWP of 3830 over 20 years. Although the concentration of HFC-134a in 2005 was only about 
                        
                           10
                           
                              −
                              7
                           
                        
                      of that of carbon dioxide, this concentration has increased by 349 percent between 1998 and 2005 compared to an increase of only 13 percent of the carbon dioxide concentration during the same period. Velders, Fahey, Daniel, McFarland, and Andersen (2009) estimated that if the objectives of reducing CO2 emissions are accomplished but nothing is done about HFCs, they will be responsible for between 28 percent and 45 percent of carbon-equivalent emissions by 2050. Even if no action is taken on CO2, HFCs will still be responsible for between 10 percent and 20 percent of carbon-equivalent emissions by 2050.

Among different applications, air conditioning (domestic and automotive) and refrigeration (domestic, industrial, commercial and transport) use, by far, the largest quantities of HFC gases. Food processing, cold storage and transportation applications contain about two third of the total HFC quantities used in refrigeration applications and generate about the same percentage of HFC emissions (IPC, 2005). Therefore, incorporating the contribution of refrigerant gases while calculating the total global warming impact is particularly important for firms using these gases extensively. For instance, it has been estimated that, in an environment with an average energy mix, the refrigerant emissions represent about 60 percent of the total emissions of GHG resulting from refrigeration system operation in the commercial sector, whereas the rest is indirect emissions caused by power production (IPC, 2005). Since most of the refrigerant emissions take place in the transportation and warehousing stages, it is crucial to incorporate the greenhouse impact of refrigerant gases in the logistics/supply chain design models developed to minimize or control the environmental damage caused by these firm.

The set-up and operational costs of conventional (non-chilled) warehouses are known to exhibit strong economies of scale, and thus were modeled as concave functions of the their volumetric capacity (Feldman, Lehrer, & Ray, 1966). However, classical capacitated facility location models assumed that the capacity of potential warehouses are determined exogenously and known a priori, such that these capacities only impose limits on demand quantities (i.e., throughput) handled by warehouses Verter (2011). Even when the warehouse capacity was considered a variable to be determined by the program, it was linked directly to the throughput via a linear (Geoffrion & Graves, 1974) or a concave function (Moon, 1989), and was not based on the actual physical stock holding requirements. This treatment of the warehouse capacity is justifiable for conventional warehouses as the capacity cost is usually modest. However, upon adding the cost of the refrigeration system to the capacity cost in cold supply chains, the latter substantially increases, and consequently, the throughput-based sizing approach may not be suitable for determining the optimal capacity accurately. Therefore, in our model we determine the warehouse capacity based on the actual storage requirements dictated by the demand pattern, inventory policy, and customer service requirements.

It is easy to show that the cost and global warming impact of the refrigeration system are also concave functions of the warehouse volumetric capacity. First, there are economies of scale with respect to the equipment sizes required to serve a certain cooling load. Many refrigeration system components, such as motors, compressors, condensers, values, and control units, cost less per unit size as they grow larger. Moreover, the mechanical, electrical, and thermal efficiencies of the refrigeration system components are usually higher for larger sizes, thereby reducing their energy consumption per unit of refrigeration load served. Second, The relationship between the volumetric capacity of a cold store and its refrigeration load is concave. This relationship results from two major heat load components that increase sub-proportionally with the cold store volume, namely the external heat and the infiltration loads. The external heat load is approximately proportional to the surface area of the cold store, whereas the number of air changes in a cold store has an inverse relationship with its volume (ASR, 1956).

The amount of refrigerant gas leakage is usually estimated as a percentage of the amount of the refrigerant charged (i.e., refrigerant bank) (IPC, 2005). The amount of refrigerant required per tonne of refrigeration is a constant referred to as the ‘net refrigeration effect’ for each refrigerant type (Gunther, 1969), implying that the leakage quantity is proportional to the cooling capacity of the system. Again, this leads to the conclusion that the leakage quantity is a concave function of the volumetric capacity of the warehouse.

The two environmental effects of the refrigeration system can be combined in a single metric known as the total equivalent warming impact (TEWI), defined as the sum of the direct equivalent (chemical emissions) and the indirect (energy use) global warming effects (Fischer et al., 1991).

Let us define indices 
                        
                           i
                           =
                           1
                           ,
                           ⋯
                           ,
                           m
                           ,
                        
                     
                     
                        
                           j
                           =
                           1
                           ,
                           ⋯
                           ,
                           n
                           ,
                        
                     
                     
                        
                           k
                           =
                           1
                           ,
                           ⋯
                           ,
                           p
                        
                      and 
                        
                           l
                           =
                           1
                           ,
                           ⋯
                           ,
                           q
                           ,
                        
                      corresponding to retailers/customers, potential warehouse locations, production plants and products, respectively. Each plant has sufficient capacity to satisfy the total demand, so plant capacity is not an issue. The number, location and size of warehouses to open is not known in advance. There is a fixed annual cost aj
                      for opening a warehouse at location j. In addition, there is a volume-dependent capacity cost represented by a concave function fj
                     (.) to capture economies of scale. Products are shipped from plants to open warehouses in bulk quantities using single-type long-haul trucks, so cjkl
                     , the cost of shipping one unit of product l from plant k to warehouse j, is constant. Each unit of product l has volume ul
                     . To ensure better customer service, each retailer is assigned to a single warehouse for serving its requirements of all products. No restrictions are placed on the demand pattern of retailers, i.e., time and composition of orders can follow any probability distribution. However, we assume that the planner can characterize this distribution with reasonable accuracy. Let dil
                      be the expected annual demand of product l from retailer i. Ordered products are shipped to customers using trucks of different types depending on order size and distance, so the transportation cost is not linearly proportional to the number of units shipped. However, since the demand distribution of each customers is known, rij
                     , the annual cost of serving customer i from warehouse j, can be estimated. Finally, warehouses implement an inventory policy that aims to minimize the total inventory cost, including: ordering, holding, and backordering or lost sales costs. Upon knowing the inventory policy in each warehouse, we can construct its total inventory cost function tjl
                     (.) and the maximum inventory level function sjl
                     (.) for every product, both are functions of the total demand served by the warehouse. The maximum inventory level depends on the inventory policy implemented by warehouses. For example, if a warehouse uses a base-stock policy or a (s, S) policy, it is equal to the order-up-to level (R or S, respectively); whereas for a reorder point (Q, R) or (R, nQ) policies, it is equal to 
                        
                           Q
                           +
                           R
                           ,
                        
                      and so on.

To model the problem, we introduce the following variables:

                        
                           
                              xij
                               : binary variable takes value 1 if retailer i is assigned to warehouse j.


                              yjkl
                              : units of product l shipped from plant k to warehouse j.


                              zj
                                : binary variable takes value 1 if a warehouse is opened in location j.

The expected total annual cost of the system includes: warehouse capacity cost (fixed and size-dependent), transshipment cost between plants and warehouses, and between warehouses and retailers, and inventory costs (i.e., ordering, holding, and backordering or lost sales cost), which can be formulated as:

                        
                           
                              
                                 
                                    
                                       
                                          T
                                          C
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             a
                                             j
                                          
                                          
                                             z
                                             j
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             c
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             r
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             f
                                             j
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Likewise, the global warming effect of the system is the result of GHG emissions through the shipment of units between plants and warehouses, and between warehouses and retailers, and GHG emissions corresponding to the warehousing of products. The schematic diagram in Fig. 1
                      illustrates the different cost and GHG emission components.

Let eCO2 jkl
                      be the average CO2 emissions corresponding to the shipment of one unit of product l between plant k and warehouse j and eHFCjkl
                      be the average HFC gas leakage per unit of product l shipped between plant k and warehouse j. The combined global warming effect of both emitted gases is quantified using the principle of equivalence between the emission of a unit of HFC and GWPHFC
                      units of CO2, where GWPHFC
                      is the GWP of HFC described earlier. Thus, ejkl
                     , the CO2-equivalent amount of GHGs emitted for shipping a unit between a plant and a warehouse is calculated as:

                        
                           
                              
                                 
                                    e
                                    
                                       j
                                       k
                                       l
                                    
                                 
                                 =
                                 
                                    GWP
                                    
                                       H
                                       F
                                       C
                                    
                                 
                                 .
                                 e
                                 H
                                 F
                                 
                                    C
                                    
                                       j
                                       k
                                       l
                                    
                                 
                                 +
                                 e
                                 
                                    CO
                                    
                                       2
                                       
                                       j
                                       k
                                       l
                                    
                                 
                              
                           
                        
                     
                  

Likewise, oij
                     , the annual CO2-equivalent emissions for serving retailer i from warehouse j, bj
                     , the annual fixed CO2-equivalent emissions from warehouse j, and the concave function gj
                     (.), the annual CO2-equivalent emissions from a warehouse as a function of its volume, can be found in the same way. Thus the total CO2-equivalent emissions of the system can be expressed mathematically as:

                        
                           
                              
                                 
                                    
                                       
                                          T
                                          E
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             b
                                             j
                                          
                                          
                                             z
                                             j
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             e
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             o
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             g
                                             j
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Let w be the weight assigned to the emissions minimization objective, which can be the price of carbon emissions in the context of a carbon trading scheme. Thus, to simultaneously minimize the total cost and the total CO2-equivalent emissions the objective function is: 
                        
                           T
                           C
                           +
                           w
                           .
                           T
                           E
                        
                     . With that, the problem is formulated as:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          [P]:
                                          
                                          min
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                a
                                                ^
                                             
                                             j
                                          
                                          
                                             z
                                             j
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                c
                                                ^
                                             
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                r
                                                ^
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 s.t.
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 i
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    p
                                 
                                 
                                    y
                                    
                                       j
                                       k
                                       l
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    d
                                    
                                       i
                                       l
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 ∀
                                 j
                                 ,
                                 l
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 ≤
                                 
                                    z
                                    j
                                 
                                 
                                 ∀
                                 i
                                 ,
                                 j
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                    z
                                    j
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 j
                                 ,
                                 
                                 
                                    y
                                    
                                       j
                                       k
                                       l
                                    
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 ∀
                                 j
                                 ,
                                 k
                                 ,
                                 l
                                 .
                              
                           
                        
                     where 
                        
                           
                              
                                 f
                                 ^
                              
                              j
                           
                           
                              (
                              .
                              )
                           
                           =
                           
                              f
                              j
                           
                           
                              (
                              .
                              )
                           
                           +
                           w
                           
                              g
                              j
                           
                           
                              (
                              .
                              )
                           
                           ,
                        
                     
                     
                        
                           
                              
                                 c
                                 ^
                              
                              
                                 j
                                 k
                                 l
                              
                           
                           =
                           
                              c
                              
                                 j
                                 k
                                 l
                              
                           
                           +
                           w
                           
                              e
                              
                                 j
                                 k
                                 l
                              
                           
                           ,
                        
                     
                     
                        
                           
                              
                                 r
                                 ^
                              
                              
                                 i
                                 j
                              
                           
                           =
                           
                              r
                              
                                 i
                                 j
                              
                           
                           +
                           w
                           
                              o
                              
                                 i
                                 j
                              
                           
                           ,
                        
                      and 
                        
                           
                              
                                 a
                                 ^
                              
                              j
                           
                           =
                           
                              a
                              j
                           
                           +
                           w
                           
                              b
                              j
                           
                        
                     . The first constraint ensures that every retailer is assigned to exactly one warehouse. The second constraint represents the quantity balance for every warehouse and product. Whereas the last constraint stipulates that a retailer can not be assigned to a warehouse unless it is open. Our model resembles the single-echelon, multi-commodity supply chain design problem in (Shen, 2005), which also considered economies of scale within the supply chain using a concave term in the cost function. A similar problem structure is also analyzed in the more recent work of Berman, Krass, and Menezes (2015) on inventory location problems.

In order to find rij
                      and oij
                     , the annual cost and carbon-equivalent emissions for serving retailer i by warehouse j, we assume that each retailer is served individually, i.e., a truck is sent to a single retailer to fulfill its order. This is a reasonable assumption when the order frequency is low (i.e., it is quite unlikely to have several adjacent retailers ordering at the same day), when the shipment sizes are large, or when the retailers are widely dispersed. Let 
                        
                           V
                           =
                           {
                           1
                           ,
                           ⋯
                           ,
                           v
                           }
                        
                      be the set of different vehicle types that can be used to ship products between warehouses and retailers. Upon knowing the distribution of demand from each retailer, we can determine the expected annual number of shipments using a specific type of trucks:

                        
                           
                              
                                 E
                                 
                                    (
                                    
                                       N
                                       v
                                    
                                    )
                                 
                                 =
                                 E
                                 
                                    (
                                    N
                                    )
                                 
                                 .
                                 Pr
                                 
                                    (
                                    
                                       U
                                       
                                          v
                                          −
                                          1
                                       
                                    
                                    <
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       q
                                    
                                    
                                       N
                                       l
                                    
                                    
                                       u
                                       l
                                    
                                    ≤
                                    
                                       U
                                       v
                                    
                                    )
                                 
                                 .
                                 
                                    1
                                    
                                       v
                                       ∈
                                       
                                          V
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                     where Nv
                      is the number of shipments using truck type v, Uv
                      and 
                        
                           U
                           
                              v
                              −
                              1
                           
                        
                      are the volumetric capacity of truck types v and its next smaller type 
                        
                           v
                           −
                           1
                           ,
                        
                      
                     Nl
                      is the number of units shipped of product l, and 
                        
                           1
                           
                              v
                              ∈
                              
                                 V
                                 
                                    i
                                    j
                                 
                              
                           
                        
                      is an indicator function taking value 1 if this truck types belong to the set Vij
                      of trucks that can be used between i and j, since some truck types (e.g., electric trucks) can be used only within a certain travel range.

The solution methodology is built on the assumption that the last two terms in the objective function of [P] are concave functions. We discuss the validity of this assumption in Appendix A. Let us define the new auxiliary variables 
                           
                              
                                 Q
                                 j
                              
                              =
                              
                                 ∑
                                 
                                    l
                                    =
                                    1
                                 
                                 q
                              
                              
                                 u
                                 l
                              
                              
                                 s
                                 
                                    j
                                    l
                                 
                              
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    d
                                    
                                       i
                                       l
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 )
                              
                           
                        . Thus, [P] can be written as:

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             [P]:
                                             
                                             min
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   Q
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                       
                                          
                                             (
                                             2
                                             )
                                             −
                                             (
                                             5
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                Q
                                                j
                                             
                                             =
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                             ∀
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                    0
                                    ≤
                                    
                                       Q
                                       j
                                    
                                    ≤
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       q
                                    
                                    
                                       u
                                       l
                                    
                                    
                                       s
                                       
                                          j
                                          l
                                       
                                    
                                    
                                       (
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          d
                                          
                                             i
                                             l
                                          
                                       
                                       )
                                    
                                    
                                    ∀
                                    j
                                 
                              
                           
                        Since sjl
                        (.) is a non-decreasing function in the total demand 
                           
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    d
                                    
                                       i
                                       l
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                 
                                 )
                              
                              ,
                           
                         
                        Qj
                         reaches its upper bound when all the demand is served by a single warehouse, i.e., 
                           
                              
                                 Q
                                 j
                              
                              =
                              
                                 ∑
                                 
                                    l
                                    =
                                    1
                                 
                                 q
                              
                              
                                 u
                                 l
                              
                              
                                 s
                                 
                                    j
                                    l
                                 
                              
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    d
                                    
                                       i
                                       l
                                    
                                 
                                 )
                              
                           
                        . Upon relaxing (6) with multipliers 
                           
                              
                                 λ
                                 j
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              ⋯
                              ,
                              n
                              ,
                           
                         we get the subproblem:

                           
                              
                                 
                                    
                                       
                                          
                                             [SP0]:
                                             
                                          
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   Q
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                λ
                                                j
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                λ
                                                j
                                             
                                             
                                                Q
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                             (
                                             2
                                             --
                                             5
                                             )
                                             ,
                                             (
                                             7
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Next, we introduce the auxiliary variables 
                           
                              
                                 P
                                 
                                    j
                                    l
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 m
                              
                              
                                 d
                                 
                                    i
                                    l
                                 
                              
                              
                                 x
                                 
                                    i
                                    j
                                 
                              
                              ,
                           
                         so [SP0] can be written as:

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             [SP0]:
                                             
                                          
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   Q
                                                   j
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                λ
                                                j
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                λ
                                                j
                                             
                                             
                                                Q
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             (
                                             2
                                             --
                                             5
                                             )
                                             ,
                                             (
                                             7
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                P
                                                
                                                   j
                                                   l
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             
                                             ∀
                                             j
                                             ,
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                             0
                                             ≤
                                             
                                                P
                                                
                                                   j
                                                   l
                                                
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             
                                             ∀
                                             j
                                             ,
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        
                     

By relaxing (8) with multipliers μjl
                        , we get the subproblem:

                           
                              
                                 
                                    
                                       
                                          
                                             [SP00]:
                                             
                                          
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   Q
                                                   j
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                λ
                                                j
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                λ
                                                j
                                             
                                             
                                                Q
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                P
                                                
                                                   j
                                                   l
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             (
                                             2
                                             --
                                             5
                                             )
                                             ,
                                             (
                                             7
                                             )
                                             ,
                                             (
                                             9
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With that, [SP00] can be decomposed into 
                           
                              n
                              (
                              q
                              +
                              1
                              )
                              +
                              1
                           
                         subproblems. The first is an integer programming problem in the original variables:

                           
                              
                                 
                                    
                                       
                                          
                                             [SP1]:
                                             
                                          
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   μ
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                +
                                                
                                                   
                                                      r
                                                      ^
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             (
                                             2
                                             )
                                             −
                                             (
                                             5
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The second set of subproblems are n single variable concave minimization problems in Qj
                        :

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             [
                                             S
                                             P
                                             
                                                2
                                                j
                                             
                                             ]
                                             :
                                             
                                          
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   Q
                                                   j
                                                
                                                )
                                             
                                             −
                                             
                                                λ
                                                j
                                             
                                             
                                                Q
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                Q
                                                j
                                             
                                             ≤
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                j
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    Q
                                    ¯
                                 
                                 j
                              
                              =
                              
                                 ∑
                                 
                                    l
                                    =
                                    1
                                 
                                 q
                              
                              
                                 u
                                 l
                              
                              
                                 s
                                 
                                    j
                                    l
                                 
                              
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    d
                                    
                                       i
                                       l
                                    
                                 
                                 )
                              
                           
                        . As the objective function is concave, one of the extreme points is optimal, i.e., 
                           
                              
                                 Q
                                 
                                    j
                                 
                                 *
                              
                              =
                              0
                           
                         or 
                           
                              
                                 Q
                                 ¯
                              
                              j
                           
                        .

The third set of subproblems are nq single variable concave minimization problems in Pjl
                        :

                           
                              
                                 
                                    
                                       
                                          
                                             [
                                             S
                                             P
                                             
                                                3
                                                
                                                   j
                                                   l
                                                
                                             
                                             ]
                                             :
                                             
                                          
                                       
                                       
                                          min
                                       
                                       
                                          
                                             
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                λ
                                                j
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                P
                                                
                                                   j
                                                   l
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                P
                                                
                                                   j
                                                   l
                                                
                                             
                                             ≤
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                             
                                             ∀
                                             j
                                             ,
                                             l
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                    ¯
                                 
                                 
                                    j
                                    l
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 m
                              
                              
                                 d
                                 
                                    i
                                    l
                                 
                              
                           
                        . Again, the optimal solution exists at one of the extreme points, i.e., 
                           
                              
                                 P
                                 
                                    j
                                    l
                                 
                                 *
                              
                              =
                              0
                           
                         or 
                           
                              
                                 P
                                 ¯
                              
                              
                                 j
                                 l
                              
                           
                        . Thus, the best Lagrangian bound resulting from this relaxation is obtained by solving the Lagrangian dual problem:

                           
                              
                                 
                                    L
                                    
                                       B
                                       *
                                    
                                    =
                                    
                                       max
                                       
                                          λ
                                          ,
                                          μ
                                       
                                    
                                    
                                       {
                                       v
                                       
                                          [
                                          S
                                          P
                                          1
                                          ]
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          n
                                       
                                       v
                                       
                                          [
                                          S
                                          P
                                          
                                             2
                                             j
                                          
                                          ]
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          ∑
                                          
                                             l
                                             =
                                             1
                                          
                                          q
                                       
                                       v
                                       
                                          [
                                          S
                                          P
                                          
                                             3
                                             
                                                j
                                                l
                                             
                                          
                                          ]
                                       
                                       }
                                    
                                 
                              
                           
                        where v[SP1] is the optimal solution of [SP1], 
                           
                              v
                              
                                 [
                                 S
                                 P
                                 
                                    2
                                    j
                                 
                                 ]
                              
                              =
                              min
                              
                                 (
                                 0
                                 ,
                                 
                                    
                                       f
                                       ^
                                    
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          Q
                                          ¯
                                       
                                       j
                                    
                                    )
                                 
                                 −
                                 
                                    λ
                                    j
                                 
                                 
                                    
                                       Q
                                       ¯
                                    
                                    j
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              v
                              
                                 [
                                 S
                                 P
                                 
                                    3
                                    
                                       j
                                       l
                                    
                                 
                                 ]
                              
                              =
                              min
                              
                                 (
                                 0
                                 ,
                                 
                                    t
                                    
                                       j
                                       l
                                    
                                 
                                 
                                    (
                                    
                                       
                                          P
                                          ¯
                                       
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    λ
                                    j
                                 
                                 
                                    u
                                    l
                                 
                                 
                                    s
                                    
                                       j
                                       l
                                    
                                 
                                 
                                    (
                                    
                                       
                                          P
                                          ¯
                                       
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                                 −
                                 
                                    μ
                                    
                                       j
                                       l
                                    
                                 
                                 
                                    
                                       P
                                       ¯
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 )
                              
                              .
                           
                         Furthermore, let H be the index set of the feasible solutions of [SP1]:

                           
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             h
                                             :
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                h
                                             
                                             =
                                             1
                                             ;
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                                h
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                h
                                             
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                h
                                             
                                             ≤
                                             
                                                z
                                                
                                                   j
                                                
                                                h
                                             
                                             ;
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                h
                                             
                                             ,
                                             
                                                z
                                                
                                                   j
                                                
                                                h
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                                h
                                             
                                             ≥
                                             0
                                             ;
                                             ∀
                                             i
                                             ,
                                             j
                                             ,
                                             k
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        The Lagrangian dual problem can be reformulated as a linear programming problem by introducing the variables:

                           
                              
                                 
                                    
                                       
                                          
                                             θ
                                             1
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   h
                                                   ∈
                                                   H
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      a
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   z
                                                   
                                                      j
                                                   
                                                   h
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   p
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   
                                                      c
                                                      ^
                                                   
                                                   
                                                      j
                                                      k
                                                      l
                                                   
                                                
                                                
                                                   y
                                                   
                                                      j
                                                      k
                                                      l
                                                   
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         l
                                                         =
                                                         1
                                                      
                                                      q
                                                   
                                                   
                                                      μ
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         l
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         r
                                                         ^
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   h
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             θ
                                             
                                                2
                                                j
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             min
                                             
                                                (
                                                0
                                                ,
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                −
                                                
                                                   λ
                                                   j
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             θ
                                             
                                                3
                                                j
                                                l
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             min
                                             
                                                (
                                                0
                                                ,
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   λ
                                                   j
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   μ
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             
                                             ∀
                                             j
                                             ,
                                             l
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Therefore, the dual master problem is:

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             [DMP]:
                                             
                                          
                                       
                                       
                                          
                                             max
                                             
                                                λ
                                                ,
                                                μ
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                {
                                                
                                                   θ
                                                   1
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   θ
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   θ
                                                   
                                                      3
                                                      j
                                                      l
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                             
                                                θ
                                                1
                                             
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                h
                                             
                                             ≤
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                
                                                   j
                                                
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                                h
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                h
                                             
                                             ,
                                             
                                             ∀
                                             h
                                             ∈
                                             H
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             
                                                θ
                                                
                                                   2
                                                   j
                                                
                                             
                                             +
                                             
                                                λ
                                                j
                                             
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                j
                                             
                                             ≤
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             j
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             
                                                θ
                                                
                                                   3
                                                   j
                                                   l
                                                
                                             
                                             −
                                             
                                                λ
                                                j
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             ≤
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             
                                             ∀
                                             j
                                             ,
                                             l
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             
                                                θ
                                                
                                                   2
                                                   j
                                                
                                             
                                             ≤
                                             0
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             j
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                       
                                       
                                       
                                          
                                             
                                                θ
                                                
                                                   3
                                                   j
                                                   l
                                                
                                             
                                             ≤
                                             0
                                             ,
                                          
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             j
                                             ,
                                             l
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Obviously, its impractical to consider all feasible solutions of [SP1] in the index set H to generate constraints in the dual master problem [DMP], since the number of these constraints is very large. Instead, a classical cutting plane algorithm starts with a subset of feasible solutions to generate a relaxed dual master problem [RDMP] that is solved to get a set of Lagrangian multipliers (λj
                         and μjl
                        ) and an upper bound. These multipliers are then used to solve the subproblems and get a lower bound. The index set H is updated and a new constraint is added to [RDMP], which is then solved again to get new multipliers. This process continues until the upper and lower bounds coincide, in which case the Lagrangian bound is reached. In the problem under consideration, however, we are able to find the best Lagrangian bound directly.

In the next proposition, we provide a closed-form expression for the optimal multipliers in the general case, i.e., 
                           
                              (
                              
                                 
                                    Q
                                    ̲
                                 
                                 j
                              
                              ≤
                              
                                 Q
                                 j
                              
                              ≤
                              
                                 
                                    Q
                                    ¯
                                 
                                 j
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    P
                                    ̲
                                 
                                 
                                    j
                                    l
                                 
                              
                              ≤
                              
                                 P
                                 
                                    j
                                    l
                                 
                              
                              ≤
                              
                                 
                                    P
                                    ¯
                                 
                                 
                                    j
                                    l
                                 
                              
                              )
                              ,
                           
                         so we can use it to devise a branch-and-bound algorithm in the upcoming section. To get a lower bound on [P], we just need to set 
                           Q
                         
                        
                           j
                         and 
                           P
                         
                        
                           jl
                         to 0. The proof of Proposition 1 in provided in Appendix B.

                           Proposition 1
                           
                              The optimal multipliers are given by
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                   
                                                      j
                                                   
                                                   *
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                               ^
                                                            
                                                            j
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  Q
                                                                  ¯
                                                               
                                                               j
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            
                                                               f
                                                               ^
                                                            
                                                            j
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  Q
                                                                  ̲
                                                               
                                                               j
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               Q
                                                               ¯
                                                            
                                                            j
                                                         
                                                         −
                                                         
                                                            
                                                               Q
                                                               ̲
                                                            
                                                            j
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                   .
                                                
                                             
                                          
                                          
                                             
                                                
                                                   μ
                                                   
                                                      j
                                                      l
                                                   
                                                   *
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            t
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  P
                                                                  ¯
                                                               
                                                               
                                                                  j
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            t
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  P
                                                                  ̲
                                                               
                                                               
                                                                  j
                                                                  l
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            λ
                                                            
                                                               j
                                                            
                                                            *
                                                         
                                                         
                                                            u
                                                            l
                                                         
                                                         
                                                            (
                                                            
                                                               s
                                                               
                                                                  j
                                                                  l
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     P
                                                                     ¯
                                                                  
                                                                  
                                                                     j
                                                                     l
                                                                  
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               s
                                                               
                                                                  j
                                                                  l
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     P
                                                                     ̲
                                                                  
                                                                  
                                                                     j
                                                                     l
                                                                  
                                                               
                                                               )
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               P
                                                               ¯
                                                            
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               P
                                                               ̲
                                                            
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                
                                             
                                          
                                          
                                             
                                                j
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   1
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                   ,
                                                   
                                                   l
                                                   =
                                                   1
                                                   ,
                                                   ⋯
                                                   ,
                                                   q
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Next, we note that 
                           
                              (
                              
                                 x
                                 
                                    h
                                    *
                                 
                              
                              ,
                              
                                 y
                                 
                                    h
                                    *
                                 
                              
                              ,
                              
                                 z
                                 
                                    h
                                    *
                                 
                              
                              )
                              ,
                           
                         the optimal solution of [SP1
                           
                              
                              
                                 (
                                 
                                    λ
                                    *
                                 
                                 ,
                                 
                                    μ
                                    *
                                 
                                 )
                              
                           
                        ], is also feasible to [P] as both problems have the same feasible set. Its corresponding objective

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                
                                                   j
                                                
                                                
                                                   h
                                                   *
                                                
                                             
                                          
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                                
                                                   h
                                                   *
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   h
                                                   *
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                   *
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   Q
                                                   
                                                      j
                                                   
                                                   *
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 P
                                 
                                    j
                                    l
                                 
                                 *
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 m
                              
                              
                                 d
                                 
                                    i
                                    l
                                 
                              
                              
                                 x
                                 
                                    i
                                    j
                                 
                                 
                                    h
                                    *
                                 
                              
                           
                         and 
                           
                              
                                 Q
                                 
                                    j
                                 
                                 *
                              
                              =
                              
                                 ∑
                                 
                                    l
                                    =
                                    1
                                 
                                 q
                              
                              
                                 u
                                 l
                              
                              
                                 s
                                 
                                    j
                                    l
                                 
                              
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    d
                                    
                                       i
                                       l
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                    
                                    
                                       h
                                       *
                                    
                                 
                                 )
                              
                              ,
                           
                         is an upper bound. The difference between this upper bound and the Lagrangian bound is given by

                           
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   P
                                                   
                                                      j
                                                      l
                                                   
                                                   *
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   Q
                                                   
                                                      j
                                                   
                                                   *
                                                
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            Q
                                                            ̲
                                                         
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   −
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            Q
                                                            ¯
                                                         
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                
                                                
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   −
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          −
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   
                                                      λ
                                                      
                                                         j
                                                      
                                                      *
                                                   
                                                   
                                                      u
                                                      l
                                                   
                                                   
                                                      [
                                                      
                                                         s
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               P
                                                               ̲
                                                            
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               P
                                                               ¯
                                                            
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                         −
                                                         
                                                            P
                                                            
                                                               j
                                                               l
                                                            
                                                            *
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         s
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               P
                                                               ¯
                                                            
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         
                                                            P
                                                            
                                                               j
                                                               l
                                                            
                                                            *
                                                         
                                                         −
                                                         
                                                            
                                                               P
                                                               ̲
                                                            
                                                            
                                                               j
                                                               l
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          −
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   
                                                      t
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      −
                                                      
                                                         P
                                                         
                                                            j
                                                            l
                                                         
                                                         *
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      t
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         P
                                                         
                                                            j
                                                            l
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        which provides an upper limit on the optimality gap.

                           Corollary 1
                           
                              If
                              
                                 
                                    
                                       Q
                                       
                                          j
                                       
                                       *
                                    
                                    =
                                    
                                       
                                          Q
                                          ¯
                                       
                                       j
                                    
                                 
                               
                              or 
                              
                                 Q
                               
                              
                                 j
                              , 
                                 
                                    (
                                    
                                       x
                                       
                                          h
                                          *
                                       
                                    
                                    ,
                                    
                                    
                                       y
                                       
                                          h
                                          *
                                       
                                    
                                    ,
                                    
                                    
                                       z
                                       
                                          h
                                          *
                                       
                                    
                                    )
                                 
                               
                              is optimal to [P].
                           

The proof of Corollary 1 is provided in Appendix C. Based on this corollary , if the optimal solution of [SP1] is to open a single warehouse, the optimality gap is guaranteed to close in the root node (i.e., without branching). More importantly, this corollary helps us to devise an efficient branch-and-bound algorithm as described in the next section.

To close the optimality gap, we embed the Lagrangian decomposition in a Falk and Soland’s type branch-and-bound algorithm (Falk & Soland, 1969). Branching is performed around the optimal solution of [SP1] using the auxiliary variables 
                           
                              
                                 Q
                                 j
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              ⋯
                              ,
                              n
                           
                        . At any node, upon solving [SP1] we get the vector x
                        * and calculate 
                           
                              Q
                              
                                 j
                              
                              *
                           
                        . The variables 
                           
                              
                                 Q
                                 i
                                 *
                              
                              
                              ,
                              i
                              =
                              1
                              ,
                              ⋯
                              ,
                              n
                           
                         are classified to two sets: ‘extreme’ when 
                           
                              
                                 Q
                                 
                                    j
                                 
                                 *
                              
                              =
                              
                                 
                                    Q
                                    ̲
                                 
                                 j
                              
                           
                         or 
                           
                              
                                 
                                    Q
                                    ¯
                                 
                                 j
                              
                              ,
                           
                         and ‘non-extreme’ otherwise. If all the variables are extreme, the gap is guaranteed to close according to corollary 1, otherwise, a non extreme variable 
                           
                              Q
                              
                                 j
                                 ^
                              
                           
                         is selected for branching. In one child node, we set 
                           
                              
                                 
                                    Q
                                    
                                       j
                                       ^
                                    
                                 
                                 ̲
                              
                              =
                              
                                 Q
                                 
                                    
                                       j
                                       ^
                                    
                                 
                                 *
                              
                           
                         and 
                           
                              
                                 
                                    P
                                    
                                       
                                          j
                                          ^
                                       
                                       l
                                    
                                 
                                 ̲
                              
                              =
                              
                                 P
                                 
                                    
                                       j
                                       ^
                                    
                                    l
                                 
                                 *
                              
                              ,
                              
                              ∀
                              l
                              ,
                           
                         and add the constraints 
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 m
                              
                              
                                 d
                                 
                                    i
                                    l
                                 
                              
                              
                                 x
                                 
                                    i
                                    
                                       j
                                       ^
                                    
                                 
                              
                              ≥
                              
                                 P
                                 
                                    
                                       j
                                       ^
                                    
                                    l
                                 
                                 *
                              
                              ,
                              
                              ∀
                              l
                           
                         to [SP1]; And in the other child node, we set 
                           
                              
                                 
                                    Q
                                    
                                       j
                                       ^
                                    
                                 
                                 ¯
                              
                              =
                              
                                 Q
                                 
                                    
                                       j
                                       ^
                                    
                                 
                                 *
                              
                           
                         and 
                           
                              
                                 
                                    P
                                    
                                       
                                          j
                                          ^
                                       
                                       l
                                    
                                 
                                 ¯
                              
                              =
                              
                                 P
                                 
                                    
                                       j
                                       ^
                                    
                                    l
                                 
                                 *
                              
                              ,
                              
                              ∀
                              l
                              ,
                           
                         and add the constraints 
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 m
                              
                              
                                 d
                                 
                                    i
                                    l
                                 
                              
                              
                                 x
                                 
                                    i
                                    
                                       j
                                       ^
                                    
                                 
                              
                              ≤
                              
                                 P
                                 
                                    
                                       j
                                       ^
                                    
                                    l
                                 
                                 *
                              
                              ,
                              
                              ∀
                              l
                           
                         to [SP1]. In each node we obtain a lower bound using the Lagrangian approach. Furthermore, an upper bound is obtained from the feasible solution of [SP1] and the incumbent is updated if a better upper bound is found.


                        Falk and Soland (1969) have shown that, when the feasible region is a polyhedron, this branch-and-bound algorithm is complete in the sense that it finds the optimal solution of [P] after a solving a finite number of nodes. Let Ms
                        , s ∈ S be the partitioning subsets of the feasible region. For each subset (i.e., node) we can get a lower and an upper bound using the Lagrangian approach, denoted 
                           
                              L
                              (
                              
                                 M
                                 s
                              
                              )
                           
                         and 
                           
                              U
                              (
                              
                                 M
                                 s
                              
                              )
                              ,
                           
                         respectively. Then, 
                           
                              L
                              =
                              
                                 min
                                 
                                    s
                                    ∈
                                    S
                                 
                              
                              L
                              
                                 (
                                 
                                    M
                                    s
                                 
                                 )
                              
                              ,
                              
                              
                              U
                              =
                              
                                 min
                                 
                                    s
                                    ∈
                                    S
                                 
                              
                              U
                              
                                 (
                                 
                                    M
                                    s
                                 
                                 )
                              
                           
                         are the overall bounds, respectively. If at any iteration 
                           
                              L
                              =
                              U
                              ,
                           
                         the branch-and-bound algorithm terminates.

Except for special inventory policies (e.g., the classical EOQ policy), there are no closed-form expressions for the inventory functions sjl
                         and tjl
                        , but they can be estimated at specific points using discrete-event simulation. A reasonable assumption is that each warehouse selects the control parameters of the inventory policy (i.e., reorder point, ordering frequency, order quantity, etc.) to achieve the minimum inventory cost. Thus, the simulation runs are embedded in a heuristic optimization routine to find the optimal control parameters. We refer to this process as the ‘simulation-optimization’ algorithm. In what follows, we address the case when the inventory at warehouses is managed using the (r, nQ) inventory policy. It is important to notice, though, that this is just a representative example for the application of simulation-optimization algorithms within the proposed framework, and that other inventory policies can be handled similarly.

The (r, nQ) policy is suitable when products are ordered and shipped in batches (e.g., pallets or full-truck-loads). This is a periodic review policy in which a reorder level r is set such that an order of size nQ is placed whenever the inventory position falls to or below r. Q is a pre-specified quantity that represents the batch size, whereas n is the smallest integer that restores the inventory position above r, i.e., between 
                           
                              r
                              +
                              1
                           
                         and 
                           
                              r
                              +
                              Q
                           
                        . Our interest in the (r, nQ) policy is stimulated by both theoretical and practical reasons. On one hand, it has been shown that the (r, nQ) policy gives results that are nearly as good as those obtained from the (s, S) policy, which is proven to be optimal under modest assumptions (Wagner, O’Hagan, & Lundh, 1965). On the other hand, this policy seems suitable for the problem under consideration in which shipping between plants and warehouses is carried out in bulk quantities using long-haul trucks, meaning that the batch size can, intuitively, be set equal to the full capacity of a truck. In fact, when the transportation cost is taken into account, the (r, nQ) policy might lead to better results than the (s, S) policy due to the higher utilization of trucks.

It is known that the total inventory cost function is convex in the reorder level (Zipkin, 2000). Therefore, we propose a bisection search algorithm to find the optimal reorder level. We start with two values of the reorder level r
                        1 and r
                        2 such that 
                           
                              
                                 r
                                 1
                              
                              +
                              1
                              <
                              
                                 r
                                 *
                              
                           
                         and r
                        2 > r
                        *. We set 
                           
                              
                                 r
                                 3
                              
                              =
                              
                                 ⌊
                                 
                                    
                                       
                                          r
                                          1
                                       
                                       +
                                       
                                          r
                                          2
                                       
                                    
                                    2
                                 
                                 ⌋
                              
                           
                         and estimate the total inventory cost at r
                        3 and 
                           
                              
                                 r
                                 3
                              
                              +
                              1
                           
                         using simulation. If 
                           
                              t
                              
                                 (
                                 
                                    r
                                    3
                                 
                                 )
                              
                              >
                              t
                              
                                 (
                                 
                                    r
                                    3
                                 
                                 +
                                 1
                                 )
                              
                              ,
                           
                         
                        r
                        3 becomes r
                        1 for the next iteration, otherwise, it becomes r
                        2. The updated values of r
                        1 and r
                        2 are used to obtain a new midpoint r
                        3, and the process continues until 
                           
                              
                                 r
                                 2
                              
                              =
                              
                                 r
                                 1
                              
                              +
                              1
                              ,
                           
                         at which point the algorithm terminates and reports 
                           
                              
                                 r
                                 *
                              
                              =
                              
                                 r
                                 2
                              
                           
                        .

Obviously, the algorithm is guaranteed to reach the global optimal solution when the cost function is unimodal convex, which is true for the actual cost function. However, since the inventory cost is estimated based on a finite sample size (i.e., a number of simulation days), the resulting cost function is just an estimator of the population (i.e., infinite horizon) cost function and sampling error is inevitable. If this sampling error is large, the estimated function may become multimodal and the algorithm may get stuck in a local optimum. One way to overcome this issue is to increase the sample size to reduce sampling error. Also, common random numbers (CRN) can be used when searching for the optimal reorder level. This technique is shown to reduce the variance of the subgradient estimate (Glasserman & Yao, 1992), thereby minimizing the likelihood of premature termination of the algorithm. Both ways are used to improve the bisection search algorithm


                        Fig. 2
                         presents a flowchart that illustrates the solution method including the Lagrangian decomposition, the branch-and-bound and the simulation-optimization stages.

We test the proposed cold supply chain design approach on two realistic cases from different industries. The first is drawn from the bulk-volume, low-margin processed meat industry, and the second deals with a supply chain network for medical vaccines, a niche product characterized by its low-volume and high-value. We aim to study the trade-off between the economic and the environmental effects in cold supply chains. Testing is performed on a workstation with intel Core-i7 processor of the 4th generation and 8 GigaByte of RAM. The approach, including the simulation-optimization algorithm, is coded on Matlab2013b and the mixed integer subproblem is solved using Cplex12.5. Simulation runs are conducted in parallel using the parallel computing toolbox in Matlab with a maximum of 4 simultaneous threads.

Maple Leaf Foods (MLF) is the largest producer of prepared meats in Canada with revenues of over $3 billion in 2014. The company has recently embarked on an ambitious plan to restructure its supply chain that involves the consolidation of plants and distribution centers (DCs), aiming to achieve significant savings in operational cost and environmental impact. MLF has a strong commitment towards sustainability as demonstrated by its environmental sustainability program that has GHG emissions reduction as one of its pillars (MLF).

We use our proposed approach to design a cold supply chain for MLF in the Canadian province of Ontario. In particular, we consider the demand originating from the province’s 20 largest cities. MLF has two plants in Ontario: one in Brampton that produces sausage (P
                        1) and meat snacks (P
                        2), and another in Hamilton that specializes in wieners (P
                        3) and deli products (P
                        4). The demand is estimated based on the population of each city, the dietary habits of consumers and the company market share. The daily demand of each product is assumed to have a Poisson distribution with the rates shown in Table 1. Every demand node is also a candidate location for a DC.

Products are shipped from plants to DCs in 40′ (feet) refrigerated (reefer) containers loaded on conventional (diesel operated) long-haul trucks. For shipping products from DCs to retailers, both 40′ and 20′ reefer containers are used, depending on the quantity shipped. The 20′ containers can be used with one of two types of smaller trucks: conventional or electric. The latter are used for shipment distances of 100 km or less. The cost and GHG emissions per kilometer for a long-haul truck with a fully loaded 40′ reefer container are $2 and 6.3~kilograms, respectively. The number of units of each product for a 40′ container, alongside the holding and backordering costs per day, are shown in Table 2
                        
                        . The annual cost and global warming impact of shipping products between DCs and retailers is calculated based on the distance, the frequency of shipments, and the type of trucks used. Table 3
                         shows the annual cost (the upper row, in thousands of dollars) and the annual CO2-equivalent emissions (the lower row, in metric tonnes) for each DC-retailer pair.

Annual capacity cost of each DC has two components: a fixed cost of $55,000 and a volume-dependent cost that follows the function 
                           
                              
                                 f
                                 j
                              
                              
                                 (
                                 
                                    Q
                                    j
                                 
                                 )
                              
                              =
                              1.281
                              
                                 Q
                                 
                                    j
                                 
                                 
                                    0.68
                                 
                              
                           
                         in thousand dollars . Each DC has base annual GHG emissions of 112 tonnes of CO2-equivalent emissions and volume-dependent GHG emissions that follow the function 
                           
                              
                                 g
                                 j
                              
                              
                                 (
                                 
                                    Q
                                    j
                                 
                                 )
                              
                              =
                              11.1
                              
                                 Q
                                 
                                    j
                                 
                                 
                                    0.76
                                 
                              
                           
                         tonnes of CO2-equivalent emissions. To reach these functions, the cost and emissions of real cold stores of different sizes are calculated using a bottom-up approach, starting with the cooling load requirements to estimate the equipment size, cost, and energy consumption. Then, assuming that the size-dependent cost and emissions follow functions of the form 
                           
                              
                                 β
                                 1
                              
                              
                                 Q
                                 
                                    j
                                 
                                 
                                    β
                                    2
                                 
                              
                              ,
                           
                         regression techniques are implemented to estimate the coefficients β
                        1 and β
                        2. This regression model is found to provide a good approximation of the relationship between both the DC variable cost and emissions and its size. Each warehouse manages its inventory independently using the (r, nQ) inventory policy, where Q is the capacity of a 40′ reefer container. Whenever an order is placed, a fixed cost of $100 is incurred and the order arrives after 2 days. In our simulation model, the order at which events occur in DCs is as follows: first, ordered products arrive from the plants and added to the inventory-in-hand, then demand from retailers is realized. If the cumulative demand is less than or equal to the inventory-in-hand, it is satisfied immediately, otherwise, the shortage is carried forward to the next day. At the end of the day, the inventory position is evaluated and, if needed, an order is placed to replenish the inventory.

We test for various values of w, the weight assigned to the GHG emissions minimization objective, in order to investigate the cost-emissions trade-off. w is changed between 0 (minimizing the cost only) and 6. The results are depicted in Table 4
                        . The ‘Solution’ column shows the optimal solution obtained: the opened DCs outside the parenthesis; and for each opened DC, inside the parenthesis, its cold storage area in cubic meters, followed (after the semicolon) by the retailers assigned to it. Each DC is found to serve the retailer in its location. The columns ‘TC’ and ‘TE’ show the total cost in thousand dollars, and the total GHG emissions in metric tonnes of CO2-equivalent.

It is clear from these results that as w is increased, fewer DCs are opened. This observation is explained by two factors: First, it seems that emissions have stronger economies of scale than cost due to the high fixed emissions for DCs, which implies higher demand consolidation. Second, once emissions are penalized, there is a stronger incentive to assign close-by retailers to opened DCs in order to utilize electric trucks for shipping. The second factor explains the alternative optimal solution obtained with the same cost but with lower emissions when w is increased from 0 to 0.1. We also notice that the gross storage area of the DCs decreases as fewer DCs are opened due to the well-known risk pooling effect. The primary trade-off in this case is between capacity and transportation cost, whereas the inventory cost is comparatively insignificant because of the low-cost nature of the products.

The trade-off between cost and emissions is illustrated in Fig. 3
                        , which shows the Pareto frontier curve. We notice that when one objective is optimized, the other does not deteriorate sharply. For example, when minimizing only the cost by setting w to 0, the emissions level is merely 14.2 percent higher than when w is set to 6, at which case the emissions minimization objective is dominant. Likewise, the cost increases only by 10.7 percent when the focus is shifted from minimizing cost to minimizing emissions. It is even possible to decrease the quantity of emissions with no increase in cost by assigning a small weight, i.e., 
                           
                              w
                              =
                              0.1
                              ,
                           
                         to emissions in the objective function. This weak trade-off between cost and emissions agrees with the result reported in Benjaafar et al. (2013).


                        Fig. 4
                         shows a breakdown of the different components in the combined objective function. Note that as w increases, the inventory component decreases dramatically because, unlike the other components, inventory does not directly contribute to the supply chain emissions. Surprisingly, the contribution of the transportation component to the total cost decreases slightly as the environmental objective weight is increased, which can be attributed to the increased use of the less polluting, yet more expensive, electric trucks.

The computational performance of the algorithm is reasonable for a simulation-optimization approach. The computational time ranges between 2082 and 9290 seconds, with an average of 4271 seconds for the tested instances.

In this hypothetical case we use our approach to design a cold supply chain for publicly-funded vaccines in Ontario. We use the same network of Case I (i.e., the 20 largest cities in the province) and focus on the 13 vaccines having annual demand of more than 100,000 doses, which represent about 96 percent of the total number of non-flu vaccine doses delivered. Flu vaccine is excluded because it is highly seasonal and has different logistical considerations.

Vaccines are small volume, high margin products that are extremely sensitive to the ambient temperature and have to be maintained under tight temperature control to preserve their efficacy. Vaccine packages are shipped in bulk quantities from two local manufacturing facilities (Sanofi Pasteur facility in Toronto and GlaxoSmithKline facility in Mississauga) to DCs, and then to local dispensaries in each city, before they are dispatched to vaccination centers upon request. Demand for vaccines is quite predictable and fairly uniform, thus it makes sense to use a simple inventory management policy like the EOQ with backordering in DCs. Vaccines are shipped to demand points at constant (e.g., weekly) intervals using small refrigerated vans. Thus, the annual cost and emissions for serving a dispensary from a DC is proportional to the distance between them, with coefficients $78 per kilometer and 142 kilograms of CO2 per kilometer, respectively. As with the first case, the demand points are the candidate locations for DCs. The distance matrix is shown in Table 5
                        
                        .

The closed form expressions for the maximum inventory level sjl
                         and the total inventory cost tjl
                         functions in the classical EOQ with backordering policy are used directly without need for simulation. While the cost per vaccine dose varies widely, we assume equal annual holding and backordering costs for all vaccine types of $250 per package per year, where a package consists of 100 doses. The ordering cost is set to $200 per order, and the shipping cost and GHG emissions between suppliers and DCs equal $0.04 per kilometer per package and 0.08 kilograms CO2 per kilometer per package, respectively. The annual demand for vaccines is estimated from (OAHPP, 2014) based on the population of each city and is depicted in Table 6. Since the size of products is very small, the storage volume, and consequently the variable capacity cost of DCs, is negligible. The annual cost and GHG emissions of a DC are considered fixed at $9000 and 3000 kilogram CO2, respectively, regardless of its capacity.

As in Case I, we test using different values of w, ranging between 0 (pure cost minimization) and 50 (dominant emissions minimization objective). The results are shown in Table 7
                        . In the column titled ‘Solution’ we report the opened DCs and the retailers assigned to them inside the parenthesis, whereas the columns ‘TC’ and ‘TE’ show the total cost (in $) and the total GHG emissions (in kilograms CO2), respectively. The computational time ranges between 19 and 1331 seconds with a mean of 528 seconds.

It is interesting to notice that, contrary to Case I, the primary trade-off in this case is between transportation and inventory costs, whereas the role of the capacity cost is comparatively marginal. When w is small, the risk-pooling effect related to the inventory cost is dominant and hence demand consolidation is beneficial and fewer DCs are opened. When w is increased, the effect of the inventory cost diminishes (since inventory does not have an environmental impact) and the transportation cost becomes dominant, calling for more DCs to be opened.

The trade-off between the two objectives, cost and emissions minimization, is illustrated in Fig. 5
                         that shows the Pareto frontier curve. It can be noticed, as in Case I, that a substantial reduction in GHG emissions can be achieved without significantly increasing the cost. For example, 25 percent reduction in the GHG emissions can be achieved with only 3 percent increase in cost by setting w to 0.5 instead of 0. However, the cost of emissions reduction increases exponentially beyond this point.


                        Fig. 6
                         shows the breakdown of the different components in the combined objective function. The inventory cost contribution is high initially due to high value of the products. When w is increased, the inventory cost increases as an absolute value as more DCs are opened and the risk-pooling advantage is lost. However, it decreases as a ratio of the total objective value when the other cost components (transportation and capacity) increase at a faster pace thanks to the environmental penalty imposed.

@&#CONCLUSIONS@&#

In this paper, we developed a new mathematical model for designing cold supply chains with environmental considerations and proposed a novel approach to solve it efficiently. The model links the different components of the design problem by minimizing the capacity, inventory, and transportation costs simultaneously while accounting for realistic considerations such as stochastic demand, the inventory policy used in warehouses, and economies of scale inherent in different aspects of the system. Our model differs from the traditional green supply chain models found in the literature in three main aspects. (1) It considers the entire global warming impact of the cold supply chain, including the effect of refrigerant gas leakage in addition to the CO2 emissions related to energy consumption. (2) It does not stipulate any restrictive assumptions regarding the demand pattern or inventory policy implemented at warehouses except concavity of the inventory functions. (3) It bases the determination of the warehouse capacity on the actual storage requirements as determined by the inventory policy and not on the throughput.

The solution approach combines the efficiency of optimization methods with the accuracy of simulation methods. We were able to provide a closed-form expression for the best Lagrangian multipliers so that the Lagrangian bound is obtained in a single iteration alongside a feasible solution. Lagrangian decomposition is embedded in a B&B framework to close the optimality gap. When the inventory functions cannot be expressed explicitly in the mathematical model, a simulation-optimization algorithm is used within the Lagrangian approach to estimate these functions at the branching points.

The proposed approach was tested on two realistic cases representing industries with different logistical characteristics. The results show that it is possible to substantially reduce the global warming effect of cold supply chains with a small increase, and sometimes with virtually no increase, in cost. Furthermore, we shed light on how the contribution of the different cost components affect the design of the cold supply chain. The managerial insights drawn from these results enable the decision-makers to identify and target the primary cost and emissions drivers in their supply chain networks. Also, through these tests, the proposed approach is shown to be versatile and can be tailored to suit many real life situations including different demand patterns, inventory policies, transportation modes, and operational constraints.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the anonymous reviewers for their valuable comments and suggestions to improve the paper.

The proposed approach is valid only when the inventory functions are concave. Concavity of the total inventory cost function (tjl
                     ) is assured for inventory policies with explicit formulas such as the EOQ. Other than these special cases, little was reported in the literature about the nature of the cost function. This issue, however, is closely related to the topic of warehouse consolidation which was studied extensively. The effect of increasing the demand served by a certain warehouse is equivalent to consolidating it with an identical warehouse that serves the additional demand. The cost effect of warehouse consolidation was first studied by Eppen (1979), who concluded that cost saving is achieved when demand from different sources is managed in a centralized manner. In particular, he showed that when demand is independent and normally distributed, inventory cost can be represented as a square root function in a multi-echelon newsvendor problem. Teo, Ou, and Goh (2001) studied the (r, Q) systems and noted that consolidation leads to lower total inventory cost if the demands are i.i.d., or when they follow independent but possibly nonidentical Poisson processes. Although they showed also that, for a general demand distribution, consolidation can lead to higher inventory cost, this happens only under special conditions including very different ordering cost and lead times across warehouses. Clearly, when considering the cost function of a single warehouse, this case is irrelevant. Lim, Ou, and Teo (2003) reached the same conclusion for multi-echelon system and noted that “consolidated systems are rarely suboptimal”. Apart from analytical models, the functional form of the total inventory cost for the complex (s, S) inventory policy was approximated using regression methods for a wide range of system parameters and demand distributions and was shown to be concave in the demand served (Ehrhardt, 1981). Numerical results presented in other studies have shown that the inventory cost is concave, although that was not explicitly reported.

When it comes to the maximum inventory level function (sjl
                     ), it is even more difficult to ascertain its concavity with respect to the demand in the general case. Since most inventory policies are simplifications of the (s, S) policy, we focus our attention on this policy. Ehrhardt (1979) and Schneider and Ringuest (1990) have used regression analysis to derive power approximations of the (s, S) policy under a wide range of conditions. The regression models developed suggest that both s and 
                        
                           (
                           S
                           −
                           s
                           )
                        
                      are concave functions of the demand rate, implying that the maximum inventory level S is also a concave function.

While the results discussed above do not lead to a definite conclusion that inventory functions are concave in the general case, they provide a strong indication. Note that, since the maximum inventory cost function sjl
                     (Pjl
                     ) is embedded within the concave function 
                        
                           
                              
                                 f
                                 ^
                              
                              j
                           
                           
                              (
                              
                                 Q
                                 j
                              
                              )
                           
                           ,
                        
                      the nested function may still be concave in Pjl
                      even if sjl
                      are slightly convex. For further assurance about the concavity of the inventory functions in our case study, we estimated their values using simulation.

First, let us solve the subproblems for 
                        
                           
                              λ
                              
                                 j
                              
                              *
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           ⋯
                           ,
                           n
                        
                      and 
                        
                           
                              μ
                              
                                 j
                                 l
                              
                              *
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           ⋯
                           ,
                           n
                           ,
                           
                           l
                           =
                           1
                           ,
                           ⋯
                           ,
                           q
                        
                     . Let h
                     * ∈ H be the index of the optimal solution of [SP1].

The solution of [SP2
                        j
                     ] is:

                        
                           
                              
                                 
                                    
                                       
                                          v
                                          [
                                          S
                                          P
                                          
                                             2
                                             j
                                          
                                          ]
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          min
                                          
                                             (
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                                )
                                             
                                             −
                                             
                                                λ
                                                
                                                   j
                                                
                                                *
                                             
                                             
                                                
                                                   Q
                                                   ̲
                                                
                                                j
                                             
                                             ,
                                             
                                                
                                                   f
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                )
                                             
                                             −
                                             
                                                λ
                                                
                                                   j
                                                
                                                *
                                             
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

And the solution of [SP3
                        jl
                     ] is:

                        
                           
                              
                                 
                                    
                                       
                                          v
                                          [
                                          S
                                          P
                                          
                                             3
                                             
                                                j
                                                l
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          min
                                          
                                             (
                                             
                                                t
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                λ
                                                
                                                   j
                                                
                                                *
                                             
                                             
                                                u
                                                l
                                             
                                             
                                                s
                                                
                                                   j
                                                   l
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             μ
                                             
                                                j
                                                l
                                             
                                             *
                                          
                                          
                                             
                                                P
                                                ¯
                                             
                                             
                                                j
                                                l
                                             
                                          
                                          ,
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             λ
                                             
                                                j
                                             
                                             *
                                          
                                          
                                             u
                                             l
                                          
                                          
                                             s
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             μ
                                             
                                                j
                                                l
                                             
                                             *
                                          
                                          
                                             
                                                P
                                                ¯
                                             
                                             
                                                j
                                                l
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                +
                                                
                                                   λ
                                                   
                                                      j
                                                   
                                                   *
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Thus, the Lagrangian lower bound corresponding to the proposed multipliers is:

                        
                           (B.1)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          L
                                          B
                                          
                                             (
                                             
                                                λ
                                                *
                                             
                                             ,
                                             
                                                μ
                                                *
                                             
                                             )
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                a
                                                ^
                                             
                                             j
                                          
                                          
                                             z
                                             
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                c
                                                ^
                                             
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                             
                                                h
                                                *
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                                *
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                +
                                                
                                                   λ
                                                   
                                                      j
                                                   
                                                   *
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Second, let us consider the relaxed dual master problem [RDMP] corresponding to 
                        
                           H
                           =
                           {
                           
                              h
                              *
                           
                           }
                        
                     :

                        
                           (B.2)
                           
                              
                                 
                                    
                                       
                                          [RDMP]:
                                          
                                       
                                    
                                    
                                       
                                          max
                                          
                                             λ
                                             ,
                                             μ
                                          
                                       
                                    
                                    
                                       
                                          
                                          
                                             {
                                             
                                                θ
                                                1
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                θ
                                                
                                                   2
                                                   j
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                θ
                                                
                                                   3
                                                   j
                                                   l
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       s.t.
                                    
                                    
                                       
                                          
                                          
                                             θ
                                             1
                                          
                                          −
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             μ
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             d
                                             
                                                i
                                                l
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          ≤
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                a
                                                ^
                                             
                                             j
                                          
                                          
                                             z
                                             
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                c
                                                ^
                                             
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                r
                                                ^
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.3)
                           
                              
                                 
                                    
                                    
                                    
                                    
                                       
                                          
                                             θ
                                             
                                                2
                                                j
                                             
                                          
                                          +
                                          
                                             λ
                                             j
                                          
                                          
                                             
                                                Q
                                                ¯
                                             
                                             j
                                          
                                          ≤
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.4)
                           
                              
                                 
                                    
                                    
                                    
                                    
                                       
                                          
                                             θ
                                             
                                                2
                                                j
                                             
                                          
                                          +
                                          
                                             λ
                                             j
                                          
                                          
                                             
                                                Q
                                                ̲
                                             
                                             j
                                          
                                          ≤
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ̲
                                                
                                                j
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.5)
                           
                              
                                 
                                    
                                    
                                    
                                    
                                       
                                          
                                             θ
                                             
                                                3
                                                j
                                                l
                                             
                                          
                                          −
                                          
                                             λ
                                             j
                                          
                                          
                                             u
                                             l
                                          
                                          
                                             s
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             μ
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             
                                                P
                                                ¯
                                             
                                             
                                                j
                                                l
                                             
                                          
                                          ≤
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ,
                                          l
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.6)
                           
                              
                                 
                                    
                                    
                                    
                                    
                                       
                                          
                                             θ
                                             
                                                3
                                                j
                                                l
                                             
                                          
                                          −
                                          
                                             λ
                                             j
                                          
                                          
                                             u
                                             l
                                          
                                          
                                             s
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             μ
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             
                                                P
                                                ̲
                                             
                                             
                                                j
                                                l
                                             
                                          
                                          ≤
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ,
                                          l
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     and let us check whether the solution (
                        
                           
                              λ
                              j
                           
                           =
                           
                              λ
                              
                                 j
                              
                              *
                           
                           ,
                           
                           
                              μ
                              
                                 j
                                 l
                              
                           
                           =
                           
                              μ
                              
                                 j
                                 l
                              
                              *
                           
                           ,
                           
                           
                              θ
                              1
                           
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              n
                           
                           
                              
                                 a
                                 ^
                              
                              j
                           
                           
                              z
                              
                                 j
                              
                              
                                 h
                                 *
                              
                           
                           +
                           
                              ∑
                              
                                 k
                                 =
                                 1
                              
                              p
                           
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              n
                           
                           
                              ∑
                              
                                 l
                                 =
                                 1
                              
                              q
                           
                           
                              
                                 c
                                 ^
                              
                              
                                 j
                                 k
                                 l
                              
                           
                           
                              y
                              
                                 j
                                 k
                                 l
                              
                              
                                 h
                                 *
                              
                           
                           +
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              n
                           
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              m
                           
                           
                              (
                              
                                 ∑
                                 
                                    l
                                    =
                                    1
                                 
                                 q
                              
                              
                                 μ
                                 
                                    j
                                    l
                                 
                              
                              
                                 d
                                 
                                    i
                                    l
                                 
                              
                              +
                              
                                 
                                    r
                                    ^
                                 
                                 
                                    i
                                    j
                                 
                              
                              )
                           
                           
                              x
                              
                                 i
                                 j
                              
                              
                                 h
                                 *
                              
                           
                           ,
                           
                           
                              θ
                              
                                 2
                                 j
                              
                           
                           =
                           
                              
                                 
                                    
                                       f
                                       ^
                                    
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          Q
                                          ̲
                                       
                                       j
                                    
                                    )
                                 
                                 
                                    
                                       Q
                                       ¯
                                    
                                    j
                                 
                                 −
                                 
                                    
                                       f
                                       ^
                                    
                                    j
                                 
                                 
                                    (
                                    
                                       
                                          Q
                                          ¯
                                       
                                       j
                                    
                                    )
                                 
                                 
                                    
                                       Q
                                       ̲
                                    
                                    j
                                 
                              
                              
                                 
                                    
                                       Q
                                       ¯
                                    
                                    j
                                 
                                 −
                                 
                                    
                                       Q
                                       ̲
                                    
                                    j
                                 
                              
                           
                           ,
                           
                           
                              θ
                              
                                 3
                                 j
                                 l
                              
                           
                           =
                           
                              
                                 
                                    t
                                    
                                       j
                                       l
                                    
                                 
                                 
                                    (
                                    
                                       
                                          P
                                          ̲
                                       
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                                 
                                    
                                       P
                                       ¯
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 −
                                 
                                    t
                                    
                                       j
                                       l
                                    
                                 
                                 
                                    (
                                    
                                       
                                          P
                                          ¯
                                       
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                                 
                                    
                                       P
                                       ̲
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 +
                                 
                                    λ
                                    
                                       j
                                    
                                    *
                                 
                                 
                                    u
                                    l
                                 
                                 
                                    (
                                    
                                       s
                                       
                                          j
                                          l
                                       
                                    
                                    
                                       (
                                       
                                          
                                             P
                                             ̲
                                          
                                          
                                             j
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       
                                          P
                                          ¯
                                       
                                       
                                          j
                                          l
                                       
                                    
                                    −
                                    
                                       s
                                       
                                          j
                                          l
                                       
                                    
                                    
                                       (
                                       
                                          
                                             P
                                             ¯
                                          
                                          
                                             j
                                             l
                                          
                                       
                                       )
                                    
                                    
                                       
                                          P
                                          ̲
                                       
                                       
                                          j
                                          l
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       P
                                       ¯
                                    
                                    
                                       j
                                       l
                                    
                                 
                                 −
                                 
                                    
                                       P
                                       ̲
                                    
                                    
                                       j
                                       l
                                    
                                 
                              
                           
                        
                     ) is feasible to [RDMP]. By substituting in (B.2)–(B.6), all these constraints are found to be satisfied as equalities. The objective function value of [RDMP] corresponding to the proposed solution is

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          v
                                          [RDMP]
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                a
                                                ^
                                             
                                             j
                                          
                                          
                                             z
                                             
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                c
                                                ^
                                             
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                             
                                                h
                                                *
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                                *
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                +
                                                
                                                   λ
                                                   
                                                      j
                                                   
                                                   *
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

To prove the optimality of the proposed solution, we resort to the dual of [RDMP], the restricted master problem [RMP]:

                        
                           (B.7)
                           
                              
                                 
                                    
                                       
                                          [RMP]:
                                          
                                       
                                    
                                    
                                       min
                                    
                                    
                                       
                                          
                                          
                                          
                                             {
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   a
                                                   ^
                                                
                                                j
                                             
                                             
                                                z
                                                
                                                   j
                                                
                                                
                                                   h
                                                   *
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                p
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   j
                                                   k
                                                   l
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                   l
                                                
                                                
                                                   h
                                                   *
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                                
                                                   h
                                                   *
                                                
                                             
                                             }
                                          
                                          
                                             α
                                             
                                                h
                                                *
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          
                                             β
                                             
                                                1
                                                j
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ̲
                                                
                                                j
                                             
                                             )
                                          
                                          
                                             β
                                             
                                                2
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             γ
                                             
                                                1
                                                j
                                                l
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             γ
                                             
                                                2
                                                j
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       s.t.
                                    
                                    
                                       
                                          
                                          
                                             α
                                             
                                                h
                                                *
                                             
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.8)
                           
                              
                                 
                                    
                                    
                                    
                                    
                                       
                                          
                                             β
                                             
                                                1
                                                j
                                             
                                          
                                          +
                                          
                                             β
                                             
                                                2
                                                j
                                             
                                          
                                          =
                                          1
                                       
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.9)
                           
                              
                                 
                                    
                                    
                                    
                                    
                                       
                                          
                                             γ
                                             
                                                1
                                                j
                                                l
                                             
                                          
                                          +
                                          
                                             γ
                                             
                                                2
                                                j
                                                l
                                             
                                          
                                          =
                                          1
                                       
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ,
                                          l
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.10)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                Q
                                                ¯
                                             
                                             j
                                          
                                          
                                             β
                                             
                                                1
                                                j
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                                ̲
                                             
                                             j
                                          
                                          
                                             β
                                             
                                                2
                                                j
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             u
                                             l
                                          
                                          
                                             s
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             γ
                                             
                                                1
                                                j
                                                l
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          −
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             u
                                             l
                                          
                                          
                                             s
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             γ
                                             
                                                2
                                                j
                                                l
                                             
                                          
                                          =
                                          0
                                          ,
                                          
                                          
                                          ∀
                                          j
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.11)
                           
                              
                                 
                                    
                                    
                                    
                                    
                                       
                                          
                                             
                                                P
                                                ¯
                                             
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             γ
                                             
                                                1
                                                j
                                                l
                                             
                                          
                                          +
                                          
                                             
                                                P
                                                ̲
                                             
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             γ
                                             
                                                1
                                                j
                                                l
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             d
                                             
                                                i
                                                l
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          
                                             α
                                             
                                                h
                                                *
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                    
                                       
                                          
                                          ∀
                                          j
                                          ,
                                          l
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

By substituting the value of 
                        
                           α
                           
                              h
                           
                           *
                        
                      from (B.7) in (B.11) and solving (B.9) and (B.11) simultaneously, we get:

                        
                           
                              
                                 
                                    
                                       
                                          γ
                                          
                                             1
                                             j
                                             l
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      h
                                                      *
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          γ
                                          
                                             2
                                             j
                                             l
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      h
                                                      *
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     And by solving (B.8) and (B.10) simultaneously, we get:

                        
                           
                              
                                 
                                    
                                       
                                          β
                                          
                                             1
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      1
                                                      j
                                                      l
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      2
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          β
                                          
                                             2
                                             j
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      1
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      2
                                                      j
                                                      l
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Thus,

                        
                           
                              
                                 
                                    
                                       
                                          v
                                          [
                                          R
                                          M
                                          P
                                          ]
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                a
                                                ^
                                             
                                             j
                                          
                                          
                                             z
                                             
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                c
                                                ^
                                             
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             
                                                r
                                                ^
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      1
                                                      j
                                                      l
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      2
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ̲
                                                
                                                j
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      1
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   q
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                   
                                                      2
                                                      j
                                                      l
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      h
                                                      *
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   m
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      l
                                                   
                                                
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      h
                                                      *
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                a
                                                ^
                                             
                                             j
                                          
                                          
                                             z
                                             
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             p
                                          
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                c
                                                ^
                                             
                                             
                                                j
                                                k
                                                l
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                                l
                                             
                                             
                                                h
                                                *
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             m
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                q
                                             
                                             
                                                μ
                                                
                                                   j
                                                   l
                                                
                                                *
                                             
                                             
                                                d
                                                
                                                   i
                                                   l
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                   ^
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                             
                                             
                                                h
                                                *
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                +
                                                
                                                   λ
                                                   
                                                      j
                                                   
                                                   *
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   (
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

By strong duality, since 
                        
                           v
                           [
                           R
                           D
                           M
                           P
                           ]
                           =
                           v
                           [
                           R
                           M
                           P
                           ]
                           ,
                        
                      the proposed solution is optimal to [RDMP]. Furthermore, LB(λ*, μ*) ≤ v[DMP]. According to (B.1), 
                        
                           L
                           B
                           
                              (
                              
                                 λ
                                 *
                              
                              ,
                              
                                 μ
                                 *
                              
                              )
                           
                           =
                           v
                           
                              [
                              R
                              D
                              M
                              P
                              ]
                           
                           ,
                        
                      therefore, 
                        
                           v
                           
                              [
                              R
                              D
                              M
                              P
                              ]
                           
                           =
                           v
                           
                              [
                              D
                              M
                              P
                              ]
                           
                           =
                           L
                           B
                           
                              (
                              
                                 λ
                                 *
                              
                              ,
                              
                                 μ
                                 *
                              
                              )
                           
                           ,
                        
                      the Lagrangian bound. Thus, λ
                     * and μ
                     * are optimal.

Note that the gap can be decomposed by j such that 
                        
                           δ
                           =
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              n
                           
                           
                              δ
                              j
                           
                           ,
                        
                      and

                        
                           (C.1)
                           
                              
                                 
                                    
                                       
                                          δ
                                          j
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                P
                                                
                                                   j
                                                   l
                                                
                                                *
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                Q
                                                
                                                   j
                                                
                                                *
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                
                                                   λ
                                                   
                                                      j
                                                   
                                                   *
                                                
                                                
                                                   u
                                                   l
                                                
                                                
                                                   [
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      −
                                                      
                                                         P
                                                         
                                                            j
                                                            l
                                                         
                                                         *
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      s
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                            ¯
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         P
                                                         
                                                            j
                                                            l
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         
                                                            P
                                                            ̲
                                                         
                                                         
                                                            j
                                                            l
                                                         
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   −
                                                   
                                                      P
                                                      
                                                         j
                                                         l
                                                      
                                                      *
                                                   
                                                   )
                                                
                                                +
                                                
                                                   t
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                         ¯
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      P
                                                      
                                                         j
                                                         l
                                                      
                                                      *
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                         ̲
                                                      
                                                      
                                                         j
                                                         l
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      P
                                                      ¯
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                                −
                                                
                                                   
                                                      P
                                                      ̲
                                                   
                                                   
                                                      j
                                                      l
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Also note that since 
                        
                           
                              
                                 Q
                                 ¯
                              
                              j
                           
                           =
                           
                              ∑
                              
                                 l
                                 =
                                 1
                              
                              q
                           
                           
                              u
                              l
                           
                           
                              s
                              
                                 j
                                 l
                              
                           
                           
                              (
                              
                                 
                                    P
                                    ¯
                                 
                                 
                                    j
                                    l
                                 
                              
                              )
                           
                           ,
                        
                     
                     
                        
                           
                              Q
                              
                                 j
                              
                              *
                           
                           =
                           
                              
                                 Q
                                 ¯
                              
                              j
                           
                        
                      if and only if 
                        
                           
                              P
                              
                                 j
                                 l
                              
                              *
                           
                           =
                           
                              
                                 P
                                 ¯
                              
                              
                                 j
                                 l
                              
                           
                           ,
                           
                           ∀
                           l
                        
                     . By substituting in (C.1), we get

                        
                           
                              
                                 
                                    
                                       
                                          δ
                                          j
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ¯
                                                
                                                j
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             λ
                                             
                                                j
                                             
                                             *
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             s
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ¯
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                
                                                   [
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            Q
                                                            ¯
                                                         
                                                         j
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            Q
                                                            ̲
                                                         
                                                         j
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                          −
                                          
                                             λ
                                             
                                                j
                                             
                                             *
                                          
                                          
                                             
                                                Q
                                                ¯
                                             
                                             j
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Likewise, since 
                        
                           
                              
                                 Q
                                 ̲
                              
                              j
                           
                           =
                           
                              ∑
                              
                                 l
                                 =
                                 1
                              
                              q
                           
                           
                              u
                              l
                           
                           
                              s
                              
                                 j
                                 l
                              
                           
                           
                              (
                              
                                 
                                    P
                                    ̲
                                 
                                 
                                    j
                                    l
                                 
                              
                              )
                           
                           ,
                        
                     
                     
                        
                           
                              Q
                              
                                 j
                              
                              *
                           
                           =
                           
                              
                                 Q
                                 ̲
                              
                              j
                           
                        
                      if and only if 
                        
                           
                              P
                              
                                 j
                                 l
                              
                              *
                           
                           =
                           
                              
                                 P
                                 ̲
                              
                              
                                 j
                                 l
                              
                           
                           ,
                           
                           ∀
                           l
                        
                     . By substituting in (C.1), we get

                        
                           
                              
                                 
                                    
                                       
                                          δ
                                          j
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                f
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             
                                                
                                                   Q
                                                   ̲
                                                
                                                j
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ̲
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   
                                                      
                                                         Q
                                                         ¯
                                                      
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             λ
                                             
                                                j
                                             
                                             *
                                          
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             s
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             ∑
                                             
                                                l
                                                =
                                                1
                                             
                                             q
                                          
                                          
                                             t
                                             
                                                j
                                                l
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                   ̲
                                                
                                                
                                                   j
                                                   l
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                                
                                                   [
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            Q
                                                            ¯
                                                         
                                                         j
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            Q
                                                            ̲
                                                         
                                                         j
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                             
                                                
                                                   
                                                      Q
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      Q
                                                      ̲
                                                   
                                                   j
                                                
                                             
                                          
                                          −
                                          
                                             λ
                                             
                                                j
                                             
                                             *
                                          
                                          
                                             
                                                Q
                                                ̲
                                             
                                             j
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Thus, 
                        
                           δ
                           =
                           0
                        
                      and optimality is proven.

@&#REFERENCES@&#

