@&#MAIN-TITLE@&#Extraction of instantaneous frequencies from ridges in time–frequency representations of signals

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Identifying and following instantaneous (ridge) frequencies in complex signals.


                        
                        
                           
                           Adaptive, universal, extraction of ridge frequencies from time–frequency representations.


                        
                        
                           
                           Comparison of the performance of different approaches for ridge curve extraction.


                        
                        
                           
                           Relative performance of the synchrosqueezed transforms in terms of curve extraction.


                        
                        
                           
                           Freely available codes implementing the new method.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ridge analysis

Wavelet ridges

Time–frequency representations

Wavelet transform

Windowed Fourier transform

Instantaneous frequency

Synchrosqueezing

@&#ABSTRACT@&#


               
               
                  In signal processing applications, it is often necessary to extract oscillatory components and their properties from time–frequency representations, e.g. the windowed Fourier transform or wavelet transform. The first step in this procedure is to find an appropriate ridge curve: a sequence of amplitude peak positions (ridge points), corresponding to the component of interest and providing a measure of its instantaneous frequency. This is not a trivial issue, and the optimal method for extraction is still not settled or agreed. We discuss and develop procedures that can be used for this task and compare their performance on both simulated and real data. In particular, we propose a method which, in contrast to many other approaches, is highly adaptive so that it does not need any parameter adjustment for the signal to be analyzed. Being based on dynamic path optimization and fixed point iteration, the method is very fast, and its superior accuracy is also demonstrated. In addition, we investigate the advantages and drawbacks that synchrosqueezing offers in relation to curve extraction. The codes used in this work are freely available for download.
               
            

@&#INTRODUCTION@&#

A recurring problem in many areas of science is that of identifying curvilinear structures in noisy data and, in many cases, following them as the system evolves in time. The object of study may be spatial, as in automated screening for diabetic retinopathy [1] and in astronomy [2], or it may be a wavelet transform as in the identification of substances through terahertz tomography measurements [3], or it can be a prehistory probability density whose ridge represents the most probable fluctuational path for a nonlinear system undergoing a large fluctuation [4]. It has recently been shown that time-dependent dynamics can be of particular importance, and effective methods have been devised for characterizing the time-dependent amplitudes and phases [5,6]. In these and enumerable other cases the basic problem is that of putting a best-fit curve through a set of points, typically tracing a sequence of extrema, in a digital object. Difficulties to be overcome, in addition to the noise, may include possible crossings, self-crossings or closure of the extracted curves. The approaches that have been proposed include, for example, a variety of ridge-based methods based on locally defined principal curves [7–11] and a method based on an adaptive short-time Fourier transform [12]. In what follows we will focus on the problem as it arises in the analysis of recorded signals.

Separation of the amplitude and frequency-modulated components (AM/FM components) in a given signal, and estimation of their instantaneous characteristics, is a classical problem of signal analysis. It can be approached by projecting the signal onto the time–frequency plane, on which the changes of its spectral content can be followed in time. Such projections are called time–frequency representations (TFRs), typical examples being the windowed Fourier transform (WFT) and the wavelet transform (WT). If the construction of the TFR is well-matched to the signal׳s structure, then each AM/FM component will appear as a “curve” in the time–frequency plane, formed by a unique sequence of TFR amplitude peaks – ridge points. Based on the properties of these curves, one can estimate the time-varying characteristics of the corresponding components (such as amplitude, phase and instantaneous frequency), an idea that was first expressed in [13]. In other words, to separate a signal into its AM/FM components one can: (a) trace the ridge curves corresponding to the individual components in the signal׳s TFR; (b) feed these curves into a chosen reconstruction method in order to recover the components and their characteristics (see [14] for a detailed study of the different reconstruction methods together with evaluations of their performance).

However, the first step of such an approach, namely finding the TFR peak sequences associated with the individual signal components, is not a trivial issue. In real cases there are often many peaks in the TFR amplitude at each time, and their number often varies. In such circumstances it can be unclear which peak corresponds to which component, and which are just noise-induced artifacts.

In the present paper, we concentrate solely on the problem of ridge curve identification, which is of great importance in time–frequency signal processing. Ridge analysis is widely used, e.g. machine fault diagnosis [15], fringe pattern analysis [16], studies of cardiovascular dynamics [17] and system classification [18,19]. Although curve extraction has been addressed explicitly in the past [17,20–23], there seems to be no agreement as to the optimal procedure to be used for this task. Here we discuss and generalize some existing algorithms, present new ones, and compare their performance. We end up with a method that is accurate and of almost universal applicability, so that it works well for a large class of signals and, in most cases, does not require adjustment by the user; this is the main contribution of the work. The effects of synchrosqueezing [23–26] on curve extraction are also studied.

The plan of the work is as follows. After reviewing the background and notation in Section 2, we discuss different schemes for curve extraction in Section 3. In Section 4 we compare the performance of these schemes, while the advantages and drawbacks of synchrosqueezing in relation to curve extraction are studied in Section 5, and the limitations of the proposed methods are discussed in Section 6. We draw conclusions and summarize the work in Section 7. A dynamic programming algorithm for fast optimization of a path functional of particular form over all possible peak sequences is discussed in the Appendix.

In what follows, we denote by 
                        
                           
                              f
                           
                           
                              ^
                           
                        
                        (
                        ξ
                        )
                      and 
                        
                           
                              f
                           
                           
                              +
                           
                        
                        (
                        t
                        )
                     , respectively, the Fourier transform of the function f(t) and its positive frequency part:
                        
                           (2.1)
                           
                              
                                 
                                    f
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    −
                                    ∞
                                 
                                 
                                    ∞
                                 
                              
                              f
                              (
                              t
                              )
                              
                                 
                                    e
                                 
                                 
                                    −
                                    i
                                    ξ
                                    t
                                 
                              
                              
                              dt
                              
                              ⇔
                              
                              f
                              (
                              t
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                    π
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    −
                                    ∞
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              
                                 
                                    e
                                 
                                 
                                    i
                                    ξ
                                    t
                                 
                              
                              
                              d
                              ξ
                              ,
                              
                                 
                                    f
                                 
                                 
                                    +
                                 
                              
                              (
                              t
                              )
                              ≡
                              
                                 
                                    1
                                 
                                 
                                    2
                                    π
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              
                                 
                                    e
                                 
                                 
                                    i
                                    ξ
                                    t
                                 
                              
                              
                              d
                              ξ
                              .
                           
                        
                     Next, by an AM/FM component (or simply component) we will mean a signal of the form:
                        
                           (2.2)
                           
                              x
                              (
                              t
                              )
                              =
                              A
                              (
                              t
                              )
                              
                              cos
                              
                              ϕ
                              (
                              t
                              )
                              
                              (
                              ∀
                              t
                              :
                              A
                              (
                              t
                              )
                              >
                              0
                              ,
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              >
                              0
                              )
                              ,
                           
                        
                     which is additionally required to satisfy 
                        A
                        (
                        t
                        )
                        
                           
                              e
                           
                           
                              i
                              ϕ
                              (
                              t
                              )
                           
                        
                        ≈
                        2
                        
                           
                              [
                              A
                              (
                              t
                              )
                              
                                 
                                    e
                                 
                                 
                                    i
                                    ϕ
                                    (
                                    t
                                    )
                                 
                              
                              ]
                           
                           
                              +
                           
                        
                     , so that A(t) and 
                        ϕ
                        (
                        t
                        )
                      are determined uniquely and, in the case of a single component, can be found using the analytic signal approach; more detailed discussions of issues related to the definition and estimation of the amplitude A(t), phase 
                        ϕ
                        (
                        t
                        )
                      and instantaneous frequency 
                        ν
                        (
                        t
                        )
                        ≡
                        
                           
                              ϕ
                           
                           
                              ′
                           
                        
                        (
                        t
                        )
                      of the component can be found in [14,27–30].

In real cases, a signal usually contains many components x
                     
                        i
                     (t) of the form (2.2), as well as some noise 
                        ζ
                        (
                        t
                        )
                      (that can be of any form, and is not necessarily white and Gaussian [30]):
                        
                           (2.3)
                           
                              s
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              +
                              ζ
                              (
                              t
                              )
                              .
                           
                        
                     The goal of ridge analysis is to extract these components, either all or only those of interest, from the signal׳s TFR.

The two main linear TFRs suitable for components extraction and reconstruction are the windowed Fourier transform (WFT) 
                        
                           
                              G
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                      and the wavelet transform (WT) 
                        
                           
                              W
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                     . Given a signal s(t), they can be constructed as
                        
                           (2.4)
                           
                              
                                 
                                    G
                                 
                                 
                                    s
                                 
                              
                              (
                              ω
                              ,
                              t
                              )
                              ≡
                              
                                 
                                    ∫
                                 
                                 
                                    −
                                    ∞
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    +
                                 
                              
                              (
                              u
                              )
                              g
                              (
                              u
                              −
                              t
                              )
                              
                                 
                                    e
                                 
                                 
                                    −
                                    i
                                    ω
                                    (
                                    u
                                    −
                                    t
                                    )
                                 
                              
                              
                              du
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                    π
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    i
                                    ξ
                                    t
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              
                                 
                                    g
                                 
                                 
                                    ^
                                 
                              
                              (
                              ω
                              −
                              ξ
                              )
                              
                              d
                              ξ
                              ,
                              
                                 
                                    W
                                 
                                 
                                    s
                                 
                              
                              (
                              ω
                              ,
                              t
                              )
                              ≡
                              
                                 
                                    ∫
                                 
                                 
                                    −
                                    ∞
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    +
                                 
                              
                              (
                              u
                              )
                              
                                 
                                    ψ
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    
                                       ω
                                       (
                                       u
                                       −
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ψ
                                          
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    ω
                                    
                                    du
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ψ
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                    π
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    i
                                    ξ
                                    t
                                 
                              
                              
                                 
                                    s
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    ω
                                 
                                 
                                    ψ
                                 
                              
                              ξ
                              /
                              ω
                              )
                              
                              d
                              ξ
                              ,
                           
                        
                     where 
                        
                           
                              s
                           
                           
                              +
                           
                        
                        (
                        t
                        )
                      is the positive frequency part of the signal (as defined in (2.1)), g(t) and 
                        ψ
                        (
                        t
                        )
                      are respectively the window and wavelet functions chosen, and 
                        
                           
                              ω
                           
                           
                              ψ
                           
                        
                        ≡
                        argmax
                        |
                        
                           
                              ψ
                           
                           
                              ^
                           
                        
                        (
                        ξ
                        )
                        |
                      denotes the wavelet peak frequency (for the WFT we assume 
                        argmax
                        |
                        
                           
                              g
                           
                           
                              ^
                           
                        
                        (
                        ξ
                        )
                        |
                        =
                        0
                     ). Note that the WT is commonly defined through the scales 
                        a
                        =
                        
                           
                              ω
                           
                           
                              ψ
                           
                        
                        /
                        ω
                     , but that in (2.4) we have already transformed to frequencies.

The main difference between the two TFRs mentioned is that the WFT distinguishes the components on the basis of their frequency differences (linear frequency resolution), while the WT does so on the basis of ratios between their frequencies (logarithmic frequency resolution). In effect, while the time-resolution of the WFT is fixed, for the WT it is linearly proportional to frequency, so that the time-modulation of the higher frequency components is represented better than that for the components at lower frequencies.

In numerical simulations we use a Gaussian window for the WFT and a lognormal wavelet [14] for the WT:
                        
                           (2.5)
                           
                              
                                 
                                    g
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              =
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                             
                                          
                                          ξ
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                 
                              
                              
                              ⇔
                              
                              g
                              (
                              t
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          2
                                          π
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                0
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          t
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              =
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          (
                                          2
                                          π
                                          
                                             
                                                f
                                             
                                             
                                                0
                                             
                                          
                                          
                                          log
                                          
                                          ξ
                                          )
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    ω
                                 
                                 
                                    ψ
                                 
                              
                              =
                              1
                              ,
                           
                        
                     where f
                     0 is the resolution parameter determining the tradeoff between the time and frequency resolution of the resultant transform (we use 
                        
                           
                              f
                           
                           
                              0
                           
                        
                        =
                        1
                      by default). While the methods developed below are generally applicable for any window/wavelet, the forms (2.5) seem to be the best choice [14], at least for the extraction and reconstruction of components.

As illustrated in Fig. 1
                     , the components present in the signal appear in its TFR as “curves” (which will be referred to as ridge curves), i.e. time sequences of close peaks. Generally, the component׳s ridge curve can be defined as the sequence of TFR amplitude peaks into which most of the energy of that component is mapped at each time (for further discussion see e.g. [13,21,24,31]). In the case when the signal consists of only one component, and there is no noise, and the TFR resolution is sufficient to represent all of the related time and frequency variability, there will only be one ridge curve: it can be found as a simple 
                        argmax
                      of the TFR amplitude at each time; but in real cases there are usually many peaks, noise, and other complications.

The problem of curve extraction therefore lies in selecting from among all possible trajectories the sequence of peaks that corresponds to a single component; the positions of these peaks then form a specific frequency profile, which will be denoted as 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        t
                        )
                     . Having found the ridge curve, the parameters of the corresponding component can be estimated in a number of ways [14,24,31]. In the present work, however, we concentrate on curve extraction only and, except where it is unavoidable, do not consider the reconstruction issues; for a detailed study of the latter, see [14]. Note that, in practice, it is convenient to find the ridge curve associated with the dominant component present, which can then be reconstructed and subtracted from the signal; the procedure can then be repeated to extract any other possible ridge curves.

In what follows, we denote the ridge frequencies, i.e. positions of the peaks at each time, as 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                     , the corresponding TFR amplitudes as Q
                     
                        m
                     (t), and their numbers as N
                     
                        p
                     (t):
                        
                           (2.6)
                           
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                              :
                              {
                              
                                 
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         ω
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   ω
                                                   ,
                                                   t
                                                   )
                                                   |
                                                
                                                ]
                                             
                                             
                                                ω
                                                =
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      m
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         ω
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   (
                                                   ω
                                                   ,
                                                   t
                                                   )
                                                   |
                                                
                                                ]
                                             
                                             
                                                ω
                                                =
                                                
                                                   
                                                      ν
                                                   
                                                   
                                                      m
                                                   
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                          <
                                          0
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                              ≡
                              |
                              
                                 
                                    H
                                 
                                 
                                    s
                                 
                              
                              (
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                              ,
                              t
                              )
                              |
                              ,
                              
                              m
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    p
                                 
                              
                              (
                              t
                              )
                              ,
                           
                        
                     where 
                        
                           
                              H
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                      is the chosen TFR of a given signal (WFT 
                        
                           
                              G
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                      or WT 
                        
                           
                              W
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                     ). The ridge curve can then be parametrized as 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              ν
                           
                           
                              
                                 
                                    m
                                 
                                 
                                    c
                                 
                              
                              (
                              t
                              )
                           
                        
                        (
                        t
                        )
                     , where m
                     
                        c
                     (t) is the sequence of peak indices at each time t, which we need to find. Note that the number of peaks N
                     
                        p
                     (t) can vary in time and in practice is often greater than the number of components present in the signal, with the additional peaks being attributable e.g. to noise.

For simplicity, we have treated ω and t as continuous variables. In practice, however, both time and frequency are discretized, and so also are many other related quantities (e.g. the ridge curve 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        t
                        )
                      becomes a discrete set of points). In what follows we therefore assume that the signal is sampled at 
                        
                           
                              t
                           
                           
                              n
                           
                        
                        =
                        (
                        n
                        −
                        1
                        )
                        Δ
                        t
                      for 
                        n
                        =
                        1
                        ,
                        …
                        ,
                        N
                     , so that N is the signal׳s length in samples, while the TFRs (2.4) are calculated for the frequencies 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                        =
                        
                           
                              ω
                           
                           
                              min
                           
                        
                        +
                        (
                        k
                        −
                        1
                        )
                        Δ
                        ω
                      (WFT) or 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                        =
                        
                           
                              2
                           
                           
                              
                                 
                                    k
                                    −
                                    1
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              ω
                           
                           
                              min
                           
                        
                      (WT), where 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              N
                           
                           
                              f
                           
                        
                     . The discretization parameters 
                        Δ
                        ω
                      and n
                     
                        v
                      are generally selected by the user, but one can use e.g. the criteria suggested in [14] to make an appropriate choice.

The most straightforward way to extract the ridge curve is first to choose some starting point 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              0
                           
                        
                        )
                     , and then to follow from it forwards and backwards in time, selecting next ridges as those maximizing some suitably chosen functional of the corresponding peak amplitudes and the previously selected ridges. This approach, which we will call one-step optimization, can be formulated mathematically as
                        
                           (3.1)
                           
                              
                                 for
                              
                              
                              n
                              =
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              +
                              1
                              ,
                              …
                              ,
                              N
                              
                              
                                 do
                              
                              :
                              
                                 
                                    m
                                 
                                 
                                    c
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       argmax
                                    
                                    
                                       m
                                    
                                 
                              
                              {
                              
                                 F
                                 [
                                 
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          Q
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          ν
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          −
                                          2
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ]
                              
                              }
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              
                                 
                                    ν
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                           
                        
                     and similarly backwards in time, for 
                        n
                        =
                        
                           
                              n
                           
                           
                              0
                           
                        
                        −
                        1
                        ,
                        
                           
                              n
                           
                           
                              0
                           
                        
                        −
                        2
                        ,
                        …
                        ,
                        1
                     . In (3.1), n
                     0 denotes the discrete index of the starting time t
                     0 (for which 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           
                        
                        )
                      is known), and 
                        F
                        [
                        ⋯
                        ]
                      is the chosen functional of the current discrete time t
                     
                        n
                     , the peak positions 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      and amplitudes 
                        
                           
                              Q
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      at this time, and all previously selected ridge points 
                        {
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           
                        
                        ≤
                        t
                        ≤
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        }
                     . For scheme (3.1) to be O 
                        (
                        N
                        )
                     , the functional 
                        F
                        [
                        
                           ⋯
                        
                        ]
                      should either depend on the finite number of previously selected ridges, or on the set of parameters which can be updated in O 
                        (
                        1
                        )
                      steps whenever a new point becomes available (e.g. the moments of 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        t
                        )
                     ).

To implement (3.1), one needs to choose the starting time index n
                     0 and the corresponding ridge 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                           
                        
                        )
                     . It seems natural to select this starting point (among all times and ridges) as being that for which the functional in (3.1) is likely to attain its maximum: 
                        
                           (3.2)
                           
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                              =
                              
                                 
                                    ν
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                              ,
                              {
                              
                                 
                                    m
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    0
                                 
                              
                              }
                              =
                              
                                 
                                    
                                       argmax
                                    
                                    
                                       {
                                       m
                                       ,
                                       n
                                       }
                                    
                                 
                              
                              {
                              
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ]
                              
                              }
                              ,
                           
                        
                     where 
                        
                           
                              F
                           
                           
                              0
                           
                        
                        [
                        ⋯
                        ]
                      denotes a “zero-step” version of the original functional, obtained from the latter by taking its maximum among all the other parameters. For example, if one has 
                        
                           
                              F
                              [
                              ⋯
                              ]
                              =
                              f
                              (
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              )
                              +
                              g
                              (
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              −
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              )
                              ,
                           
                        
                     then 
                        
                           
                              F
                           
                           
                              0
                           
                        
                        [
                        ⋯
                        ]
                        =
                        f
                        (
                        
                           
                              Q
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        ,
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        )
                        +
                        
                           
                              max
                           
                           
                              Δ
                              ξ
                           
                        
                        g
                        (
                        Δ
                        ξ
                        )
                     ; if additionally 
                        f
                        (
                        
                           
                              Q
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        ,
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        )
                      does not depend on 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      and is proportional to 
                        
                           
                              Q
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                     , then (3.2) will correspond to the highest TFR amplitude peak over all time. The criterion (3.2) works well in most cases, although it could still provide a “bad” starting point when sharp time events are present or the noise is too strong.

A serious drawback of the outlined one-step approach (3.1) is that even a single wrongly selected point might completely change all the following curve being extracted. Consequently, it is more accurate to optimize the functional not over each consecutive point, as in (3.1), but over the whole profile 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        t
                        )
                     , selecting the ridge curve as being that which maximizes the full integral of 
                        F
                        [
                        ⋯
                        ]
                      over time:
                        
                           (3.3)
                           
                              {
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              …
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    N
                                 
                              
                              )
                              }
                              =
                              {
                              
                                 
                                    ν
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              …
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    N
                                 
                              
                              )
                              }
                              ,
                              {
                              
                                 
                                    m
                                 
                                 
                                    c
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              …
                              ,
                              
                                 
                                    m
                                 
                                 
                                    c
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    N
                                 
                              
                              )
                              }
                              =
                              
                                 
                                    
                                       argmax
                                    
                                    
                                       {
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             N
                                          
                                       
                                       }
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              F
                              [
                              
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ,
                              
                              
                                 
                                    
                                       ν
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ,
                                 {
                                 
                                    
                                       
                                          ν
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ν
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                                 }
                              
                              ]
                              .
                           
                        
                     This approach, where the optimization is performed over all possible sequences of peak numbers 
                        {
                        
                           
                              m
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              m
                           
                           
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              m
                           
                           
                              N
                           
                        
                        }
                     , will be referred to as the path optimization. In general, it is computationally very expensive. However, if the functional depends on only a finite number of previous points 
                        {
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              i
                           
                        
                        )
                        ,
                        …
                        ,
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        }
                     , rather than on the full history, then the optimal path in terms of (3.3) can be selected in O 
                        (
                        N
                        )
                      computations using a dynamic programming algorithm (see Appendix). Note that, in this way, the widely used method of Carmona et al. [20] can also be performed in O 
                        (
                        N
                        )
                      steps instead of the computationally expensive simulated annealing used previously.

It will be demonstrated in Section 4 (Figs. 3 and 4) that path optimization (3.3) usually gives much better results than the one-step optimization (3.1), and should therefore always be preferred to the latter. Furthermore, it has no problem associated with the selection of the starting point (3.2), as all the trajectories are explored.

What remains is to select an appropriate functional in (3.3). We consider below some curve-extraction schemes defined by particular classes of 
                        F
                        [
                        ⋯
                        ]
                     . We first develop these schemes for the WFT, and then discuss how they can be adjusted for the WT. In all cases, we perform path optimization using the algorithm discussed in the Appendix. Taking into account its complexity, and the fact that one needs to locate all peaks (2.6) in the TFR prior to applying any extraction procedure, the computational costs of the methods discussed below are 
                        O
                        (
                        
                           
                              N
                           
                           
                              f
                           
                        
                        N
                        )
                        +
                        O
                        (
                        
                           
                              M
                           
                           
                              p
                           
                           
                              2
                           
                        
                        N
                        )
                      (scheme I) and 
                        O
                        (
                        
                           
                              N
                           
                           
                              f
                           
                        
                        N
                        )
                        +
                        O
                        (
                        
                           
                              M
                           
                           
                              p
                           
                           
                              2
                           
                        
                        N
                        
                        log
                        
                        N
                        )
                      (scheme II), with 
                        log
                        
                        N
                      corresponding to the number of iterations as discussed below; N
                     
                        f
                      and 
                        
                           
                              M
                           
                           
                              p
                           
                        
                        ≡
                        
                           
                              max
                           
                           
                              t
                           
                        
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        t
                        )
                      are respectively the number of frequencies ω
                     
                        k
                      for which the TFR is calculated, and the maximum number of TFR amplitude peaks present at any one time. Both N
                     
                        f
                      and M
                     
                        p
                      are independent of N. 
                        Remark 3.1
                        Because in practice the frequency scale for the WFT/WT is discretized, the ridge frequencies 
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                            also take discrete values at each time. As a result, e.g. the differences between consecutive ridges 
                              Δ
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ≡
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              −
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                            cannot reliably be calculated, being “quantized” in steps determined by the widths of the frequency bins, so that in typical cases it will be zero for most of the time and have relatively high values otherwise. To avoid consequential problems, and to improve the quality of the ridge frequency estimates, we find peak positions 
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                            more precisely by using parabolic interpolation based on the TFR amplitudes at the peak and the two adjacent bins: see e.g. the discussion of ridge reconstruction in [14]. Because the TFR amplitudes take continuous values, the estimates of 
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                            (and therefore those of 
                              Δ
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              (
                              t
                              )
                           ) also become continuous. One then does not need to worry about the related discretization effects, which could otherwise influence significantly the performance of methods that are based on the differences between ridge frequencies.

A widespread approach is to penalize the frequency difference between the consecutive ridge points, so that
                           
                              (3.4)
                              
                                 F
                                 [
                                 
                                    ⋯
                                 
                                 ]
                                 =
                                 log
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 +
                                 w
                                 (
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 −
                                 
                                    
                                       ω
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 )
                                 ,
                                 α
                                 )
                                 ,
                              
                           
                        where 
                           w
                           (
                           Δ
                           ξ
                           ,
                           α
                           )
                         is some weighting function, aimed at suppressing frequency jumps, and α is its set of adjustable parameters. Note that in (3.4) one can choose another function of 
                           
                              
                                 Q
                              
                              
                                 m
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                         instead of the logarithm, e.g. 
                           |
                           
                              
                                 Q
                              
                              
                                 m
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           
                              
                                 |
                              
                              
                                 2
                              
                           
                        ; however, the logarithm seems to be the most appropriate choice because the path functional (3.3) then depends on the product of all the amplitudes and thus can be significantly influenced even by a single “wrong” point, making selection of the latter less probable.

The class of functionals (3.4) is a popular choice. The approach of [22] corresponds to 
                           w
                           (
                           Δ
                           ξ
                           ,
                           α
                           )
                           =
                           0
                         for 
                           Δ
                           ξ
                           ∈
                           [
                           −
                           1
                           /
                           α
                           ,
                           1
                           /
                           α
                           ]
                         and 
                           =
                           −
                           ∞
                         otherwise, while the procedure used in [23,30] utilizes the quadratic weights 
                           w
                           (
                           Δ
                           ξ
                           ,
                           α
                           )
                           =
                           α
                           Δ
                           
                              
                                 ξ
                              
                              
                                 2
                              
                           
                         (though in these methods the optimization is carried out over all frequency bins ω
                        
                           k
                         at each time rather than using only the peaks 
                           
                              
                                 ν
                              
                              
                                 m
                              
                           
                           (
                           t
                           )
                        , as we do here). The algorithm of [17] also represents a variant of (3.4). Finally, the approach of Carmona et. al. [20] can be viewed as a modified version of (3.4) with additional penalization of the second order frequency differences.

The main disadvantage of the approaches mentioned is that they require fine tuning of each method׳s parameters to obtain an accurate result, with different choices being needed for different signals and different characteristics of the TFR in use. To make the parametrization more universal, the weighting function should utilize the resolution properties of the WFT, which are determined by the window function g(t). Thus, for a given window there exists a minimum frequency (resp. time) difference Δξ
                        g (resp. Δτ
                        g) for which two frequency events, e.g. tones (resp. time events, e.g. delta-peaks) can be resolved in the WFT. In other words, the larger Δτ
                        g is (the smaller f
                        0 is in (2.5)), the less time-variability is allowed for the components, so that one expects smaller frequency jumps.

We therefore penalize the ratio of the observed time-derivative of the ridge frequency difference to its characteristic value, which can naturally be taken as 
                           Δ
                           
                              
                                 ξ
                              
                              
                                 g
                              
                           
                           /
                           Δ
                           
                              
                                 τ
                              
                              
                                 g
                              
                           
                        . This leads to the choice
                           
                              (3.5)
                              
                                 w
                                 (
                                 Δ
                                 ξ
                                 ,
                                 α
                                 )
                                 =
                                 α
                                 
                                    
                                       w
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                s
                                             
                                          
                                          |
                                          Δ
                                          ξ
                                          |
                                       
                                       
                                          Δ
                                          
                                             
                                                ξ
                                             
                                             
                                                g
                                             
                                          
                                          /
                                          Δ
                                          
                                             
                                                τ
                                             
                                             
                                                g
                                             
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 −
                                 α
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             s
                                          
                                       
                                       |
                                       Δ
                                       ξ
                                       |
                                    
                                    
                                       Δ
                                       
                                          
                                             ξ
                                          
                                          
                                             g
                                          
                                       
                                       /
                                       Δ
                                       
                                          
                                             τ
                                          
                                          
                                             g
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where f
                        
                           s
                         is the signal sampling frequency, while Δξ
                        g and Δτ
                        g are chosen resolution measures. We use those introduced in [14], taking Δξ
                        g and Δτ
                        g as being the widths of the regions in time and frequency encompassing 50% of the window function: 
                           
                              (3.6)
                              
                                 Δ
                                 
                                    
                                       ξ
                                    
                                    
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       ξ
                                    
                                    
                                       g
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 (
                                 0.5
                                 )
                                 −
                                 
                                    
                                       ξ
                                    
                                    
                                       g
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 0.5
                                 )
                                 ,
                                 
                                 Δ
                                 
                                    
                                       τ
                                    
                                    
                                       g
                                    
                                 
                                 =
                                 
                                    
                                       τ
                                    
                                    
                                       g
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 (
                                 0.5
                                 )
                                 −
                                 
                                    
                                       τ
                                    
                                    
                                       g
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 0.5
                                 )
                                 ;
                                 
                                    
                                       ξ
                                    
                                    
                                       g
                                    
                                    
                                       (
                                       1
                                       ,
                                       2
                                       )
                                    
                                 
                                 (
                                 ϵ
                                 )
                                 :
                                 |
                                 
                                    
                                       
                                          R
                                       
                                       
                                          g
                                       
                                    
                                    (
                                    
                                       ξ
                                       ≤
                                       
                                          
                                             ξ
                                          
                                          
                                             g
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ,
                                 
                                 |
                                 
                                    1
                                    −
                                    
                                       
                                          R
                                       
                                       
                                          g
                                       
                                    
                                    (
                                    
                                       ξ
                                       ≥
                                       
                                          
                                             ξ
                                          
                                          
                                             g
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ;
                                 
                                    
                                       τ
                                    
                                    
                                       g
                                    
                                    
                                       (
                                       1
                                       ,
                                       2
                                       )
                                    
                                 
                                 (
                                 ϵ
                                 )
                                 :
                                 |
                                 
                                    
                                       
                                          P
                                       
                                       
                                          g
                                       
                                    
                                    (
                                    
                                       τ
                                       ≤
                                       
                                          
                                             τ
                                          
                                          
                                             g
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ,
                                 
                                 |
                                 
                                    1
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          g
                                       
                                    
                                    (
                                    
                                       τ
                                       ≥
                                       
                                          
                                             τ
                                          
                                          
                                             g
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ;
                                 
                                    
                                       R
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 ω
                                 )
                                 ≡
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             −
                                             ∞
                                          
                                          
                                             ω
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       ξ
                                       )
                                       
                                       d
                                       ξ
                                    
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             −
                                             ∞
                                          
                                          
                                             ∞
                                          
                                       
                                       
                                          
                                             g
                                          
                                          
                                             ^
                                          
                                       
                                       (
                                       ξ
                                       )
                                       
                                       d
                                       ξ
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 τ
                                 )
                                 ≡
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             −
                                             ∞
                                          
                                          
                                             τ
                                          
                                       
                                       g
                                       (
                                       t
                                       )
                                       
                                       dt
                                    
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             −
                                             ∞
                                          
                                          
                                             ∞
                                          
                                       
                                       g
                                       (
                                       t
                                       )
                                       
                                       dt
                                    
                                 
                                 .
                              
                           
                        For a Gaussian window (2.5) one obtains 
                           Δ
                           
                              
                                 ξ
                              
                              
                                 g
                              
                           
                           /
                           Δ
                           
                              
                                 τ
                              
                              
                                 g
                              
                           
                           =
                           1
                           /
                           
                              
                                 f
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                        , and this result remains the same even if using as Δξ
                        g and Δτ
                        g the conventional standard deviations of 
                           |
                           
                              
                                 g
                              
                              
                                 ^
                              
                           
                           (
                           ξ
                           )
                           
                              
                                 |
                              
                              
                                 2
                              
                           
                         and 
                           |
                           g
                           (
                           t
                           )
                           
                              
                                 |
                              
                              
                                 2
                              
                           
                        , respectively.

With the choice (3.5), the parameter α is expected to be nearly universal, so that the same value should work well for different window functions. Note that, although in (3.5) we use 
                           
                              
                                 w
                              
                              
                                 ˜
                              
                           
                           (
                           r
                           )
                           =
                           −
                           |
                           r
                           |
                        , other functions can be utilized instead. However, for any reasonable choice, the method remains qualitatively the same, i.e. one expects it to suffer from the same drawbacks and to have similar issues.

It is important to note that scheme I corresponds to the simple cases of “global maximum” and “nearest neighbor” curve extraction for 
                           α
                           =
                           0
                         and 
                           α
                           →
                           ∞
                        , respectively:
                           
                              •
                              Global maximum 
                                    (
                                    α
                                    =
                                    0
                                    )
                                 . In this case the functional (3.4) reduces to 
                                    F
                                    [
                                    ⋯
                                    ]
                                    =
                                    log
                                    
                                    
                                       
                                          Q
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 , so that the maximum peak will be selected at each time, taking no account of the previous ridge points.

Nearest neighbor 
                                    (
                                    α
                                    →
                                    ∞
                                    )
                                 . This case differs for one-step optimization (3.1) and path optimization (3.3). The former approach corresponds to selecting at each new step the peak which is nearest to the previous one, taking no account of its amplitude. The latter approach will give simply the least frequency-varying curve.

In the previous scheme, an adjustable parameter α determines the suppression of the frequency variations. Although some choices (e.g. 
                           α
                           =
                           1
                        ) appear to be almost universal, they still remain highly non-adaptive, so that a particular parameter value might be suitable for one type of the signal, and a different value for another type. For example, in the case of chirps 
                           ~
                           cos
                           (
                           at
                           +
                           
                              
                                 bt
                              
                              
                                 2
                              
                           
                           )
                         it is clear that one should penalize not simply the frequency derivative 
                           |
                           Δ
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                           /
                           Δ
                           t
                           |
                        , but its difference from the true value 
                           (
                           2
                           b
                           )
                        , i.e. 
                           |
                           Δ
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                           /
                           Δ
                           t
                           −
                           2
                           b
                           |
                        .

To make the scheme adaptive, the parameters of the functional should be matched to the properties of the component being extracted, such as the typical variations of its instantaneous frequency. The latter can be characterized by the averages and standard deviations of the ridge frequencies 
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                         and their differences 
                           Δ
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           ≡
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           −
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           )
                        ; or, which appears to be more stable in practice, by the corresponding medians 
                           m
                           [
                           ⋯
                           ]
                         and interquartile ranges 
                           IQR
                           [
                           ⋯
                           ]
                        , defined for an arbitrary function f(t) as
                           
                              (3.7)
                              
                                 m
                                 [
                                 f
                                 (
                                 t
                                 )
                                 ]
                                 ≡
                                 
                                    
                                       
                                          perc
                                       
                                       
                                          0.5
                                       
                                    
                                 
                                 [
                                 f
                                 (
                                 t
                                 )
                                 ]
                                 ,
                                 
                                 IQR
                                 [
                                 f
                                 (
                                 t
                                 )
                                 ]
                                 ≡
                                 
                                    
                                       
                                          perc
                                       
                                       
                                          0.75
                                       
                                    
                                 
                                 [
                                 f
                                 (
                                 t
                                 )
                                 ]
                                 −
                                 
                                    
                                       
                                          perc
                                       
                                       
                                          0.25
                                       
                                    
                                 
                                 [
                                 f
                                 (
                                 t
                                 )
                                 ]
                                 ,
                              
                           
                        where 
                           
                              
                                 perc
                              
                              
                                 p
                              
                           
                           [
                           f
                           (
                           t
                           )
                           ]
                         denotes the 
                           p
                           th
                         quantile of f(t).

An adaptive functional can then be constructed by suppressing not the absolute frequency jumps, as before, but the relative deviations of the component׳s ridge frequency and its derivative from their typical values:
                           
                              (3.8)
                              
                                 F
                                 [
                                 
                                    ⋯
                                 
                                 ]
                                 =
                                 log
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       
                                          ν
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ,
                                    m
                                    [
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    IQR
                                    [
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    β
                                 
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       
                                          ν
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    )
                                    ,
                                    m
                                    [
                                    Δ
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    IQR
                                    [
                                    Δ
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    α
                                 
                                 )
                                 .
                              
                           
                        where α and β denote sets of adjustable parameters controlling suppression of atypical variations of the ridge frequency׳s derivative and value, respectively. Similar to (3.5), we choose the first order penalization functions: 
                           
                              (3.9)
                              
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    Δ
                                    ξ
                                    ,
                                    m
                                    [
                                    Δ
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    IQR
                                    [
                                    Δ
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    α
                                 
                                 )
                                 =
                                 −
                                 α
                                 |
                                 
                                    
                                       
                                          Δ
                                          ξ
                                          −
                                          m
                                          [
                                          Δ
                                          
                                             
                                                ω
                                             
                                             
                                                p
                                             
                                          
                                          ]
                                       
                                       
                                          IQR
                                          [
                                          Δ
                                          
                                             
                                                ω
                                             
                                             
                                                p
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 |
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    ξ
                                    ,
                                    m
                                    [
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    IQR
                                    [
                                    
                                       
                                          ω
                                       
                                       
                                          p
                                       
                                    
                                    ]
                                    ,
                                    β
                                 
                                 )
                                 =
                                 −
                                 β
                                 |
                                 
                                    
                                       
                                          ξ
                                          −
                                          m
                                          [
                                          
                                             
                                                ω
                                             
                                             
                                                p
                                             
                                          
                                          ]
                                       
                                       
                                          IQR
                                          [
                                          
                                             
                                                ω
                                             
                                             
                                                p
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 |
                                 .
                              
                           
                        By maximizing the path integral (3.3) based on the functional (3.8), one is in fact trying to extract the curve which is most consistent with itself. Thus, the strength of the respective frequency variations becomes unimportant, and it is only their agreement and similarity at different times that matters.

Even the most adaptive method can be parametrized to tackle special cases, and in (3.8) we have introduced the adjustable parameters α and β controlling the strengths of suppression of the corresponding relative deviations. However, although there are now two parameters, they are in fact more universal than the single parameter of scheme I, and the particular choice of 
                           α
                           ,
                           β
                         for scheme II is expected to work well for a larger class of signals than the particular choice of α in the scheme I, as will be seen below. This is because in (3.8) we take explicitly into account the actual properties of the component being extracted, penalizing deviations from its typical behavior rather than simply the frequency jumps. Additionally, by suppressing the relative deviations of the component׳s frequency from its mean, scheme II stabilizes the curve in its characteristic frequency range (thus decreasing the possibility that it will “escape” and switch to another component), while there is no such mechanism in scheme I.

The functional (3.8) depends, however, on the whole time-evolution of 
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                        , so that the path optimization (3.3) cannot be performed in O
                           (
                           N
                           )
                         steps, as before (see Appendix); nor is it evident how to update the functional at each step if using the one-step optimization (3.1). Nevertheless, one can approach the approximately optimal curve 
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                         by use of a kind of fixed-point iteration [32]. Starting with some initial guess 
                           
                              
                                 ω
                              
                              
                                 p
                              
                              
                                 (
                                 0
                                 )
                              
                           
                           (
                           t
                           )
                        , one calculates the corresponding medians and ranges, fixes them in (3.8) (so that the functional now depends on only two consecutive ridges rather than on the full history, meaning that the algorithm discussed in Appendix becomes applicable), and extracts the newer profile 
                           
                              
                                 ω
                              
                              
                                 p
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           (
                           t
                           )
                         in the usual way. The (fixed) medians and ranges are then updated to those of the 
                           
                              
                                 ω
                              
                              
                                 p
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           (
                           t
                           )
                         and, based on these newer estimates, the next approximation 
                           
                              
                                 ω
                              
                              
                                 p
                              
                              
                                 (
                                 2
                                 )
                              
                           
                           (
                           t
                           )
                         is found in the same manner. The procedure is repeated until the curves obtained in two consecutive iterations coincide perfectly (
                           
                              
                                 ω
                              
                              
                                 p
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 ω
                              
                              
                                 p
                              
                              
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                           
                           (
                           t
                           )
                         for all t). For the first iteration, we use a simple global maximum curve 
                           
                              
                                 ω
                              
                              
                                 p
                              
                              
                                 (
                                 0
                                 )
                              
                           
                           (
                           t
                           )
                           =
                           
                              
                                 argmax
                              
                              
                                 ω
                              
                           
                           |
                           
                              
                                 G
                              
                              
                                 s
                              
                           
                           (
                           ω
                           ,
                           t
                           )
                           |
                        .

The convergence of the fixed-point algorithm outlined above is in general hard to prove. In practice, however, the procedure converges not only exactly (so that the next iterations produce absolutely identical curves), but also rapidly. To show this, we have analyzed the performance of the method for white noise signals with different sampling frequencies and time lengths, thus trying to model the worst case (as the method will obviously converge faster if the signal contains some pronounced components). The results are presented in the Supplementary material, Fig. 1. The number of iterations needed is always relatively small, being proportional to 
                           log
                           N
                        ; it is determined primarily by the signal׳s time length, while the sampling frequency only has a very minor effect. Note also that one can set some maximum number of allowed iterations if desired, though in our simulations the procedure always converged exactly and rapidly.

Due to the logarithmic frequency resolution of the WT, one should consider not the frequencies but their logarithms, which is the only significant difference from the WFT case. In the case of the WT one uses the same schemes and functionals, but now everything is taken on a logarithmic frequency scale (
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           →
                           log
                           
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                        , 
                           Δ
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           ≡
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           −
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           )
                           →
                           Δ
                           
                           log
                           
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           ≡
                           log
                           
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           −
                           log
                           
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           )
                        , and similarly for all the other frequency variables). We now summarize briefly the required adjustments.


                        Scheme I: Instead of 
                           w
                           (
                           
                              
                                 ν
                              
                              
                                 m
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           −
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           )
                           ,
                           α
                           )
                        , in (3.4) one uses 
                           w
                           (
                           log
                           
                           
                              
                                 ν
                              
                              
                                 m
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           )
                           −
                           log
                           
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           )
                           ,
                           α
                           )
                        . The form of the penalization function (3.5) remains qualitatively the same:
                           
                              (3.10)
                              
                                 w
                                 (
                                 Δ
                                 
                                 log
                                 
                                 ξ
                                 ,
                                 α
                                 )
                                 =
                                 α
                                 
                                    
                                       w
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                s
                                             
                                          
                                          |
                                          Δ
                                          
                                          log
                                          
                                          ξ
                                          |
                                       
                                       
                                          Δ
                                          
                                          log
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                ψ
                                             
                                          
                                          /
                                          Δ
                                          
                                             
                                                τ
                                             
                                             
                                                ψ
                                             
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 −
                                 α
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             s
                                          
                                       
                                       |
                                       Δ
                                       
                                       log
                                       
                                       ξ
                                       |
                                    
                                    
                                       Δ
                                       
                                       log
                                       
                                       
                                          
                                             ξ
                                          
                                          
                                             ψ
                                          
                                       
                                       /
                                       Δ
                                       
                                          
                                             τ
                                          
                                          
                                             ψ
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        but one now uses the wavelet׳s characteristic log-frequency and time differences 
                           Δ
                           
                           log
                           
                           
                              
                                 ξ
                              
                              
                                 ψ
                              
                           
                         and 
                           Δ
                           
                              
                                 τ
                              
                              
                                 ψ
                              
                           
                        , respectively. The estimates given in [14] are calculated as
                           
                              (3.11)
                              
                                 Δ
                                 
                                 log
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       ψ
                                    
                                 
                                 =
                                 log
                                 
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             ψ
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       (
                                       0.5
                                       )
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             ψ
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       (
                                       0.5
                                       )
                                    
                                 
                                 ,
                                 
                                 Δ
                                 
                                    
                                       τ
                                    
                                    
                                       ψ
                                    
                                 
                                 =
                                 
                                    
                                       τ
                                    
                                    
                                       ψ
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 (
                                 0.5
                                 )
                                 −
                                 
                                    
                                       τ
                                    
                                    
                                       ψ
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 0.5
                                 )
                                 ;
                                 
                                    
                                       ξ
                                    
                                    
                                       ψ
                                    
                                    
                                       (
                                       1
                                       ,
                                       2
                                       )
                                    
                                 
                                 (
                                 ϵ
                                 )
                                 :
                                 |
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ψ
                                       
                                    
                                    (
                                    
                                       ξ
                                       ≤
                                       
                                          
                                             ξ
                                          
                                          
                                             ψ
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ,
                                 
                                 |
                                 
                                    1
                                    −
                                    
                                       
                                          R
                                       
                                       
                                          ψ
                                       
                                    
                                    (
                                    
                                       ξ
                                       ≥
                                       
                                          
                                             ξ
                                          
                                          
                                             ψ
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ;
                                 
                                    
                                       τ
                                    
                                    
                                       ψ
                                    
                                    
                                       (
                                       1
                                       ,
                                       2
                                       )
                                    
                                 
                                 (
                                 ϵ
                                 )
                                 :
                                 |
                                 
                                    
                                       
                                          P
                                       
                                       
                                          ψ
                                       
                                    
                                    (
                                    
                                       τ
                                       ≤
                                       
                                          
                                             τ
                                          
                                          
                                             ψ
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ,
                                 
                                 |
                                 
                                    1
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          ψ
                                       
                                    
                                    (
                                    
                                       τ
                                       ≥
                                       
                                          
                                             τ
                                          
                                          
                                             ψ
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 |
                                 <
                                 ϵ
                                 /
                                 2
                                 ;
                                 
                                    
                                       R
                                    
                                    
                                       ψ
                                    
                                 
                                 (
                                 ω
                                 )
                                 ≡
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             ω
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       ξ
                                       )
                                       
                                       d
                                       ξ
                                       /
                                       ξ
                                    
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             ∞
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ψ
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                ⁎
                                             
                                          
                                       
                                       (
                                       ξ
                                       )
                                       
                                       d
                                       ξ
                                       /
                                       ξ
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       ψ
                                    
                                 
                                 (
                                 τ
                                 )
                                 ≡
                                 
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             −
                                             ∞
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       t
                                       )
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             
                                                
                                                   ω
                                                
                                                
                                                   ψ
                                                
                                             
                                             t
                                          
                                       
                                       
                                       dt
                                    
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             −
                                             ∞
                                          
                                          
                                             ∞
                                          
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             ⁎
                                          
                                       
                                       (
                                       t
                                       )
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             
                                                
                                                   ω
                                                
                                                
                                                   ψ
                                                
                                             
                                             t
                                          
                                       
                                       
                                       dt
                                    
                                 
                                 .
                              
                           
                        
                     


                        Scheme II: In (3.8) the 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           (
                           ⋯
                           )
                         and 
                           
                              
                                 w
                              
                              
                                 2
                              
                           
                           (
                           ⋯
                           )
                         are changed to 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 log
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 −
                                 log
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 )
                                 ,
                                 m
                                 [
                                 Δ
                                 
                                 log
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       p
                                    
                                 
                                 ]
                                 ,
                                 IQR
                                 [
                                 Δ
                                 
                                 log
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       p
                                    
                                 
                                 ]
                                 )
                              
                           
                        and 
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 log
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ,
                                 m
                                 [
                                 log
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       p
                                    
                                 
                                 ]
                                 ,
                                 IQR
                                 [
                                 log
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       p
                                    
                                 
                                 ]
                                 )
                                 ,
                              
                           
                        respectively, with their basic forms (3.9) remaining the same.

As discussed above, the general form of scheme I is motivated by many previously proposed algorithms for curve extraction [17,20,22,23,30], most of which can be considered as its specific variants and which should therefore have qualitatively similar properties and issues. Scheme II, on the other hand, provides the main novelty of the present work. We now compare the performance of both schemes for various parameter choices and signals.

We test the relative performances of the different methods on two signals. The first signal is an AM/FM component with simple sinusoidal amplitude modulation and two-sinusoidal frequency modulation, plus a weaker component:
                           
                              (4.1)
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    1
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    
                                    cos
                                    
                                       
                                          2
                                          π
                                          t
                                       
                                       
                                          9
                                       
                                    
                                 
                                 )
                                 
                                 cos
                                 (
                                 
                                    2
                                    π
                                    t
                                    +
                                    6
                                    
                                    sin
                                    
                                       
                                          2
                                          π
                                          t
                                       
                                       
                                          30
                                       
                                    
                                    +
                                    cos
                                    
                                       
                                          2
                                          π
                                          t
                                       
                                       
                                          12
                                       
                                    
                                 
                                 )
                                 +
                                 0.8
                                 
                                 cos
                                 (
                                 
                                    2
                                    π
                                    ×
                                    1.75
                                    t
                                    +
                                    0.5
                                    
                                    sin
                                    
                                       
                                          2
                                          π
                                          t
                                       
                                       
                                          5
                                       
                                    
                                 
                                 )
                                 .
                              
                           
                        Note that, although an AM/FM component around 1Hz is dominant in terms of both maximum amplitude and mean squared amplitude, there are certain times at which the amplitude of the other component (at around 1.75Hz) becomes higher, thereby introducing additional complications for curve extraction. The second test signal is taken from real life, representing the central 200s part of a 30min electrocardiogram (ECG) signal recorded from a 30-year-old male subject [17]. The WFTs for both signals are shown above in Fig. 1.

The main complications that arise in curve extraction relate to the appearance of other WFT amplitude peaks near 
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                        , which can be due either to noise or to other components. We model these complications by corrupting the signal with colored noise 
                           η
                           (
                           t
                           )
                         of unit deviation and a particular Fourier amplitude (while the phases of its Fourier coefficients are random):
                           
                              (4.2)
                              
                                 s
                                 (
                                 t
                                 )
                                 =
                                 s
                                 (
                                 t
                                 )
                                 +
                                 σ
                                 η
                                 (
                                 t
                                 )
                                 ,
                                 
                                 |
                                 
                                    
                                       η
                                    
                                    
                                       ^
                                    
                                 
                                 (
                                 ξ
                                 )
                                 |
                                 ~
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       
                                          
                                             π
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             ξ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Being asymmetric, the noise amplitude at frequency 0.5Hz is around 2.5 times higher than at 1.5Hz, corrupting the dominant components (which have a mean frequency around 1Hz in both test signals) unequally in frequency on the two sides. This gives an opportunity to study reliably the relative performance of the different methods, as colored noise can additionally model the effect of other components that are asymmetrically distributed in frequency around the component of interest. The WFTs of the two test signals corrupted with noise are presented in Fig. 2
                        .

It is well known that, even in the absence of noise, the ridge points are not located exactly at the true instantaneous frequencies 
                           ν
                           (
                           t
                           )
                           ≡
                           
                              
                                 ϕ
                              
                              
                                 ′
                              
                           
                           (
                           t
                           )
                         
                        [14,31]. If we compare the 
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                         obtained with the true frequency profile then, even in the case when the curve extraction works perfectly (e.g. when there is a single peak at each time, and hence only one possible ridge curve) there will be some discrepancy between the two. At the same time, what we want to test is how well the methods presented can identify the peak sequence corresponding to the component of interest, and not how well one can then reconstruct the component׳s parameters from this sequence. Therefore, to assess the performance of the curve identification method, rather than the performance of the TFR itself or the accuracy with which frequencies are estimated from ridges, we compare the extracted 
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                         with the “ideal” ridge curve 
                           
                              
                                 
                                    
                                       ω
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                         obtained in the noise-free case. The corresponding error ϵ
                        
                           f
                         can then be defined as
                           
                              (4.3)
                              
                                 
                                    
                                       ϵ
                                    
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ≡
                                 
                                    
                                       〈
                                       
                                          
                                             [
                                             
                                                
                                                   ω
                                                
                                                
                                                   p
                                                
                                             
                                             (
                                             t
                                             )
                                             −
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             (
                                             t
                                             )
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                    
                                       〈
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             −
                                             〈
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             〉
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                       〉
                                    
                                 
                                 ,
                              
                           
                        where 
                           〈
                           ⋯
                           〉
                         denotes the time-average. An additional complication is that, because noise changes the ridge profile as it appears in the WFT, there always exists some deviation between the extracted profiles with and without noise, which is unrelated to the performance of the extraction method. Consequently, the ϵ
                        
                           f
                         
                        (4.3) contains both an irreducible, inherent, error related to the effect of noise on the TFR, and the error of the curve extraction method. Therefore, we only compare the performance of different methods, without aiming to find the profile as it would be without noise (which is generally impossible).

In the simulations, both test signals are sampled at 20Hz. We will test curve extraction only for the WFT, but the results remain qualitatively the same for the WT as well. To eliminate boundary distortions in the TFR, we simulate the first test signal (4.1) for 1000s, calculate the corresponding WFT and then use only its central 200s part; the same procedure is applied for the ECG signal. Also, since there are two strong components in the first signal, we find two ridge curves for it and choose that lying closer in frequency to the dominant component (around 1Hz). We use a Gaussian window (2.5) with 
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                           =
                           1
                         and calculate the WFTs at frequencies 
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                           /
                           2
                           π
                           =
                           0.25
                           +
                           (
                           k
                           −
                           1
                           )
                           Δ
                           ω
                           /
                           2
                           π
                           ∈
                           [
                           0.25
                           ,
                           2.25
                           ]
                         (this range of frequencies is chosen based on a priori knowledge that all components of interest are contained in it) with 
                           Δ
                           ω
                           =
                           Δ
                           
                              
                                 ξ
                              
                              
                                 g
                              
                           
                           /
                           25
                           ≈
                           2
                           π
                           ×
                           0.008
                        . For both signals, we use 40 noise realizations, which are the same for each method, parameters and noise intensities σ being tested.

@&#RESULTS@&#

The results of applying the different curve extraction schemes to the WFT of the first test signal (4.1) are presented in Fig. 3
                        . The performance of each method is quantified by its maximum tolerable noise level 
                           
                              
                                 σ
                              
                              
                                 max
                              
                           
                        , indicated by vertical dotted lines in Fig. 3: we define it as the noise intensity σ at which the mean error ϵ
                        
                           f
                         
                        (4.3) plus its standard deviation over noise realizations reaches 0.5, implying that in many cases the resultant 
                           
                              
                                 ω
                              
                              
                                 p
                              
                           
                           (
                           t
                           )
                         is inaccurate. Note that, in each case, the default path optimization (3.3) approach has clear and significant advantages over the one-step optimization (3.1), with the mean errors for the latter being shown by dashed gray lines in Fig. 3(b) and (d).

From Fig. 3, it can be seen that the worst performance in the case of the first test signal (4.1) is exhibited by the I(0) (global maximum) method, which is to be expected, given that the amplitude of the weaker component is sometimes higher than that of the dominant one. With increasing α above zero, the performance of method I(α) greatly improves (Fig. 3(a) and (b)), reaching its optimum at some 
                           0
                           <
                           α
                           <
                           10
                        , and then deteriorating again. For scheme I and the parameters tested, the best results are achieved at 
                           α
                           =
                           1
                        .

Nevertheless, much better performance is demonstrated by schemes II(1,1) and II(10,10), which can trace the ridge curve reliably even in the presence of very strong noise. Methods II(10,1) and II(1,10) do not work so well, indicating that large asymmetries between α and β are not advantageous, which is to be expected given that we use relative (i.e. normalized) deviations.

Results for the second test signal, the ECG, are presented in Fig. 4
                        . Clearly, the situation there is similar to the one observed for the first test signal in Fig. 3. However, the performance of methods I and II is now almost independent of their parameters (except I(0)), at least for the parameter values considered.

Summarizing, the best results were achieved with scheme II, in particular with II(1,1) and II(10,10). Scheme I(α) seems to be most accurate when 
                           α
                           =
                           1
                         (at least for the parameters tested), while the global maximum method, corresponding to I(0), is largely useless and should not be used. In all cases, the path optimization (3.3) approach was superior to the one-step optimization (3.1).

Synchrosqueezing [23–25] represents a particular reassignment method [26,33] that can be used to construct a more concentrated representation from the WFT and WT by utilizing relationships between the rates of phase growth of the corresponding coefficients, and it would appear at first sight that transforms of this kind would be optimal for ridge extraction. The synchrosqueezed WFT (SWFT) 
                        
                           
                              V
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                      and synchrosqueezed WT (SWT) 
                        
                           
                              T
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                      can be constructed as
                        
                           (5.1)
                           
                              
                                 
                                    V
                                 
                                 
                                    s
                                 
                              
                              (
                              ω
                              ,
                              t
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    g
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    −
                                    ∞
                                 
                                 
                                    ∞
                                 
                              
                              δ
                              (
                              
                                 ω
                                 −
                                 
                                    
                                       ν
                                    
                                    
                                       G
                                    
                                 
                                 (
                                 ω
                                 ,
                                 t
                                 )
                              
                              )
                              
                                 
                                    G
                                 
                                 
                                    s
                                 
                              
                              (
                              
                                 
                                    ω
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              t
                              )
                              
                              d
                              
                                 
                                    ω
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    s
                                 
                              
                              (
                              ω
                              ,
                              t
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    ψ
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              δ
                              (
                              
                                 ω
                                 −
                                 
                                    
                                       ν
                                    
                                    
                                       W
                                    
                                 
                                 (
                                 ω
                                 ,
                                 t
                                 )
                              
                              )
                              
                                 
                                    W
                                 
                                 
                                    s
                                 
                              
                              (
                              
                                 
                                    ω
                                 
                                 
                                    ˜
                                 
                              
                              ,
                              t
                              )
                              
                                 
                                    d
                                    
                                       
                                          ω
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ˜
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    g
                                 
                              
                              ≡
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    −
                                    ∞
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    g
                                 
                                 
                                    ^
                                 
                              
                              (
                              ξ
                              )
                              
                              d
                              ξ
                              =
                              π
                              g
                              (
                              0
                              )
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    ψ
                                 
                              
                              ≡
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    0
                                 
                                 
                                    ∞
                                 
                              
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    ⁎
                                 
                              
                              (
                              ξ
                              )
                              
                              d
                              ξ
                              /
                              ξ
                              ,
                           
                        
                     where 
                        
                           
                              ν
                           
                           
                              G
                           
                        
                        ≡
                        Im
                        [
                        
                           
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       G
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 ω
                                 ,
                                 t
                                 )
                              
                              
                                 
                                    
                                       G
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 ω
                                 ,
                                 t
                                 )
                              
                           
                        
                        ]
                      and 
                        
                           
                              ν
                           
                           
                              W
                           
                        
                        ≡
                        Im
                        [
                        
                           
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 ω
                                 ,
                                 t
                                 )
                              
                              
                                 
                                    
                                       W
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 ω
                                 ,
                                 t
                                 )
                              
                           
                        
                        ]
                      are the instantaneous phase velocities of the WFT and WT, respectively. In practice, the frequency scale is discretized, so one calculates the SWFT and SWT as 
                        
                           
                              V
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                      and 
                        
                           
                              T
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                      already integrated over the corresponding frequency bin (see e.g. the discussion in [14]).


                     Fig. 5
                      shows SWFTs constructed from the WFTs depicted in Figs. 1 and 2 (see also [30] for a systematic analysis of the effects of different kinds of noise on performance of the SWT). Clearly, synchrosqueezed TFRs are very concentrated and visually appealing. However, it has been found [14] that they do not possess better time or frequency resolution, i.e. do not allow for better reconstruction of components that are close in frequency or have high time variability (as compared to the original WFT/WT). The synchrosqueezing just sums all the interferences and other complications present in the WFT/WT into a more compact frequency regions so that, even if the components appear to be more widely separated as a result, this does not mean that their parameters can be better estimated. In this respect the SWFTs/SWTs are somehow similar to the WFT/WT skeletons (the corresponding transforms with only their amplitude peaks left) which, although being perfectly concentrated, do not obviously possess better resolution properties than the respective WFTs/WTs; see [14] for a more detailed discussion of this issue.

Nevertheless, it still remains to be established whether or not synchrosqueezing provides any advantages in terms of curve extraction, i.e. whether the “correct” amplitude peak sequences can be identified more easily in the SWFT/SWT than in the original WFT/WT. In other words, the following question is to be addressed: will performing synchrosqueezing first, and then applying curve extraction methods to the resultant SWFT/SWT, give more accurate results than just applying these methods directly to the original WFT/WT?

Evidently, the schemes developed for the WFT/WT can be applied straightforwardly for tracing ridge curves in the SWFT/SWT. Nothing qualitatively changes, except that now one uses the amplitude peaks of the synchrosqueezed transforms. However, an immediate and serious drawback of this approach is that, in contrast to the case of the WFT/WT, the peak amplitudes in the synchrosqueezed transforms are not universally proportional to the amplitudes of the corresponding components; instead, they are largely determined by the parameters of frequency discretization being used, as illustrated in Fig. 6
                     . Hence it can be seen that, even if one component has a smaller amplitude than the other, it may still have a much higher peak in the SWFT (see Fig. 6(a) and (c)).

Generally, the relationships between the peaks will depend on the discretization step 
                        Δ
                        ω
                     , and this dependence proves to be highly nonlinear and time-varying, being influenced by many factors such as the instantaneous amplitude and frequency modulation of the component, its interference with other components, and noise. Hence, the outcomes of different curve extraction methods when applied to synchrosqueezed transforms will also depend on the widths of the frequency bins used. This effect is additionally augmented by the fact that, due to the non-smoothness of the SWFT/SWT, one cannot apply peak interpolation to better locate the ridges 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                     , so that they remain discrete, and such a discretization in turn affects the performance of the extraction schemes (see Remark 3.1). Because of all these issues, the use of the SWFT/SWT peak amplitudes for discriminating between the components is in general not appropriate and can lead to unpredictable results, introducing considerable instability.

One way to avoid the drawbacks discussed above would be to use “integrated” ridges instead of peaks. It is well known [14,24,26] that in the case of the synchrosqueezed transforms the amplitude of the component should be estimated based on the overall sum of the SWFT/SWT over the (time-dependent) frequency region where it is concentrated. The problems attributable to use of the peaks can therefore be solved by using more appropriate amplitude/frequency estimates. Hence, at each time t we break the SWFT/SWT into the widest regions of non-zero amplitude 
                        [
                        
                           
                              
                                 ω
                              
                              
                                 −
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           (
                           t
                           )
                           ,
                           
                              
                                 ω
                              
                              
                                 +
                              
                              
                                 (
                                 m
                                 )
                              
                           
                           (
                           t
                           )
                        
                        ]
                     . Then, instead of using peak values (2.6), the ridge amplitudes Q
                     
                        m
                     (t) and frequencies 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                      (which are used in all procedures) are estimated from the corresponding regions as 
                        
                           (5.2)
                           
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                              =
                              |
                              
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                 
                                 (
                                 t
                                 )
                              
                              |
                              ,
                              
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                                 
                                    (
                                    a
                                    )
                                 
                              
                              (
                              t
                              )
                              ≡
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          −
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          +
                                       
                                       
                                          (
                                          m
                                          )
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    s
                                 
                              
                              (
                              ω
                              ,
                              t
                              )
                              
                              d
                              ω
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              t
                              )
                              ≡
                              Re
                              [
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                             
                                                m
                                             
                                             
                                                (
                                                a
                                                )
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             −
                                          
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             +
                                          
                                          
                                             (
                                             m
                                             )
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                 
                                 ω
                                 
                                    
                                       V
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 ω
                                 ,
                                 t
                                 )
                                 
                                 d
                                 ω
                              
                              ]
                              ,
                           
                        
                     for the SWFT, and similarly 
                        (
                        
                           
                              V
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                        →
                        
                           
                              T
                           
                           
                              s
                           
                        
                        (
                        ω
                        ,
                        t
                        )
                        )
                      for the SWT. Since such Q
                     
                        m
                     (t) do not depend on the widths of the frequency bins, being directly proportional to the true amplitudes of the corresponding components, while 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                      now take continuous values, curve extraction methods based on integrated ridges are expected to give consistent results that are relatively unaffected by frequency discretization.

However, in both cases of using usual and integrated ridges, we have found most of the methods considered to perform either similarly, or often worse, if applied to the SWFT/SWT instead of the original WFT/WT. The corresponding results for the two test signals are shown in the Supplementary material, Figs. 2–5; in all cases, the best performance was demonstrated by scheme II(1,1). Note that, in the case of weak frequency modulation (such as in the ECG signal), the performance of the schemes for some parameters might be slightly improved by using the SWFT/SWT peaks instead of the WFT/WT peaks; but, on the other hand, this would cause the same schemes to fail completely for other parameter choices (see e.g. Supplementary material, Fig. 3). In any case, as discussed previously, the use of the SWFT/SWT peaks in the context of curve extraction is not generally appropriate.

Typical examples of the extracted curves are presented in Fig. 7
                     , where one can see that, in contrast to the case of the WFT, the results of curve extraction from the SWFT become very sensitive to the method and parameters being used. This is mainly because, in contrast to the usual WFT and WT, the synchrosqueezed transforms often contain a lot of “spikes” with small Q
                     
                        m
                     (t) not corresponding to any component (see Fig. 6(a) and (b)). These small peaks occur both due to noise and as a side effect of amplitude/frequency modulation or interference. Consequently, at any given time, there are numerous closely spaced candidate ridge points 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                      in the SWFT/SWT, which makes it easier to switch between the curves corresponding to different components by building “bridges” between them (cf. blue lines in Fig. 7(a) and (b), (c)), while for the WFT/WT this would require large discontinuous frequency jumps. Furthermore, this structure of the synchrosqueezed transforms allows selection of an almost straight curve formed mainly from the spurious ridges due to close frequencies, and such a curve will indeed be returned if the penalization of frequency or of its time-derivative is strong enough (cf. black lines in Fig. 7(a)–(c)). Note that a similar situation would occur for the WFT/WT if we used all available frequencies as candidate ridge points 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                     , but use only of the peaks (2.6) avoids the problem.

Finally, it should also be noted that the computational cost of curve extraction from the synchrosqueezed transforms is usually considerably higher than for the conventional smooth TFRs: the number of computations is roughly proportional to the sum of the squares of the numbers N
                     
                        p
                     (t) of the ridge points 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                      at each time (see Appendix), and these numbers are much larger for the SWFT/SWT than for the original WFT/WT.

@&#LIMITATIONS@&#

The methods proposed are subject to a few important limitations. First, all the schemes are designed to extract accurately the curves corresponding to components that persist throughout the whole signal (or disappear only briefly). This is typically the case for signals of biological origin, such as recordings of ECG, EEG, respiration, or blood flow. On the other hand, when the signal contains transient components that are present only during short time frames, as is often the case e.g. in sound analysis, the curves returned by schemes I and II will most likely consist of the curves corresponding to different components appearing at similar frequencies but different times. This is because the proposed techniques do not have any built-in criteria to terminate curve extraction after a component ceases to exist. How best to formulate such a criterion is a separate topic, and will be the subject of future research.

Secondly, in common with virtually every other curve extraction method, the proposed schemes can have problems with the signals containing components whose frequencies cross each other. In such cases it becomes unclear which path to follow after the crossing occurs. In practice one would like to select the profile which seems “most consistent”, which in mathematical terms can be formulated as the most smooth. If the differences between components׳ amplitudes and/or frequency derivatives are high at the crossing point, then it is likely that the proposed schemes will return appropriate curves; otherwise they can generally select any path. Suppressing deviations of the higher derivatives of the component׳s frequency (in addition to the first one in both schemes) is likely to improve the situation, albeit with increased method complexity and computational cost.

Finally, it should be noted that, quite generally, to obtain reliable results from any method applied to the signal׳s TFR, the latter should represent appropriately at least the basic signal structure. How to achieve this is a general topic of time–frequency analysis (see e.g. [14,34,35]).

@&#CONCLUSIONS@&#

We have developed and compared techniques that can be used for ridge curve extraction from the WFT/WT, and discussed a number of related issues. Among the proposed approaches, scheme II(α,β) with 
                        α
                        =
                        β
                      was shown to produce the best results. Its parameters β and α control the strengths of suppression of the relative deviations of ridge frequency and its time-derivative from the corresponding median values, respectively. Although these parameters can be adjusted to better match any specific problem, due to high adaptivity of the approach the default choice 
                        α
                        =
                        β
                        =
                        1
                      works well in the majority of cases (within the limitations discussed in the previous section). Scheme II(1,1) appears to be of almost universal utility, being a type of “just apply” method that does not require any tuning by the user. The corresponding MatLab codes, as well as other useful time–frequency analysis tools, are freely available in [36].

We have also tested the effects of synchrosqueezing [23–26] in relation to curve extraction, and found that its drawbacks heavily outweigh its advantages. Although scheme II(1,1) still remains the best and works reasonably well if applied to the synchrosqueezed transforms, in general the structure of the SWFT/SWT seems to be less suitable for curve extraction compared to that of the WFT/WT, at least for the methods considered.

@&#ACKNOWLEDGMENTS@&#

The work was supported by the Engineering and Physical Sciences Research Council, UK (Grant no. EP/100999XI).

Finding the solution 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        t
                        )
                      to the path optimization problem (3.3) is generally very expensive computationally, often being carried out by simulated annealing. However, if the functional 
                        F
                        [
                        ⋯
                        ]
                      has finite memory, i.e. depends on the finite number of points selected at previous times (rather than the full history), then the optimal path can be found in O
                        (
                        N
                        )
                      operations using dynamic programming techniques [37]. The corresponding algorithm is discussed in detail below.

Consider first the functional 
                        F
                        [
                        
                           
                              Q
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        ,
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        ,
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        ]
                     , which depends only on the ridge point at the current time t
                     
                        n
                      (characterized by 
                        
                           
                              Q
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      and 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                     ) and the frequency of the previous one 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                     . This is basically the case utilized in all schemes presented in this work. The optimization problem (3.3) consists of finding the sequence of ridge point indices 
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      maximizing the integral of this functional over time:
                        
                           (7.1)
                           
                              
                                 
                                    
                                       argmax
                                    
                                    
                                       {
                                       
                                          
                                             m
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             N
                                          
                                       
                                       }
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              F
                              [
                              
                                 
                                    
                                       Q
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       ν
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       ν
                                    
                                    
                                       
                                          
                                             m
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 )
                              
                              ]
                              .
                           
                        
                     The ridge curve is then recovered as 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        =
                        
                           
                              ν
                           
                           
                              
                                 
                                    m
                                 
                                 
                                    c
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                     .

It is clear that at each time t
                     
                        n
                      for each ridge 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      there exists a history of previous peaks 
                        {
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              c
                           
                        
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              1
                           
                        
                        )
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              c
                           
                        
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        }
                      which maximizes the integral to this point
                        
                           (7.2)
                           
                              U
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              F
                              [
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    m
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              ]
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              F
                              [
                              
                                 
                                    Q
                                 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    m
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    m
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    m
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                              ]
                              .
                           
                        
                     What makes a fast path optimization possible is that, for functionals depending only on the current and previous points, if the profile 
                        {
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        t
                        )
                        }
                      maximizing (3.3) includes 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                     , then it should include the best path to 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      as well: 
                        {
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              1
                           
                        
                        )
                        ,
                        …
                        ,
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        }
                        =
                        {
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              c
                           
                        
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              1
                           
                        
                        )
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              c
                           
                        
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        ,
                        m
                        }
                     . This is because the behavior of 
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              i
                              =
                              n
                              +
                              1
                              
                              ,..,
                              
                              N
                           
                        
                        )
                      does not influence the integral over the previously extracted points 
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              i
                              =
                              1
                              
                              ,..,
                              
                              n
                              −
                              1
                           
                        
                        )
                     . Therefore, at each step we can leave only the best paths to each peak 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        t
                        )
                      and discard all the others.

It is useful to express 
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              c
                           
                        
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              i
                           
                        
                        )
                      through the matrix 
                        q
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      which maps the peak number m at time t
                     
                        n
                      to the previous peak number in such a way that (7.2) is maximized. We therefore introduce
                        
                           (7.3)
                           
                              q
                              [
                              i
                              ]
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ≡
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    i
                                 
                              
                              )
                              =
                              q
                              (
                              q
                              [
                              i
                              −
                              1
                              ]
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    i
                                    +
                                    1
                                 
                              
                              )
                              :
                              q
                              [
                              0
                              ]
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              m
                              ,
                              q
                              [
                              1
                              ]
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              ,
                              q
                              [
                              2
                              ]
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              q
                              (
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    2
                                 
                              
                              )
                              ,
                              ⋮
                           
                        
                     What remains is to find at each time t
                     
                        n
                      (starting from t
                     1), and for each ridge 
                        m
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                     , the maximum value 
                        U
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      of the integral up to this point and the index of the previous ridge 
                        q
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      for which this maximum is achieved:
                        
                           (7.4)
                           
                              
                                 for
                              
                              
                              n
                              =
                              1
                              ,
                              …
                              ,
                              N
                              
                              
                                 and
                              
                              
                              m
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              
                              
                                 do
                              
                              :
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       argmax
                                    
                                    
                                       k
                                    
                                 
                              
                              {
                              F
                              [
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              ]
                              +
                              U
                              (
                              k
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              }
                              ,
                              U
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              F
                              [
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    ν
                                 
                                 
                                    q
                                    (
                                    m
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              ]
                              +
                              U
                              (
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              )
                              .
                           
                        
                     Then 
                        U
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                      represents the full integral (7.1) to each of the last ridges 
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                     , and one has 
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                        =
                        
                           
                              argmax
                           
                           
                              m
                           
                        
                        U
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                     , with the sequence corresponding to this index being the optimal path: 
                        {
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        t
                        )
                        }
                        =
                        {
                        q
                        [
                        N
                        −
                        1
                        ]
                        (
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                        ,
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                        ,
                        …
                        ,
                        q
                        [
                        1
                        ]
                        (
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                        ,
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                        ,
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              N
                           
                        
                        )
                        }
                     .

For example, for the functional 
                        F
                        [
                        ⋯
                        ]
                        =
                        log
                        
                        
                           
                              Q
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        +
                        w
                        (
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        −
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        ,
                        α
                        )
                      (scheme I (3.4)), we calculate
                        
                           (7.5)
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              :
                              
                                 for
                              
                              
                              m
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              0
                              ,
                              
                              U
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              log
                              
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              :
                              
                                 for
                              
                              
                              m
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       argmax
                                    
                                    
                                       k
                                    
                                 
                              
                              {
                              log
                              
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              +
                              w
                              (
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              −
                              
                                 
                                    ν
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              α
                              )
                              +
                              U
                              (
                              k
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              }
                              ,
                              U
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              log
                              
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              +
                              w
                              (
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              −
                              
                                 
                                    ν
                                 
                                 
                                    q
                                    (
                                    m
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              α
                              )
                              +
                              U
                              (
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              :
                              
                                 for
                              
                              
                              m
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    p
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       argmax
                                    
                                    
                                       k
                                    
                                 
                              
                              {
                              log
                              
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              +
                              w
                              (
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              −
                              
                                 
                                    ν
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              α
                              )
                              +
                              U
                              (
                              k
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              }
                              ,
                              U
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              =
                              log
                              
                              
                                 
                                    Q
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              +
                              w
                              (
                              
                                 
                                    ν
                                 
                                 
                                    m
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              −
                              
                                 
                                    ν
                                 
                                 
                                    q
                                    (
                                    m
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              α
                              )
                              +
                              U
                              (
                              q
                              (
                              m
                              ,
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              ⋮
                           
                        
                     where 
                        q
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              1
                           
                        
                        )
                      is set to zero because there are no peaks before the starting time t
                     1.

Numerically, the 
                        q
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      and 
                        U
                        (
                        m
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      represent 
                        
                           
                              M
                           
                           
                              p
                           
                        
                        ×
                        N
                      matrices, updated at each step, where 
                        
                           
                              M
                           
                           
                              p
                           
                        
                        =
                        
                           
                              max
                           
                           
                              n
                           
                        
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      is the maximum number of peaks; the excess entries 
                        q
                        (
                        {
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        +
                        1
                        ,
                        ‥
                        ,
                        
                           
                              M
                           
                           
                              p
                           
                        
                        }
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      and 
                        U
                        (
                        {
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        +
                        1
                        ,
                        ‥
                        ,
                        
                           
                              M
                           
                           
                              p
                           
                        
                        }
                        ,
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      are set to Not-a-Numbers (NaNs). Since at each time t
                     
                        n
                      we need to calculate for each of the 
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      peaks the functional with each of the 
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                      of the previous peaks (to find the one maximizing it), the overall computational cost of the procedure is 
                        O
                        (
                        
                           
                              M
                           
                           
                              p
                           
                           
                              2
                           
                        
                        N
                        )
                      (or, more precisely, 
                        O
                        (
                        〈
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              i
                           
                        
                        )
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              i
                              +
                              1
                           
                        
                        )
                        〉
                        N
                        )
                     ). The outcome of the algorithm is illustrated below on a schematic example: 
                        
                     Note, that in this example there are two ways of going from the second peak at time t
                     1: either to the second row 
                        (
                        
                           
                              m
                           
                           
                              c
                           
                        
                        (
                        
                           
                              t
                           
                           
                              2
                           
                        
                        )
                        =
                        2
                        )
                     , corresponding to 
                        U
                        (
                        2
                        ,
                        
                           
                              t
                           
                           
                              2
                           
                        
                        )
                        =
                        2.0
                     , or to the third one, corresponding to 
                        U
                        (
                        3
                        ,
                        
                           
                              t
                           
                           
                              2
                           
                        
                        )
                        =
                        2.4
                     . The one-step scheme (3.1) would select the third peak, but using the path optimization scheme we explore all the possibilities, and find out that going through the second one leads at the end to the higher path functional (3.3).

The path optimization for functionals depending on any finite number of previous peak positions (and not only one, as in (7.1)) can be performed in a manner analogous to that outlined above. For example, if the functional 
                        F
                        [
                        ⋯
                        ]
                      depends on two previous points 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                      and 
                        
                           
                              ω
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              2
                           
                        
                        )
                     , then one will need to apply the same procedure but, instead of single ridges, treat their one-step sequences. In this case one selects at time t
                     
                        n
                      the trajectory maximizing the path functional (3.3) to each of the 
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        ×
                        
                           
                              N
                           
                           
                              p
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                      point combinations 
                        {
                        
                           
                              ν
                           
                           
                              k
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                              −
                              1
                           
                        
                        )
                        ,
                        
                           
                              ν
                           
                           
                              m
                           
                        
                        (
                        
                           
                              t
                           
                           
                              n
                           
                        
                        )
                        }
                     . The general case of accounting for d previous points is qualitatively similar, so the computational cost of the procedure is 
                        O
                        (
                        
                           
                              M
                           
                           
                              p
                           
                           
                              d
                              +
                              1
                           
                        
                        N
                        )
                     .

Supplementary data associated with this paper can be found in the online version at doi:10.1016/j.sigpro.2016.01.024.


                     
                        
                           Application 1
                           
                        
                     
                  

@&#REFERENCES@&#

