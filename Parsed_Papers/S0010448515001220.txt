@&#MAIN-TITLE@&#A method for improving measurement accuracy of cylinders in dimensional CT metrology

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The method can fit cylindrical surface from a projection image directly.


                        
                        
                           
                           The method can measure cylindrical surface with a higher accuracy.


                        
                        
                           
                           The method can complete measurement by use of much less measurement time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

X-ray computed tomography

Dimensional metrology

Measurement accuracy

CT artefact

Cylindrical surface fitting

@&#ABSTRACT@&#


               
               
                  Measurement quality of industrial cone beam X-ray computed tomography (CT) is influenced by many types of artefacts, therefore, industrial-level accuracy is difficult to attain. In order to avoid the influences of these artefacts, this paper proposes a new method for measuring cylindrical surface that is a common geometric structure in mechanical parts. The proposed method fits cylindrical surface from a sinogram image directly. Compared with a standard way for dimensional CT metrology, higher measurement accuracy and less measurement time can be achieved. Mainly, the method consists of edge points detection of a sinogram image and cylindrical surface fitting. The performance of the method is evaluated by use of both simulation data and actual data.
               
            

@&#INTRODUCTION@&#

X-ray CT is a powerful technique to inspect a mechanical part in a non-destructive way. In industry, this technique has been used for material analysis and non-destructive testing since 1980s  [1]. Recently, due to the ability to precisely measure inside and outside structure of a mechanical part in one single scan, its application field has been broadened to include dimensional metrology that is a young and challenging application for industrial computed tomography (ICT). So far, dimensional ICT is the only device able to complete dimensional measurement of the inner geometry and non-accessible part of a component without destroying it. Also it can perform dimensional quality control and material quality control simultaneously  [2]. However, CT is inherently influenced by many types of artefacts that may prevent reliable measurement  [3]. Those artefacts are induced by such as 3D reconstruction, beam hardening, scattering, etc.  [2,4]. ​ Since circular cone beam scanning is commonly adopted for an ICT scanning system, in this paper only circular scanning trajectory is considered. As shown in Fig. 1
                     (a), the main components of an ICT system are an X-ray source, a rotation table, and a 2D flat panel detector. The specimen is mounted on the rotation table, which is located between the X-ray source and the detector. The source emits cone beam X-rays that penetrate the specimen and generate a 2D projection image known as a sinogram image on the detector. Typically the specimen is rotated 360° and usually more than 500 sinogram images are taken. Subsequently as shown in Fig. 1(b), on the basis of those sinogram images, a CT volumetric model is generated by use of the CT reconstruction algorithm such as the FDK algorithm  [6] which is widely used for cone beam type of CT. Once the volumetric data is obtained, 3D polygonal meshes are computed by use of polygonization algorithm such as marching cubes algorithm  [7]. Then dimensional parameters are evaluated. In this study that data processing processes are called as the standard way for dimensional CT metrology.

An example of typical problems in the standard way is given in Fig. 2
                     , which includes cone beam artefact, beam hardening, and X-ray scattering. As circular scanning geometry cannot fully satisfy Tuy’s data sufficiency condition  [8], an exact reconstruction is possible only in the plane of the source trajectory, resulting in such cone beam artefact in the volumetric data. Beam hardening is a well-known cupping artefact, which is due to low energy photons of an X-ray beam with a range of energies attenuated more rapidly than high energy photons. Scattering is caused by deflection of X-ray inside the specimen or on the detector, which decreases the SNR locally. In addition to those problems, the threshold method in the process of surface extraction is also a critical and difficult issue in dimensional CT metrology. So far, 50% global threshold method is commonly used to detect the edge of single material specimen. In addition, many local adaptive threshold methods have been developed to improve edge detection by removing some noise particles or artefacts. However, neither method can detect edge accurately. It is stated that no systematic improvements can be found between local and global threshold methods with respect to the achievable accuracy  [9]. To solve these problems, much work has been done. Amirkhanov proposed a method for CT scan positions optimization to reduce artefacts by use of Radon-space analysis and penetration length analysis  [10]. Zhu presented an efficient estimation method to reduce the intensity drop in the cone beam reconstruction on circular scanning based on Grangeat’s formula and Hu’s theory  [11]. Joseph et al. described an experimental study on the influence of beam hardening, showing that beam hardening reduces internal dimensions and increase external dimensions  [12]. Xue gave a numerical analysis of the FDK reconstruction effect on CT measurement accuracy in detail  [13]. Ye proposed a material-dependent global threshold method for edge detection and reported that the grey value of an actual edge is close to the material peak in the case of serious beam hardening  [14]. All of these studies are based on the standard way. In light of that many factors in the standard way influence CT measurement quality, we propose a new way (see Fig. 1(b)) for measuring cylindrical surface from a sinogram image directly, which excludes 3D reconstruction and surface extraction.

Cylindrical surface is one of the most basic curvilinear geometric shapes and a common and important geometric structure in many mechanical parts (e.g. automotive engine, bearing, motor spindle, etc.). And we use a specimen called stepped cylinders shown in Figs. 1 and 2. It is often used as a phantom to evaluate performance of an ICT system and may be adopted as ISO reference standards for dimensional CT metrology. Thus we focus on this specimen in this paper. The proposed new way first detects the edge points that are located on the silhouette lines of the cylindrical surface on the sinogram image, and then fits the cylindrical surface from those edge points and X-ray focus by use of least square method. By use of the new way, radius, unit vector of central axis, and one point on central axis can be estimated. As 3D reconstruction is not utilized in our new way, the influence of the artefacts (cone beam artefact, beam hardening artefact, etc.) in the reconstruction image can be avoided, resulting in a higher measurement accuracy. And in the new way only dozens of sinogram images are used as input, which is far fewer than hundreds of sinogram images needed in the standard way, therefore the time and cost of CT measurement is reduced sufficiently. The same with the standard way, our new way also faces problems caused by partial volume, focus size, geometrical misalignment, etc.  [15].

This paper evaluates the new way by use of both simulation data and actual data. Our CT simulation approach can produce projection image accurately, which is different from common ones as Monte-Carlo simulation  [16] and hybrid method  [17]. To close to the actual physical situation, each detector pixel is separated into as many small pixels as possible in the simulation processing. The actual CT data of stepped cylinders scanned from a precision CT machine is used. The results of both simulation and actual data show that the new way can fit the cylindrical surface accurately.

The paper is structured as follows. The computation flow and detailed algorithm of the new way is described in Section  2. The result and discussion is shown in Section  3. Conclusion and outline directions for future work is given in Section  4.

@&#METHOD@&#


                     Fig. 3
                      shows our basic idea for estimating cylindrical surface from sinogram images. The projection of a cylinder on the sinogram image has two straight lines along its two sides. These two lines are silhouettes of the cylinder and correspond to the two planes that are tangent to the cylinder and pass the X-ray focus. These two tangent planes can be estimated from the positions of the X-ray focus and the two silhouette lines on the sinogram image. As the cylinder is rotated on the rotation table of the CT machines, many sinogram images are captured. The number of tangent planes obtained is twice the number of sinogram images. The cylinder can be estimated as one which is tangent to all of these planes.

In this section, the computation flow and detailed algorithm of the proposed method are given. The computation flow is divided into two main steps. First we apply standard image processing techniques for detecting the edge points on the silhouette lines. In this step, the core algorithm is Canny detector  [18] and Hough transform. In this study the point detected by Canny detector is called Canny point and the straight line detected by Hough transform is called Hough line. Second we apply least square method for fitting tangent planes to a cylindrical surface and estimate its equation.


                        Fig. 4
                         shows the main steps for detecting the edge points on the silhouette lines. First the sinogram image is filtered to remove some noise that are induced by X-ray scattering, refraction, electronic device, etc. Second the filtered image is upsampled to weaken the influence of the partial volume (i.e. realize sub-pixel accuracy). In a sinogram image of a single material specimen, the amount of projection value depends on the penetration length travelled in the absorbing material. Around the boundary (the area inside material) of a cylindrical structure the projection value profile is generally a continuous curve (see Fig. 5
                        (b)). The sinogram image is upsampled once by use of bicubic interpolation. One example is shown in Fig. 6
                        (a). It is worthwhile noting that high order interpolation generates ‘overshooting’ in our experience as shown in Fig. 6(b). Such overshooting causes bad effects for edge detection with Canny detector.

Third Canny detector is used to detect all the edge points on the sinogram image. Then Hough transform is used to detect the straight lines among those edge points. The projection of a cylindrical surface has two straight lines on the sinogram image along its two sides. Hough transform is used to find two Hough lines corresponding to these two straight lines. For the parameter settings of Hough transform, 1 pixel as the resolution in pixels and 1° as the resolution in radians are accurate enough in our experience.

The last step is to extract the edge points that are located on the silhouette lines of the cylindrical surface on the sinogram image. Fig. 7
                         shows some detail of the last step by use of stepped cylinders as example. The result of Canny detection and Hough transform of a sinogram image is shown in Fig. 7(a). The red points represent the Canny point, and the yellow lines represent the Hough line. As shown there are many points that we do not want. To capture the edge points on the silhouette lines, the Hough line is used as reference line. Let 
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              …
                              )
                           
                         be samples of all the Canny points. The distance from Canny point 
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                         to a given Hough line is defined as 
                           
                              dist
                           
                           
                              (
                              i
                              )
                           
                        . At first Canny point 
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                         with 
                           
                              dist
                           
                           
                              (
                              i
                              )
                           
                           <
                           δ
                         will be extracted. 
                           δ
                         is a threshold value that depends on the size of the sinogram image and the feature of the Canny points. Following are three cases for these pre-extracted points associated to Hough line. 
                           
                              •
                              Case 1: area around the silhouette lines of outside cylindrical surface.

In this case, as the gradient value of the edge points is high, nearly all the noise points can be filtered by Canny detector. The pre-extracted points nearly do not include any noise points and have a high density. Fig. 7(b) shows case 1.

Case 2: area around the silhouette lines of inside cylindrical surface.

In this case, the gradient value of the edge points is small, resulting in the presence of some noise points (see area 
                                    k
                                  in Fig. 7(c)). The pre-extracted points may include several noise points, however so few noise points nearly do not influence the final result. And the pre-extracted points have a high density. Fig. 7(c) shows case 2.

Case 3: noise area.

Though the sinogram image is filtered, in some case some noise area (see area 
                                    h
                                  in Fig. 7(d)) where there are no edge points still remains. And some area (see area 
                                    j
                                  in Fig. 7(c)) where there are edge points that we do not want is also considered as noise area in this study. The reference Hough line may pass through such noise area. In such noise area the density of the pre-extracted points is low. Fig. 7(c) and (d) show case 3.

Therefore, in summary these pre-extracted points with high density are chosen as edge points on the silhouette lines of the cylindrical surface finally.

By use of the method mentioned above, we can extract Hough lines on each of the sinogram images. However, these Hough lines contains not only the lines that can be used as reference line but also many other lines. And some specimens may have many cylindrical surfaces. Therefore, we sort the Hough lines into groups, each of which only contains the Hough lines corresponding to the same cylindrical surface. In the following we describe a method to generate such groups.


                        
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              )
                           
                         is a series of sinogram images. We extract Hough lines on each 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         and define a set of Hough lines for 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         as 
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                        . First on 
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                         a pair of two Hough lines 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         for a target cylindrical surface must be chosen manually from 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         (e.g. the blue Hough line for the inside cylindrical surface in Fig. 8
                        (a)). Then on the second image 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        , we automatically detect a Hough line 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                         from 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         corresponding to 
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                         and also 
                           
                              
                                 H
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         corresponding to 
                           
                              
                                 H
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                         as well. For the third image 
                           
                              
                                 S
                              
                              
                                 3
                              
                           
                        , we can obtain 
                           
                              
                                 H
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                         from 
                           
                              
                                 L
                              
                              
                                 3
                              
                           
                         as the corresponding Hough line to 
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         respectively. As shown in Fig. 8(a), by repeating this process we obtain one group of Hough lines 
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              )
                           
                         and 
                           
                              
                                 H
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              )
                           
                         for one target cylindrical surface.

As by scanning one specimen many sinogram images are produced continuously and the size of the detector is limited, the change in position between the corresponding Hough lines on adjacent sinogram image (e.g.  
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        ) is quite small in the detector region. We use that feature to detect the corresponding Hough lines automatically. 
                           
                              
                                 H
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         must have the smallest change in position among 
                           
                              
                                 L
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         to 
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        . The parameters for detection are shown in Fig. 8(b). 
                           D
                           1
                         and 
                           D
                           2
                         represent the distance from the two intersections of one Hough line from 
                           
                              
                                 L
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         and the boundary of the detector to the Hough line 
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        . 
                           A
                         represents the angle between the vectors of the two Hough lines. We first extract Hough lines from 
                           
                              
                                 L
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         which satisfy 
                           D
                           1
                           <
                           λ
                           ∩
                           D
                           2
                           <
                           λ
                           ∩
                           A
                           <
                           ξ
                        . 
                           λ
                         and 
                           ξ
                         are threshold values that depend on the size and the number of the sinogram image. Then among the extracted Hough lines, the Hough line with minimum 
                           min
                           
                              (
                              D
                              1
                              ,
                              D
                              2
                              )
                           
                         that represents the smaller one between 
                           D
                           1
                         and 
                           D
                           2
                         is chosen as 
                           
                              
                                 H
                              
                              
                                 i
                                 +
                                 1
                              
                           
                        . In the same manner we also obtain 
                           
                              
                                 H
                              
                              
                                 i
                                 +
                                 1
                              
                              
                                 ′
                              
                           
                        .

It is worthwhile noting that for a complex specimen, maybe there is no Hough line on some sinogram image. In that case, the Hough line detection will stop. Two Hough lines need to be chosen manually again when the two Hough lines for the target cylindrical surface appear, and then the Hough line detection will continue until the end.


                        Table 1
                         shows 
                           ξ
                         and 
                           λ
                         value for different number of sinogram images. The sinogram size is 
                           500
                           ∗
                           500
                           
                           
                              pixels
                           
                        . As shown with increases in the number, 
                           ξ
                         and 
                           λ
                         decrease.

In this study, the arrangement of CT coordinate system is shown by Fig. 9
                        . The axis of rotation is defined to be the 
                           Z
                         axis. The plane consists of the X-ray focus and the 
                           Z
                         axis is defined to be the XZ plane, then the line passing through the X-ray focus and perpendicular to the 
                           Z
                         axis on the 
                           X
                           Z
                         plane is defined to be the 
                           X
                         axis. The intersection of the 
                           X
                         axis and the 
                           Z
                         axis represents the origin, and the intersection of the 
                           X
                         axis and the detector represents the centre of the detector. The third axis perpendicular to the 
                           X
                         and 
                           Z
                         axes is defined as the 
                           Y
                         axis.

By use of the method in Section  2.1, we extract two sets of edge points 
                           
                              
                                 p
                              
                              
                                 k
                                 _
                                 i
                              
                           
                           
                           
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              …
                              )
                           
                         and 
                           
                              
                                 p
                              
                              
                                 k
                                 _
                                 i
                              
                              
                                 ′
                              
                           
                           
                           
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              …
                              )
                           
                         associated to 
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         respectively for a target cylindrical surface on each sinogram image 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        . Then, for each 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         we fit two tangent planes 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         by use of these edge points and the X-ray focus (see Fig. 9).

The focus 
                           s
                        , the point 
                           
                              
                                 p
                              
                              
                                 k
                                 _
                                 i
                              
                           
                        , and the coordinate transformation matrix 
                           R
                           
                              (
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         are defined as 
                           
                              (1)
                              
                                 s
                                 =
                                 
                                    (
                                    −
                                    m
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       k
                                       _
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    n
                                    −
                                    m
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 and
                                 
                                 R
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             −
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             sin
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             cos
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         respectively. 
                           m
                         is the distance between the X-ray source and the axis of rotation, 
                           n
                         is the distance between the X-ray source and the detector, and 
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                           =
                           2
                           π
                           ∗
                           
                              (
                              i
                              −
                              1
                              )
                           
                           /
                           n
                         is the rotation angle for 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        .

For the corresponding rotation angle 
                           
                              
                                 θ
                              
                              
                                 i
                              
                           
                        , in the XYZ coordinate system 
                           s
                         and 
                           
                              
                                 p
                              
                              
                                 k
                                 _
                                 i
                              
                           
                         are transformed as 
                           
                              (2)
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 s
                                 ⋅
                                 R
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                 and
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             k
                                             _
                                             i
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       k
                                       _
                                       i
                                    
                                 
                                 ⋅
                                 R
                                 
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Then we use 
                           
                              
                                 s
                              
                              
                                 ′
                              
                           
                         and 
                           
                              {
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          1
                                          _
                                          i
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          2
                                          _
                                          i
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          3
                                          _
                                          i
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              ,
                              …
                              }
                           
                         to fit a tangent plane 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         for 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                        . Assuming that the fitted tangent plane 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         is 
                           
                              (3)
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 y
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 z
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           
                              (
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is unit normal vector. In the same manner we also fit another tangent plane 
                           
                              
                                 t
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         for 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         by use of 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    1
                                    _
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    2
                                    _
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    3
                                    _
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              …
                              }
                           
                        . By repeating this process we obtain a series of tangent planes 
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                        . The algorithm for fitting tangent plane is the same as that of the following.

By use of those tangent planes, we fit the target cylindrical surface and estimate three parameters, the radius of the cylindrical surface 
                           R
                        , one point on the central axis of the cylindrical surface 
                           
                              (
                              α
                              ,
                              β
                              ,
                              γ
                              )
                           
                        , and the unit vector of the central axis 
                           
                              (
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                         as shown in Fig. 10
                        .

First we calculate 
                           R
                         and 
                           
                              (
                              α
                              ,
                              β
                              ,
                              γ
                              )
                           
                        .

Let 
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              2
                              n
                              )
                           
                         be the combination of 
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              }
                           
                         and 
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                        .

We get the distance 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                         from the point 
                           
                              (
                              α
                              ,
                              β
                              ,
                              γ
                              )
                           
                         to the tangent plane 
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                        : 
                           
                              (4)
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 α
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 β
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 γ
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 →
                                 R
                                 .
                              
                           
                        
                     

In order to keep 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                         be plus, we make unit normal vector of the tangent plane point to the central axis (see 
                           n
                           1
                         and 
                           n
                           2
                         in Fig. 10(a)).

By use of total least square minimization, we get 
                           min
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 2
                                 n
                              
                           
                           
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                    α
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    β
                                    +
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    γ
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    R
                                    )
                                 
                              
                              
                                 2
                              
                           
                        , which yields the solution 
                           
                              (5)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                   n
                                                
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             α
                                          
                                       
                                       
                                          
                                             β
                                          
                                       
                                       
                                          
                                             γ
                                          
                                       
                                       
                                          
                                             R
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   d
                                                
                                                
                                                   2
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

Then we solve Eq. (5) by use of singular value decomposition (SVD)  [19] that is a factorization of a real or complex matrix, with many useful applications. 
                           R
                         and 
                           
                              (
                              α
                              ,
                              β
                              ,
                              γ
                              )
                           
                         are obtained.

Second, we calculate the unit vector of the central axis 
                           
                              (
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                        . On each tangent plane 
                           
                              
                                 q
                              
                              
                                 i
                              
                           
                         one point 
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    x
                                    i
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    y
                                    i
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    z
                                    i
                                 
                              
                              )
                           
                         that has the shortest distance to 
                           
                              (
                              α
                              ,
                              β
                              ,
                              γ
                              )
                           
                         is calculated. In theory the point group 
                           
                              (
                              
                                 
                                    f
                                 
                                 
                                    x
                                    i
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    y
                                    i
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    z
                                    i
                                 
                              
                              )
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              2
                              n
                              )
                           
                         are on the same plane that is perpendicular to the central axis. We use these points to fit a plane (see Fig. 10(b)) 
                           
                              (6)
                              
                                 z
                                 =
                                 A
                                 x
                                 +
                                 B
                                 y
                                 +
                                 D
                                 ,
                              
                           
                         and the unit normal vector of this plane is considered as 
                           
                              (
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                        .

By use of total least square minimization, we get 
                           min
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 2
                                 n
                              
                           
                           
                              
                                 
                                    (
                                    A
                                    
                                       
                                          f
                                       
                                       
                                          x
                                          i
                                       
                                    
                                    +
                                    B
                                    
                                       
                                          f
                                       
                                       
                                          y
                                          i
                                       
                                    
                                    +
                                    D
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          z
                                          i
                                       
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                        , which yields the solution 
                           
                              (7)
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   y
                                                   1
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                          
                                             ⋅
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                   2
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   y
                                                   2
                                                   n
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          
                                             B
                                          
                                       
                                       
                                          
                                             D
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                       
                                       
                                          
                                             ⋅
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                   2
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

SVD is used to solve Eq. (7). 
                           
                              (
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                         is obtained.

In Eqs. (5) and (7), there are four unknowns at most, therefore in theory this new method only needs 3 sinogram images as input, which is far fewer than the number needed in the standard way.

The simulation data is obtained by use of our CT simulation approach, which can produce a sinogram image accurately. In order to evaluate the theoretical accuracy of the proposed new way, the produced sinogram image does not contain any noise. It is worthwhile noting that the partial volume effect cannot be avoided, due to the discrete detector.

Hollow cylinder with a typical feature of cylindrical surface is used as test phantom for simulation. We evaluate the new way by use of two parameters, spatial position and sinogram number. The spatial position is obtained by slanting the hollow cylinder around the 
                           X
                         axis and moving the hollow cylinder along the 
                           Y
                         axis (see Fig. 11
                        ). In addition to radius error, the angle deviation 
                           θ
                         that is the spatial angle between the fitted central axis and the original central axis and the distance deviation that represents the larger distance between d1 and d2 are used to evaluate the accuracy of the new way (see Fig. 12
                        ).


                        Table 2
                         shows the simulation parameters for movement along the 
                           Y
                         axis and slant around the 
                           X
                         axis.

For the case of an upright hollow cylinder moved along the 
                           Y
                         axis, error parameters for different position along the 
                           Y
                         axis are computed. Fig. 13
                         shows the curves of outside radius error, inside radius error, angle deviation and distance deviation, it is observed that all the values are sufficiently small. The absolute values of outside radius error and inside radius error are smaller than 15% of one pixel size. And for an upright hollow cylinder, the angle deviation is 0°.

For the case of hollow cylinder slanted around the 
                           X
                         axis, we compute error parameters for placements with 0, 10, 20, 30, 40, 50, 60, 70, 80, 90° slant angle. As shown in Fig. 14
                        , also it is observed that all the values are sufficiently small. The absolute values of outside radius error and inside radius error are smaller than 15% of one pixel size. And with increases in the slant angle, the angle deviation and distance deviation increase, but the values are small.

The effect of sinogram number on the new way is evaluated by use of hollow cylinder with 45° slant angle. The simulation parameters are the same as those in Table 2 except sinogram number. Fig. 15
                         shows the results, it is observed that the values are nearly the same with increases in the number. Therefore, if the cylindrical surface is uniform, the new way can fit the cylindrical surface accurately by use of dozens of sinogram images.

In summary, we can conclude that the new way can fit cylindrical surface accurately in theory. The radius error is smaller than 15% of one pixel size and the sinogram number does not influence the fitting accuracy for a uniform cylindrical surface.

We use a precision CT machines from AIST-National Metrology Institute of Japan in the actual experiments. The X-ray source voltage is 225 kV and the focus size is 4 μm. The stepped cylinders used in this study is shown in Fig. 16
                        . It is made of aluminium and consist of 5 steps, each 10 mm in height, the outside radius is increasing from 10 to 30 mm in step of 5 mm. The inside radius is 5 mm. Table 3
                         shows the scanning parameter settings.

In this study, we compare the result of the new way with that of the standard way by use of the actual CT data. In order to compute the measurement error of our new way and the standard way, reference measurements of the specimen have been carried out by use of a tactile CMM.

In the standard way, we use VG Studio Max 2.0 that is considered as a standard software for dimensional CT metrology to measure outside and inside radius. In the process of surface extraction, both 50% global threshold method and local adaptive method are performed. And in the process of fitting, Gaussian best-fit algorithm is used to fit a cylinder form the CT points cloud.

The stepped cylinders were scanned uprightly and aslant respectively. For both cases, the reconstructed slices have the same feature. Fig. 17
                         shows the upright case, it is observed that the beam hardening is obvious. Fig. 18
                         shows the error curves. For the standard way, the outside radius becomes larger and the inside radius becomes smaller than the actual size due to the effect of beam hardening as introduced in  [12]. In the case of 50% global threshold method, the error is large and close to half of one pixel size. By comparing the result of the new way with that of the standard way, we can get: 
                           
                              (1)
                              In the case of the standard way with 50% global threshold method, for both outside and inside radius, the new way gives a much more accurate result.

In the case of the standard way with local adaptive method, for outside radius, the new way gives a more accurate result. For inside radius, the standard way gives a more accurate result.

In the above results of the new way, 60 sinogram images are used to fit the cylindrical surface. The outside radius error and the inside radius error are smaller than 20% of one pixel size. Fig. 19
                         shows the result of the new way with different sinogram number, it is observed that the values are nearly the same with increases in the number.

In summary, the results of the actual data are nearly consistent with those of the simulation data. Those results show that the new way can fit cylindrical surface accurately by use of dozens of sinogram images and can avoid the effect of beam hardening.

In order to avoid the influences of some artefacts in the standard way, this paper proposes a new way for measuring cylindrical surface in dimensional CT metrology. The simulations show that the new way can fit cylindrical surface accurately in theory. The actual experiments show that the new way can complete a higher measurement accuracy by use of much fewer sinogram images, compared with the standard way.

Though the new way given in this study can improve measurement accuracy of cylindrical surface to a certain extent, there are several limitations. One limitation is that for some mechanical parts with complex structure maybe it is impossible to extract Hough line accurately for a target cylindrical surface, resulting in a large measurement error by use of the new way. Another limitation is that in the case of the inside cylindrical surface with serious noise on the sinogram image, the new way cannot work as the edge points cannot be detected accurately. In future work, we will continue to do further research on filtering the noise points on the sinogram image based on the image feature, and fit some other geometric shapes from sinogram images directly.

@&#ACKNOWLEDGEMENT@&#

The authors would like to thank AIST-National Metrology Institute of Japan for providing actual CT data in this study.

@&#REFERENCES@&#

