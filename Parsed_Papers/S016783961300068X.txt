@&#MAIN-TITLE@&#Geometric multiscale decompositions of dynamic low-rank matrices

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We show that for any manifold our transform achieves an optimal N-term approximation rate for piecewise smooth curves.


                        
                        
                           
                           We introduce a general method to define weighted averages in manifolds, based on the notion of retraction pairs introduced in the paper.


                        
                        
                           
                           We describe several algorithms taylored to the geometry of the Stiefel manifold and provide numerical examples.


                        
                        
                           
                           An application in the compression of hyperspectral image data concludes the article.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Riemannian data

Low-rank approximation




                     N-term approximation

Compression

Manifold-valued wavelet transforms

@&#ABSTRACT@&#


               
               
                  The present paper is concerned with the study of manifold-valued multiscale transforms with a focus on the Stiefel manifold. For this specific geometry we derive several formulas and algorithms for the computation of geometric means which will later enable us to construct multiscale transforms of wavelet type. As an application we study compression of piecewise smooth families of low-rank matrices both for synthetic data and also real-world data arising in hyperspectral imaging. As a main theoretical contribution we show that the manifold-valued wavelet transforms can achieve an optimal N-term approximation rate for piecewise smooth functions with possible discontinuities. This latter result is valid for arbitrary manifolds.
               
            

@&#INTRODUCTION@&#

This paper is concerned with two themes, namely the handling of manifold-valued data in general and more specifically the efficient compression and analysis of sequences of low-rank matrices.

Low-rank matrix or tensor-valued sequences arise in many important applications, whenever low-rank approximations of a parameterized family of large matrices or tensors (which otherwise would not be accessible computationally) are considered.

Examples include, but are not limited to, signal processing (in particular video and hyperspectral imaging), latent semantic indexing in information retrieval, dynamic graphs (and the associated graph Laplacians), solutions of high-dimensional time-dependent PDEʼs (such as the chemical master equation or the Schrödinger equation), or more general parameter dependent linear operators.

In order to connect this specific type of data to geometry, write a matrix 
                        A
                        ∈
                        
                           
                              R
                           
                           
                              n
                              ×
                              n
                           
                        
                      of rank p as
                        
                           (1)
                           
                              A
                              =
                              U
                              S
                              
                                 
                                    V
                                 
                                 
                                    ⊤
                                 
                              
                              ,
                           
                        
                      where
                        
                           (2)
                           
                              U
                              ,
                              V
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    p
                                 
                              
                              ,
                              
                              
                                 
                                    U
                                 
                                 
                                    ⊤
                                 
                              
                              U
                              =
                              
                                 
                                    V
                                 
                                 
                                    ⊤
                                 
                              
                              V
                              =
                              
                                 
                                    I
                                 
                                 
                                    p
                                 
                              
                           
                        
                      and
                        
                           
                              S
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    p
                                    ×
                                    p
                                 
                              
                              .
                           
                        
                      One particular way to arrive at a decomposition of the form (1) is to apply a truncated singular value decomposition to A in which case S is always a diagonal matrix. Due to (2), the matrices U, V lie in the orthogonal Stiefel manifold 
                        
                           St
                        
                        (
                        n
                        ,
                        p
                        )
                     , see Section 2.2 below.

In this work we exploit this geometric structure to develop wavelet-type multiscale decompositions for sequences of low-rank matrices of a fixed rank. These decompositions, which are in the spirit of Rahman et al. (2006), turn out to be optimally adapted to piecewise smooth data which in practice most often occurs. We prove this for general manifolds and confirm our results numerically. As an application we develop a compression scheme for hyperspectral image data.

The contributions of this paper are in two directions. Firstly, we study general manifold-valued multiscale decompositions and their properties. In this regard, one of our main findings is an existence theorem for geometric averaging operations based on arbitrary choices of retractions onto the manifold analogous to the exponential mapping, see Section 2.1. In Karcher (1977) similar averages are developed which however require the efficient computability of the exponential and logarithm mapping of the manifold – an assumption which for instance in the case of the Stiefel manifold is not fulfilled. Based on geometric averaging operations we show how wavelet-like multiscale decompositions can be constructed. These constructions are much in the spirit of Rahman et al. (2006) but with more freedom in the choice of averaging operations.

After introducing these constructions we prove our main theoretical result. In Theorem 3.7 we show that the manifold-valued wavelet decompositions achieve an optimal best N-term approximation rate for piecewise smooth functions. For linear wavelet constructions this result is of course also true and it may be regarded as one of the pillars of their success. Our result states that this behavior can be retained in arbitrary manifolds.

A good part of the proofs of our results relies on ideas developed in earlier work on the approximation theory of nonlinear wavelet transforms, such as in Grohs and Wallner (2009), Grohs (2010b). With these technical tools in hand, it turns out that our main result can be established without too much technical difficulty. Nevertheless, we consider the theoretical result that the manifold-valued wavelet transform enjoys an optimal best N-term approximation rate of great importance for applications.

Secondly, we study a number of results, algorithms and applications tailored to the specific case of the Stiefel manifold. This geometry which – as we have already outlined – is of tremendous importance for many applications is not treated in Rahman et al. (2006) and presents many challenges. For instance, Rahman et al. (2006) assumes the efficient computability of exponential and logarithm mapping, which is not given in the Stiefel manifold, especially for high dimensional matrices. As a remedy, we develop alternative retractions in Section 2.2.3 and present practical algorithms for their computation. By our general results these constructions perform as well as those based on the exponential mapping, but with a huge gain in efficiency.

To demonstrate the practical usefulness of our algorithms we develop a compression scheme for hyperspectral image data in Section 4.2.

To put this paper in perspective we comment on some related work. In regards to multiscale analysis of geometric data there exists by now a substantial body of work (Rahman et al., 2006; Grohs and Wallner, 2009; Nava Yazdani and Yu, 2011; Weinmann, 2012; Grohs, 2010b). Our paper builds on these results and ideas. On the other hand, low rank approximation is probably the oldest and by far most popular and significant model reduction technique in computational science.

The theory of dynamic low-rank approximation resulting in piecewise smooth families of low-rank matrices has been studied in Koch and Lubich (2008, 2010), Nonnenmacher and Lubich (2008), Baumann and Helmke (2003), Bunse-Gerstner et al. (1991), Dieci and Eirola (1999). We also refer to this work for further information on application areas.

Structured low-rank approximation has been studied in Chu et al. (2003). We expect our work to be extendible to decompositions of the type studied in that paper.

Other applications of data with values in the Stiefel manifold and related geometries can be found in Absil et al. (2008), Edelman et al. (1999), Hairer et al. (2006).

Even though in the present paper we confine the discussion to low-rank matrices, we expect an extension to the tensor case to be feasible, see also Koch and Lubich (2010).

To facilitate the reading we give a brief outline of the paper. In Section 2.1 we start by defining geometric notions of averages in general manifolds. The main result of this section is a proof of well-definedness of these constructions, extending classical results in Karcher (1977). After that, in Section 2.2.3 we study specific choices for retractions on the Stiefel manifold which are necessary in the definition of a geometric average. We obtain explicit and to our knowledge new expressions and algorithms for several computationally attractive retractions and their inverses.

In Sections 3.2 and 3.1 we give two constructions of multiscale transforms of manifold-valued functions, inspired by Rahman et al. (2006) but based on our more general averaging operations. Then, in Section 3.3 we prove our main theoretical result, namely that these constructions attain an optimal approximation rate for piecewise smooth functions.

Section 4 contains applications and computational experiments, first with synthetic data and later, in Section 4.2, we present a method for the compression of hyperspectral image data. Finally, in Section 4.3 we comment on the interesting work (Koch and Lubich, 2008) for the purpose of obtaining piecewise smooth low-rank approximations to a given matrix curve.

We use the symbol 
                           A
                           ≲
                           B
                         to describe that a quantity A is bounded by a fixed constant times the quantity B. Matrices are always written in boldface letters. We use the symbol 
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                         for the 
                           n
                           ×
                           n
                         identity matrix and 
                           
                              
                                 0
                              
                              
                                 n
                              
                           
                         for the 
                           n
                           ×
                           n
                         zero matrix.

The present section contains basic geometric facts which we will use later on. In the first Section 2.1 we treat general manifolds and exhibit useful methods of defining intrinsic notions of a weighted average of points. These results universally apply to any Riemannian manifold and are of independent interest.

Then, in Section 2.2 we specify these findings to the geometry of the Stiefel manifold. In particular we construct several useful notions of retractions which, along with their inverses, turn out to be efficiently computable.

For now we consider a general Riemannian manifold M with Riemannian metric 
                           
                              
                                 〈
                                 ⋅
                                 ,
                                 ⋅
                                 〉
                              
                              
                                 M
                              
                           
                         defined on the tangent bundle TM. We assume some familiarity with the basics of Riemannian geometry, a good entrance point into this topic is DoCarmo (1992). An important operation in our analysis will be the addition of a tangent vector to a point. Classically for Riemannian manifolds, this is done via the exponential mapping 
                           
                              
                                 exp
                              
                              
                                 x
                              
                           
                           (
                           ξ
                           )
                         which maps a tangent vector 
                           ξ
                           ∈
                           
                              
                                 T
                              
                              
                                 x
                              
                           
                           M
                        , the tangent space of M at a point 
                           x
                           ∈
                           M
                        , to the endpoint of the (locally) unique geodesic curve emanating from x with initial velocity ξ. The exponential mapping also possesses an inverse which maps two points 
                           x
                           ,
                           y
                           ∈
                           M
                         to the (locally) unique vector 
                           log
                           (
                           x
                           ,
                           y
                           )
                           ∈
                           
                              
                                 T
                              
                              
                                 x
                              
                           
                           M
                         such that
                           
                              (3)
                              
                                 
                                    
                                       exp
                                    
                                    
                                       x
                                    
                                 
                                 
                                    (
                                    log
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    )
                                 
                                 =
                                 y
                                 .
                              
                           
                         In order to arrive at computationally efficient algorithms we are also considering alternative pairs 
                           (
                           f
                           ,
                           g
                           )
                         of functions, analogous to the pair 
                           (
                           exp
                           ,
                           log
                           )
                        . 
                           Definition 2.1
                           A pair 
                                 (
                                 f
                                 ,
                                 g
                                 )
                               of functions
                                 
                                    (4)
                                    
                                       f
                                       :
                                       T
                                       M
                                       →
                                       M
                                       ,
                                       
                                       g
                                       :
                                       M
                                       ×
                                       M
                                       →
                                       T
                                       M
                                    
                                 
                               is called a retraction pair if
                                 
                                    (5)
                                    
                                       f
                                       
                                          (
                                          x
                                          ,
                                          g
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          )
                                       
                                       =
                                       y
                                       
                                       for all 
                                       x
                                       ,
                                       y
                                       ∈
                                       M
                                       ,
                                    
                                 
                               and
                                 
                                    (6)
                                    
                                       f
                                       (
                                       x
                                       ,
                                       0
                                       )
                                       =
                                       x
                                       ,
                                       
                                       
                                          ∂
                                          
                                             ∂
                                             ξ
                                          
                                       
                                       f
                                       (
                                       x
                                       ,
                                       0
                                       )
                                       =
                                       
                                          Id
                                       
                                       
                                       for all 
                                       x
                                       ∈
                                       M
                                       .
                                    
                                 
                              
                           

In general f will only be locally defined around M and g around the diagonal of 
                           M
                           ×
                           M
                        . Certainly, the pair 
                           (
                           exp
                           ,
                           log
                           )
                         satisfies the above assumptions (DoCarmo, 1992) and therefore forms a retraction pair.

Given a retraction pair 
                           (
                           f
                           ,
                           g
                           )
                        , points 
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 d
                              
                           
                           ∈
                           
                              
                                 M
                              
                              
                                 d
                              
                           
                         and weights 
                           
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 d
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         such that
                           
                              (7)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    d
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                         we are now going to define a manifold-valued weighted average of the points 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                         with weights 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        . As a motivation we first consider the linear case 
                           M
                           =
                           R
                        , where the retraction pair induced by the exponential map is given by 
                           
                              
                                 f
                              
                              
                                 LIN
                              
                           
                           (
                           x
                           ,
                           v
                           )
                           =
                           x
                           +
                           v
                         and 
                           
                              
                                 g
                              
                              
                                 LIN
                              
                           
                           (
                           x
                           ,
                           y
                           )
                           =
                           y
                           −
                           x
                        . In that case we certainly know how to compute a weighted average
                           
                              (8)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ⁎
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    d
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 .
                              
                           
                         Clearly the definition (8) makes no sense in a manifold-valued context since we cannot form linear combinations of points in M. Nevertheless, we can rewrite (8) slightly to arrive at the alternative definition of the average 
                           
                              
                                 x
                              
                              
                                 ⁎
                              
                           
                         as the unique point 
                           
                              
                                 x
                              
                              
                                 ⁎
                              
                           
                           ∈
                           R
                         with
                           
                              (9)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    d
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       LIN
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ⁎
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 0
                                 .
                              
                           
                         Note that we have used 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 d
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           =
                           1
                        . The expression (9) makes sense for a general manifold M with retraction pair 
                           (
                           f
                           ,
                           g
                           )
                        . In the following we show that under some assumptions on the points 
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 d
                              
                           
                         and for any retraction pair 
                           (
                           f
                           ,
                           g
                           )
                         on a manifold M, there exists a unique point 
                           
                              
                                 x
                              
                              
                                 ⁎
                              
                           
                         which satisfies 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 d
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           g
                           (
                           
                              
                                 x
                              
                              
                                 ⁎
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                           =
                           0
                           ∈
                           
                              
                                 T
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ⁎
                                    
                                 
                              
                           
                           M
                        . Therefore we will later define this point 
                           
                              
                                 x
                              
                              
                                 ⁎
                              
                           
                         as a geometric average of the points 
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 d
                              
                           
                        .

We now show the important fact that for any retraction pair, the definition motivated above yields a well-defined notion of average. To formulate our result we denote 
                           
                              
                                 B
                              
                              
                                 δ
                              
                           
                           (
                           p
                           )
                         the geodesic ball of radius 
                           δ
                           >
                           0
                         around 
                           p
                           ∈
                           M
                        . 
                           Proposition 2.2
                           
                              Let M be a Riemannian manifold with retraction pair 
                              
                                 (
                                 f
                                 ,
                                 g
                                 )
                              
                              . For each 
                              
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               
                              with 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                               
                              and 
                              
                                 p
                                 ∈
                                 M
                               
                              there exist 
                              
                                 Δ
                                 (
                                 p
                                 )
                                 ⩾
                                 δ
                                 (
                                 p
                                 )
                                 >
                                 0
                              
                              , such that for all 
                              
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 ⊂
                                 
                                    
                                       B
                                    
                                    
                                       δ
                                       (
                                       p
                                       )
                                    
                                 
                                 (
                                 p
                                 )
                              
                              , there exists a unique 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ⁎
                                    
                                 
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       Δ
                                       (
                                       p
                                       )
                                    
                                 
                               
                              such that
                              
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       g
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ⁎
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       =
                                       0
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ⁎
                                                
                                             
                                          
                                       
                                       M
                                       .
                                    
                                 
                              
                           

As a main ingredient in the proof of this result we use the following theorem which is proven in Groisser (2004), Corollary 2.6(a). 
                           Theorem 2.3
                           
                              Assume M is a Riemannian manifold and that 
                              
                                 
                                    
                                       B
                                    
                                    
                                       ρ
                                    
                                 
                                 ⊂
                                 M
                               
                              is a convex geodesic ball of radius 
                              
                                 ρ
                                 >
                                 0
                               
                              such the sectional curvature of M restricted to 
                              
                                 
                                    
                                       B
                                    
                                    
                                       ρ
                                    
                                 
                               
                              is bounded from below and from above. Then there exists 
                              
                                 ε
                                 >
                                 0
                               (only depending on the maximal and minimal sectional curvature of 
                              
                                 
                                    
                                       B
                                    
                                    
                                       ρ
                                    
                                 
                               
                              and the convexity radius of 
                              
                                 
                                    
                                       B
                                    
                                    
                                       ρ
                                    
                                 
                              ) such that for every vector field ϒ defined on 
                              
                                 
                                    
                                       B
                                    
                                    
                                       ρ
                                    
                                 
                               
                              satisfying the pointwise bound
                              
                                 
                                    
                                       ‖
                                       ϒ
                                       ‖
                                       ⩽
                                       ε
                                       
                                       
                                          and
                                       
                                       
                                       ‖
                                       
                                          Id
                                       
                                       +
                                       ∇
                                       ϒ
                                       ‖
                                       ⩽
                                       ε
                                    
                                 
                               (∇ denoting the covariant derivative), there exists a unique point 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ⁎
                                    
                                 
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       ρ
                                    
                                 
                               
                              such that
                              
                                 
                                    
                                       ϒ
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ⁎
                                          
                                       
                                       )
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

A more quantitative version of the previous theorem can be found in Groisser (2004), Theorem 2.8. We can now proceed with the proof of Proposition 2.2. 
                           Proof of Proposition 2.2
                           A short computation involving (6) and (5) shows that by putting
                                 
                                    
                                       
                                          
                                             ϒ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       x
                                       )
                                       :
                                       =
                                       g
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                 
                               to be the vector field of difference vectors pointing to 
                                 y
                                 ∈
                                 M
                              , we get
                                 
                                    (10)
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             ξ
                                          
                                       
                                       
                                          
                                             ϒ
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       −
                                       ξ
                                       ,
                                       
                                       x
                                       ∈
                                       M
                                       ,
                                       
                                       ξ
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             x
                                          
                                       
                                       M
                                       ,
                                    
                                 
                               where ∇ denotes the covariant derivative. Indeed, this may be seen by first differentiating (5) w.r.t. x (if necessary in a chart) which yields
                                 
                                    
                                       
                                          ∂
                                          
                                             ∂
                                             x
                                          
                                       
                                       f
                                       
                                          (
                                          x
                                          ,
                                          g
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          )
                                       
                                       +
                                       
                                          ∂
                                          
                                             ∂
                                             ξ
                                          
                                       
                                       f
                                       
                                          (
                                          x
                                          ,
                                          g
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          )
                                       
                                       
                                          ∂
                                          
                                             ∂
                                             x
                                          
                                       
                                       g
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       0
                                       .
                                    
                                 
                               Using (6) this implies that with 
                                 x
                                 =
                                 y
                              
                              
                                 
                                    
                                       
                                          Id
                                       
                                       +
                                       
                                          ∂
                                          
                                             ∂
                                             x
                                          
                                       
                                       g
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       0
                                       .
                                    
                                 
                               Finally, using the fact that 
                                 
                                    
                                       ϒ
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 y
                                 )
                                 =
                                 0
                              , we deduce that
                                 
                                    
                                       
                                          ∂
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          
                                             ϒ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       x
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             x
                                             =
                                             y
                                          
                                       
                                       ξ
                                       =
                                       
                                          
                                             ∇
                                          
                                          
                                             ξ
                                          
                                       
                                       
                                          
                                             ϒ
                                          
                                          
                                             y
                                          
                                       
                                       (
                                       y
                                       )
                                       ,
                                    
                                 
                               which gives (10). Therefore, using (7), together with the fact that 
                                 g
                                 (
                                 y
                                 ,
                                 y
                                 )
                                 =
                                 0
                               for all 
                                 y
                                 ∈
                                 M
                              , we can find for all 
                                 p
                                 ∈
                                 M
                                 ,
                                 
                                 ε
                                 >
                                 0
                               radii 
                                 Δ
                                 (
                                 p
                                 )
                                 ⩾
                                 δ
                                 (
                                 p
                                 )
                                 >
                                 0
                               such that for all points 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 ⊂
                                 
                                    
                                       B
                                    
                                    
                                       δ
                                       (
                                       p
                                       )
                                    
                                 
                                 (
                                 p
                                 )
                               and 
                                 x
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       Δ
                                       (
                                       p
                                       )
                                    
                                 
                                 (
                                 p
                                 )
                               we have
                                 
                                    (11)
                                    
                                       
                                          ‖
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             d
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          g
                                          (
                                          x
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ‖
                                       
                                       ⩽
                                       ε
                                    
                                 
                               and
                                 
                                    (12)
                                    
                                       
                                          ‖
                                          
                                             Id
                                          
                                          +
                                          ∇
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             d
                                          
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                ϒ
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          x
                                          )
                                          ‖
                                       
                                       ⩽
                                       ε
                                       .
                                    
                                 
                               Eqs. (11) and (12), together with Theorem 2.3 applied to the vector field
                                 
                                    
                                       ϒ
                                       :
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ϒ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                               suffice to establish the claim. □

The well-definedness result in Proposition 2.2 leads us to the following definition of a geometric average. 
                           Definition 2.4
                           Let M be a manifold with retraction pair 
                                 (
                                 f
                                 ,
                                 g
                                 )
                              . For points 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       d
                                    
                                 
                               and weights 
                                 
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                               satisfying 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                               we define the average
                                 
                                    
                                       
                                          
                                             av
                                          
                                          
                                             g
                                          
                                       
                                       
                                          (
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 
                               as the unique point 
                                 
                                    
                                       x
                                    
                                    
                                       ⁎
                                    
                                 
                               which satisfies the balance equation
                                 
                                    (13)
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          d
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       g
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             ⁎
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       =
                                       0
                                       ∈
                                       
                                          
                                             T
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ⁎
                                                
                                             
                                          
                                       
                                       M
                                       .
                                    
                                 
                              
                           

For the case of 
                           (
                           f
                           ,
                           g
                           )
                           =
                           (
                           exp
                           ,
                           log
                           )
                         the associated geometric average is known as the Karcher-mean and has been studied in Karcher (1977).

We have used the results of Groisser (2004) in our proof of well-definedness of the averaging operation. In this work one can also find algorithms for the computation of 
                           
                              
                                 av
                              
                              
                                 g
                              
                           
                           (
                           (
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           )
                           ,
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                           )
                        . For completeness we mention a simple iterative fixed-point method in Algorithm 1
                        , which converges to the desired average. A better choice would be a Newton-type method, see again Groisser (2004) and also Absil et al. (2008) for more information.

In our experiments we have found that the iteration in Algorithm 1 typically requires 3–5 iterations until it reaches machine precision.

We now specify our previous findings to the geometry of the Stiefel manifold. But first we start with a short motivation why we are interested in this particular geometry. After that we will exhibit several useful choices for retractions.

The fact that geometry plays a role in low rank approximation has already been noted in Absil et al. (2008), Edelman et al. (1999) (and possibly much earlier elsewhere) where it is observed that the space
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          n
                                          ,
                                          p
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       A
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             n
                                             ×
                                             n
                                          
                                       
                                       :
                                       rank
                                       
                                       (
                                       A
                                       )
                                       =
                                       p
                                       }
                                    
                                 
                              
                            of 
                              n
                              ×
                              n
                            matrices of rank p admits a manifold structure. In this paper we will actually not use this structure but factorizations of the form (1) with matrices U, V which lie on the Stiefel manifold
                           
                              
                                 
                                    
                                       St
                                    
                                    (
                                    n
                                    ,
                                    p
                                    )
                                    :
                                    =
                                    
                                       {
                                       X
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             n
                                             ×
                                             p
                                          
                                       
                                       :
                                       
                                          
                                             X
                                          
                                          
                                             ⊤
                                          
                                       
                                       X
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             p
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        

The main result which enables us to do this is the existence of a smooth singular value decomposition: 
                              Theorem 2.5
                              
                                 (See 
                                 
                                    Chern and Dieci, 2001, Theorem 2.4
                                 
                                 .) Assume that 
                                 
                                    γ
                                    :
                                    t
                                    ↦
                                    A
                                    (
                                    t
                                    )
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          n
                                          ,
                                          p
                                       
                                    
                                  
                                 is a 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                  
                                 curve. Then there exist 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                  
                                 matrix curves
                                 
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                U
                                             
                                          
                                          :
                                          t
                                          ↦
                                          U
                                          (
                                          t
                                          )
                                          ∈
                                          
                                             St
                                          
                                          (
                                          n
                                          ,
                                          p
                                          )
                                          ,
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                V
                                             
                                          
                                          :
                                          t
                                          ↦
                                          V
                                          (
                                          t
                                          )
                                          ∈
                                          
                                             St
                                          
                                          (
                                          n
                                          ,
                                          p
                                          )
                                          ,
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                S
                                             
                                          
                                          :
                                          t
                                          ↦
                                          S
                                          (
                                          t
                                          )
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                p
                                                ×
                                                p
                                             
                                          
                                          ,
                                       
                                    
                                  
                                 such that
                                 
                                    
                                       
                                          A
                                          (
                                          t
                                          )
                                          =
                                          U
                                          (
                                          t
                                          )
                                          S
                                          (
                                          t
                                          )
                                          V
                                          
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                ⊤
                                             
                                          
                                          .
                                       
                                    
                                 
                              

We now assume that we are given a piecewise smooth curve 
                              γ
                              :
                              I
                              →
                              
                                 
                                    M
                                 
                                 
                                    n
                                    ,
                                    p
                                 
                              
                           , where 
                              I
                              ⊂
                              R
                            is an interval. This curve induces three piecewise smooth families
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          U
                                       
                                    
                                    :
                                    t
                                    ↦
                                    U
                                    (
                                    t
                                    )
                                    ∈
                                    
                                       St
                                    
                                    (
                                    n
                                    ,
                                    p
                                    )
                                    ,
                                    
                                    
                                       
                                          γ
                                       
                                       
                                          V
                                       
                                    
                                    :
                                    t
                                    ↦
                                    V
                                    (
                                    t
                                    )
                                    ∈
                                    
                                       St
                                    
                                    (
                                    n
                                    ,
                                    p
                                    )
                                 
                              
                            and
                              
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          S
                                       
                                    
                                    :
                                    t
                                    ↦
                                    S
                                    (
                                    t
                                    )
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          p
                                          ×
                                          p
                                       
                                    
                                    .
                                 
                              
                            The curve 
                              
                                 
                                    γ
                                 
                                 
                                    S
                                 
                              
                            is simply a vector valued curve which can be further processed with standard data processing methods such as wavelets. For the curves 
                              
                                 
                                    γ
                                 
                                 
                                    U
                                 
                              
                           , 
                              
                                 
                                    γ
                                 
                                 
                                    V
                                 
                              
                            this is not the case since they take values in a nonlinear space. When we wish to compress these curves it is important to respect the underlying nonlinear constraints so that the columns of the resulting matrices are maximally uncorrelated, ensuring minimal redundancy.

It is easy to see that the set 
                              
                                 St
                              
                              (
                              n
                              ,
                              p
                              )
                            carries the structure of a smooth manifold by viewing it as the zero set of the submersion
                              
                                 
                                    F
                                    :
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      n
                                                      ×
                                                      p
                                                   
                                                
                                                →
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      symm
                                                   
                                                   
                                                      p
                                                      ×
                                                      p
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                X
                                                ↦
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                X
                                                −
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      p
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            From this we also see that
                              
                                 
                                    
                                       dim
                                    
                                    
                                       (
                                       
                                          St
                                       
                                       (
                                       n
                                       ,
                                       p
                                       )
                                       )
                                    
                                    =
                                    n
                                    p
                                    −
                                    
                                       1
                                       2
                                    
                                    p
                                    (
                                    p
                                    +
                                    1
                                    )
                                    .
                                 
                              
                            Furthermore, it is straightforward to obtain the following simple expression for the tangent space attached to a point 
                              X
                              ∈
                              
                                 St
                              
                              (
                              n
                              ,
                              p
                              )
                           :
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          X
                                       
                                    
                                    
                                       St
                                    
                                    (
                                    n
                                    ,
                                    p
                                    )
                                    =
                                    
                                       {
                                       ξ
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             n
                                             ×
                                             p
                                          
                                       
                                       :
                                       
                                          
                                             ξ
                                          
                                          
                                             ⊤
                                          
                                       
                                       X
                                       +
                                       
                                          
                                             X
                                          
                                          
                                             ⊤
                                          
                                       
                                       ξ
                                       =
                                       
                                          
                                             0
                                          
                                          
                                             p
                                          
                                       
                                       }
                                    
                                    .
                                 
                              
                            Attaching the linear tangent space in X to the point X yields the affine tangent space
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          X
                                       
                                       
                                          aff
                                       
                                    
                                    
                                       St
                                    
                                    (
                                    n
                                    ,
                                    p
                                    )
                                    :
                                    =
                                    X
                                    +
                                    
                                       
                                          T
                                       
                                       
                                          X
                                       
                                    
                                    
                                       St
                                    
                                    (
                                    n
                                    ,
                                    p
                                    )
                                    .
                                 
                              
                            The metric properties of the Stiefel manifold are slightly more complicated. In particular there exist two nonequivalent canonical choices for a metric on 
                              
                                 St
                              
                              (
                              n
                              ,
                              p
                              )
                           . The first one views the manifold as a factor of the orthogonal group 
                              O
                              (
                              n
                              )
                           :
                              
                                 
                                    
                                       St
                                    
                                    (
                                    n
                                    ,
                                    p
                                    )
                                    =
                                    O
                                    (
                                    n
                                    )
                                    /
                                    O
                                    (
                                    n
                                    −
                                    p
                                    )
                                    ,
                                 
                              
                            by identifying the Stiefel manifold 
                              
                                 St
                              
                              (
                              n
                              ,
                              p
                              )
                            with the equivalence classes
                              
                                 
                                    [
                                    Q
                                    ]
                                    :
                                    =
                                    
                                       {
                                       Q
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         n
                                                         −
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       :
                                       
                                          
                                             Q
                                          
                                          
                                             n
                                             −
                                             p
                                          
                                       
                                       ∈
                                       O
                                       (
                                       n
                                       −
                                       p
                                       )
                                       }
                                    
                                    ,
                                 
                              
                            
                           
                              Q
                              ∈
                              O
                              (
                              n
                              )
                           . The tangent space of 
                              
                                 St
                              
                              (
                              n
                              ,
                              p
                              )
                            at 
                              [
                              Q
                              ]
                            is identified with the horizontal space at Q consisting of vectors
                              
                                 (14)
                                 
                                    Q
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                −
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      n
                                                      −
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              μ
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    p
                                    ×
                                    p
                                 
                              
                            is skew symmetric, see Edelman et al. (1999). The Riemannian metric is defined by restriction of the metric on 
                              O
                              (
                              n
                              )
                           . The so-defined metric is sometimes called the canonical metric. Another approach defines the Riemannian metric by viewing 
                              
                                 St
                              
                              (
                              n
                              ,
                              p
                              )
                            as a Riemannian submanifold of 
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ×
                                    p
                                 
                              
                            with the metric coming from the inner product
                              
                                 
                                    〈
                                    ξ
                                    ,
                                    η
                                    〉
                                    :
                                    =
                                    
                                       tr
                                    
                                    
                                    
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             ⊤
                                          
                                       
                                       η
                                       )
                                    
                                    .
                                 
                              
                            We will mainly focus on the latter approach which we call the embedded metric.

We now turn to the problem of defining retractions on the Stiefel manifold. A natural choice would be to take the exponential function. Of course, the functions exp and log depend on the Riemannian metric imposed on 
                              
                                 St
                              
                              (
                              n
                              ,
                              p
                              )
                           .

For the canonical metric the exponential and logarithm functions can be easily defined using the matrix exponential
                                 
                                    
                                       exp
                                       (
                                       ξ
                                       )
                                       :
                                       =
                                       
                                          ∑
                                          
                                             j
                                             ⩾
                                             0
                                          
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                j
                                             
                                          
                                          
                                             j
                                             !
                                          
                                       
                                       ,
                                       
                                       ξ
                                       ∈
                                       
                                          sl
                                       
                                       (
                                       n
                                       )
                                    
                                 
                               and its local inverse log. Then, for a vector 
                                 ξ
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       X
                                    
                                 
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                              , 
                                 X
                                 =
                                 [
                                 Q
                                 ]
                                 ∈
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                              , where ξ has a representation of the form (14) we can put
                                 
                                    
                                       
                                          
                                             exp
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       ξ
                                       )
                                       :
                                       =
                                       
                                          [
                                          Q
                                          exp
                                          
                                             (
                                             
                                                (
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               ⊤
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               n
                                                               −
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          ]
                                       
                                       .
                                    
                                 
                               Algorithmically, these formulas require us to deal with 
                                 n
                                 ×
                                 n
                               matrix operations which is clearly impractical if p is much smaller than n. There exist other expressions for the exponential function associated with the canonical metric which only require the handling of 
                                 n
                                 ×
                                 p
                               matrices, see Edelman et al. (1999), but no simple expression for the logarithm function is known to us.

For the embedded metric, a formula for the computation of the exponential function is given by
                                 
                                    
                                       
                                          
                                             exp
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       ξ
                                       )
                                       =
                                       (
                                       X
                                       ,
                                       ξ
                                       )
                                       exp
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   ξ
                                                
                                                
                                                   −
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   ξ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   ξ
                                                
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       exp
                                       
                                          (
                                          −
                                          
                                             
                                                X
                                             
                                             
                                                ⊤
                                             
                                          
                                          ξ
                                          )
                                       
                                       ,
                                    
                                 
                               see e.g. Edelman et al. (1999), Absil et al. (2008). Again, we are not aware of a computationally simple expression for the logarithm mapping.

Our requirement is that f and g should both be computable efficiently. Probably the most efficient choice for f is given by
                                 
                                    
                                       f
                                       (
                                       X
                                       ,
                                       ξ
                                       )
                                       :
                                       =
                                       π
                                       (
                                       X
                                       +
                                       ξ
                                       )
                                       ,
                                    
                                 
                               where 
                                 ξ
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       X
                                    
                                 
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                               and
                                 
                                    
                                       π
                                       :
                                       
                                          
                                             R
                                          
                                          
                                             n
                                             ×
                                             p
                                          
                                       
                                       →
                                       
                                          St
                                       
                                       (
                                       n
                                       ,
                                       p
                                       )
                                    
                                 
                               denotes the closest-point projection onto 
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                               with respect to the metric induced by 
                                 〈
                                 ⋅
                                 ,
                                 ⋅
                                 〉
                              . This can be computed via a polar decomposition of a matrix 
                                 X
                                 =
                                 R
                                 H
                               with 
                                 R
                                 ∈
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                               and 
                                 H
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       p
                                       ×
                                       p
                                    
                                 
                               is symmetric. This decomposition is unique whenever X is nonsingular and can be computed efficiently (Kovarik, 1970; Higham, 1989). Algorithm 2
                               gives a quadratically convergent iterative scheme. See also Absil et al. (2012) for further information about this projection. In particular, by the results of Absil et al. (2012) (or by a short and easy computation), for this choice of f, Eq. (6) holds true.

We also need to find a simple expression for the inverse g of f. It turns out that such an expression exists. 
                                 Proposition 2.6
                                 
                                    Assume that 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ⊤
                                          
                                       
                                       Y
                                     
                                    has only eigenvalues with positive real part (in other words, 
                                    
                                       −
                                       
                                          
                                             X
                                          
                                          
                                             ⊤
                                          
                                       
                                       Y
                                     
                                    is a Hurwitz matrix). Then we have
                                    
                                       
                                          
                                             g
                                             (
                                             X
                                             ,
                                             Y
                                             )
                                             =
                                             2
                                             Y
                                             
                                                ∫
                                                0
                                                ∞
                                             
                                             exp
                                             
                                                (
                                                −
                                                t
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                Y
                                                )
                                             
                                             exp
                                             
                                                (
                                                −
                                                t
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                X
                                                )
                                             
                                             
                                             d
                                             t
                                             −
                                             X
                                             ,
                                          
                                       
                                     
                                    or
                                    
                                       
                                          
                                             π
                                             
                                                (
                                                2
                                                Y
                                                
                                                   ∫
                                                   0
                                                   ∞
                                                
                                                exp
                                                
                                                   (
                                                   −
                                                   t
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   Y
                                                   )
                                                
                                                exp
                                                
                                                   (
                                                   −
                                                   t
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   X
                                                   )
                                                
                                                
                                                d
                                                t
                                                )
                                             
                                             =
                                             Y
                                             .
                                          
                                       
                                    
                                 

Before we get to the proof we collect some further auxiliary results regarding the embedded geometry of the Stiefel manifold. For a general matrix 
                                 Z
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ×
                                       p
                                    
                                 
                               and 
                                 X
                                 ∈
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                              , the orthogonal projection 
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             X
                                          
                                          
                                             aff
                                          
                                       
                                       
                                          St
                                       
                                       (
                                       n
                                       ,
                                       p
                                       )
                                    
                                 
                               onto the affine tangent space in X is given by
                                 
                                    (15)
                                    
                                       
                                          
                                             π
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   X
                                                
                                                
                                                   aff
                                                
                                             
                                             
                                                St
                                             
                                             (
                                             n
                                             ,
                                             p
                                             )
                                          
                                       
                                       (
                                       Z
                                       )
                                       =
                                       X
                                       +
                                       Z
                                       −
                                       X
                                       
                                          sym
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ⊤
                                             
                                          
                                          Z
                                          )
                                       
                                       ,
                                    
                                 
                               where
                                 
                                    
                                       
                                          sym
                                       
                                       (
                                       A
                                       )
                                       :
                                       =
                                       
                                          1
                                          2
                                       
                                       
                                          (
                                          A
                                          +
                                          
                                             
                                                A
                                             
                                             
                                                ⊤
                                             
                                          
                                          )
                                       
                                    
                                 
                               denotes the symmetric part of a matrix. We also need a description of the normal space 
                                 
                                    
                                       N
                                    
                                    
                                       X
                                    
                                 
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                               of 
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                               at a point 
                                 X
                                 ∈
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                              . We have
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             X
                                          
                                       
                                       
                                          St
                                       
                                       (
                                       n
                                       ,
                                       p
                                       )
                                       =
                                       
                                          {
                                          X
                                          S
                                          :
                                          S
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                p
                                                ×
                                                p
                                             
                                          
                                          ,
                                          
                                          S
                                           symmetric
                                          }
                                       
                                    
                                 
                               and the orthogonal projection onto the normal space is given by
                                 
                                    (16)
                                    
                                       
                                          
                                             π
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   X
                                                
                                             
                                             
                                                St
                                             
                                             (
                                             n
                                             ,
                                             p
                                             )
                                          
                                       
                                       (
                                       Z
                                       )
                                       =
                                       X
                                       
                                          sym
                                       
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ⊤
                                             
                                          
                                          Z
                                          )
                                       
                                       .
                                    
                                 
                               With these preparations we can now proceed with the proof of the representation of g. 
                                 Proof of Proposition 2.6
                                 Clearly 
                                       g
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                     is uniquely defined as the matrix ξ which lies both in the affine tangent space at X and the normal space of Y. Therefore, we must have that
                                       
                                          
                                             ξ
                                             =
                                             Y
                                             S
                                             ,
                                             
                                             S
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   p
                                                   ×
                                                   p
                                                
                                             
                                             ,
                                             
                                             S
                                              symmetric
                                             ,
                                          
                                       
                                     such that
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ⊤
                                                
                                             
                                             (
                                             ξ
                                             −
                                             X
                                             )
                                             +
                                             
                                                
                                                   (
                                                   ξ
                                                   −
                                                   X
                                                   )
                                                
                                                
                                                   ⊤
                                                
                                             
                                             X
                                             =
                                             
                                                
                                                   0
                                                
                                                
                                                   p
                                                
                                             
                                             .
                                          
                                       
                                     Therefore we have
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ⊤
                                                
                                             
                                             (
                                             Y
                                             S
                                             −
                                             X
                                             )
                                             +
                                             
                                                
                                                   (
                                                   Y
                                                   S
                                                   −
                                                   X
                                                   )
                                                
                                                
                                                   ⊤
                                                
                                             
                                             X
                                             =
                                             
                                                
                                                   0
                                                
                                                
                                                   p
                                                
                                             
                                             .
                                          
                                       
                                     Now we use that 
                                       
                                          
                                             X
                                          
                                          
                                             ⊤
                                          
                                       
                                       X
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             p
                                          
                                       
                                     and obtain
                                       
                                          (17)
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ⊤
                                                
                                             
                                             Y
                                             S
                                             +
                                             S
                                             
                                                
                                                   Y
                                                
                                                
                                                   ⊤
                                                
                                             
                                             X
                                             −
                                             2
                                             
                                                
                                                   I
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             
                                                
                                                   0
                                                
                                                
                                                   p
                                                
                                             
                                             .
                                          
                                       
                                     Equations of the form (17) are well-known and frequently studied in the area of control theory, and it turns out that an explicit solution formula for S symmetric is given by the expression of our proposition, see Sontag (1998). □

In practice we will not use Proposition 2.6 directly, but compute 
                                 g
                                 (
                                 X
                                 ,
                                 Y
                                 )
                               via the iterative procedure outlined in Algorithm 3
                              :

Using (16) and (15), this iteration can be computed very efficiently. 
                                 Lemma 2.7
                                 
                                    The iteration in 
                                    
                                       Algorithm 3 
                                    converges linearly towards 
                                    
                                       g
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                    
                                    .
                                 


                              
                                 Proof
                                 The iterative procedure in Algorithm 3 is an instance of a very common way to iteratively compute the intersection of two convex sets (in our case affine subspaces) by alternating projections. A proof of convergence of these algorithms can be found in Bregman (1967), Malick (2004). □

Again, in our experiments we have found that the iteration in Algorithm 3 typically requires 3–5 iterations until it reaches machine precision.

For the construction of the pair 
                                 (
                                 f
                                 ,
                                 g
                                 )
                               we started with the choice of f and found its inverse g. Another approach to construct a retraction is to define the function g first and then find out whether the corresponding f is efficiently computable. A natural choice is to put
                                 
                                    (18)
                                    
                                       
                                          g
                                          ˜
                                       
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                       :
                                       =
                                       
                                          
                                             π
                                          
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   X
                                                
                                                
                                                   aff
                                                
                                             
                                             
                                                St
                                             
                                             (
                                             n
                                             ,
                                             p
                                             )
                                          
                                       
                                       (
                                       Y
                                       )
                                       −
                                       X
                                       =
                                       Y
                                       −
                                       X
                                       
                                          sym
                                       
                                       
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                ⊤
                                             
                                          
                                          Y
                                          )
                                       
                                       ,
                                    
                                 
                               the orthogonal projection onto the tangent space in X. In contrast to the previous example, it is now not so clear how to compute the corresponding retraction 
                                 
                                    f
                                    ˜
                                 
                              . The next result, which can be found in Hairer et al. (2006), Chapter IV.9, shows how to easily compute it. For the convenience of the reader we also provide a short proof. The retraction f is called orthographic retraction in Absil et al. (2012) and studied therein. 
                                 Proposition 2.8
                                 
                                    The function 
                                    
                                       
                                          f
                                          ˜
                                       
                                    
                                    , satisfying
                                    
                                       
                                          (19)
                                          
                                             
                                                f
                                                ˜
                                             
                                             
                                                (
                                                X
                                                ,
                                                
                                                   g
                                                   ˜
                                                
                                                (
                                                X
                                                ,
                                                Y
                                                )
                                                )
                                             
                                             =
                                             Y
                                             
                                             
                                                for all 
                                             
                                             Y
                                             ∈
                                             
                                                St
                                             
                                             (
                                             n
                                             ,
                                             p
                                             )
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          g
                                          ˜
                                       
                                     
                                    as in 
                                    (18) 
                                    can be taken to be 
                                    
                                       
                                          f
                                          ˜
                                       
                                       (
                                       X
                                       ,
                                       ξ
                                       )
                                       :
                                       =
                                       
                                          
                                             
                                                π
                                                ˜
                                             
                                          
                                          
                                             X
                                          
                                       
                                       (
                                       X
                                       +
                                       ξ
                                       )
                                    
                                    , where
                                    
                                       
                                          (20)
                                          
                                             
                                                
                                                   
                                                      π
                                                      ˜
                                                   
                                                
                                                
                                                   X
                                                
                                             
                                             (
                                             Y
                                             )
                                             :
                                             =
                                             Y
                                             +
                                             X
                                             S
                                             ,
                                          
                                       
                                     
                                    where 
                                    
                                       S
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             p
                                             ×
                                             p
                                          
                                       
                                     
                                    is symmetric and satisfies the algebraic Riccati equation
                                       
                                          (21)
                                          
                                             
                                                
                                                   Y
                                                
                                                
                                                   ⊤
                                                
                                             
                                             Y
                                             +
                                             S
                                             
                                                
                                                   Y
                                                
                                                
                                                   ⊤
                                                
                                             
                                             X
                                             +
                                             
                                                
                                                   Y
                                                
                                                
                                                   ⊤
                                                
                                             
                                             X
                                             S
                                             +
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   I
                                                
                                                
                                                   p
                                                
                                             
                                             =
                                             
                                                
                                                   0
                                                
                                                
                                                   p
                                                
                                             
                                             .
                                          
                                       
                                    
                                 


                              
                                 Proof
                                 First note that, if we want (19) to hold, then certainly
                                       
                                          
                                             
                                                f
                                                ˜
                                             
                                             (
                                             X
                                             ,
                                             ξ
                                             )
                                             =
                                             X
                                             +
                                             ξ
                                             +
                                             X
                                             S
                                          
                                       
                                     for some symmetric matrix 
                                       S
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             p
                                             ×
                                             p
                                          
                                       
                                    . Therefore, since also
                                       
                                          
                                             
                                                f
                                                ˜
                                             
                                             
                                                
                                                   (
                                                   X
                                                   ,
                                                   ξ
                                                   )
                                                
                                                
                                                   ⊤
                                                
                                             
                                             
                                                f
                                                ˜
                                             
                                             (
                                             X
                                             ,
                                             ξ
                                             )
                                             =
                                             
                                                
                                                   I
                                                
                                                
                                                   p
                                                
                                             
                                             ,
                                          
                                       
                                     we get Eq. (21). □

We would like to remark that Eq. (21) can be solved efficiently, see for instance Pappas et al. (1980).

We briefly summarize what we have achieved so far. For the Stiefel manifold we have constructed efficiently computable pairs 
                                 (
                                 f
                                 ,
                                 g
                                 )
                               of functions satisfying (4), (5) and (6). These will be crucial in our later construction of a multiscale decomposition of Stiefel-valued curves.

Using the above defined retraction pairs we can now define a geometric averaging operation on 
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                               which satisfies certain natural invariance properties.

There exists a natural transitive action τ of the group 
                                 O
                                 (
                                 n
                                 )
                               on 
                                 
                                    St
                                 
                                 (
                                 n
                                 ,
                                 p
                                 )
                               via
                                 
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             Q
                                          
                                       
                                       (
                                       X
                                       )
                                       :
                                       =
                                       Q
                                       X
                                       ,
                                       
                                       Q
                                       ∈
                                       O
                                       (
                                       n
                                       )
                                       .
                                    
                                 
                               
                              
                                 Lemma 2.9
                                 
                                    For all functions g considered above, the average is invariant under the action τ: we have
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      av
                                                   
                                                
                                                
                                                   g
                                                
                                             
                                             
                                                (
                                                (
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                ,
                                                
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         Q
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   )
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   τ
                                                
                                                
                                                   Q
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         av
                                                      
                                                   
                                                   
                                                      g
                                                   
                                                
                                                
                                                   (
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   ,
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 


                              
                                 Proof
                                 This follows from the fact that the functions g are always invariant under the action of τ. □


                              Lemma 2.9 shows that the geometric averaging operation defined in this section is invariant under an orthogonal change of coordinates, as it should be. Fig. 1
                               shows the different choices of retractions for the circle which is equal to 
                                 
                                    St
                                 
                                 (
                                 2
                                 ,
                                 1
                                 )
                              .


                              
                                 Remark 2.10
                                 In order to compute a weighted average of points 
                                       
                                          
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                     a minimal requirement is that there exists a point 
                                       
                                          
                                             X
                                          
                                          
                                             ⁎
                                          
                                       
                                     such that all operations 
                                       g
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             ⁎
                                          
                                       
                                       ,
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       d
                                     are well-defined. In this respect, the inverse of the closest-point projection appears to be the worst choice, see Fig. 1. If this requirement is not fulfilled, some ad-hoc strategies seem necessary. In our experiments we simply compute the linear average of the points 
                                       
                                          
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                     and project the result back onto the manifold.

In this section we describe the wavelet-type decomposition of manifold valued data, using a retraction pair of functions 
                        (
                        f
                        ,
                        g
                        )
                      as in the previous section. All results of the present section apply to general manifolds M, therefore, for now, we shall consider a manifold M, together with a pair of functions 
                        (
                        f
                        ,
                        g
                        )
                      such that (4), (6) and (5) hold. Furthermore, we assume that an averaging operation defined by (13) is well-defined.

For instance in the general case of a Riemannian manifold M and 
                        (
                        f
                        ,
                        g
                        )
                        =
                        (
                        exp
                        ,
                        log
                        )
                     , where exp and log denote the exponential resp. the logarithm function on M, it can be shown that all these assumptions are valid. Another example is, of course, M the Stiefel manifold and the functions 
                        (
                        f
                        ,
                        g
                        )
                      defined in the previous section.

Up to minor variations, the material in Section 3.1 and Section 3.2 is taken from Rahman et al. (2006). The main difference is that we allow for more general retractions than the exponential function and that we utilize a different, in our view more natural notion of geometric average.

One of the main theoretical results of this paper is contained in Section 3.3 where it is shown that manifold valued wavelets are capable of approximating piecewise smooth functions with the same efficiency as globally smooth functions.

The general idea for the construction of manifold valued wavelet transforms is to start with a linear construction and replace all averaging operations by geometric averages and all difference operations by the point–point difference function g. For more information on wavelets in general we recommend Daubechies (1992), Chui (1992).


                     Convention: 
                     Since our wavelet constructions will be based on geometric averages which in general are only locally defined we understand all the theoretical results in this section under the tacit assumption that all underlying operations are well-defined.
                  

Here, we describe the construction of interpolating wavelets in manifolds using geometric averaging operations, see Rahman et al. (2006), Grohs and Wallner (2009), Donoho (2001) for more information. The corresponding linear construction is due to Donoho (1992). We first describe this linear construction. The basic idea is that a smooth function 
                              u
                              :
                              R
                              →
                              R
                            can be well approximated by a polynomial. Define the sampling operator
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          (
                                          u
                                          (
                                          h
                                          i
                                          )
                                          )
                                       
                                       
                                          i
                                          ∈
                                          Z
                                       
                                    
                                 
                              
                            and pick an odd integer D. We try to exploit possible redundancies between the samples 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                            by computing a simple estimate
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             u
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    ∼
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            based only on the knowledge of 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                              
                           . We have already noted that, whenever u is smooth, it can be well approximated by a polynomial p of degree D. Therefore, it seems natural to define 
                              
                                 
                                    
                                       u
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                            in such a way that 
                              
                                 
                                    
                                       p
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                            for all polynomials of degree D. One can achieve this as follows: Denote 
                              
                                 
                                    π
                                 
                                 
                                    k
                                    ,
                                    j
                                 
                              
                            the degree D polynomial which interpolates the data
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      j
                                                   
                                                
                                                (
                                                k
                                                −
                                                ⌊
                                                D
                                                /
                                                2
                                                ⌋
                                                )
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      j
                                                   
                                                
                                                k
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      j
                                                   
                                                
                                                (
                                                k
                                                +
                                                ⌊
                                                D
                                                /
                                                2
                                                ⌋
                                                )
                                             
                                          
                                          
                                             
                                                u
                                                (
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      j
                                                   
                                                
                                                (
                                                k
                                                −
                                                ⌊
                                                D
                                                /
                                                2
                                                ⌋
                                                )
                                                )
                                             
                                             
                                                …
                                             
                                             
                                                u
                                                (
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      j
                                                   
                                                
                                                k
                                                )
                                             
                                             
                                                …
                                             
                                             
                                                u
                                                (
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      j
                                                   
                                                
                                                (
                                                k
                                                +
                                                ⌊
                                                D
                                                /
                                                2
                                                ⌋
                                                )
                                                )
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Then we can put
                              
                                 
                                    
                                       
                                          
                                             u
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    :
                                    =
                                    
                                       
                                          π
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             j
                                          
                                       
                                       k
                                       )
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    k
                                    )
                                    
                                    and
                                    
                                    
                                       
                                          
                                             u
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    :
                                    =
                                    
                                       
                                          π
                                       
                                       
                                          k
                                          ,
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             j
                                          
                                       
                                       (
                                       k
                                       +
                                       1
                                       /
                                       2
                                       )
                                       )
                                    
                                    ,
                                    
                                    k
                                    ∈
                                    Z
                                    .
                                 
                              
                            In general, the relation (22) will not be an equality, therefore we need to store the error
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          k
                                          )
                                          )
                                       
                                       
                                          k
                                          ∈
                                          Z
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          (
                                          u
                                          
                                             (
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   j
                                                
                                             
                                             (
                                             k
                                             +
                                             1
                                             /
                                             2
                                             )
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   u
                                                   ˆ
                                                
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                          )
                                       
                                       
                                          k
                                          ∈
                                          Z
                                       
                                    
                                    .
                                 
                              
                            We have now transformed the sequence 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                            into two sequences 
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                              )
                           , each of which is half the size of the original sequence. Fig. 2
                            shows an illustration of this scheme. The point of this procedure is that, provided u is smooth, the coefficients of 
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                            measure the local polynomial approximation error at scale 
                              
                                 
                                    2
                                 
                                 
                                    −
                                    j
                                 
                              
                            which decays very fast. Therefore, most of the coefficients of 
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                            can be set to zero in this case. It is also clear how to invert the transformation by adding the coefficients of 
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                            to the polynomial imputation of the coarser sampling 
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                              
                           . We can iterate this construction and arrive at a decomposition
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                J
                                             
                                          
                                       
                                    
                                    ⇝
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          J
                                       
                                    
                                    )
                                    ,
                                 
                              
                            with a minimal scale 
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                           . Here is a fundamental result regarding the decay properties of the coefficients 
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                           : 
                              Theorem 3.1
                              
                                 Assume that 
                                 
                                    u
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                  
                                 with 
                                 
                                    s
                                    <
                                    D
                                 
                                 . Then we have
                                 
                                    
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ‖
                                             
                                             
                                                ∞
                                             
                                          
                                          ≲
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                s
                                                j
                                             
                                          
                                          
                                          
                                             for 
                                          
                                          j
                                          ∈
                                          N
                                          .
                                       
                                    
                                 
                              

Several signals which appear in practice are not globally smooth but only piecewise smooth. Due to the local nature of the wavelet construction, also piecewise smooth functions can be approximated efficiently. 
                              Theorem 3.2
                              
                                 Assume that u is supported on 
                                 
                                    [
                                    −
                                    1
                                    ,
                                    1
                                    ]
                                  
                                 and that 
                                 
                                    u
                                    
                                       
                                          |
                                       
                                       
                                          [
                                          −
                                          1
                                          ,
                                          0
                                          )
                                       
                                    
                                    ,
                                    
                                    u
                                    
                                       
                                          |
                                       
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                  
                                 with a possible discontinuity of u in 0 and 
                                 
                                    s
                                    <
                                    D
                                 
                                 . Then, by keeping only N wavelet coefficients, one can get an approximation 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          N
                                       
                                    
                                  
                                 of u such that
                                 
                                    
                                       
                                          
                                             
                                                ‖
                                                u
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      N
                                                   
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                          ≲
                                          
                                             
                                                N
                                             
                                             
                                                −
                                                s
                                             
                                          
                                          .
                                       
                                    
                                 
                              


                           
                              Proof
                              We only sketch the proof. Assume w.l.o.g. that 
                                    N
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          j
                                       
                                    
                                 . Then we can set all wavelet coefficients of scale >j to zero except for those which contribute to the singularity. For any fixed scale J, there is a finite number of such coefficients. We also keep these coefficients up to scale 
                                    2
                                    s
                                    j
                                 . Thus, all in all we keep order N coefficients, and all the others are set to zero. By Theorem 3.1, this approximation gives an error of order 
                                    
                                       
                                          N
                                       
                                       
                                          −
                                          s
                                       
                                    
                                  in the 
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                  norm (and thus also in the 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 -norm) away from an interval I of size 
                                    ∼
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          2
                                          s
                                          j
                                       
                                    
                                  around the singularity. It remains to estimate the error on the interval I. Here, the 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                 -error is also of order 
                                    
                                       
                                          N
                                       
                                       
                                          −
                                          s
                                       
                                    
                                 , due to the small size of the interval. □


                           Theorem 3.2 is of tremendous importance. It states that a piecewise smooth signal can be encoded up to an error 
                              
                                 
                                    N
                                 
                                 
                                    −
                                    s
                                 
                              
                            by using about N coefficients. This is as good as if the singularity were not present at all! Also, it can be shown that this result is optimal in the sense that essentially no better compression strategies for piecewise smooth functions exist (Donoho, 1993).

Our first goal is to extend the constructions and results of Section 3.1.1 to the manifold-valued setting. To some extent this has been done in Donoho (2001), Rahman et al. (2006), Grohs and Wallner (2009). Our construction is somewhat different from the one in Rahman et al. (2006) in that we use another notion of geometric mean, namely the one developed in Section 2.1. This is a minor difference for the nonlinear construction of interpolating wavelets, but it will make a difference for the construction of nonlinear average interpolating wavelet transforms which we study below in Section 3.2.

The starting point is the fact that the mapping
                              
                                 
                                    S
                                    :
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    ↦
                                    
                                       
                                          
                                             u
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                            has a very simple structure:
                              
                                 (23)
                                 
                                    S
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    
                                    S
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          −
                                          ⌊
                                          D
                                          /
                                          2
                                          ⌋
                                       
                                       
                                          ⌊
                                          D
                                          /
                                          2
                                          ⌋
                                       
                                    
                                    
                                       
                                          l
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    i
                                    )
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    k
                                    −
                                    i
                                    )
                                    ,
                                 
                              
                            with some sequence l satisfying
                              
                                 (24)
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          −
                                          ⌊
                                          D
                                          /
                                          2
                                          ⌋
                                       
                                       
                                          ⌊
                                          D
                                          /
                                          2
                                          ⌋
                                       
                                    
                                    
                                       
                                          l
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    i
                                    )
                                    =
                                    1
                                    .
                                 
                              
                            In the literature, the operator S is usually called the Deslauriers–Dubuc subdivision scheme (Deslauriers and Dubuc, 1989). It is now immediate to generalize the prediction operator to the nonlinear setting. Assume we have a pair 
                              (
                              f
                              ,
                              g
                              )
                            satisfying (4), (5) and (6). Then by Proposition 2.2, the operator S can also be defined in the M-valued setting: For a function 
                              u
                              :
                              R
                              →
                              M
                            we again use the notation 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                                 
                                    M
                                 
                              
                            to denote uniform sampling of meshwidth 
                              h
                              >
                              0
                           . Then we can define
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             u
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    :
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    
                                    
                                       
                                          
                                             u
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    :
                                    =
                                    
                                       
                                          av
                                       
                                       
                                          g
                                       
                                    
                                    
                                       (
                                       
                                          
                                             (
                                             
                                                
                                                   l
                                                
                                                
                                                   D
                                                
                                             
                                             (
                                             i
                                             )
                                             )
                                          
                                          
                                             i
                                             =
                                             −
                                             ⌊
                                             D
                                             /
                                             2
                                             ⌋
                                          
                                          
                                             ⌊
                                             D
                                             /
                                             2
                                             ⌋
                                          
                                       
                                       ,
                                       
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         −
                                                         j
                                                      
                                                   
                                                
                                                
                                                   M
                                                
                                             
                                             (
                                             k
                                             −
                                             i
                                             )
                                             )
                                          
                                          
                                             i
                                             =
                                             −
                                             ⌊
                                             D
                                             /
                                             2
                                             ⌋
                                          
                                          
                                             ⌊
                                             D
                                             /
                                             2
                                             ⌋
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Similar to the linear case, the wavelet coefficients 
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                                 
                                    M
                                 
                              
                            are defined as the prediction error arising from this procedure. However, in contrast to the linear case we cannot simply subtract two points. Nevertheless the function g gives us a notion of difference vector between points. Using this notion we can define the wavelet coefficients as follows:
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    k
                                    )
                                    :
                                    =
                                    g
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ˆ
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       ,
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       )
                                    
                                    ∈
                                    
                                       
                                          T
                                       
                                       
                                          
                                             
                                                
                                                   u
                                                   ˆ
                                                
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    M
                                    ,
                                    
                                    k
                                    ∈
                                    Z
                                    .
                                 
                              
                            For a function 
                              u
                              :
                              R
                              →
                              M
                            we get a decomposition
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                J
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    ⇝
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             J
                                             −
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            The reconstruction procedure is obvious, for instance to go from 
                              (
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    j
                                    +
                                    1
                                 
                                 
                                    M
                                 
                              
                              )
                            to 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    M
                                 
                              
                            we first compute 
                              
                                 
                                    
                                       u
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    M
                                 
                              
                            from 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                                 
                                    M
                                 
                              
                            using (25). Then we have
                              
                                 (26)
                                 
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ˆ
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       k
                                       )
                                       )
                                    
                                    .
                                 
                              
                            Observe however that the reconstruction procedure constitutes a nonlinear operation in each step which makes it much more difficult to analyze theoretically. 
                              Remark 3.3
                              Analogous pyramid decompositions can be defined by replacing S above by an arbitrary interpolatory subdivision scheme (Cavaretta et al., 1991). The definition of our manifold-valued generalization using the geometric mean defined in Definition 2.4 immediately implies that all symmetries of a linear subdivision scheme carry over to the manifold-valued case. This is not necessarily the case with the construction of Rahman et al. (2006) where the nonlinear average construction relies on the choice of a suitable basepoint.

Nevertheless we mention that one can also replace the exponential and logarithm mappings in the construction of Rahman et al. (2006) by an arbitrary retraction pair and all approximation results which we show in Section 3.3 below remain valid.

If we are dealing with data which is free of noise, the interpolating wavelet transform is an appropriate choice. However, in practice one often has to work with noisy data which, due to the instability of point evaluations, presents difficulties for the interpolating transform (Rahman et al., 2006). A remedy to this problem is to work not with point values but with averages of the function over dyadic boxes. In Donoho (1994) such constructions are given. We briefly describe the construction which is a special case of the biorthogonal wavelet transform framework introduced in Cohen et al. (1992).

The idea is to discretize not by point evaluation but by integration over dyadic boxes. The resulting discretization operator for a function 
                              u
                              :
                              R
                              →
                              R
                            is defined via
                              
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          h
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          
                                          
                                             ∫
                                             
                                                [
                                                h
                                                k
                                                ,
                                                h
                                                (
                                                k
                                                +
                                                1
                                                )
                                                ]
                                             
                                          
                                          u
                                          (
                                          t
                                          )
                                          
                                          d
                                          t
                                          )
                                       
                                       
                                          k
                                          ∈
                                          Z
                                       
                                    
                                    .
                                 
                              
                            Again we need an operator to get from 
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                              
                            to a prediction 
                              
                                 
                                    
                                       
                                          u
                                          ¯
                                       
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                              ∼
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                           . This is done in a similar way as for the interpolating wavelet transform by picking for each k a polynomial 
                              
                                 
                                    
                                       π
                                       ¯
                                    
                                 
                                 
                                    k
                                    ,
                                    j
                                 
                              
                            of degree D, D even, which interpolates the averages of f over dyadic boxes of size 
                              
                                 
                                    2
                                 
                                 
                                    −
                                    j
                                 
                              
                            around k. Then we define
                              
                                 
                                    
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    =
                                    
                                       ∫
                                       
                                          [
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                          k
                                          ,
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                          (
                                          k
                                          +
                                          1
                                          /
                                          2
                                          )
                                          ]
                                       
                                    
                                    
                                       
                                          
                                             π
                                             ¯
                                          
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    d
                                    t
                                    
                                    and
                                    
                                    
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    =
                                    
                                       ∫
                                       
                                          [
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                          (
                                          k
                                          +
                                          1
                                          /
                                          2
                                          )
                                          ,
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                          (
                                          k
                                          +
                                          1
                                          )
                                          ]
                                       
                                    
                                    
                                       
                                          
                                             π
                                             ¯
                                          
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    d
                                    t
                                    .
                                 
                              
                            Observe the redundancies
                              
                                 (27)
                                 
                                    
                                       1
                                       2
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                                ˆ
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       (
                                       2
                                       k
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                                ˆ
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    k
                                    )
                                    
                                    for all 
                                    k
                                    ∈
                                    Z
                                 
                              
                            and
                              
                                 (28)
                                 
                                    
                                       1
                                       2
                                    
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       (
                                       2
                                       k
                                       )
                                       +
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    k
                                    )
                                    
                                    for all 
                                    k
                                    ∈
                                    Z
                                    .
                                 
                              
                            Again we can define wavelet coefficients
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          k
                                          )
                                          )
                                       
                                       
                                          k
                                          ∈
                                          Z
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                          −
                                          
                                             
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   ˆ
                                                
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      (
                                                      j
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                          )
                                       
                                       
                                          k
                                          ∈
                                          Z
                                       
                                    
                                    .
                                 
                              
                            Using the redundancies (27), (28) we can reconstruct the values of 
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                            from 
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                              
                            via
                              
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    +
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    =
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    k
                                    )
                                    −
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   (
                                                   j
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       −
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   −
                                                   j
                                                
                                             
                                          
                                       
                                       (
                                       k
                                       )
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              k
                              ∈
                              Z
                           . Note that also for this wavelet transform Theorems 3.1 and 3.2 hold true (Donoho, 1994).

Average interpolating wavelet transforms can also be defined in the manifold-valued context, at least to some extent. Several problems arise, mostly due to the fact that it is not clear how to define an averaging operation of an N-valued function over a dyadic box. Certainly, such operations exist in a geometric setting, see Karcher (1977), but the problem with these constructions is that in general the redundancy relation (28) fails.

At least for practical purposes a partial remedy is to start from a midpoint pyramid
                           
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          J
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          J
                                          −
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                 
                              
                            satisfying the consistency condition
                           
                              
                                 (30)
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          j
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    k
                                    )
                                    =
                                    
                                       
                                          av
                                       
                                       
                                          g
                                       
                                    
                                    
                                       (
                                       
                                          (
                                          
                                             1
                                             2
                                          
                                          ,
                                          
                                             1
                                             2
                                          
                                          )
                                       
                                       ,
                                       
                                          (
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          )
                                          ,
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                            for a minimal scale 
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                            and a maximal scale J and 
                              
                                 
                                    J
                                 
                                 
                                    0
                                 
                              
                              ⩽
                              j
                              <
                              J
                           . In practice, one is given a sequence of data 
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                 
                                 
                                    J
                                 
                                 
                                    M
                                 
                              
                           , say of length 
                              
                                 
                                    2
                                 
                                 
                                    J
                                 
                              
                           . Then one can define a midpoint pyramid (29) by taking (30) as a definition.

Next we note the fact that in the linear case the prediction operator which maps 
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          j
                                       
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       
                                          u
                                          ¯
                                       
                                       ˆ
                                    
                                 
                                 
                                    
                                       
                                          2
                                       
                                       
                                          −
                                          (
                                          j
                                          +
                                          1
                                          )
                                       
                                    
                                 
                              
                            can be written as
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             ˆ
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                (
                                                j
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          −
                                          D
                                          /
                                          2
                                          +
                                          1
                                       
                                       
                                          D
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    i
                                    )
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                j
                                             
                                          
                                       
                                    
                                    (
                                    k
                                    −
                                    i
                                    )
                                 
                              
                            for some sequence 
                              
                                 
                                    r
                                 
                                 
                                    D
                                 
                              
                            satisfying
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          −
                                          D
                                          /
                                          2
                                          +
                                          1
                                       
                                       
                                          D
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          r
                                       
                                       
                                          D
                                       
                                    
                                    (
                                    i
                                    )
                                    =
                                    1
                                    .
                                 
                              
                            Motivated by (31) and (27) we put
                              
                                 (32)
                                 
                                    
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             ˆ
                                          
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    =
                                    
                                       
                                          av
                                       
                                       
                                          g
                                       
                                    
                                    
                                       (
                                       
                                          
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   D
                                                
                                             
                                             (
                                             i
                                             )
                                             )
                                          
                                          
                                             i
                                             =
                                             −
                                             D
                                             /
                                             2
                                             +
                                             1
                                          
                                          
                                             D
                                             /
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                
                                                
                                                   j
                                                
                                                
                                                   M
                                                
                                             
                                             (
                                             k
                                             −
                                             i
                                             )
                                             )
                                          
                                          
                                             i
                                             =
                                             −
                                             D
                                             /
                                             2
                                             +
                                             1
                                          
                                          
                                             D
                                             /
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                            and
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                             ˆ
                                          
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       k
                                       )
                                       ,
                                       −
                                       g
                                       
                                          (
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                j
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          k
                                          )
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   ˆ
                                                
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                            By (33) we get the redundancy relation
                              
                                 (34)
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          j
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    k
                                    )
                                    =
                                    
                                       
                                          av
                                       
                                       
                                          g
                                       
                                    
                                    
                                       (
                                       
                                          (
                                          
                                             1
                                             2
                                          
                                          ,
                                          
                                             1
                                             2
                                          
                                          )
                                       
                                       ,
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   ˆ
                                                
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          )
                                          ,
                                          
                                             
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   ˆ
                                                
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                            One should compare the relations (34) and (30) with the linear relations (27) and (28).

We can now define wavelet coefficients
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    k
                                    )
                                    :
                                    =
                                    g
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                                ˆ
                                             
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       ,
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       )
                                    
                                    ∈
                                    
                                       
                                          T
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   ˆ
                                                
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                    M
                                    ,
                                    
                                    k
                                    ∈
                                    Z
                                    .
                                 
                              
                            The reconstruction procedure proceeds similarly to the linear one. Given 
                              (
                              
                                 
                                    
                                       u
                                       ¯
                                    
                                 
                                 
                                    j
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                                 
                                    M
                                 
                              
                              )
                            we first compute 
                              
                                 
                                    
                                       
                                          u
                                          ¯
                                       
                                       ˆ
                                    
                                 
                                 
                                    j
                                    +
                                    1
                                 
                                 
                                    M
                                 
                              
                            using (32) and (33). Then we get the reconstruction of the odd indices via
                              
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    +
                                    1
                                    )
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       k
                                       )
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       k
                                       )
                                       )
                                    
                                    .
                                 
                              
                            To reconstruct the even indices we make use of (30) to find that, by
                              
                                 
                                    g
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       k
                                       )
                                       ,
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       2
                                       k
                                       )
                                       )
                                    
                                    =
                                    −
                                    g
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       k
                                       )
                                       ,
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       2
                                       k
                                       +
                                       1
                                       )
                                       )
                                    
                                    ,
                                 
                              
                            we get the reconstruction formula
                              
                                 
                                    
                                       
                                          
                                             u
                                             ¯
                                          
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    (
                                    2
                                    k
                                    )
                                    =
                                    f
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             j
                                          
                                          
                                             M
                                          
                                       
                                       (
                                       k
                                       )
                                       ,
                                       −
                                       g
                                       
                                          (
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                j
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          k
                                          )
                                          ,
                                          
                                             
                                                
                                                   u
                                                   ¯
                                                
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          2
                                          k
                                          +
                                          1
                                          )
                                          )
                                       
                                       )
                                    
                                    .
                                 
                              
                            We have constructed a way to transform a midpoint pyramid into a wavelet decomposition
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                u
                                                ¯
                                             
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             M
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             J
                                             −
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       )
                                    
                                 
                              
                            and vice versa.


                           
                              Remark 3.4
                              Our construction easily extends to the regular multivariate case by defining the notion of midpoint pyramid as a uniformly weighted average of (in the case of bivariate data) four points. For each point at a coarse scale, in the bivariate case one then has to store three wavelet coefficients – the fourth one can be computed from the first-order condition (13) which defines the geometric average. Therefore, in view of ensuring a representation of minimal redundancy, the use of an averaging procedure of the form introduced in this paper is crucial.

Note that in Rahman et al. (2006) a different generalization to the multivariate case is given which e.g. in the bivariate setting first applies a wavelet transform in the vertical direction and then in the horizontal direction. Doing this one runs into trouble when computing the wavelet coefficients corresponding to the diagonal direction which requires the computation of a univariate wavelet transform of tangent vectors. We think that our approach of computing two dimensional transforms using geometric averages is more natural.

We now turn to the theoretical properties of the manifold-valued wavelet constructions. The average interpolating construction described in Section 3.2.2 starts from a midpoint pyramid, which in practice can be constructed from a discrete sequence of data via (30). However, it is not clear how to associate to a given function 
                           u
                           :
                           R
                           →
                           M
                         an infinite midpoint pyramid satisfying the downsampling relation (30), or a similar one. This fact makes an asymptotic analysis of the decay of the wavelet coefficients impossible. For this reason we focus on the interpolating wavelet transform for manifold-valued data described in Section 3.1.2.

In the remainder of this section we once and for all fix an odd integer 
                           D
                           >
                           0
                         and associate to an arbitrary function 
                           u
                           :
                           R
                           →
                           M
                         its nonlinear interpolating wavelet transform
                           
                              
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    …
                                    )
                                 
                                 ,
                              
                           
                         as in Section 3.1.2.

Before we formulate our main results we need to introduce some notation.

For a sequence α of vectors 
                           
                              
                                 (
                                 α
                                 (
                                 k
                                 )
                                 )
                              
                              
                                 k
                                 ∈
                                 Z
                              
                           
                        , 
                           α
                           (
                           k
                           )
                           ∈
                           T
                           M
                         we use the symbol
                           
                              
                                 
                                    
                                       ‖
                                       α
                                       ‖
                                    
                                    
                                       ∞
                                    
                                 
                                 =
                                 
                                    sup
                                    
                                       k
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       ‖
                                       α
                                       (
                                       k
                                       )
                                       ‖
                                    
                                    
                                       M
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ‖
                                 ⋅
                                 ‖
                              
                              
                                 M
                              
                           
                         indicates the Riemannian metric on M. Further, we want to be able to compare two sequences 
                           u
                           =
                           
                              
                                 (
                                 u
                                 (
                                 k
                                 )
                                 )
                              
                              
                                 k
                                 ∈
                                 Z
                              
                           
                        , 
                           v
                           =
                           
                              
                                 (
                                 v
                                 (
                                 k
                                 )
                                 )
                              
                              
                                 k
                                 ∈
                                 Z
                              
                           
                        , 
                           u
                           (
                           k
                           )
                           ,
                           v
                           (
                           k
                           )
                           ∈
                           M
                        . Here we use the notation
                           
                              
                                 
                                    
                                       dist
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    
                                       ∞
                                    
                                 
                                 :
                                 =
                                 
                                    sup
                                    
                                       k
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       dist
                                    
                                    
                                       M
                                    
                                 
                                 
                                    (
                                    u
                                    (
                                    k
                                    )
                                    ,
                                    v
                                    (
                                    k
                                    )
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 dist
                              
                              
                                 M
                              
                           
                         denotes the geodesic distance in M. Finally, with α as above and β of the same form, we also want to compare these two sequences. Denoting for two vectors 
                           γ
                           ∈
                           
                              
                                 T
                              
                              
                                 x
                              
                           
                           M
                        , 
                           δ
                           ∈
                           
                              
                                 T
                              
                              
                                 y
                              
                           
                           M
                        
                        
                           
                              
                                 
                                    
                                       dist
                                    
                                    
                                       T
                                       M
                                    
                                 
                                 (
                                 γ
                                 ,
                                 δ
                                 )
                                 :
                                 =
                                 
                                    
                                       dist
                                    
                                    
                                       M
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 +
                                 
                                    
                                       ‖
                                       γ
                                       −
                                       
                                          
                                             Pt
                                          
                                          
                                             y
                                          
                                          
                                             x
                                          
                                       
                                       (
                                       δ
                                       )
                                       ‖
                                    
                                    
                                       M
                                    
                                 
                                 ,
                              
                           
                         
                        
                           
                              
                                 Pt
                              
                              
                                 y
                              
                              
                                 x
                              
                           
                         denoting parallel transport from y to x (DoCarmo, 1992) we write
                           
                              
                                 
                                    
                                       dist
                                    
                                    
                                       T
                                       M
                                    
                                 
                                 
                                    
                                       (
                                       α
                                       ,
                                       β
                                       )
                                    
                                    
                                       ∞
                                    
                                 
                                 :
                                 =
                                 
                                    sup
                                    
                                       k
                                       ∈
                                       Z
                                    
                                 
                                 
                                    
                                       dist
                                    
                                    
                                       T
                                       M
                                    
                                 
                                 
                                    (
                                    α
                                    (
                                    k
                                    )
                                    ,
                                    β
                                    (
                                    k
                                    )
                                    )
                                 
                                 .
                              
                           
                        
                     

Then the following analog of Theorem 3.1 holds: 
                           Theorem 3.5
                           
                              Assume that 
                              
                                 u
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       s
                                    
                                 
                               
                              for 
                              
                                 s
                                 <
                                 D
                              
                              . Then we get the following decay rate for the wavelet coefficients:
                                 
                                    (35)
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   α
                                                
                                                
                                                   j
                                                
                                                
                                                   M
                                                
                                             
                                             ‖
                                          
                                          
                                             ∞
                                          
                                       
                                       ≲
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             s
                                             j
                                          
                                       
                                    
                                 
                               
                              with the implied constant uniform on compact sets. Conversely, if 
                              (35) 
                              holds for the wavelet decomposition of u, then for all 
                              
                                 ε
                                 >
                                 0
                               
                              we have 
                              
                                 u
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       s
                                       −
                                       ε
                                    
                                 
                              
                              .
                           

This has been proven in Grohs and Wallner (2009). □


                        Theorem 3.5 tells us something about the decay of the wavelet coefficients associated with a smooth function. The potential use of this result is clear: by setting all small coefficients to zero, one should expect to still obtain a very good approximation of the original function. This intuition turns out to be correct, but it is far from trivial in the nonlinear case. The key issue lies in the stability properties of the reconstruction procedure. More specifically, one needs to address the question of how a change of the wavelet coefficients affects the reconstruction. To this end we consider the reconstruction operator
                           
                              
                                 
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 :
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                −
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 ↦
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             j
                                          
                                       
                                    
                                    
                                       M
                                    
                                 
                                 ,
                              
                           
                         using (26).

The following result holds. 
                           Theorem 3.6
                           
                              Assume that 
                              
                                 (
                                 f
                                 ,
                                 g
                                 )
                               
                              satisfy 
                              (6)
                              , 
                              (5) 
                              and 
                              (4)
                              . Assume we are given two wavelet decompositions
                              
                                 
                                    
                                       U
                                       :
                                       =
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                j
                                                −
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       V
                                       :
                                       =
                                       
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                −
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               
                              Then there exists a constant C independent of j such that
                              
                                 
                                    
                                       
                                          
                                             dist
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   R
                                                
                                                
                                                   j
                                                
                                             
                                             (
                                             U
                                             )
                                             ,
                                             
                                                
                                                   R
                                                
                                                
                                                   j
                                                
                                             
                                             (
                                             V
                                             )
                                             )
                                          
                                          
                                             ∞
                                          
                                       
                                       ⩽
                                       C
                                       
                                          (
                                          
                                             
                                                dist
                                             
                                             
                                                M
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            −
                                                            
                                                               
                                                                  J
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            −
                                                            
                                                               
                                                                  J
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                ∞
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                =
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                dist
                                             
                                             
                                                T
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                                
                                                   M
                                                
                                             
                                             ,
                                             
                                                
                                                   β
                                                
                                                
                                                   i
                                                
                                                
                                                   M
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           This has been shown in Grohs (2010b). □

Using the above stability result, we can now prove a nonlinear analog of Theorem 3.2. In order to avoid technical complications we assume that 
                           u
                           :
                           [
                           −
                           1
                           ,
                           1
                           )
                           →
                           M
                         is periodic.


                        
                           Theorem 3.7
                           
                              Assume that 
                              
                                 u
                                 :
                                 [
                                 −
                                 1
                                 ,
                                 1
                                 )
                                 →
                                 M
                               
                              is a periodic 
                              
                                 
                                    
                                       C
                                    
                                    
                                       s
                                    
                                 
                               
                              function 
                              
                                 (
                                 s
                                 <
                                 D
                                 )
                               
                              apart from a discontinuity at 0. Then, using N wavelet coefficients, one can obtain an approximation 
                              
                                 
                                    
                                       u
                                    
                                    
                                       N
                                    
                                 
                               
                              such that
                              
                                 
                                    
                                       
                                          ∫
                                          
                                             [
                                             −
                                             1
                                             ,
                                             1
                                             ]
                                          
                                       
                                       
                                          
                                             dist
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             (
                                             u
                                             (
                                             t
                                             )
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   N
                                                
                                             
                                             (
                                             t
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       t
                                       ≲
                                       
                                          
                                             N
                                          
                                          
                                             −
                                             2
                                             s
                                          
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Using Theorem 3.6, the proof proceeds with similar arguments as the proof of the linear version, Theorem 3.2. Without loss of generality, we put 
                                 N
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       j
                                    
                                 
                              . Let
                                 
                                    
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          …
                                          )
                                       
                                    
                                 
                               be the wavelet decomposition of f. Assume we have the full data 
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             2
                                             s
                                             j
                                          
                                       
                                    
                                 
                               at hand. We first examine what happens if we build an approximation 
                                 
                                    u
                                    ˜
                                 
                               of u from 
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             2
                                             s
                                             j
                                          
                                       
                                    
                                 
                               by setting all wavelet coefficients of higher scale to zero. By Theorem 3.6, Theorem 3.5 and the locality of the wavelet reconstruction, we observe that, away from an interval I of size 
                                 ∼
                                 
                                    
                                       2
                                    
                                    
                                       −
                                       2
                                       s
                                       j
                                    
                                 
                               around 0, we get an approximation error
                                 
                                    
                                       
                                          sup
                                          
                                             t
                                             ∈
                                             [
                                             −
                                             1
                                             ,
                                             1
                                             )
                                             ∖
                                             I
                                          
                                       
                                       
                                          dist
                                       
                                       
                                          (
                                          u
                                          (
                                          t
                                          )
                                          ,
                                          
                                             u
                                             ˜
                                          
                                          (
                                          t
                                          )
                                          )
                                       
                                       ≲
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             2
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                             
                                             j
                                          
                                       
                                       .
                                    
                                 
                               See also Xie and Yu (2011), Grohs (2010a) for more details. Therefore we get that
                                 
                                    (36)
                                    
                                       
                                          ∫
                                          
                                             [
                                             −
                                             1
                                             ,
                                             1
                                             )
                                             ∖
                                             I
                                          
                                       
                                       
                                          
                                             dist
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             (
                                             u
                                             (
                                             t
                                             )
                                             ,
                                             
                                                u
                                                ˜
                                             
                                             (
                                             t
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       t
                                       ≲
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             4
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                             
                                             j
                                          
                                       
                                       .
                                    
                                 
                               On the other hand, the error
                                 
                                    
                                       
                                          
                                             dist
                                          
                                          
                                             M
                                          
                                       
                                       
                                          (
                                          u
                                          (
                                          t
                                          )
                                          ,
                                          
                                             u
                                             ˜
                                          
                                          (
                                          t
                                          )
                                          )
                                       
                                    
                                 
                               is bounded on I. Therefore we have
                                 
                                    (37)
                                    
                                       
                                          ∫
                                          I
                                       
                                       
                                          
                                             dist
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             (
                                             u
                                             (
                                             t
                                             )
                                             ,
                                             
                                                u
                                                ˜
                                             
                                             (
                                             t
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       t
                                       ≲
                                       
                                          ∫
                                          I
                                       
                                       1
                                       
                                       d
                                       t
                                       ≲
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             2
                                             s
                                             j
                                          
                                       
                                       .
                                    
                                 
                               Putting together (36) and (37) we arrive at the estimate
                                 
                                    (38)
                                    
                                       
                                          ∫
                                          
                                             [
                                             −
                                             1
                                             ,
                                             1
                                             )
                                          
                                       
                                       
                                          
                                             dist
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             (
                                             u
                                             (
                                             t
                                             )
                                             ,
                                             
                                                u
                                                ˜
                                             
                                             (
                                             t
                                             )
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                       d
                                       t
                                       ≲
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             2
                                             s
                                             j
                                          
                                       
                                       .
                                    
                                 
                               Eq. (38) gives the right magnitude of approximation error but clearly way too many coefficients are needed for 
                                 
                                    u
                                    ˜
                                 
                              , which requires order 
                                 
                                    
                                       2
                                    
                                    
                                       2
                                       s
                                       j
                                    
                                 
                               nonzero wavelet coefficients. We now perform a further compression step, reducing the number of nonzero wavelet coefficients to order 
                                 
                                    
                                       2
                                    
                                    
                                       j
                                    
                                 
                              . To do this, we observe that by Theorem 3.6 it would be sufficient to threshold the wavelet coefficients
                                 
                                    
                                       U
                                       :
                                       =
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                2
                                                s
                                                j
                                                −
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                    
                                 
                               to
                                 
                                    
                                       V
                                       :
                                       =
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                M
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                β
                                             
                                             
                                                2
                                                s
                                                j
                                                −
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                               such that
                                 
                                    (39)
                                    
                                       
                                          
                                             dist
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                   s
                                                   j
                                                
                                             
                                             (
                                             U
                                             )
                                             ,
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                   s
                                                   j
                                                
                                             
                                             (
                                             V
                                             )
                                             )
                                          
                                          
                                             ∞
                                          
                                       
                                       ≲
                                       
                                          
                                             2
                                          
                                          
                                             −
                                             s
                                             j
                                          
                                       
                                       ,
                                    
                                 
                               and such that the number of nonzero wavelet coefficients in 
                                 V
                               is of order N. To do this we note that at each scale k, only a fixed finite number 
                                 2
                                 L
                                 +
                                 1
                               of wavelet coefficients
                                 
                                    
                                       
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          −
                                          L
                                          )
                                          ,
                                          …
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          L
                                          )
                                          )
                                       
                                    
                                 
                               gets affected by the singularity at 0. All the other wavelet coefficients
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             k
                                          
                                          
                                             M
                                             ,
                                             
                                                smooth
                                             
                                          
                                       
                                       :
                                       =
                                       
                                          (
                                          …
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          −
                                          L
                                          −
                                          2
                                          )
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          −
                                          L
                                          −
                                          1
                                          )
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          L
                                          +
                                          1
                                          )
                                          ,
                                          
                                             
                                                α
                                             
                                             
                                                k
                                             
                                             
                                                M
                                             
                                          
                                          (
                                          L
                                          +
                                          2
                                          )
                                          ,
                                          …
                                          )
                                       
                                    
                                 
                               are only affected by the smooth part of u and therefore (by the locality of the construction and Theorem 3.5) decay of order 
                                 
                                    
                                       2
                                    
                                    
                                       −
                                       s
                                       k
                                    
                                 
                              . We now obtain our compression 
                                 V
                               by setting to zero all coefficients 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                    
                                       M
                                       ,
                                       
                                          smooth
                                       
                                    
                                 
                               for all scales 
                                 j
                                 ,
                                 j
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 2
                                 s
                                 j
                              . Due to the decay properties of 
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                    
                                       M
                                       ,
                                       
                                          smooth
                                       
                                    
                                 
                               and Theorem 3.6, we get (39). It remains to count the number of nonzero coefficients in 
                                 V
                              . There are order 
                                 
                                    
                                       2
                                    
                                    
                                       j
                                    
                                 
                               coefficients up to scale j. For the scales 
                                 j
                                 +
                                 1
                                 ,
                                 j
                                 +
                                 2
                                 ,
                                 …
                                 ,
                                 2
                                 s
                                 j
                               we have 
                                 2
                                 L
                                 +
                                 1
                               coefficients which amounts to a total of order 
                                 
                                    
                                       2
                                    
                                    
                                       j
                                    
                                 
                               coefficients. This proves the theorem. □


                        Theorem 3.7 confirms that the nonlinear wavelet transform indeed satisfies the same important properties as its linear counterpart. 
                           Remark 3.8
                           We already mentioned that an asymptotic analysis of the nonlinear average interpolating wavelet construction is not possible. Nevertheless, one could still analyze the heuristic construction of Section 3.2.2 for finite data. We postpone this for future work. Note also that the possibilities for constructing more general wavelet transforms in manifolds are limited since a perfect reconstruction property can in general not be achieved, cf. Grohs and Wallner (2011). In future work we aim to study whether redundant wavelet transforms such as the undecimated wavelet transform (Starck et al., 2007) are more amenable to a generalization to manifold-valued data.

We return to the specific case of the Stiefel manifold and present some computational experiments, starting first with synthetic data. For our experiments we have chosen the pair 
                        (
                        f
                        ,
                        g
                        )
                      constructed in 2.2.3 based on closest point projection. For the plots of the wavelet coefficients in Figs. 3 and 4
                     
                      we made use of the plotting routines of the Symmlab100 MATLAB package, available from http://www.stanford.edu/~slansel/SymmLab/. We are grateful to the authors of this package for making their software codes publicly available.

Our first experiment deals with a smooth matrix curve (and its svd)
                           
                              (40)
                              
                                 A
                                 (
                                 t
                                 )
                                 =
                                 U
                                 (
                                 t
                                 )
                                 Σ
                                 (
                                 t
                                 )
                                 V
                                 
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 sin
                                 (
                                 t
                                 E
                                 )
                                 +
                                 
                                    noise
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       10
                                       ×
                                       10
                                    
                                 
                                 ,
                              
                           
                         with some random 
                           10
                           ×
                           10
                         matrix E. We have used the first 3 columns of 
                           U
                           (
                           t
                           )
                         as a curve in 
                           
                              St
                           
                           (
                           10
                           ,
                           3
                           )
                         and performed a nonlinear average interpolating wavelet transform of this curve with 
                           D
                           =
                           4
                        . We performed a thresholding operation by setting all wavelet coefficients to zero which exceed the threshold of 0.01. The results can be seen in Fig. 3. We can observe two things: First, the thresholding operation serves as a denoising operation. We remark that this is in general not the case with the interpolating wavelet transform. Second, if the noise level is set to zero, almost all wavelet coefficients are negligible, resulting in huge compression rates.

Our second experiment deals with a matrix curve which possesses a point singularity. We chose the curve
                           
                              (41)
                              
                                 A
                                 (
                                 t
                                 )
                                 =
                                 U
                                 (
                                 t
                                 )
                                 Σ
                                 (
                                 t
                                 )
                                 V
                                 
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 sin
                                 (
                                 t
                                 E
                                 )
                                 +
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 cos
                                 (
                                 t
                                 F
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       10
                                       ×
                                       10
                                    
                                 
                                 ,
                              
                           
                         
                        E, F random 
                           10
                           ×
                           10
                         matrices, and again used the first 3 columns of 
                           U
                           (
                           t
                           )
                         as a curve in 
                           
                              St
                           
                           (
                           10
                           ,
                           3
                           )
                        . This time our analysis was performed using the interpolating wavelet transform with 
                           D
                           =
                           3
                        . The results are shown in Fig. 4. We can nicely observe that all coefficients which do not correspond to the point singularity are almost negligible and only those around the singularity must be kept. The wavelet transform finds pointwise singularities by itself. On the right of Fig. 4, a thresholding operation has been performed which results in overall savings of more than ninety percent.

After some preliminary experiments on synthetic data in Section 4.1 we now apply our methods to a real problem in imaging science namely the compression of hyperspectral images. In our numerical experiments on real data we have always used the average interpolating construction from Section 3.2.2 due to its noise insensitivity. We stress once again that this is just one selected application, there are many other situations where smooth curves of low-rank matrices appear naturally, for instance latent semantic indexing, dynamic graph compression or linear operators depending on a parameter.

In our experiments we mainly focused on data compression. Since wavelet methods are capable of detecting large temporal variations in data, several other tasks such as feature detection, inpainting, classification, … could be tackled. We postpone a more detailed study to future work. Before we describe our application we give a brief introduction to hyperspectral imaging.

A hyperspectral image is an image where intensities corresponding to many different wavelengths are recorded separately (Chang, 2003). The result is a parameterized family 
                           A
                           (
                           λ
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 N
                                 ×
                                 N
                              
                           
                         of matrices, λ being the wavelength. We would like to emphasize that, when the wavelength λ varies continuously we get a smooth curve 
                           A
                           (
                           λ
                           )
                        . In practice, only a finite number of wavelengths is recorded, typically at the order of hundreds or more. A related imaging technique is inferometry, where even more frequency bands are recorded. It is to be expected that in the near future technology will advance to develop sensors capable of recording many more spectral bands, in the order of many thousand or even millions. This technique is called ultraspectral imaging (Meigs et al., 2008). For completeness we also mention the term multispectral imaging which refers to only a few frequency bands.

Due to its capacity to record information across the full range of the spectrum and recent technological advances, the scope of applicability of hyperspectral imaging is tremendous. We restrict ourselves to mentioning only a few important ones: In mineralogy, hyperspectral imaging is used for the detection of oil fields, while the US military uses this technique for the surveillance and detection of humans. A less controversial application is the monitoring of the constitution of plants and crops in agriculture.

Usually, the size of a hyperspectral image can be quite large which calls for efficient means to compress such data. Since a hyperspectral image can be interpreted as dense samples of a smooth matrix curve, it is reasonable to use a compression strategy which takes advantage of this fact.

In Algorithm 4
                         we propose a simple strategy for the compression of a hyperspectral image
                           
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       N
                                       ×
                                       N
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                              
                           
                         corresponding to recordings 
                           A
                           (
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           )
                         at wavelength 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        .


                        
                           Remark 4.1
                           There is nothing exceptional about our choice of blocksize or the rank of the low-rank approximation in each block in Algorithm 4, any other choice would do. There is of course a lot of room for improvement; for instance the rank of the low-rank approximation could be chosen differently for each block by an adaptive procedure. We confine ourselves to our simple algorithm since the primary goal of this work is to demonstrate the usefulness of manifold-valued wavelet transforms, especially for the Stiefel manifold.


                        
                           Remark 4.2
                           Note that the more frequency bands are recorded, the better the performance of the wavelet compression is to be expected. This is because one needs at least 8–16 sampling points at the lowest scale (depending on D) in order to render the wavelet scheme well-defined. This limits the achievable compression rate. In our experiments, almost all wavelet coefficients could be discarded and we conjecture that it would be possible to achieve much higher compression rates for ultraspectral images with more frequency bands using our algorithm.


                        Fig. 5
                         shows an example of Algorithm 4 applied to real hyperspectral image data. The data is taken from http://earthexplorer.usgs.gov/ and represents a sample of the Dehradun region in India, recorded with the Hyperion sensor aboard NASAʼs Earth Observation-1 (EO1) satellite. The sensor records wavelengths in the range of 355–2577 nm at a sampling interval of about 10 nm. The dataset we used is an image cube of size 
                           144
                           ×
                           144
                           ×
                           128
                        .

The resulting compression only requires about 
                           7
                           %
                         of the original data, compared to about 
                           30
                           %
                         by only using the low rank approximation without wavelet thresholding. In view of the present article, one should compare the difference between the low rank approximation and its wavelet compression, which is barely noticeable, see Fig. 5. This represents a compression of the low-rank approximation by a factor about 
                           1
                           :
                           5
                        , essentially without any noticeable degradation. 
                           Remark 4.3
                           So far we have not specified how we actually carry out Step 2 in Algorithm 4. We will comment on this issue later in Section 4.3 below. In addition we would like to point to the recent work (Studer et al., 2012) where sensing devices are constructed which directly sense a sparse representation without going through the usual procedure of first recording the full image and then throwing away almost all of the data. It seems conceivable that in the future sensors capable of directly recording a low rank approximation of an image can be constructed, although this is just speculation.


                        
                           Remark 4.4
                           We reiterate that we do not claim that the compression scheme for hyperspectral images presented in this work is superior to state-of-the-art methods which are currently in use. The point is to demonstrate the usefulness of our flexible compression scheme for curves of low rank matrices. Of particular importance is the fact that our scheme provably achieves (asymptotically) optimal compression rates for piecewise smooth families of low-rank matrices. In fact, we are not aware of any other method in the literature which satisfies a similar property. Another distinctive property of the approach presented in this paper is that features such as point singularities can be detected automatically and non-adaptively simply by looking for the largest coefficients.

In all our analysis the underlying assumption is that the curve of low-rank matrices is smooth, or at least piecewise smooth. This seems like a problem since usually low-rank approximations are computed via svd which is nonunique, therefore one should not expect low-rank approximation curves computed via svd to be smooth.

Fortunately, a remedy exists. In Koch and Lubich (2008) a method is given to obtain smooth dynamical low-rank approximations to matrix curves 
                           A
                           (
                           t
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                                 ×
                                 n
                              
                           
                        , 
                           t
                           >
                           0
                        .

The idea is to not compute a low-rank approximation for each matrix but to solve the ODE
                           
                              (42)
                              
                                 
                                    X
                                    ˙
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    min
                                    
                                       ξ
                                       ∈
                                       T
                                       
                                          
                                             M
                                          
                                          
                                             n
                                             ,
                                             p
                                          
                                       
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          A
                                          ˙
                                       
                                       (
                                       t
                                       )
                                       −
                                       ξ
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 X
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                         is some initial rank p approximation to 
                           A
                           (
                           0
                           )
                        . The computation of the solution of (42) can be done using geometric ODE integrators (Iserles et al., 2000). This is very efficient since typically the matrices 
                           
                              A
                              ˙
                           
                           (
                           t
                           )
                         are much sparser than the matrices 
                           A
                           (
                           t
                           )
                        . Moreover, in Koch and Lubich (2008) it is shown that the approximation quality of 
                           X
                           (
                           t
                           )
                         is equivalent to the best possible approximation by a rank p matrix, at least as long as the first singular values stay well-separated. If singular values interlace, e.g. new singular vectors enter the best approximation, then the algorithm (42) needs to be restarted. By this procedure one obtains a piecewise smooth rank p approximation of 
                           A
                           (
                           t
                           )
                        . In Nonnenmacher and Lubich (2008) several important applications of this algorithm are given, each one of them producing piecewise smooth curves on the Stiefel manifold which can be processed by the Stiefel-valued wavelet transform developed in this paper.

@&#ACKNOWLEDGEMENTS@&#

We thank Achim Nonnenmacher for sharing data related to Nonnenmacher and Lubich (2008) and Othmar Koch for sharing the MATLAB codes related to Koch and Lubich (2008).

@&#REFERENCES@&#

