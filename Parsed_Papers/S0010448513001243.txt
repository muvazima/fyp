@&#MAIN-TITLE@&#Engineering feature design for level set based structural optimization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method to design engineering features in structural optimization is proposed.


                        
                        
                           
                           It combines CSG modeling and level set based shape and topology optimization.


                        
                        
                           
                           Feature design and structural optimization are unified under the level set framework.


                        
                        
                           
                           A truly optimal structure with features can be designed conveniently.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Engineering feature design

Structural optimization

Level set method

Constructive solid geometry

@&#ABSTRACT@&#


               
               
                  Engineering features are regular and simple shape units containing specific engineering significance. It is useful to combine feature design with structural optimization. This paper presents a generic method to design engineering features for level set based structural optimization. A Constructive Solid Geometry based Level Sets (CSGLS) description is proposed to represent a structure based on two types of basic entities: a level set model containing either a feature shape or a freeform boundary. By treating both entities implicitly and homogeneously, the optimal design of engineering features and freeform boundary are unified under the level set framework. For feature models, constrained affine transformations coupled with an accurate particle level set updating scheme are utilized to preserve feature characteristics, where the design velocity approximates continuous shape variation via a least squares fitting. Meanwhile, freeform models undergo a standard shape and topology optimization using a semi-Lagrangian level set scheme. With this method, various feature requirements can be translated into a CSGLS model, and the constrained motion provides flexible mechanisms to design features at different stages of the model tree. As a result, a truly optimal structure with engineering features can be created in a convenient way. Several numerical examples are provided to demonstrate the applicability and potential of this method.
               
            

@&#INTRODUCTION@&#

In structural design, engineering features refer to regular and simple shape units containing specific engineering significance  [1]. They generally serve as a bridge between computer-aided design (CAD) and computer-aided manufacture (CAM), and also have a great impact on assembly  [2]. Recently, as structural optimization techniques have been widely utilized to design innovative and lightweight products, it is practically meaningful to generate an optimal structural layout containing engineering features at an early stage of product lifecycle. However, this has been a challenge for standard structural shape and topology optimization.

Current structural optimization techniques for continuum structure can be categorized into three mainstreams based on different model representations. Firstly, the B-rep model based approaches  [3,4] are the most suitable for feature design, as engineering significance is captured directly through the dimensional parameters or constraints in a CAD modeler. But it rarely supports topology optimization over an explicit model by modifying its parameters. In comparison, the density based approaches, such as the Homogenization Method  [5], the method of Solid Isotropic Material with Penalization  [6,7] and the Evolutionary Structural Optimization  [8], are able to optimize structural topology conveniently. However, it is difficult to employ geometric constraints into optimization, because neither an explicit geometry nor feature concept is readily available from a finite element (FE) mesh model.Implicit model based approaches, such as level set based optimization [9,10], have the advantage of maintaining a clear structural boundary during a shape and topology optimization process. But due to its infinite dimensional nature, to track geometric consistency between consecutive updated models is nontrivial, such that feature constraints can hardly be imposed during optimization.

To enhance the applicability of structural optimization, several techniques have been developed for a simultaneously optimization of engineering features and structural layout. The key to address this problem is that the model representation must support both feature definition and topological change. In  [11,12], a finite circle method was proposed to approximate the exact geometry of predefined feature components with circumcircles. The location and orientation of these circles can be determined together with a density based structural topology optimization. Besides, Kang and Wang  [13] presented a novel topology description model to design movable hole-features by combining material density and level set models. On the other hand, for dynamic feature design problems, that the feature shape is not fixed a priori, the state-of-the-art solutions are mainly geometric primitives based. In  [14], the Bubble method  [15] was utilized to insert basic hole-features, such as circles and triangles, into a structure according to topological derivative analysis. The optimal design eventually comprises several simple feature shapes, which approximate the merged holes. Another parametric solution can be found in  [16,17], in which they represented feature primitives by 
                        R
                     -function and combined them with a 
                        B
                     -spline model.

The integration of feature and freeform boundary design has profound meaning in structural optimization. For example, if a right-angle feature shown in Fig. 1
                     (a) is expected in final design, all the shape of Fig. 1(b)–(d) are potential candidates to be modeled into an initial structure for optimization. Obviously, the one with a freeform boundary, as shown in Fig. 1(d), can lead to a better structural performance than the other two fixed geometry because of the extra design freedom over the non-critical boundary. This example reveals that under certain circumstances, it is unnecessary to use fixed high-level primitives to capture the critical engineering significance. Instead, if one can separate out feature characteristics and freely optimize non-critical regions, a truly optimal design of maximum structural performance can be eventually realized. In the literature, the method proposed in  [16,17] can accomplish this task by carefully conceiving parametric constraints over the primitive’s boundary.

A level set based optimization method has good potentials of designing freeform boundary meanwhile supporting flexible shape and topology optimization. However, there are two fundamental challenges to design features with the level set method. Firstly, as a structural boundary conventionally embeds inside an implicit model, a continuous shape evolution will make the underlying geometric consistency unpredictable. Hence, it is complicated to track any predetermined feature shape during optimization. Secondly, engineering features usually contain sharp characteristics, such as corners in 2D model or corners and edges in 3D model. Due to the inherent dissipation nature of numerical calculation, all of these high curvature regions will be gradually smoothed out during optimization.

In this paper, the above modeling difficulties are resolved by leveraging a CSG representation and an accurate constrained motion scheme. Inspired from the multiphase level set description in  [18], a structural model here is built upon two types of entities: a level set model containing either a feature shape or a freeform boundary. These entities are the operands in a CSG model tree and serve as either feature models containing necessary engineering significance or freeform models (non-feature model) otherwise. An inherited advantage from the CSG modeling is that a structure can be flexibly constructed with different levels of entities according to design requirements. In this way, feature characteristics can be identified either through the shape of a particular feature model or the relation between lower-level feature entities (e.g. the right-angle determined by two line feature models in Fig. 1), rather than by simply resorting to a fixed high-level geometry.

Besides modeling features, it is important to devise a workable mechanism to preserve and optimize them. The idea of imposing motion constraints has been proven a viable way in designing structures for practical requirements. In  [19], the design velocity of level set equation was regularized to ensure the optimal structure can be formed by casting. Moreover, the rigid body motion was justified in  [20], which spurs polygon-shaped components to be positioned and oriented optimally inside design region. In this work, a constrained affine transformation coupled with an accurate particle level set updating scheme  [21] is adopted to design feature characteristics. Specifically, it consists of translation, rotation and scaling, which can simulate most of the effects in deforming a geometric primitive by modifying its parameters  [17]. The transformation velocity is determined from a least square fitting to the continuous shape variation. Meanwhile, non-feature models just undergo a conventional level set updating for freeform shape and topology optimization.

To demonstrate the proposed approach, this paper is organized as follows. Section  2 introduces the CSG based level sets representation. Section  3 presents a sensitivity analysis for linear elastic structural optimization problems. The constrained motion and implementation details are described in Sections  4 and 5 respectively. Section  6 shows several numerical examples. Finally, discussion and conclusion are stated in Section  7.

Constructive Solid Geometry is a ubiquitous solid model representation, which facilitates both set operations and boundary evaluation. In CSG modeling, because a structure can be assembled flexibly with different solid entities, it becomes possible to interpret practical machining or assembly requirements in terms of the geometry of and relation between feature entities (e.g. a low-level linear entity for a flat edge or surface, an angle intersected by two entities, or a high-level predefined mating geometry). The level set method, on the other hand, provides an effective way to freely optimize the boundary of a solid model. Intuitively, by combining the strengths of CSG modeling in feature definition and level set method in shape and topology optimization, a CSG based Level Sets (CSGLS) model description is adopted to address the problem of feature design in structural optimization.

The CSGLS represents a solid structure in terms of 
                        m
                      individual sub-level set models 
                        Φ
                        =
                        
                           [
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 ϕ
                              
                              
                                 m
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 m
                              
                           
                           ]
                        
                     . Each 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                        
                        
                           (
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           m
                           )
                        
                      is a well defined half-space model, denoting a geometric entity in the model tree. Among these models, a “feature model” contains feature geometry according to the engineering requirement, as opposed to a “freeform model” (non-feature model) with freely designable boundary embedded. The design domain 
                        D
                      with a underlying structure 
                        Ω
                      is thus formulated as 
                        
                           
                              Φ
                           
                           
                              D
                           
                        
                        =
                        
                           
                              ⋂
                           
                           
                              i
                              =
                              1
                           
                           
                              m
                           
                        
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                     , and the followings are hold by convention:
                        
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          >
                                          0
                                          
                                          ∀
                                          x
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                          /
                                          ∂
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                            (inside)
                                       
                                    
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          =
                                          0
                                          
                                          ∀
                                          x
                                          ∈
                                          ∂
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                            (on the boundary)
                                       
                                    
                                    
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          <
                                          0
                                          
                                          ∀
                                          x
                                          ∈
                                          D
                                          /
                                          
                                             
                                                Ω
                                             
                                             
                                                i
                                             
                                          
                                            (outside) ,
                                       
                                    
                                 
                              
                           
                           
                              (2)
                              
                                 H
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                          
                                          
                                             if  
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             if  
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             <
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        H
                      is a Heaviside function. A simple combination rule implies that there are at most 
                        n
                        =
                        
                           
                              2
                           
                           
                              m
                           
                        
                      non-overlapping regions 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                        
                        
                           (
                           k
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           )
                        
                      inside the domain 
                        D
                     , such that: 
                        
                           (3)
                           
                              D
                              =
                              
                                 
                                    ⋃
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              
                              and
                              
                              
                                 
                                    ω
                                 
                                 
                                    p
                                 
                              
                              ∩
                              
                                 
                                    ω
                                 
                                 
                                    q
                                 
                              
                              =
                              0̸
                              ,
                              
                              p
                              ≠
                              q
                              .
                           
                        
                      Each region is uniquely tagged with a constant Heaviside vector 
                        H
                        
                           (
                           Φ
                           )
                        
                        =
                        
                           [
                           H
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           ,
                           H
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ,
                           …
                           ,
                           H
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    m
                                 
                              
                              )
                           
                           ]
                        
                     : 
                        
                           (4)
                           
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 {
                                 
                                    x
                                 
                                 ∈
                                 D
                                 :
                                 H
                                 
                                    (
                                    Φ
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 constant vector
                                 }
                              
                              .
                           
                        
                      Note that, since there is only one material region assumed in this paper, any point locating inside it should belong to the interior of all sub-level set models: 
                        
                           (5)
                           
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          material
                                       
                                       
                                          if  
                                          H
                                          
                                             (
                                             Φ
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             [
                                             1
                                             ,
                                             …
                                             ,
                                             1
                                             ]
                                          
                                          
                                          
                                             x
                                          
                                          ∈
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          void
                                       
                                       
                                          otherwise .
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Fig. 2
                      illustrates the CSGLS description, in which a simple model is constructed with two sub-level set models 
                        Φ
                        =
                        
                           [
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                           ]
                        
                      representing a rectangular hole feature as shown in Fig. 2(b) and (c) respectively. There are in total four separating regions in the design domain, where 
                        H
                        
                           (
                           Φ
                           )
                        
                        =
                        
                           [
                           1
                           ,
                           1
                           ]
                        
                      denotes the material region and the others refer to void. In practice, the two feature models 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                      can be further decomposed into lower level entities 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                        =
                        
                           [
                           
                              
                                 ϕ
                              
                              
                                 i
                                 1
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 i
                                 2
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 i
                                 3
                              
                           
                           ,
                           
                              
                                 ϕ
                              
                              
                                 i
                                 4
                              
                           
                           ]
                        
                        ,
                        
                        i
                        =
                        1
                        ,
                        2
                     , where each 
                        
                           
                              ϕ
                           
                           
                              i
                              j
                           
                        
                        ,
                        j
                        =
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        4
                      denotes a half space model defined by one dash line shown in Fig. 2(b) and (c). Such decomposition is important to preserve and retrieve sharp characteristics during optimization. As shown in Fig. 2(d), a 2D sharp corner is rebuilt by firstly cutting the voxel according to one zero level set (red dash line), and then the other (purple dash line). If such a sharp feature is expected in final design, the exact shape and relation of 
                        
                           
                              ϕ
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              ϕ
                           
                           
                              2
                           
                        
                      in Fig. 2(d) must be well maintained throughout optimization. This is the motivation to apply constrained affine transformation with a highly accurate updating scheme. Note that, to reconstruct complex geometry locally (e.g. curves defined by one or multiple level sets inside an element), several refinement schemes are available in  [22].

In level set based structural optimization, a solid structure is represented by a dynamic signed-distance function 
                        Φ
                        
                           (
                           
                              x
                           
                           ,
                           t
                           )
                        
                      and optimized via solving the following Hamilton–Jacobi (H–J) equation:
                        
                           (6)
                           
                              
                                 
                                    ∂
                                    Φ
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              +
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                              
                              ⋅
                              
                                 |
                                 ∇
                                 Φ
                                 |
                              
                              =
                              0
                              ,
                              
                              Φ
                              
                                 (
                                 
                                    x
                                 
                                 ,
                                 0
                                 )
                              
                              =
                              
                                 
                                    Φ
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              Φ
                           
                           
                              0
                           
                        
                        
                           (
                           
                              x
                           
                           )
                        
                      denotes an initial structural configuration and 
                        
                           
                              V
                           
                           
                              n
                           
                        
                      refers to a normal boundary velocity derived from the sensitivity analysis of continuum shape variation  [9,10]. However, for the proposed CSGLS model, because each sub-level set model 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                      requires an independent design velocity 
                        
                           
                              V
                           
                           
                              n
                           
                           
                              i
                           
                        
                      for shape updating, the conventional sensitivity analysis for a single level set model must be modified accordingly.

By leveraging the idea in  [23], a characteristic function 
                        
                           
                              χ
                           
                           
                              k
                           
                        
                        
                           (
                           
                              x
                           
                           )
                        
                      is firstly introduced for each region 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                      as: 
                        
                           (7)
                           
                              
                                 
                                    χ
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                       
                                       
                                          if  
                                          
                                             x
                                          
                                          ∈
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          otherwise .
                                       
                                    
                                 
                              
                           
                        
                      Let the Heaviside function 
                        H
                        
                           (
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           )
                        
                      be expressed as following: 
                        
                           (8)
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              =
                              H
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ,
                              
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                              =
                              1
                              −
                              H
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              .
                           
                        
                      Eq. (7) can be re-written in terms of Heaviside function as: 
                        
                           (9)
                           
                              
                                 
                                    χ
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 Φ
                                 )
                              
                              =
                              
                                 
                                    ∏
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where the superscript 
                        
                           
                              I
                           
                           
                              i
                           
                           
                              k
                           
                        
                      indicates the relationship between each 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                      as follows: 
                        
                           (10)
                           
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                       
                                       
                                          if  
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          ∈
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          otherwise .
                                       
                                    
                                 
                              
                           
                        
                     
                  

In this paper, the optimization problem of a linear elastic structure under a volume constraint is studied. The mathematical formulation with CSGLS representation is expressed as:
                        
                           
                              (11)
                              
                                 
                                    
                                       Minimize
                                    
                                    
                                       Φ
                                    
                                 
                                 
                                 J
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 
                                    
                                       χ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    Φ
                                    )
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                           
                              (12)
                              
                                 Subject to  
                                 G
                                 
                                    (
                                    Φ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       χ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    Φ
                                    )
                                 
                                 d
                                 Ω
                                 ≤
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 ,
                              
                           
                           
                              (13)
                              
                                 a
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    
                                       v
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 =
                                 l
                                 
                                    (
                                    
                                       v
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 
                                 for all  
                                 
                                    v
                                 
                                 ∈
                                 U
                                 ,
                              
                           
                           
                              (14)
                              
                                 a
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    
                                       v
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          E
                                       
                                    
                                    
                                       k
                                    
                                 
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 :
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       v
                                    
                                    )
                                 
                                 
                                    
                                       χ
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    Φ
                                    )
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                           
                              (15)
                              
                                 l
                                 
                                    (
                                    
                                       v
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             k
                                          
                                       
                                       ⋅
                                       
                                          v
                                       
                                       )
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       Φ
                                       )
                                    
                                    d
                                    Ω
                                    +
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                       
                                       
                                          k
                                       
                                    
                                    ⋅
                                    
                                       v
                                    
                                    d
                                    Γ
                                    )
                                 
                                 ,
                              
                           
                        
                      where 
                        F
                        
                           (
                           
                              u
                           
                           )
                        
                      denoting the objective function, 
                        
                           
                              V
                           
                           
                              0
                           
                        
                      the upper allowable volume, 
                        U
                      the space of kinematically admissible displacement fields with predefined displacement at Dirichlet boundary, 
                        
                           u
                        
                      the elastic displacement under external loads, 
                        
                           E
                        
                      the elasticity tensor, 
                        
                           ε
                        
                      the strain tensor, 
                        
                           f
                        
                      the body force, 
                        
                           h
                        
                      the boundary traction force, and 
                        
                           
                              Γ
                           
                           
                              k
                           
                        
                      the boundary of 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                     . Eq. (13) corresponds to the linear elastic equilibrium, where 
                        a
                        
                           (
                           
                              u
                           
                           ,
                           
                              v
                           
                           ,
                           Φ
                           )
                        
                      and 
                        l
                        
                           (
                           
                              v
                           
                           ,
                           Φ
                           )
                        
                      are the energy bilinear and load linear variational form respectively.

By taking the material derivative  [6,24] of Eq. (11), the following expressions can be obtained as in  [23]: 
                        
                           
                              (16)
                              
                                 
                                    
                                       d
                                       J
                                       
                                          (
                                          
                                             u
                                          
                                          ,
                                          Φ
                                          )
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    
                                       w
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 δ
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ∇
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 d
                                 Ω
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    
                                       w
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 d
                                 Γ
                                 ,
                              
                           
                           
                              (17)
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    ,
                                    
                                       w
                                    
                                    ,
                                    Φ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    (
                                    2
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             f
                                          
                                       
                                       
                                          k
                                       
                                    
                                    ⋅
                                    
                                       w
                                    
                                    −
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    :
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          w
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       e
                                       =
                                       1
                                       ,
                                       e
                                       ≠
                                       i
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       H
                                    
                                    
                                       e
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 +
                                 
                                    (
                                    ∇
                                    
                                       (
                                       
                                          
                                             
                                                h
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          w
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             
                                                h
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          w
                                       
                                       )
                                    
                                    κ
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              Γ
                           
                           
                              i
                           
                        
                        =
                        
                           {
                           
                              x
                           
                           :
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                           }
                        
                      denoting the full boundary of level set function 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                        i
                        =
                        
                           (
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           m
                           )
                        
                        ,
                        
                           n
                        
                      the normal, 
                        κ
                      the curvature, and 
                        
                           w
                        
                      an adjoint variable for the following adjoint equation: 
                        
                           (18)
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    D
                                 
                              
                              
                                 
                                    
                                       E
                                    
                                 
                                 
                                    k
                                 
                              
                              
                                 ε
                              
                              
                                 (
                                 
                                    w
                                 
                                 )
                              
                              :
                              
                                 ε
                              
                              
                                 (
                                 
                                    v
                                 
                                 )
                              
                              
                                 
                                    χ
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 Φ
                                 )
                              
                              d
                              Ω
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    D
                                 
                              
                              
                                 
                                    ∂
                                    
                                       
                                          F
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                 
                                 
                                    ∂
                                    
                                       u
                                    
                                 
                              
                              
                                 
                                    χ
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 Φ
                                 )
                              
                              d
                              Ω
                              ,
                              
                              ∀
                              
                                 v
                              
                              ∈
                              U
                                and  
                              
                                 w
                              
                              =
                              0
                                on  
                              
                                 
                                    Γ
                                 
                                 
                                    D
                                 
                              
                              .
                           
                        
                      Considering that the physical properties and corresponding measures are defined only at the material region, Eq. (17) reduces to the following expression by canceling out zero terms that related to the void regions: 
                        
                           (19)
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    u
                                 
                                 ,
                                 
                                    w
                                 
                                 ,
                                 Φ
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          f
                                       
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 ⋅
                                 
                                    w
                                 
                                 −
                                 
                                    
                                       
                                          E
                                       
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 :
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       w
                                    
                                    )
                                 
                                 )
                              
                              
                                 
                                    ∏
                                 
                                 
                                    e
                                    =
                                    1
                                    ,
                                    e
                                    ≠
                                    i
                                 
                                 
                                    m
                                 
                              
                              H
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                              +
                              
                                 (
                                 ∇
                                 
                                    (
                                    
                                       
                                          
                                             h
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ⋅
                                    
                                       w
                                    
                                    )
                                 
                                 ⋅
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    (
                                    
                                       
                                          
                                             h
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ⋅
                                    
                                       w
                                    
                                    )
                                 
                                 κ
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              k
                           
                           
                              s
                           
                        
                      is the index for solid region. Meanwhile, the material derivative of the volume constraint in Eq. (12) can be determined as: 
                        
                           (20)
                           
                              
                                 
                                    d
                                    G
                                    
                                       (
                                       Φ
                                       )
                                    
                                 
                                 
                                    d
                                    t
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          Γ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 [
                                 
                                    
                                       ∏
                                    
                                    
                                       e
                                       =
                                       1
                                       ,
                                       e
                                       ≠
                                       i
                                    
                                    
                                       m
                                    
                                 
                                 H
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          e
                                       
                                    
                                    )
                                 
                                 ]
                              
                              ⋅
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              d
                              Γ
                              .
                           
                        
                      For simplicity, a traction-free boundary and body-force free conditions are assumed in this paper. (Readers may refer to  [23] and references therein for a complete discussion about the problem subject to a boundary dependent loading.) Consequently, by constructing an augmented objective functional as follows: 
                        
                           (21)
                           
                              
                                 
                                    J
                                 
                                 ¯
                              
                              =
                              J
                              +
                              λ
                              
                                 (
                                 G
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        λ
                      is a Lagrange multiplier, the steepest descent direction of this composite objective can be readily found by setting the normal velocity 
                        
                           
                              V
                           
                           
                              n
                           
                           
                              i
                           
                        
                      for each level set model 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                      as: 
                        
                           (22)
                           
                              
                                 
                                    V
                                 
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              =
                              −
                              
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       
                                          E
                                       
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       u
                                    
                                    )
                                 
                                 :
                                 
                                    ε
                                 
                                 
                                    (
                                    
                                       w
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    ¯
                                 
                                 )
                              
                              
                                 
                                    ∏
                                 
                                 
                                    e
                                    =
                                    1
                                    ,
                                    e
                                    ≠
                                    i
                                 
                                 
                                    m
                                 
                              
                              H
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       e
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 
                                    λ
                                 
                                 ¯
                              
                           
                           
                              i
                              +
                              1
                           
                        
                        =
                        max
                        
                           {
                           0
                           ,
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                           +
                           μ
                           
                              (
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              d
                              Ω
                              −
                              
                                 
                                    V
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           }
                        
                      and 
                        μ
                        >
                        0
                      is a penalty parameter.

Eq. (22) implies that non-zero design velocity exists only at a boundary portion 
                        
                           
                              Γ
                           
                           
                              i
                           
                           
                              ′
                           
                        
                      of 
                        
                           
                              ϕ
                           
                           
                              i
                           
                        
                     , where 
                        
                           
                              Γ
                           
                           
                              i
                           
                           
                              ′
                           
                        
                        =
                        
                           {
                           
                              x
                           
                           ∈
                           D
                           :
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                           
                           and  
                           Φ
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                           }
                        
                     . The other part 
                        
                           
                              Γ
                           
                           
                              i
                           
                           
                              ∗
                           
                        
                        =
                        
                           {
                           
                              x
                           
                           ∈
                           D
                           :
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                           
                           and  
                           Φ
                           
                              (
                              
                                 x
                              
                              )
                           
                           ≠
                           0
                           }
                        
                      submerged in solid region has zero velocity, which indicates no contribution in improving the overall structural performance. This result coincides with the single level set model problem in  [24], as the final design velocity are the same over the structural boundary 
                        Γ
                        =
                        
                           {
                           
                              x
                           
                           ∈
                           D
                           :
                           Φ
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           0
                           }
                        
                     . However, it reveals an interesting fact that the evolution process of a single level set model can be decomposed into a parallel behavior of lower-level entities with a coherent but zero-extended velocity. Therefore, it is practically viable to separate out feature level sets from a CSGLS model and control their evolution individually.

In feature based design, manufacture or assembly requirements are interpreted through carefully conceived feature geometry. To maintain such geometric information throughout optimization, a constrained motion strategy is pertinent for the proposed CSGLS scheme to preserve the shape and relation of well initiated feature models. Three basic affine transformations, namely translation, rotation, and scaling, are adopted here to reproduce the same net effect to that by changing a primitive’s parameters as in  [14,17]. They can be applied to entities at different levels of a CSG tree for various purposes, such as to change the shape of a composite model in a rigid body manner, to maintain the relation between entities, or to preserve the shape of a low-level primitive. The corresponding applications are demonstrated in Section  6.

For simplicity and conciseness, only a 2D algorithm is introduced below. Extension to 3D problems is straightforward. Given a feature level set model 
                        
                           
                              ϕ
                           
                           
                              i
                           
                           
                              f
                           
                        
                      with boundary 
                        
                           
                              Γ
                           
                           
                              i
                           
                        
                     , the constrained velocity is defined as the composition of two linear translation velocities 
                        
                           
                              V
                           
                           
                              x
                           
                        
                      and 
                        
                           
                              V
                           
                           
                              y
                           
                        
                      for 
                        X
                      and 
                        Y
                      axis respectively, a counter-clock angular velocity 
                        
                           
                              θ
                           
                           
                              ̇
                           
                        
                      about the centroid 
                        
                           
                              
                                 c
                              
                           
                           
                              i
                           
                        
                      of 
                        
                           
                              Γ
                           
                           
                              i
                           
                        
                     , and a homogeneous scaling coefficient 
                        
                           
                              α
                           
                           
                              ̇
                           
                        
                      about 
                        
                           
                              
                                 c
                              
                           
                           
                              i
                           
                        
                      for both axes. For any point 
                        
                           p
                        
                        ∈
                        
                           
                              Γ
                           
                           
                              i
                           
                        
                     , its normal velocity 
                        
                           
                              V
                           
                           
                              
                                 np
                              
                           
                        
                      can be thus expressed in homogeneous coordinate as:
                        
                           (23)
                           
                              
                                 
                                    V
                                 
                                 
                                    
                                       np
                                    
                                 
                              
                              =
                              
                                 n
                              
                              ⋅
                              
                                 W
                              
                              ⋅
                              
                                 
                                    
                                       (
                                       
                                          p
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           (
                           
                              p
                           
                           −
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                              
                           
                           )
                        
                        =
                        
                           [
                           
                              
                                 
                                    p
                                 
                              
                              
                                 x
                              
                           
                           −
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                                 x
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 y
                              
                           
                           −
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                                 y
                              
                           
                           ,
                           1
                           ]
                        
                        ,
                        
                           n
                        
                        =
                        
                           [
                           
                              
                                 n
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 n
                              
                              
                                 y
                              
                           
                           ,
                           0
                           ]
                        
                      the normal vector at point 
                        
                           p
                        
                     , and 
                        
                           W
                        
                      the velocity matrix: 
                        
                           (24)
                           
                              
                                 W
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          −
                                          
                                             
                                                θ
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ̇
                                             
                                          
                                       
                                       
                                          
                                             
                                                V
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                 
                                 ]
                              
                              .
                           
                        
                     
                  

The unknown 
                        
                           
                              V
                           
                           
                              x
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              y
                           
                        
                        ,
                        
                           
                              θ
                           
                           
                              ̇
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              ̇
                           
                        
                      are determined through the following least square fitting problem, which approximates the unconstrained normal velocity 
                        
                           
                              V
                           
                           
                              
                                 n
                              
                              inf
                           
                           
                              i
                           
                        
                      in Eq. (22):


                     
                        
                           
                              
                                 Find  
                                 
                                    
                                       V
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       y
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ̇
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       ̇
                                    
                                 
                                 ,
                              
                           
                           
                              (25)
                              
                                 Min  
                                 Z
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   np
                                                
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   n
                                                
                                                inf
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 Γ
                                 .
                              
                           
                        
                      This quadratic problem can be readily solved as: 
                        
                           
                              (26)
                              
                                 
                                    X
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         ̇
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          A
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    B
                                 
                                 ,
                              
                           
                           
                              (27)
                              
                                 where  
                                 
                                    A
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             O
                                          
                                          
                                             P
                                          
                                          
                                             Q
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             M
                                          
                                          
                                             S
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             S
                                          
                                          
                                             N
                                          
                                          
                                             U
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             T
                                          
                                          
                                             U
                                          
                                          
                                             L
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    B
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   
                                                      n
                                                   
                                                   inf
                                                
                                                
                                                   i
                                                
                                             
                                             ⋅
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             d
                                             Γ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   
                                                      n
                                                   
                                                   inf
                                                
                                                
                                                   i
                                                
                                             
                                             ⋅
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             d
                                             Γ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   
                                                      n
                                                   
                                                   inf
                                                
                                                
                                                   i
                                                
                                             
                                             ⋅
                                             
                                                [
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         i
                                                         x
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         i
                                                         y
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             d
                                             Γ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∫
                                                
                                                
                                                   
                                                      
                                                         Γ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   
                                                      n
                                                   
                                                   inf
                                                
                                                
                                                   i
                                                
                                             
                                             ⋅
                                             
                                                [
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         i
                                                         x
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      y
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         i
                                                         y
                                                      
                                                   
                                                   )
                                                
                                                ]
                                             
                                             d
                                             Γ
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                           
                              
                                 O
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 d
                                 Γ
                                 
                                 Q
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              
                                 P
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 d
                                 Γ
                                 
                                 S
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              (28)
                              
                                 
                                    
                                       
                                          R
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                x
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      i
                                                      x
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      i
                                                      y
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                          d
                                          Γ
                                       
                                    
                                    
                                       
                                          T
                                          =
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Γ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                y
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   n
                                                
                                                
                                                   x
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      x
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      i
                                                      x
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      y
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      i
                                                      y
                                                   
                                                
                                                )
                                             
                                             ]
                                          
                                          d
                                          Γ
                                       
                                    
                                 
                              
                           
                           
                              
                                 N
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              
                                 L
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              
                                 M
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 d
                                 Γ
                                 
                                 U
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                                 .
                              
                           
                        
                      Note that the matrix 
                        
                           A
                        
                      in Eq. (27) may become singular under certain circumstances. For example, if a feature model contains only a linear boundary with normal component 
                        
                           
                              n
                           
                           
                              x
                           
                        
                        =
                        0
                      or 
                        
                           
                              n
                           
                           
                              y
                           
                        
                        =
                        0
                     , many items in matrix 
                        
                           A
                        
                      will vanish. In such case, the translation motion along 
                        X
                      or 
                        Y
                      axis should be suppressed and hence Eqs. (25)–(28) must be reformulated accordingly. In the Appendix, all the possible combinations of 2D transformations and corresponding design velocities are listed for reference. Properly combining the three basic transformations can produce flexible feature design capabilities.

@&#IMPLEMENTATION DETAILS@&#

To make this paper self-contained, several implementation details are described in this section. Firstly, an extended finite element method (XFEM)  [25] is adopted for structural analysis, which computes a more accurate result than density based FEM. Secondly, to alleviate the side effect due to unavoidable numerical dissipation in solving the H–J equation (6), an accurate particle level set method  [21] is employed to update feature models. Meanwhile, a numerically stable semi-Lagrange method  [26,27] is implemented for freeform boundary optimization. Lastly, a divide and conquer strategy is proposed to design sharp characteristics.

For a CSGLS based structural model, its explicit boundary (even sharp characteristics) can be reconstructed  [22] for an XFEM based structural analysis. Similar to previous works  [25,28,29], the displacement field 
                           
                              u
                           
                         is approximated as: 
                           
                              (29)
                              
                                 
                                    u
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 H
                                 
                                    (
                                    Φ
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                         where a point 
                           
                              x
                           
                         locates inside the 
                           i
                        th element of the entire element set 
                           I
                           ,
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                         the standard finite element shape function, 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 i
                              
                           
                         the corresponding nodal values, and 
                           H
                         a Heaviside function as in Eq. (2). In practice, the global stiffness matrix reads in the following discretized form as:
                           
                              (30)
                              
                                 K
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       K
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                    
                                    
                                       s
                                    
                                 
                                 
                                    B
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                         where 
                           
                              
                                 K
                              
                              
                                 e
                              
                           
                         the element stiffness matrix, 
                           
                              B
                           
                         the displacement differentiation matrix, 
                           Ω
                         the solid domain inside a element, 
                           
                              
                                 
                                    D
                                 
                              
                              
                                 s
                              
                           
                         the elasticity matrix of solid material.

Eq. (30) is evaluated numerically with a standard Gaussian quadrature rule for solid elements. But the cut elements, containing both material and void inside, require a special treatment. Figs. 3 and 4
                        
                         illustrate different types of 2D cut elements. The solid region inside each element is firstly identified according to zero level set intersections and then divided into several sub-triangles (tetrahedrons in 3D case) connecting to its barycenter. As a result, the element stiffness equals to the sum of that of each sub-triangle. In current implementation, weak material is assumed in void element to avoid numerical singularity, which provides a natural velocity extension for level set update  [10].

Generally, shape evolution with the level set method suffers from numerical dissipation, which causes difficulty in maintaining particular feature geometry. To mitigate such side effect in updating feature entities, a particle level set method  [21] of acceptable computational accuracy is leveraged for the proposed affine transformations. This scheme utilizes marker particles to correct errors due to numerical dissipation and is able to preserve feature characteristics during optimization. Table 1
                         briefly summarizes the algorithm according to a publicly available C++ library  [21]. The algorithm is re-implemented using MATLAB for the 2D examples in this paper.

On the other hand, freeform models undergo a standard semi-Lagrangian updating scheme  [26,27] for simultaneously shape and topology design. This scheme follows the fact that the H–J equation propagates 
                           Φ
                         values along the characteristic curves 
                           
                              x
                           
                           =
                           
                              c
                           
                           
                              (
                              t
                              )
                           
                        , that defined by the following equations: 
                           
                              (31)
                              
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       ̇
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 v
                                 
                                    (
                                    
                                       c
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    t
                                    )
                                 
                                 ,
                                 
                                 
                                    c
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       0
                                    
                                 
                                 .
                              
                           
                         By approximating the curve with a first order Courant–Isaacson–Rees formula  [30]: 
                           
                              (32)
                              
                                 
                                    c
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≈
                                 
                                    x
                                 
                                 −
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    t
                                    )
                                 
                                 ⋅
                                 
                                    v
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    Δ
                                 
                                 t
                                 ,
                              
                           
                         where 
                           
                              v
                           
                           
                              (
                              
                                 x
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the velocity of any spatial point 
                           
                              x
                           
                         at previous time 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        , the current 
                           Φ
                         value at 
                           
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         can be explicitly determined through a backward path tracing as follows: 
                           
                              (33)
                              
                                 Φ
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 Φ
                                 
                                    (
                                    
                                       x
                                    
                                    −
                                    
                                       Δ
                                    
                                    t
                                    ⋅
                                    v
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

With the proposed CSGLS description and constrained motion, sharp feature can also be designed by firstly identifying the lower-level feature entities, which contribute to sharp characteristics, and then maintaining their geometry and relation throughout optimization.

For example, all the sharp corners in Fig. 2(a) can be reconstructed during optimization only if 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         in Fig. 2(b) and (c) keep their shape exactly as the origin under the constrained motion. However, simply updating 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                         or 
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         will still smooth out the corner regions after cycles of rotation and scaling, because the fundamental dissipation nature cannot be eliminated completely even with the accurate particle level set method  [21]. As a remedy, once the constrained velocity of 
                           
                              
                                 ϕ
                              
                              
                                 1
                              
                           
                         or 
                           
                              
                                 ϕ
                              
                              
                                 2
                              
                           
                         is obtained, it is applied to drive the lower-level entities 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           =
                           
                              [
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    1
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    2
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    3
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    4
                                 
                              
                              ]
                           
                           
                           i
                           =
                           1
                           ,
                           2
                         individually, as shown in Fig. 2(b) and (c), to maintain the linear hole edges. In this way, all the sharp corners are implicitly preserved and can be reconstructed on the fly for visualization or structural analysis. Experiments show that this “divide and conquer” strategy works well in designing sharp features, which makes full use of the proposed approach.

The following MOI maximization problem under a volume constraint is firstly studied: 
                           
                              
                                 (34)
                                 
                                    
                                       
                                          Minimize
                                       
                                       
                                          Φ
                                       
                                    
                                    
                                    J
                                    
                                       (
                                       Φ
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    −
                                    
                                       
                                          
                                             |
                                             
                                                x
                                             
                                             −
                                             
                                                c
                                             
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       Φ
                                       )
                                    
                                    d
                                    Ω
                                    ,
                                 
                              
                              
                                 (35)
                                 
                                    Subject to  
                                    G
                                    
                                       (
                                       Φ
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       Φ
                                       )
                                    
                                    d
                                    Ω
                                    ≤
                                    
                                       
                                          V
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              c
                           
                         denoting the domain center and 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                         the upper volume constraint. According to the sensitivity analysis in Section  3, design velocity for each level set 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                         is obtained as: 
                           
                              (36)
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             |
                                             
                                                x
                                             
                                             −
                                             
                                                c
                                             
                                             |
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          λ
                                       
                                       ¯
                                    
                                    )
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       e
                                       =
                                       1
                                       ,
                                       e
                                       ≠
                                       i
                                    
                                    
                                       m
                                    
                                 
                                 H
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          e
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 where  
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          ¯
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 max
                                 
                                    {
                                    0
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    μ
                                    
                                       (
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       d
                                       Ω
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     


                        Fig. 5
                        (a) shows the initial configuration, where three level set models are used for computation: a rectangular hole, a circular hole, and a fixed rectangular outer boundary. The dimension of design domain is 1.0×1.0 and the volume constraint is set as 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                           =
                           0.58
                        . During the optimization process shown in Fig. 5, both holes move gradually towards the center of the domain through translation, rotation, expansion and shrinking. The final result containing one circular hole at the center indicates the MOI has been maximized. Meanwhile, the volume constraint is also satisfied.

In this example, although the feature models (rectangular and circular holes) are updated implicitly with level set method, all the required feature shapes and sharp characteristics are well preserved during optimization. It validates that the proposed velocity approximation and affine transformations can trigger a reasonable feature based optimization without jeopardizing the effectiveness of gradient based search.

One interesting application of the proposed method is structural optimization for assembly. In Fig. 6
                        , a static circular hole is expected inside a cantilever beam, while the structural compliance is to be minimized under a volume constraint. Previous implementations, like in  [31–33], simply treat the circular region as non-design domain while optimizing the shape and topology of the rest regions. This is straightforward if such a determinate requirement is known as a priori. However, it may become difficult for traditional SIMP or level set method to dynamically modify the configurations of feature (e.g. position and radius of the circle), unless its geometry is explicitly parameterized as in  [16].

To further demonstrate the generality and applicability of the proposed approach in structural shape and topology optimization, this benchmark example is re-studied and compared with a dynamic feature design. As shown in Fig. 6, the structure is subject to a fixed boundary condition at the left edge and a downward load at the right bottom corner. The geometric dimensions and force are defined as follows: 
                           H
                           =
                           120
                           ,
                           L
                           =
                           180
                           ,
                           R
                           =
                           30
                           ,
                           W
                           =
                           60
                           ,
                           D
                           =
                           60
                           ,
                           F
                           =
                           10
                        . The Young’s modulus of weak and solid material are set as 
                           1
                           e
                           −
                           3
                         and 1 respectively. The mathematical formulations of this linear elastic problem are written as:
                           
                              
                                 (37)
                                 
                                    
                                       
                                          Minimize
                                       
                                       
                                          Φ
                                       
                                    
                                    
                                    J
                                    
                                       (
                                       Φ
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    :
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       Φ
                                       )
                                    
                                    d
                                    Ω
                                    ,
                                 
                              
                              
                                 (38)
                                 
                                    Subject to  
                                    G
                                    
                                       (
                                       Φ
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          D
                                       
                                    
                                    
                                       
                                          χ
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       Φ
                                       )
                                    
                                    d
                                    Ω
                                    ≤
                                    
                                       
                                          V
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                 
                              
                              
                                 (39)
                                 
                                    a
                                    
                                       (
                                       
                                          u
                                       
                                       ,
                                       
                                          v
                                       
                                       ,
                                       Φ
                                       )
                                    
                                    =
                                    l
                                    
                                       (
                                       
                                          v
                                       
                                       ,
                                       Φ
                                       )
                                    
                                    
                                    for all  
                                    
                                       v
                                    
                                    ∈
                                    U
                                    .
                                 
                              
                           
                         For simplicity, both the boundary tracking force and body force are neglected. Thus, a sensitivity analysis gives the following design velocity for each 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                         for steepest descent search: 
                           
                              (40)
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    :
                                    
                                       ε
                                    
                                    
                                       (
                                       
                                          u
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          λ
                                       
                                       ¯
                                    
                                    )
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       e
                                       =
                                       1
                                       ,
                                       e
                                       ≠
                                       i
                                    
                                    
                                       m
                                    
                                 
                                 H
                                 
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          e
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 where  
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          ¯
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 max
                                 
                                    {
                                    0
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    μ
                                    
                                       (
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       d
                                       Ω
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

In this example, the initial structure shown in Fig. 7
                         is built upon one feature model for circular hole and another freeform model. Figs. 8 and 9
                        
                         record two different optimization processes respectively. In Fig. 8, a fixed feature hole is realized by simply assigning the feature model as non-design domain. In comparison, a scaling transformation is enabled in Fig. 9 to optimize the circular radius simultaneously with the structural shape and topology. Although the two optimal designs (Fig. 10
                        ) share a similar topology to the benchmark results in  [31–33], the one with a variable-size hole has a lower compliance value (Table 2
                        ), thus a better structural performance. In fact, this example demonstrates that the proposed approach generalizes and enhances the feature design capability of traditional structural optimization techniques.

Another promising capability of this method is to design truly optimal structures with generative features. In this paper, three motion constraints (design rules), namely group, relation and primitive constraints, are proposed to accommodate different types of feature. As illustrated in Fig. 11
                        , the constraints at different levels of a CSG model tree have different purposes to (i) preserve high-level feature shape, (ii) keep the relation between low-level entities and (iii) maintain geometry of basic entities, respectively. Their practical usage is demonstrated by a cantilever beam example as shown in Fig. 12
                        , which initially contains two rectangular feature holes inside. The structure is subject to a fixed Dirichlet boundary condition at the left edge and a downward force load at the middle of the right edge. Parameters are consistently set for all the following experiments as: 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                           =
                           200
                           ,
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           =
                           100
                           ,
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           =
                           20
                           ,
                           
                              
                                 H
                              
                              
                                 2
                              
                           
                           =
                           10
                           ,
                           
                              
                                 L
                              
                              
                                 3
                              
                           
                           =
                           35
                           ,
                           
                              
                                 L
                              
                              
                                 4
                              
                           
                           =
                           155
                           ,
                           F
                           =
                           10
                        , the upper volume 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                           =
                           0.5
                           
                              
                                 V
                              
                              
                                 
                                    domain
                                 
                              
                           
                        , where 
                           
                              
                                 V
                              
                              
                                 
                                    domain
                                 
                              
                           
                         denotes the volume of design domain, and the Young’s modulus 
                           1
                           e
                           −
                           3
                         and 1 for weak and solid material respectively. The optimization problem is to minimize structural compliance under a volume constraint.

The beam is firstly optimized using the standard level set method with one single model. As shown in Fig. 13
                        , both of the rectangular features have disappeared in the final design and no geometric consistency can be explicitly tracked during the optimization process.

In comparison, two group constraints are employed to preserve the two rectangular holes. Accordingly, the model in Fig. 14
                         is constructed with nine entities: eight feature models (four line entities for each hole) and one freeform model for the outer boundary. During optimization, the constrained velocity of rectangular holes is firstly obtained and used to update the lower-level line entities. As illustrated in Fig. 15
                        (a), the size and location of feature holes are eventually optimized with all the sharp corners well preserved. Besides, the outer freeform boundary transforms ideally towards a maximal structural performance. Comparing to the smooth convergence history in Fig. 13(b) of the previous infinite dimensional optimization, the wiggles shown in Fig. 15(b) are due to the extra motion constraint over feature models, which causes small-scale geometric modulation around to the optimum. However, such phenomenon only occurs after a proper optimal design has been found, and thus has little impact to overall optimization.

In the third example, two 90° angles intersected by the yellow edges in Fig. 16
                         will be preserved under a relation constraint, while the left hole is subject to a group constraint. Similar to the previous example, each feature hole is further decomposed into low-level entities as in Fig. 16(b). But the one containing the blue edge is regarded as a freeform entity. In the final structural configuration shown in Fig. 17
                        , the right rectangular hole eventually transforms into a truly optimal shape together with the outer boundary and all the required features are properly satisfied.

Finally, two primitive constraints are exerted to the right hole in Fig. 18
                          to keep the linearity of two edges (in red color). The left hole is still subject to a group constraint and the other boundary (including blue edges and outer boundary) can be freely designed. Fig. 19
                         shows the optimal result and convergence curves. During optimization, the two feature edges maintain their linear geometry while the adjacent edges are freely optimized, although they together form a rectangular primitive initially. Note that, numerical singularity of velocity approximation occurs in this example, because the two feature line entities initially have a zero normal component 
                           
                              
                                 n
                              
                              
                                 x
                              
                           
                           =
                           0
                         along its boundary. Disabling horizontal translation at the beginning can avoid such problem.

To summarize, Table 3
                         records the structural compliance and volume of each optimal design. A stricter and more conservative constraint (group constraint) essentially leads to a larger compliance value compared with the infinite dimensional optimization (no constraint), which gives the most effective structural layout with the same amount of material.

This example clearly demonstrates that the CSGLS representation and proposed motion constraints constitute an elegant solution to the problem of generative feature design in structural optimization. By imposing motion constraints to different levels of a CSG tree, various feature geometry can be flexibly designed to meet practical engineering requirements. Compared with the traditional methods using fixed geometric primitives, this approach focuses on preserving the necessary engineering significance and meanwhile allows for a truly optimized shape to be designed in an effective and reasonable way.

The proposed approach is further justified by a 3D design example. As shown in Figs. 20
                        (a) and Fig. 21
                        (a), an initial beam containing a cylindrical feature is to be optimized for maximum stiffness under a volume constraint. Two level set models are used to model the initial beam: one for the cylinder hole and the other for the outer freeform boundary. In both examples, the following parameters are set: 
                           L
                           =
                           40
                           ,
                           H
                           =
                           20
                           ,
                           W
                           =
                           15
                           ,
                           d
                           =
                           8
                        , an upper volume constraint 
                           
                              
                                 V
                              
                              
                                 0
                              
                           
                           =
                           0.4
                           
                              
                                 V
                              
                              
                                 
                                    domain
                                 
                              
                           
                        , and Young’s modulus 
                           1
                           e
                           −
                           3
                         and 1 for weak and solid material respectively. Besides, a structural mesh of 32×16×12 elements is utilized for structural analysis.

In Fig. 20(a), a vertical force load 
                           F
                           =
                           20
                         is firstly applied at the middle of front face while the back side is subject to a fixed boundary condition. Fig. 20(b) and (c) show the optimized design from different views. The location and size of the cylindrical hole are properly determined through affine transformations and the outer freeform boundary evolves simultaneously for a maximum structural performance. To demonstrate the robustness of proposed approach, another horizontal force load 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           =
                           10
                         is added to the beam in Fig. 21(a) and the optimal designs are pictured in Fig. 21(b) and (c). In this example, not only the size and location of the cylindrical feature are optimized but also the most effective orientation is found accordingly.

@&#CONCLUSIONS@&#

This paper presents a general approach to designing engineering features in structural shape and topology optimization. It combines CSG modeling in representing features and level set method in optimizing freeform boundary. Several well-known techniques are employed, such as XFEM, particle level set method and semi-Lagrange method, and constitutes a viable solution to the proposed problem.

The CSGLS description distinguishes feature entities from non-feature ones in a CSG model tree, and allows engineering significance to be precisely interpreted by the geometry or relation between feature models. For practical applications, the rule of thumb to build an effective CSGLS model is to use a minimum number of feature entities (such as line or plane primitives) to satisfy engineering requirements, while ensuring non-critical regions can be freely optimized as much as possible.

The proposed constrained motion provides several basic but useful design functions to preserve and design features (including sharp characteristic) during optimization. It provides a practical means to manipulate features through an implicit design approach, especially for level set based structural optimization. However, the current affine transformation is by no means a complete solution. It would be desirable to develop alternative constrained motions to address more complex design requirements.

Remarkably, this method unifies feature design and structural shape and topology optimization under the level set framework. It shows an appealing design flexibility to create truly optimal structural configurations with features considered. The whole scheme can be easily implemented into any level set based structural optimization framework without model parameterization. Based on the current implementation, future development could take 3D geometric editing into account for an integrated CAD/CAE solution. It would also be interesting to apply the proposed methodology to design sharp features for stress related design problems.

For the constrained affine transformation, combination of translation, rotation and scaling can produce different motion patterns for practical design requirements. The following table summarizes all the possible constrained motions and the corresponding velocity matrix of 2D problem (see Table A.1
                     ).
                        
                           
                              
                                 O
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 d
                                 Γ
                                 
                                 Q
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                                 
                                 R
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              
                                 P
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 d
                                 Γ
                                 
                                 S
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                                 
                                 T
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              
                                 N
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              
                                 L
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                              
                           
                           
                              
                                 M
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                                 d
                                 Γ
                                 
                                 U
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Γ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             x
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             i
                                             y
                                          
                                       
                                       )
                                    
                                    ]
                                 
                                 d
                                 Γ
                                 .
                              
                           
                        
                     
                  

@&#REFERENCES@&#

