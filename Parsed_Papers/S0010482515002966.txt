@&#MAIN-TITLE@&#Real-time prediction of acute cardiovascular events using hardware-implemented Bayesian networks

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A system for detecting conditions dangerous to patient׳s health or life is presented.


                        
                        
                           
                           The system is a microprocessor-based device attached to a medical monitor.


                        
                        
                           
                           The system works in real time providing guidance for medical personnel.


                        
                        
                           
                           The core of the reasoning algorithms is based on Bayesian networks.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Decision support

Sudden cardiac arrest

Cardiology

Bayesian networks

Embedded systems

@&#ABSTRACT@&#


               
               
                  This paper presents a decision support system that aims to estimate a patient׳s general condition and detect situations which pose an immediate danger to the patient׳s health or life. The use of this system might be especially important in places such as accident and emergency departments or admission wards, where a small medical team has to take care of many patients in various general conditions. Particular stress is laid on cardiovascular and pulmonary conditions, including those leading to sudden cardiac arrest. The proposed system is a stand-alone microprocessor-based device that works in conjunction with a standard vital signs monitor, which provides input signals such as temperature, blood pressure, pulseoxymetry, ECG, and ICG. The signals are preprocessed and analysed by a set of artificial intelligence algorithms, the core of which is based on Bayesian networks. The paper focuses on the construction and evaluation of the Bayesian network, both its structure and numerical specification.
               
            

@&#INTRODUCTION@&#

Cardiovascular diseases, which are one of the most common causes of death in the world [1], are often characterised by sudden onsets of the severe stage of the illness, leading to a rapid deterioration of the patient׳s condition. If such a deterioration takes place, immediate actions have to be taken in order to sustain the patient׳s life. If possible, it is essential to predict the onset of the severe stage, as this allows taking preventive steps before actual deterioration takes place.

Experiences with the Modified Early Warning Score (MEWS, see Section 2) show that even such a simple approach has allowed reducing the risk of sudden cardiac arrest (SCA), the leading cause of hospital mortality [2]. This paper presents research aimed at developing a system which, taking the approach of MEWS as a basis, offers a solution that is automatic, based on more data pertaining to the condition of the patient, and uses artificial intelligence (AI) algorithms in order to predict problems with patient׳s health.

The proposed solution may be particularly useful in circumstances in which it is difficult for the doctors to devote enough attention to the individual patients. This may happen in admission wards and accident and emergency departments, where limited staff may have to deal with a suddenly increased number of cases. Moreover, in some circumstances the doctor may not be present at all: ambulances are a typical example of such a situation.

The development of this system has been previously described in [3–5]. Earlier publications have been focused on the general concept of the system, including hardware considerations and the development of a user interface. In this paper we provide details about employed algorithms, a knowledge base, and test results based on real-life data.

The remainder of this paper is organised as follows: Section 2 introduces the Modified Early Warning Score, a commonly used indicator of a patient׳s condition and its changes. Section 3 discusses recent developments in the field of decision support systems for cardiovascular diseases. Section 4 outlines the proposed concept. Section 5 describes the approach applied to segment ECG signal. Section 6 presents some issues related to Bayesian network implementation – the central reasoning element of the system, including an example of the network structure and numerical specification. Section 7 offers some closing remarks and a plan for future research.

The Modified Early Warning Score (MEWS) is an algorithm used to quickly determine a patient׳s condition and changes in this condition. Although there are various algorithms with the same name, in most cases the input data used to compute the score are identical: these are the systolic blood pressure, heart rate, respiratory rate, body temperature, and level of consciousness (using the scale alert, voice, pain, unresponsive). As the algorithm is very simple, the score can be computed manually, just by referring to a compact chart (an example is presented in Table 1
                     ), listing the ranges of the possible input values. The most important information is obtained by analysing not the current value of the score, but its changes: if the score rises by 2, consultation with a doctor should take place, if the score rises by 4, the patient should be immediately transferred to the Intensive Care Unit.

Even though MEWS has proven its effectiveness, it is a very simplistic approach. Its main drawback is the very limited input data set: it does not make use of data such as the electrocardiography (ECG) signal, which carries an enormous amount of information that is important for assessing cardiovascular problems. Obviously, using the ECG is not possible in a scale computed manually, so extending the scale requires computerised calculations.

On the other hand, much more elaborate scales are already in use. A popular example is the Acute Physiology, Age, and Chronic Health Evaluation (APACHE III) scale. Such scales allow including much more input data. However, this comes at a price: APACHE III uses as many as 20 input parameters, and determining some of them requires laboratory tests. Because all the parameters have to be entered manually into a computer program, it cannot be used in the same way as MEWS. This makes the use of such a scale difficult in an ambulance or an accident and emergency department.

Computerised decision support systems aimed at cardiovascular diseases have already been discussed in the literature. The development of AI algorithms and the increasing computing power of processors has resulted in a significant number of solutions designed in recent years. These use various soft computing formalisms to develop the required algorithms and encode knowledge. For example, the system described in [6] employs a rule-based inference for the task of chest pain diagnosis: the rules are based on the knowledge learned from real patient data. In [7], another system for chest pain diagnosis is described, this time built on the ontology approach and Bayesian Networks (BNs). BNs are also used in [8], where a system for the diagnosis of cardiovascular diseases is presented. Yet another method is outlined in [9], where data mining algorithms and fuzzy models are used as the basis for a decision support system. A fuzzy rule based approach is also used in [10].

Although there is evidence that such computerised systems may improve the quality of care [11–13] their use is not straightforward, as none of them automatically acquire the signals characterising the patient׳s condition. Instead, they employ patient records or additional questionnaires, similar to the APACHE III system discussed in the previous section. This means they are difficult or impossible to use in cases when the patient׳s record is not available, or there is no time to enter all the required data. Neither do they work in real-time, so they cannot respond to a patient׳s condition that is changing quickly. The system proposed in this paper aims at overcoming these difficulties:
                        
                           •
                           it automatically acquires the data in real time;

it processes the data in real time in order to respond to changes in the patient׳s condition;

it employs a BN-based approach that can cope with incomplete or partially contradictory data in order to provide robust decision support for the medical personnel in various situations.

The proposed system is constructed as a stand-alone microprocessor-based device that attaches to a typical vital signs monitor. The authors decided to rely on the monitor as a source of data, as this presents a number of advantages:
                        
                           •
                           there is no need to attach additional wires to the patient, which simplifies and speeds up the setting up of the device;

the infrastructure already present in the hospitals/ambulances is used, which reduces the cost;

development is simpler, as there is no need to design the part responsible for acquiring the signals.

Although, from the hardware point of view, the proposed solution is simply a computer attached to the vital signs monitor, the authors decided not to use an of-the-shelf PC computer, notebook or tablet, as such devices are not designed to meet the standards required for operation in ambulances or accident and emergency departments. Instead, the system was built as a custom device around an embedded processor, Texas Instruments DaVinci DM3730 digital media processor [14], which combines in one integrated circuit an ARM Cortex-A8 processor, a TMS320C64x+ DSP, and a POWERVR SGX graphics accelerator. The presence of a DSP may be advantageous for the implementation of the data processing algorithms. As a prototyping platform, Embest DevKit8500 (Fig. 2
                     ) for this processor was selected.

Software is the key element of the proposed system. It consists of a number of interconnected blocks, which can roughly be divided into input, processing, and output/presentation. The following sections focus on the processing blocks, one responsible for ECG signal segmentation and the BN-based AI one responsible for estimating the patient׳s condition. For details related to the presentation module the reader is referred to [5].

In order to employ the ECG signal in the analysis of the patient׳s condition, the raw signal must be subjected to pre-processing and segmentation. In particular, correct segmentation, that is, the division of the ECG signal into fragments corresponding to heart beats and marking the position of the particular waves, is essential.

The basic element of segmentation algorithms is the detection of the QRS complex. This problem may be addressed in many different ways. The solutions may be divided into five distinct groups: time-domain, frequency-domain, pattern based, neural network based, and genetic algorithms based. The algorithm implemented in the presented system is based on the time-domain approach developed by Pan and Tompkins [15]. The time-domain approach is very useful for ECG signal segmentation in real time (which is essential in the presented system); the main drawback is its sensitivity to signal distortion. The ECG signal analysis in the time domain is based on the observation of changes in the signal amplitude. The main operations employed are signal thresholding and transformations based on the first and the second derivative.

This ECG segmentation algorithm consists of five stages, schematically shown in Fig. 3
                        . The first step is low-pass filtering: its main task is to attenuate the noise caused by the movement and baseline fluctuation caused by skin-electrode contact. The transfer function of a second order low-pass filter used in this step is expressed by (1), and the corresponding difference equation of the filter by (2), respectively. The second stage employs a high-pass filter with the filter transfer function given by (3) and the difference equation by (4). Next, a derivative of filtered ECG is calculated. The transfer function of a five-point derivative is given by (5) and the corresponding difference equation by (6). The penultimate stage is exponentiating the signal, the main objective of which is to ensure that all samples have a positive sign, additionally amplifying the higher frequencies. The final step is signal integration, which allows detecting abnormal QRS complexes with gentle inclines of the slopes. The difference equation of the integration operation is given by (7). The authors obtained satisfactory results with N=32
                           
                              (1)
                              
                                 
                                    
                                       H
                                    
                                    
                                       lp
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      −
                                                      
                                                      6
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                1
                                                −
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 y
                                 (
                                 nT
                                 )
                                 =
                                 2
                                 y
                                 (
                                 nT
                                 −
                                 T
                                 )
                                 −
                                 y
                                 (
                                 nT
                                 −
                                 2
                                 T
                                 )
                                 +
                                 x
                                 (
                                 nT
                                 )
                                 −
                                 2
                                 x
                                 (
                                 nT
                                 −
                                 6
                                 T
                                 )
                                 +
                                 x
                                 (
                                 nT
                                 −
                                 12
                                 T
                                 )
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       H
                                    
                                    
                                       hp
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       −
                                       16
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             lp
                                          
                                       
                                       (
                                       z
                                       )
                                    
                                    
                                       32
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 y
                                 (
                                 nT
                                 )
                                 =
                                 x
                                 (
                                 nT
                                 −
                                 16
                                 T
                                 )
                                 −
                                 1
                                 /
                                 32
                                 [
                                 y
                                 (
                                 nT
                                 −
                                 T
                                 )
                                 +
                                 x
                                 (
                                 nT
                                 )
                                 −
                                 x
                                 (
                                 nT
                                 −
                                 32
                                 T
                                 )
                                 ]
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       H
                                    
                                    
                                       der
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 0.1
                                 (
                                 
                                    2
                                    +
                                    
                                       
                                          z
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          z
                                       
                                       
                                          −
                                          3
                                       
                                    
                                    −
                                    2
                                    
                                       
                                          z
                                       
                                       
                                          −
                                          4
                                       
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (6)
                              
                                 y
                                 (
                                 nT
                                 )
                                 =
                                 [
                                 2
                                 x
                                 (
                                 nT
                                 )
                                 +
                                 x
                                 (
                                 nT
                                 )
                                 −
                                 x
                                 (
                                 nT
                                 −
                                 3
                                 T
                                 )
                                 −
                                 2
                                 x
                                 (
                                 nT
                                 −
                                 4
                                 T
                                 )
                                 ]
                                 /
                                 8
                              
                           
                        
                        
                           
                              (7)
                              
                                 y
                                 (
                                 nT
                                 )
                                 =
                                 1
                                 /
                                 N
                                 {
                                 x
                                 [
                                 nT
                                 −
                                 (
                                 N
                                 −
                                 1
                                 )
                                 T
                                 ]
                                 +
                                 x
                                 [
                                 nT
                                 −
                                 (
                                 N
                                 −
                                 2
                                 )
                                 T
                                 ]
                                 +
                                 ⋯
                                 +
                                 x
                                 (
                                 nT
                                 )
                                 }
                              
                           
                        An example of segmentation performed by the described algorithm is shown in Fig. 4
                        .

The performance of the segmentation algorithm was evaluated by comparing its results with those obtained from commercially available software for processing Holter recordings, the PathFinder Digital Holter system, manufactured by Spacelabs Healthcare. The evaluation was based on 171 recordings, each containing (on average) 90,861 beats. Both algorithms were capable of correctly segmenting more than 94% of the beats (with many recordings exceeding the 99% level); this should be treated as a good result, considering the fact that many recordings had some periods of almost unusable data (resulting from, for example, imperfect contact of the electrodes or vigorous movements of the patient׳s body). A detailed analysis showed that the proposed algorithm detected (on average) 4.5% more beats than the commercially available system. It should be noted that the larger number of beats detected should not be considered as a definite proof of superiority of one system over the other. The difference in the number of correct heart beats detected in the ECG signal mainly comes from different criteria for treating the beat as suitable for further analysis, rather than from the position of the detected QRS complex. However, we present statistics showing that the two algorithms have similar performances and that the proposed algorithm fully complies with the applicable standards in this area.

A Bayesian network has been chosen for the real-time prediction of acute cardiovascular events. The main motivation is the ability of BNs to cope with incomplete or partially contradictory data, and ease of creating their descriptions by various complementary methods, such as with the help of a human expert, or through machine learning.

Bayesian networks are graphical models that are based on directed acyclic graphs; the nodes of the graph correspond to the variables, and the edges correspond to the dependences between them. The graph allows encoding qualitative relations between the variables, in particular, by not connecting some of the nodes, it is possible to express conditional independence between their variables. This in turn allows encoding the joint probability distribution of the variables in a very compact way (compared to the enumeration of the probabilities assigned to all possible combinations of the variables׳ states); it also allows using efficient algorithms for querying the network, i.e., obtaining the probabilities of the variables’ states given some piece of evidence. The graph is supplemented by a numerical specification that expresses the quantitative relations between the variables. For such a specification, it is necessary to provide conditional probabilities for the variables that are children of other variables and unconditional probabilities for the rest of them. In the case of a discrete BN (which is what is employed in the presented solution) these are expressed using probability tables, while for continuous BNs, they are expressed as relations between the parameters of continuous distributions (multivariate Gaussian being the most common example).

In order to query a BN it is necessary to set the state of the observed variables (enter evidence) and apply an inference algorithm, which computes the probabilities of the states of the other variables. As it is possible to arbitrarily choose the variables for which the evidence is entered, BNs are an ideal tool for reasoning in cases when some of the input data might be missing.

The complete specification of a BN can be created by a human expert; this is important especially in the case of its structure, as this encodes the qualitative relations, which are easily comprehended by humans. However, it is also possible to create a BN through machine learning procedures. Moreover, it is possible to combine these approaches: the structure may be created by an expert, while the numerical specification may be obtained through machine learning.

For an in-depth discussion of Bayesian networks, refer to [16–18].

The task of the BN in this system is to perform reasoning on the basis of data coming from various sensors of the vital signs monitor and also the data entered by the medical personnel. Using this broad base and the medical knowledge encoded in its structure and numerical specification, the BN should be capable of detecting a number of conditions that pose a danger to the patient׳s health or life.

The preliminary structure of the network is presented in Fig. 5
                        . It has been obtained by following the well-known cause–effect relations that are known to doctors and are summarised in medical text-books, especially those in the field of evidence-based medicine (EBM) [19]. This structure was further verified by the physicians who are the co-authors of this paper. Its largest fragment is devoted to the detection of myocardial infarctions, which is a dangerous condition in itself and may also lead to an SCA [20]. The layout of the graph is such that the white nodes (ovals) in the upper part represent the conditions for which the network should compute the probabilities, while the other nodes represent the possible observations and symptoms. Among the latter, the leaves of the graph (nodes with no outgoing edges) are strictly associated with specific observations, while the remaining ones only group observations from other nodes (e.g., ECG abnormalities). In general, the direction of the arrow is from conditions to symptoms.

It should be noted that, in general, the connection (edge) between a condition and a symptom does not necessarily imply that the symptom is present for the particular condition – it only indicates that there is a significant dependency between the condition and the symptom. This dependency may be such that the symptom is not present in this condition. However, no situations of this kind exist in the presented structure.

Among the symptom nodes, most are related to evidence obtained through the ECG signal analyses. However, two of them (marked in dark grey) represent evidence coming from other sources, namely the temperature sensor and the blood pressure sensor. Because the Emtel FX2000-MD monitor is equipped with such sensors, the presented BN can be provided with data in a fully automatic manner, without the need to enter any information manually. As to the discussion of the possible drawbacks of this approach (and consequently potential departures from it), see Section 6.4.

The reader may also note the presence of two identically named nodes (Conduction impairment) and the fact that the network consists of three separate fragments. The reason for these choices will be presented in the next subsection.

The qualitative dependencies expressed by the structure of the BN have to be supplemented by a numerical specification which captures the quantitative relations. There are many ways in which such a specification can be obtained: for example, it is possible to elicit such knowledge from an expert using a questionnaire using the Likert scale [21]. However, values obtained in this way will always be biased and may significantly differ between experts. Consequently, it is advisable to obtain the numerical specification using a more objective approach.

In the literature it is possible to find objective numerical data that tie particular conditions with their symptoms. Some text-books in the field of EBM are particularly useful, as they aggregate a vast number of publications providing in one place most of the required data. Consequently, the core of the numerical specification of the BN is based on two such books: [19,22]. As the amount of data contained therein and used in the construction of the numerical specification is significant, the authors decided not to include these data in this paper; the reader is referred to the original sources for the details.

It should be noted that the data used as the source of the numerical specification may take on various forms. In the simplest situation, they are just numbers reflecting the percentages of patients with the particular condition that exhibited the symptom; more complete data include likelihood ratios (positive LR+ and negative LR−) that allow precisely assessing the value of observing the symptom in diagnosing the condition [23]. In the latter case, confidence intervals are sometimes also available, reflecting the discrepancies in the likelihood ratios obtained by various research groups. An example of such data is presented in Table 2
                        . Likelihood ratios are especially useful in constructing the numerical specification of the BN, as they can be directly translated into the values of the probability matrix that constitutes the numerical specification of the BN; the calculations involved are presented in Table 3
                        . However, even the likelihood ratio data do not provide all the information. This is because they express only the relations in a one-to-one manner: one condition is related to one symptom at a time. Such an approach ignores two important problems:
                           
                              •
                              the symptoms may not be conditionally independent (given the condition),

the conditions may be conditionally dependent (given the symptom).

The second problem means that there can be a group of conditions sharing the same symptom. In such case, when the confidence in one of these conditions is increased (for example, due to the presence of other symptoms), the confidence in others should be reduced (the symptom is ‘sufficiently explained׳ by the presence of one condition). Again, lack of the required numerical data means that such a construct, fully supported by the BN, is not possible. This is the reason why the BN presented in Fig. 5 has three separate fragments. Note also that the Conduction impairment node is duplicated. This makes the model not consistent, as there may be at the same time two different probabilities of the same symptom. One possible remedy is, again, to have the specification corrected by a human expert.

To complete the numerical specification it is also necessary to provide the unconditional probabilities for the root nodes of the BN, which correspond to the nodes representing the conditions to diagnose. However, providing meaningful numbers is troublesome. The natural approach would seem to be to use the morbidity rate of the condition: this would correspond to the probability that a randomly selected person suffers from the condition. However, the proposed use of the system (Accident and Emergency Departments, ambulances) significantly modifies the group from which the person might be selected: it is no longer the whole population, but the group of people consisting primarily of individuals that feel severely unwell or are victims of accidents. Clearly, the probability of conditions in the latter group is different than in the former. Consequently, literature data about the percentage of the patients admitted to the hospital or Accident and Emergency Departments suffering from the particular condition [25–27] were used to set the unconditional probabilities of the root nodes. This approach is not without its faults, as the numbers may greatly differ from one country to another (or even from one region of a country to another); for some conditions it is also difficult to find reliable data.

Prospective research includes the possibility of automatically adjusting the numerical specification using the patient database and doctor׳s diagnoses and decisions.

As already noted, the BN presented in Fig. 5 is designed for fully automatic operation, relying only on the data obtained through the vital signs monitor. However, this approach overlooks two important sources of data:
                           
                              •
                              symptoms whose presence cannot be determined through the measurements performed by the vital signs monitor,

information available about the patient, such as age, sex, or the medical history.

As far as the second source of data is concerned, the discussion of its usefulness and the resulting departure from the fully automatic operation is identical as previously; however, this information does not adhere to the concept of symptoms: instead of being results (manifestations) of the condition, they are factors that may be the reasons (causes) of the condition. Consequently, they should be the parents of the nodes representing the conditions; in this way the condition nodes will no longer be root nodes. The usefulness of this source of data is limited by the difficulties in obtaining the data that tie various information about the patient with the probability of the condition in the case of people admitted to the Accident and Emergency departments.

The structure of the BN with new nodes corresponding to the above-described data sources is presented in Fig. 6
                        . The probability tables for the new child nodes were, as previously, based on data contained in [19]. A different approach had to be used for the new parent nodes (Sex and Age), as the required data were of a different nature. The morbidity rate values for myocardial infarction, broken into sex and age categories [28], were used to construct the new probability table for the Myocardial infarction node. These values had to be scaled, because they reflected the morbidity rate in the whole population, not in the group admitted to the Accident and Emergency departments, as they should. The unconditional probabilities for the Sex node were set so as to make both sexes equally probable, and the unconditional probabilities for the Age node were chosen so as to reflect the age distribution of the population [29]. The complete probabilistic tables for the above-mentioned three nodes are shown in Table 4
                        .

The structure of the network will be further expanded to include more symptoms, as well as more diseases or conditions requiring prompt actions of the medical staff.

In order to estimate the capabilities of the proposed BN, a number of cases (combinations of the input nodes values) were evaluated. Tables 5
                         and 6 present the obtained results.

Entry no. 1 in Table 5 shows the probabilities when no evidence is available: the probabilities are equal to the frequency of the particular condition cases for patients admitted to the Accident and Emergency Department. Entry nos. 2–4 show situations when various symptoms connected with infective endocarditis are present. The reader may note that based on all evidence that can be automatically obtained from the vital signs monitor (entry no. 3) there are no significant indications concerning the presence of the condition: the probability is only 0.082. Only when external data (results of echocardiography) are entered does the output probability rise significantly (entry no. 4). This is an example of a condition for which it will be difficult to provide reliable diagnosis support in a fully automatic way.

The situation is different with myocardial infarction, as presented in Table 6
                        . Here even a single piece of evidence coming from the ECG analysis may result in a significant increase in the probability (entry no. 5), while two such pieces result in a high probability (entry no. 6). Nevertheless, the inference process may significantly benefit from entering some readily obtained additional evidence, such as sex, age and the presence or absence of chest pain in the patient. In fact, these data alone (entry nos. 1–4) will considerably alter the belief in the discussed condition, either positively (entry no. 4) or negatively (entry no. 1). When combined with the ECG evidence they may give a probability exceeding the value of 0.96 (entry no. 7). At the same time, negative ECG evidence may also reduce the probability below the ‘no evidence’ level, regardless of the sex and chest pain data (entry no. 9).

High belief levels may also be obtained using cardiac markers (entry no. 8). It is not to be expected that this kind of evidence will be available upon admission to the accident and emergency department (or even shortly afterwards), but including this evidence in the inference process does not impair such process, while it may provide an important contribution if the evidence is available. Finally, contradictory evidence will, as expected, result in an inconclusive output probability (entry no. 10).

The performance of the proposed BN has been verified using real patient data, which contained cases of ST elevation myocardial infarction (STEMI), non-ST elevation myocardial infarction (NSTEMI), as well as cases of unstable angina with no myocardial infarction and cases of atypical chest pain. These cases are briefly summarised in Table 7
                        . The BN has been tested by presenting each case separately and recording the probability of the ‘Myocardial infarction’ node. An important aspect of the validation procedure is the threshold used to separate the probabilities indicating cases of myocardial infarction from the cases that should not raise a suspicion of this affliction. One may argue that the threshold of 0.5 should be used, as it halves the possible values of the output probability. However, one must remember that the presented system is intended to detect cases that should be further investigated by doctors, rather than conclusively separate the cases of myocardial infarction from other problems. Consequently, the threshold should be significantly lower – in order to include more of the suspicious cases, at the same time accepting the risk of more false positives. Following this reasoning the threshold was set at the value of 0.25. However, this is an arbitrary threshold. A more objective approach is to set the threshold equal to the probability of myocardial infarction in the absence of any data. In the case of the developed BN, this probability is equal to the typical proportion of patients admitted to the emergency department that were found to have myocardial infarction: this value is equal to 0.03. The results of employing both thresholds are presented in Table 8
                        .

The results of the validation using these two approaches to setting the discriminating threshold mainly differ in the correctness of the classification of the STEMI cases. Setting the threshold at 0.03 improved the sensitivity of the BN at the expense of only one false positive. The sensitivity and specificity values for both cases are summarised in Table 9
                        .

The conducted validation proved the usefulness of the proposed BN. However, further improvement is desired, in particular in the case of NSTEMI. On the other hand, one must remember that this particular case of myocardial infarction is inherently more difficult to detect, especially using only ECG data.

@&#CONCLUSIONS@&#

This paper presents research concerning the development of a real-time monitoring system for patients, with an emphasis on detecting conditions related to cardiovascular diseases that may pose an immediate risk to the patients’ health or life. The aim of the system is to provide support for (para)medical staff, especially when a physician cannot be immediately accessible. The system uses a standard vital signs monitor as the primary source of data. The main inference path involves ECG signal segmentation and using its result as evidence for a Bayesian Network.

The preliminary evaluation confirms the possibility of encoding the available medical knowledge in a BN that can be computed in real-time in an embedded device. The main problems identified at this point are the difficulties in obtaining data that may serve as the basis for the numerical specification of the BN, in particular, the lack of data that take into account the correlations between various symptoms or conditions. The precise segmentation of the ECG signal and the computation of its parameters that are required for the BN operation also pose a significant challenge, especially in the case of low-quality signals.

The system is still in the development phase and requires further testing in order to unambiguously prove its usefulness. Obtained results are highly encouraging. Consequently, should the final evaluation prove satisfactory, we plan to undertake steps needed to introduce the product to the market. These would at least require ensuring compatibility with a wide range of vital sign monitors and designing a robust chassis for the device, which will be investigated in the future. Exhaustive tests of the final device in various environments would also be needed to fine-tune the user interface for hassle free operation.

@&#SUMMARY@&#

This paper presented a decision support system for estimating a patient׳s general condition, with particular stress on cardiovascular and pulmonary conditions. The proposed system is a stand-alone microprocessor-based device that works in conjunction with a standard vital signs monitor; the monitor provides input signals such as temperature, blood pressure, pulseoxymetry, ECG, and ICG. The system is built around a DaVinci DM3730 embedded microprocessor. The acquired signals are preprocessed and analysed by a set of algorithms, the core of which is based on Bayesian networks (BNs). As an output, the system should give information about detected problems, possible future threats, possible causes, and suggestions for further treatment. The Use of the presented system might be especially important in places such as Accident and Emergency Departments or Admission Wards, where a small medical team has to take care of many patients in various general conditions. The paper contrasted the proposed approach with currently used algorithmic methods for evaluating a patient׳s condition, both simple (e.g., Modified Early Warning Score) and advanced (e.g., APACHE III). It advocated the choice made regarding the hardware platform of the system and the use of a standard vital signs monitor as the source of data. The algorithm used to perform the ECG signal segmentation was depicted and the results of tests on real patient data that indicate its correctness were presented. A brief introduction to BNs has been offered, followed by a presentation of the method for constructing the BN (both the structure and the numerical specification). The performance of the proposed BN has been tested by evaluating sample case scenarios, it has been further validated using a data set of 29 patient cases: both myocardial infarction and other ailments that may result in chest pain were included. The sensitivity and specificity of the BN with regard to two different thresholds of the output probability has been discussed. Indications of further research plans were offered at the end of the paper.

None declared.

@&#ACKNOWLEDGEMENTS@&#

The graph of the Bayesian network has been designed using the GeNIe modelling environment. The system may use SMILE reasoning engine for graphical probabilistic model. GeNIe and SMILE are developed by the Decision Systems Laboratory of the University of Pittsburgh and available at http://genie.sis.pitt.edu/ The authors are grateful to NHS Orkney for permission to use the patient data for validation of the BN. The work described in this paper has been financed through Polish National Science Centre funding granted by decisions DEC-2011/01/B/ST6/04726 and DEC-2011/03/B/ST6/03454.

@&#REFERENCES@&#

