@&#MAIN-TITLE@&#A robust and real-time vascular intervention simulation based on Kirchhoff elastic rod

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A VR based simulation system has been proposed and developed for vascular intervention training.


                        
                        
                           
                           A real-time physically-based modeling approach ground on Kirchhoff elastic rod is proposed to simulate complicated behaviors of guidewires and catheters.


                        
                        
                           
                           We performed a series of experiments to evaluate the robustness and effectiveness of the proposed guidewire simulation method as well as the system.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Vascular intervention

Kirchhoff elastic rod

Physically based simulation

Guidewire and catheter

@&#ABSTRACT@&#


               
               
                  A virtual reality (VR) based vascular intervention simulation system is introduced in this paper, which helps trainees develop surgical skills and experience complications in safety remote from patients. The system simulates interventional radiology procedures, in which flexible tipped guidewires are employed to advance diagnostic or therapeutic catheters into vascular anatomy of a patient. A real-time physically-based modeling approach ground on Kirchhoff elastic rod is proposed to simulate complicated behaviors of guidewires and catheters. The slender body of guidewire and catheter is modeled using more efficient special case of naturally straight, isotropic Kirchhoff rods, and the shorter flexible tip composed of straight or angled design is modeled using more complex generalized Kirchhoff rods. The motion equations for guidewire and catheter were derived with continuous elastic energy, followed by a discretization using a linear implicit scheme that guarantees stability and robustness. In addition, we used a fast-projection method to enforce the inextensibility of guidewire and catheter. An adaptive sampling algorithm was also implemented to improve the simulation efficiency without decrease of accuracy. Experimental results revealed that our system is both robust and efficient in a real-time performance.
               
            

@&#INTRODUCTION@&#

Vascular intervention has been widely used all over the world for its smaller incisions, less blood loss, decreased pain and quicker recovery of patients [1]. However, a big challenge in vascular intervention is to develop inexperienced interns’ operation skills through a safe and low-cost training. Traditionally, vascular intervention skills of interns were developed by using animals, human phantoms or even actual patients. However, each of these ways has its own limitations [20,22]. Animal cannot be considered as a good replacement of human body due to the anatomical differences of vascular networks. Training on phantoms lacks credible force feedback of human tissues, and it is also expensive to make a phantom with complex vasculature of a patient. Training on real patients under X-ray machine is harmful for the health of both interns and patients. In contrast, VR-based simulation system provides a promising way for intervention training with high flexibility, high realism, low cost and no risks for patients and trainees [2,21,22,23]. Studies have shown that surgical skills learnt through VR-based simulators can significantly decrease the time needed by a procedure and reduce the frequency of medical errors compared with traditional training methods [3].

Previously, a hybrid mass-spring model [4] was proposed to simulate guidewire with a set of particles connected by rigid springs with a fixed length, but it was not able to simulate inherent bending guidewire. Alderliesten et al. [5] proposed a relatively accurate model. It is based on the principle of energy minimization and different optimization techniques were used to solve this model. Although it somehow guaranteed the accuracy and stability of simulation, real-time interaction of the method was unsatisfying even some approximate accelerating algorithms were used. Subsequently, an incremental finite beam element model [6,7] was introduced with an optimization scheme which used substructure decomposition to speed up the computation. Lenoir et al. [8] developed a simulator based on this method. By avoiding resolving the global stiffness matrix, it reduced the computational time significantly and made real-time interaction possible. However, the motion errors are also propagated incrementally and it is rather difficult to reduce the total error to an acceptable level. Lenoir et al. [9] suggested a one-dimensional dynamic spline model to model wire-like structures. This model, however, cannot present twisting although it can effectively simulated realistic bending effects of surgical threads.

Several recent approaches have been proposed to address the nonlinear deformation of guidewire. Duratti et al. [10] presented an interventional radiology system based on Cosserat rod model. Nevertheless, they just implemented the basic functionalities. Other non-Cosserat rod approaches include simulating a guidewire using graph-theoretical method based on the principle of minimal total potential energy [26] and a nonphysically based forward kinectmatics approach to predict the catheter's tip position but assume that the catheter bends with zero torsion and with constant curvature [24,25]. Tang et al. [11] have applied an implicit time integration method to Kirchhoff elastic rod model [12] for guidewire simulation similar to ours. A path planning method was proposed to fix the path of guidewire during its advancing. However, skills of manipulating the guidewires with various complex curved tips to reach a clinical target are significant in vascular intervention. In this case, if trainees cannot control the path of guidewire advancing, surgical skills cannot be well developed.

In this paper, we propose a robust and real-time vascular intervention simulation system to help trainees enhance operation skills. A physically-based hybrid modeling approach based on Kirchhoff elastic rod and inextensible constraint is developed, and it can realistically and interactively simulate the complex behaviors of guidewires and catheters. The long slender bodies of guidewire and catheter are simulated by using more efficient special case of naturally straight, isotropic Kirchhoff rods. The shorter flexible tip composed of straight or angled design is modeled using more complex generalized Kirchhoff rods. We derive the equations of motion for guidewire and catheter with continuous elastic energy and discretize these equations using a linear implicit scheme that guarantees stability and robustness. In addition, our system is further augmented by the force sensing device as input.


                     Fig. 1
                      shows the overview of the simulation system, which is composed of three parts: vascular modeling, guidewire simulation and visualization. The vascular model is based on segmented blood vessels from CT images, in which the aorta and coronary arteries are achieved via a semiautomatic algorithm [13]. Vascular model is fed into guidewire simulation for collision detection between guidewires and vessel walls. The guidewire is modeled based on the Kirchhoff elastic rod model and discretized as a set of nodes and edges for numerical solution. An implicit linear is proposed to solve this model to guarantee stability and robustness. The motion of trainees, including pushing, pulling and twisting, is captured by the motion sensors equipped in a customized hardware device and fed into the implicit integrator. Finally, the intervention simulation procedure is visualized in 3D vascular and X-ray images and the output force are fed back to the trainees.

The guidewires and catheters used in vascular intervention (for brevity, we use “guidewire” to represent “catheter” or “guidewire” hereafter) are modeled by thin, fixed centerlines. A centerline can bend but not stretch and it is surrounded by a finite, but thin, elastic material. It is a challenging task to realistically simulate the complicated behaviors of guidewires in an interactive manner.

The configuration of a guidewire with length L is described by an adapted framed curve Γ={γ; d
                        1,d
                        2,d
                        3} (see Fig. 2
                        ). Here γ(s,t) represents the rod's centerline curve, the material coordinate s
                        ϵ[0,L]along the centerline and time t. The material frame [d
                        1,d
                        2,d
                        3] is a right orthonormal basis attached to each mass point along the centerline, containing the requisite information for measuring bending and twisting of a guidewire. This material frame satisfies d
                        1(s,t)⊥d
                        2(s,t), d
                        1(s,t)⊥d
                        3(s,t), d
                        2(s,t)⊥d
                        3(s,t), 
                           
                              
                                 
                                    d
                                 
                                 1
                              
                              (
                              s
                              ,
                              t
                              )
                              =
                              (
                              
                                 γ
                                 ′
                              
                              (
                              s
                              ,
                              t
                              )
                              /
                              |
                              
                                 γ
                                 ′
                              
                              (
                              s
                              ,
                              t
                              )
                              |
                              )
                           
                        . The length of the spatial derivative |γ’(s)| indicates the stretch of the centerline γ(s). Without loss of generality, we assume the length of the rod to be 1. As a consequence, |γ’(s)|=1 if the rod is unstretched.

We formulate the elastic energy based on the Kirchhoff elastic rod [12]. However, because the geometric configurations and mechanical properties of the tip of a guidewire differs from those of the main slender body, it is unsuitable to apply the same simulation model throughout the whole guidewire, which is computationally inefficient especially since nonlinear deformation model suffers from real-time performance issues. By modeling the slender body of guidewire using a less expensive special case of naturally straight, isotropic Kirchhoff rods and employing the generalized Kirchhoff rods for flexible tip, our approach is computationally efficient. Based on the model of the guidewire, there are three main components of potential energy of a guidewire: bending energy E
                        
                           bend
                        (Γ), twisting energy E
                        
                           twist
                        (Γ) and stretch energy E
                        
                           stretch
                        (Γ).
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                                (
                                                Γ
                                                )
                                                =
                                                
                                                   E
                                                   
                                                      b
                                                      e
                                                      n
                                                      d
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                +
                                                
                                                   E
                                                   
                                                      t
                                                      w
                                                      i
                                                      s
                                                      t
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                +
                                                
                                                   E
                                                   
                                                      s
                                                      t
                                                      r
                                                      e
                                                      t
                                                      c
                                                      h
                                                   
                                                
                                                (
                                                Γ
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      b
                                                      e
                                                      n
                                                      d
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                =
                                                
                                                   1
                                                   2
                                                
                                                
                                                   ∫
                                                   L
                                                
                                                
                                                   
                                                      K
                                                      b
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            ω
                                                         
                                                         −
                                                         
                                                            
                                                               ω
                                                            
                                                            ¯
                                                         
                                                         )
                                                      
                                                      T
                                                   
                                                   (
                                                   
                                                      ω
                                                   
                                                   −
                                                   
                                                      
                                                         ω
                                                      
                                                      ¯
                                                   
                                                   )
                                                   d
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      t
                                                      w
                                                      i
                                                      s
                                                      t
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                =
                                                
                                                   1
                                                   2
                                                
                                                
                                                   ∫
                                                   L
                                                
                                                
                                                   
                                                      K
                                                      t
                                                   
                                                   
                                                      m
                                                      2
                                                   
                                                   d
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      s
                                                      t
                                                      r
                                                      e
                                                      t
                                                      c
                                                      h
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                =
                                                
                                                   1
                                                   2
                                                
                                                
                                                   ∫
                                                   L
                                                
                                                
                                                   
                                                      K
                                                      s
                                                   
                                                   
                                                      
                                                         (
                                                         |
                                                         
                                                            γ
                                                            ′
                                                         
                                                         (
                                                         s
                                                         )
                                                         |
                                                         −
                                                         1
                                                         )
                                                      
                                                      2
                                                   
                                                   d
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the 2-vector ω
                        =(ω
                        1,ω
                        2)
                           T
                        , ω
                        1
                        =
                        d’1·d
                        2, ω
                        2
                        =
                        d’1·d
                        3 represents the centerline curvature vector, 
                           
                              
                                 K
                                 b
                              
                              =
                              E
                              (
                              π
                              
                                 r
                                 2
                              
                              /
                              4
                              )
                           
                        , 
                           
                              
                                 K
                                 t
                              
                              =
                              G
                              (
                              π
                              
                                 r
                                 2
                              
                              /
                              2
                              )
                           
                        , 
                           
                              
                                 K
                                 s
                              
                              =
                              
                                 E
                                 s
                              
                              π
                              
                                 r
                                 2
                              
                           
                         
                        [14] with E denoting the flexural modulus governing the bending resistance, G denoting the shear modulus governing the torsional resistance, E
                        
                           s
                         denoting the stretching Young's modulus and r denoting the radius of the rod's cross section. Here, 
                           
                              
                                 ω
                              
                              ¯
                           
                         is the inherent curvature of guidewire and it equals to (0,0) for a naturally straight guidewire. The formula m
                        =
                        d’2·d
                        3 gives an expression for the guidewire's twisting. |γ’(s)| represents the stretch ratio of guidewire.

The continuous guidewire should be discretized for numeric solution. A spatially discrete centerline representation of the aforementioned continuous model is to divide γ(s) into n
                        +1 segments (see Fig. 3
                        ).

The slender body of the guidewire is simulated as a naturally straight isotropic rod. The elastic energy of the discrete guidewire's shaft can be formulated as [12]:
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      b
                                                      e
                                                      n
                                                      d
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                =
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         n
                                                      
                                                      
                                                         
                                                            K
                                                            b
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     κ
                                                                     
                                                                        b
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           l
                                                                           ¯
                                                                        
                                                                        i
                                                                     
                                                                     /
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                                
                                                   
                                                      
                                                         
                                                            l
                                                            ¯
                                                         
                                                         i
                                                      
                                                   
                                                   2
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      
                                                         
                                                            K
                                                            b
                                                         
                                                         
                                                            
                                                               (
                                                               κ
                                                               
                                                                  b
                                                                  i
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                               ¯
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      t
                                                      w
                                                      i
                                                      s
                                                      t
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                =
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      K
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  θ
                                                                  
                                                                     i
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  θ
                                                                  i
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                               ¯
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   
                                                      K
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                            i
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                               ¯
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      s
                                                      t
                                                      r
                                                      e
                                                      t
                                                      c
                                                      h
                                                   
                                                
                                                (
                                                Γ
                                                )
                                                =
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            0
                                                         
                                                         n
                                                      
                                                      
                                                         
                                                            K
                                                            s
                                                         
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                     
                                                                        e
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           e
                                                                           ¯
                                                                        
                                                                        i
                                                                     
                                                                  
                                                               
                                                               |
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where i represents segment index of guidewire after discretization, e
                        
                           i
                        
                        =
                        x
                        
                           i+1
                        −
                        x
                        
                           i
                        , 
                           
                              
                                 
                                    l
                                    ¯
                                 
                                 i
                              
                              =
                              |
                              
                                 
                                    
                                       e
                                    
                                    ¯
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              |
                              +
                              |
                              
                                 
                                    
                                       e
                                    
                                    ¯
                                 
                                 i
                              
                              |
                           
                        , x
                        
                           i
                         is the coordinate position of i th node, θ
                        
                           i
                         is the twisting angle of the ith mass point and the curvature binormal can be formulated as:
                           
                              (3)
                              
                                 
                                    κ
                                    
                                       
                                          b
                                       
                                       i
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ×
                                          
                                             
                                                e
                                             
                                             i
                                          
                                       
                                       
                                          |
                                          
                                             
                                                
                                                   e
                                                
                                                ¯
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          |
                                          |
                                          
                                             
                                                
                                                   e
                                                
                                                ¯
                                             
                                             i
                                          
                                          |
                                          +
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ⋅
                                          
                                             
                                                e
                                             
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The flexible tip of the guidewire is simulated as generalized Kirchhoff rod as having different mechanical properties to the shaft. Recall that for the generalized Kirchhoff rod bending response in formula (1), the bending energy of the discrete guidewire's tip is:
                           
                              (4)
                              
                                 
                                    
                                       E
                                       
                                          b
                                          e
                                          n
                                          d
                                       
                                    
                                    (
                                    Γ
                                    )
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                K
                                                b
                                             
                                             
                                                
                                                   
                                                      
                                                         κ
                                                         
                                                            
                                                               b
                                                            
                                                            i
                                                         
                                                         −
                                                         
                                                            
                                                               κ
                                                               
                                                                  
                                                                     b
                                                                  
                                                                  i
                                                               
                                                            
                                                            ¯
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                               ¯
                                                            
                                                            i
                                                         
                                                         /
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       2
                                    
                                    
                                       
                                          
                                             
                                                l
                                                ¯
                                             
                                             i
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        where the 2-vector 
                           
                              
                                 
                                    κ
                                    
                                       
                                          b
                                       
                                       i
                                    
                                 
                                 ¯
                              
                           
                         is the inherent curvature binormal of guidewire's tip.

As for the “inherent curvature binormal of the guidewire's tip 
                           
                              
                                 
                                    κ
                                    b
                                 
                                 ¯
                              
                              '
                              '
                           
                         mentioned in the energy formulation part, will be changed during guidewire's movement, we use a discrete parallel transport approach [12] to update the inherent curvature binormal of the guidewire's tip 
                           
                              
                                 
                                    κ
                                    b
                                 
                                 ¯
                              
                           
                        , resulting in a stable and fast simulation for protecting the inherent curvature of the guidewir's tip.

We define a rotation P
                        
                           i
                         about the curvature binormal, 
                           
                              
                                 P
                                 i
                              
                              (
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                              ,
                               
                              
                                 P
                                 i
                              
                              (
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ×
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                              )
                              =
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ×
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                           
                        . By Convention, P
                        
                           i
                         is the identity if 
                           
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                           
                        , whereas P
                        
                           i
                         is not defined if 
                           
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              =
                              −
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                           
                        . Discrete parallel transport is a key notion that allows us to update the inherent curvature binormal of the guidewire's tip during guidewire's movement (see Fig. 4
                        ). In order to update 
                           
                              
                                 
                                    κ
                                    
                                       b
                                    
                                 
                                 ¯
                              
                           
                        , we iteratively compute:
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      κ
                                                      
                                                         
                                                            b
                                                         
                                                         j
                                                         i
                                                      
                                                   
                                                   ¯
                                                
                                                =
                                                
                                                   P
                                                   i
                                                
                                                (
                                                
                                                   
                                                      κ
                                                      
                                                         
                                                            b
                                                         
                                                         j
                                                         
                                                            i
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   ¯
                                                
                                                )
                                             
                                          
                                          
                                             
                                                i
                                                ∈
                                                [
                                                1
                                                ,
                                                m
                                                ]
                                                ,
                                                 
                                                j
                                                ∈
                                                [
                                                m
                                                +
                                                1
                                                ,
                                                n
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      κ
                                                      
                                                         
                                                            b
                                                         
                                                         j
                                                         0
                                                      
                                                   
                                                   ¯
                                                
                                                =
                                                R
                                                (
                                                
                                                   
                                                      κ
                                                      
                                                         
                                                            b
                                                         
                                                         j
                                                      
                                                   
                                                   ¯
                                                
                                                )
                                             
                                          
                                          
                                              
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    κ
                                    
                                       
                                          b
                                       
                                       j
                                       i
                                    
                                 
                                 ¯
                              
                           
                         represents the jth inherent curvature of the guidewire's tip 
                           
                              
                                 
                                    κ
                                    
                                       
                                          b
                                       
                                       j
                                    
                                 
                                 ¯
                              
                           
                         after discrete parallel transport iteratively from 1 to i, m is the last node index of the slender body of the guidewire, n is the second node index of the flexible tip of the guidewire. P
                        
                           i
                         is a rotation operation with rotation axis 
                           
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ×
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                           
                         and angle 
                           
                              arc
                               
                              c
                              o
                              s
                               
                              (
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ⋅
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                              /
                              |
                              
                                 
                                    d
                                 
                                 1
                                 
                                    i
                                    −
                                    1
                                 
                              
                              |
                              |
                              
                                 
                                    d
                                 
                                 1
                                 i
                              
                              |
                              )
                           
                        . R is also a rotation operation with rotation axis e
                        0 and angle being the twisting angle (see Fig. 4).

In vascular intervention simulation, a guidewire often collides with interior vessel walls. To prevent the guidewire from penetrating through vessel walls, every collision must be detected at every time step, so that the reaction force can be computed as an external force. The bouding-volume hierarchy method (BVH) is an efficient collision detection algorithm, which can logarithmically reduce the time complexity. During the simulation we only update the deformation of the guidewire because the deformation of arteries is considered to be very small. Therefore, we enwrap the rod model volume with spheres and vessel walls with discrete orientation polytopes (k-dops) [15], the k value of the optimal execution performance is 18 in our simulation system.

There exist two classes of schemes to handle collisions of deformable objects. Penalty methods lack physical plausibleness, and this approach requires the definition of a stiffness constant k for each collision. Constraint methods are linear complementary problems that are solved by iterative methods. Thus, the resulting methods tend to be expensive or sensitive to numerical problems and require moreover effortful implementations [16]. We present a hybrid scheme that combines the accuracy and physical correctness of constraint methods with the simplicity and efficiency of penalty methods by applying an impulse force:
                           
                              (6)
                              
                                 
                                    
                                       
                                          F
                                       
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             m
                                             i
                                          
                                       
                                       
                                          
                                             Δ
                                          
                                          
                                             t
                                             2
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       K
                                    
                                    
                                       
                                          
                                             d
                                          
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                        
                     

where m
                        
                           i
                         represents mass of the mass points of guidewire, Δt is the time step, K is the max id of vascular triangles, 
                           
                              
                                 
                                    d
                                 
                                 i
                                 j
                              
                           
                         is the penetration depth that mass point i relatives to vascular triangle j.

The movement of guidewire is governed by its energy discussed in the part of energy formulation. The variational formulation results in the Lagrange equation of motion is 
                           
                              M
                              
                                 
                                    x
                                 
                                 ¨
                              
                              =
                              −
                              (
                              d
                              E
                              (
                              Γ
                              )
                              /
                              d
                              
                                 x
                              
                              )
                           
                        , where M is a 3(n
                        +2)×3(n
                        +2) (diagonal) mass matrix associated to centerline positions. We integrate the system with a linear implicit scheme [17] to guarantee stability and robustness of the system.
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Δ
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               Δ
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                      
                                                   
                                                
                                                =
                                                Δ
                                                t
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  v
                                                               
                                                               t
                                                            
                                                            +
                                                            
                                                               Δ
                                                            
                                                            
                                                               v
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               f
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               t
                                                            
                                                            +
                                                            
                                                               Δ
                                                            
                                                            
                                                               x
                                                            
                                                            ,
                                                            
                                                               
                                                                  v
                                                               
                                                               t
                                                            
                                                            +
                                                            
                                                               Δ
                                                            
                                                            
                                                               v
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   t
                                                
                                                +
                                                
                                                   Δ
                                                
                                                
                                                   x
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   t
                                                
                                                +
                                                
                                                   Δ
                                                
                                                
                                                   v
                                                
                                                )
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   t
                                                
                                                +
                                                
                                                   
                                                      ∂
                                                      
                                                         f
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                
                                                
                                                   x
                                                
                                                +
                                                
                                                   
                                                      ∂
                                                      
                                                         f
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         v
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ∂
                              
                                 f
                              
                              /
                              ∂
                              
                                 x
                              
                              ,
                               
                              ∂
                              
                                 f
                              
                              /
                              ∂
                              
                                 v
                              
                              ∈
                              
                                 ℜ
                                 
                                    3
                                    (
                                    n
                                    +
                                    2
                                    )
                                    ×
                                    3
                                    (
                                    n
                                    +
                                    2
                                    )
                                 
                              
                           
                         are the Jacobian matrices of the force with respect to positions and velocities, evaluated at (x
                        
                           t
                        ,v
                        
                           t
                        ). Due to the local connectivity structure of the guidewire, these are sparse matrices. We then solve the resulting linear system at each step
                           
                              (8)
                              
                                 
                                    A
                                    
                                       Δ
                                    
                                    
                                       v
                                    
                                    =
                                    
                                       b
                                    
                                 
                              
                           
                        
                     

where
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                                =
                                                
                                                   
                                                      I
                                                      −
                                                      
                                                         Δ
                                                      
                                                      t
                                                      
                                                         M
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            
                                                               f
                                                            
                                                         
                                                         
                                                            ∂
                                                            
                                                               v
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         Δ
                                                      
                                                      
                                                         t
                                                         2
                                                      
                                                      
                                                         M
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            
                                                               f
                                                            
                                                         
                                                         
                                                            ∂
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                b
                                                =
                                                
                                                   Δ
                                                
                                                t
                                                
                                                   M
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         t
                                                      
                                                      +
                                                      
                                                         Δ
                                                      
                                                      t
                                                      
                                                         
                                                            ∂
                                                            
                                                               f
                                                            
                                                         
                                                         
                                                            ∂
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         v
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The matrix A is a structured sparse matrix, because each node has nonzero entries for itself, back and forth; we use the PARDISO [18] solver to solve rapidly the linear system of equations.

Guidewires tend to bend or twist rather than stretch. However, stretch force alone is very difficult to avoid the stretch deformation of the guidewire. Therefore, we achieve very low strain by using the fast projection method after guidewire dynamic. Fast projection is a velocity filter that enforces constraints. It combines the robustness of using an implicit constraint direction with the efficiency of approximate manifold projection [19]. Formally, the (j
                        +1)th step of fast projection is:
                           
                              (10)
                              
                                 
                                    
                                       C
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       C
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       j
                                    
                                    +
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    )
                                    ≈
                                    
                                       C
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       j
                                    
                                    )
                                    +
                                    
                                       ∇
                                       
                                          
                                             x
                                             j
                                          
                                       
                                    
                                    
                                       C
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       j
                                    
                                    )
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    =
                                    −
                                    
                                       Δ
                                    
                                    
                                       t
                                       2
                                    
                                    
                                       M
                                       
                                          −
                                          1
                                       
                                    
                                    ∇
                                    
                                       C
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             j
                                          
                                          )
                                       
                                       T
                                    
                                    δ
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

Substituting (10) into (11), we eliminate δ
                        x
                        
                           j+1 and solve a linear system in δ
                        λ
                        
                           j+1:
                           
                              (12)
                              
                                 
                                    Δ
                                    
                                       t
                                       2
                                    
                                    (
                                    ∇
                                    
                                       C
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       j
                                    
                                    )
                                    
                                       M
                                       
                                          −
                                          1
                                       
                                    
                                    ∇
                                    
                                       C
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             j
                                          
                                          )
                                       
                                       T
                                    
                                    )
                                    δ
                                    
                                       
                                          λ
                                       
                                       j
                                    
                                    =
                                    
                                       C
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       j
                                    
                                    )
                                 
                              
                           
                        where C(x
                        
                           j
                        ) is a (n
                        +1)-vector, the ith element of this vector is 
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       j
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       j
                                       i
                                    
                                    )
                                 
                                 T
                              
                              (
                              
                                 
                                    x
                                 
                                 j
                                 
                                    i
                                    +
                                    1
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 j
                                 i
                              
                              )
                              −
                              |
                              
                                 
                                    
                                       e
                                    
                                    ¯
                                 
                                 i
                              
                              
                                 |
                                 2
                              
                           
                        . ▿C(x
                        
                           j
                        ) is the gradient of C(x
                        
                           j
                        ) with respect to x
                        
                           j
                        , which can be considered as constraint force to the guidewire. δ
                        x
                        
                           j+1 is the displacement caused by the constraint force, λ
                        
                           j
                         is a (n
                        −1)-vector need to be determined. The matrix 
                           
                              
                                 Δ
                              
                              
                                 t
                                 2
                              
                              (
                              ∇
                              
                                 C
                              
                              (
                              
                                 
                                    x
                                 
                                 j
                              
                              )
                              
                                 M
                                 
                                    −
                                    1
                                 
                              
                              ∇
                              
                                 C
                              
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       j
                                    
                                    )
                                 
                                 T
                              
                              )
                              ∈
                              
                                 ℜ
                                 
                                    (
                                    n
                                    +
                                    1
                                    )
                                    ×
                                    (
                                    n
                                    +
                                    1
                                    )
                                 
                              
                           
                         is also a structured sparse matrix; the PARDISO solver can similarly provide help for solving the linear system of equations.

The blood vessel structure could be extremely complex. A constant interval between the sample points on the guidewire may lead to less accurate simulation or unreasonable computational time due to the different curvature. In order to maintain the real-time simulation speed and enable the guidewire's sampling resolution fit as closely as possible to the blood vessel structure, we design an adaptive sampling strategy that dynamically modifies the discrete setting of the guidewire according to the shape of the guidewire during the insertion.

The adaptive sampling strategy splits the edges of the guidewire into smaller ones when the curvature of the guidewire is large but these edges’ length is not small enough to describe the guidewire behavior more precisely. On the other hand, merge small edges of the guidewire into larger ones to reduce computation when the curvature of the guidewire is small. More detailed principle of the adaptive sampling is shown in Fig. 5
                        .

We developed and tested our simulation system on a PC with Intel(R) Xeon(R) E3-1230 V2 3.3GHz CPU, 4G memory and an Nvidia GeForce GTX 760 GPU. A customized hardware device was equipped for motion sensing and force feedback in order to enhance immersive feeling within arterial vessels. A snapshot of the whole system is shown in Fig. 6
                     . We performed a series of experiments to evaluate the robustness and effectiveness of the proposed guidewire simulation method as well as the system.

During the vascular intervention surgery, different shaped guidewires were selected at different cases. Therefore, our proposed guidewire simulation method should handle various tipped guidewire composed of straight or curved design for further simulator's scalability. Fig. 7
                         illustrates the simulation results of the guidewire of various shapes being inserted into the blood vessel.

We conducted an experiment to evaluate the effectiveness of adaptive sampling. As adaptive sampling has obvious advantages in complicated vascular structure, the coronary artery was used as the experimental subject. We compared the behavior of adaptive guidewire whose edge length was between 0.5mm and 1.5mm, with two uniformly sampled resolution guidewires with an edge length of 0.5mm and 0.8mm respectively. As shown in Fig. 8
                        , the adaptive guidewire can achieve almost identical accuracy with the uniformly sampled high-resolution guidewire, whereas the adaptive guidewire is almost twice as efficient as the high-resolution guidewire. The results of experiment reveal that adaptive sampling of the guidewire model can achieve both high simulation efficiency and accuracy.

The percutaneous coronary intervention was considered as a typical example to evaluate the robustness of our system. We inserted the guidewires and catheters from the femoral artery into the aortic arch to reach the left stenosis coronary artery, then stent was placed at coronary stenosis by balloon catheter inflation. Fig. 9
                         shows the total percutaneous coronary intervention simulation procedure.

Real-time haptic feedback to users is essential to the intervention simulation system. In our intervention simulator, after detecting collisions between vessel walls and guidewires, a continuous response force needs to be computed and provided to the trainee with haptic devices. The haptic feedback is composed of contact force and twist force. The contact force is mainly marked when the guidewire or cathether are pushed and pulled, whereas the twist force is mainly marked when the guidewire or cathether are twisted. The contact force is generated by formula (6) and the twist force can be calculated by making derivation for E
                        
                           twist
                        (Γ) in formula (2). In this experiment we demonstrate that our system can provide accurate and continuous haptic feedback in real-time. In the haptic feedback test, we simulated the percutaneous coronary intervention procedure and recorded the resulting feedback force as a function of the insertion length of guidewires. Fig. 10
                         illustrates the haptic feedback with different guidewire parameters and manipulation inputs. When the guidewire was constantly pushed by the trainee, the minimum insertion velocity had the minimum haptic feedback (Chart A in Fig. 10) and the maximum bend modulus had the maximum haptic feedback (Chart B in Fig. 10). When the guidewire was twisted by the trainee, the larger shear modulus and twisting angle had the larger haptic feedback (Chart C in Fig. 10). Furthermore, various tipped guidewire would produce different haptic feedback of guidewire tip. As illustrated in Chart D in Fig. 10, the haptic feedback of guidewire tip with the angled shape and semicircle shape were obviously lower than the haptic feedback of guidewire tip with straight shape. The results of experiment proved that the angled tipped guidewire and semicircle tipped guidewire can decrease the risk of vessel walls being pierced.

Our simulation system has been demonstrated to be physically accurate and robust. More importantly, it has to be also efficient to run in real-time. Table 1
                         summarizes the computational time for handing collision, inextensible constraints, adaptive sampling, physics computation and rending with different number of nodes. Experiment demonstrates that our system's time complexity is linear with respect to number of nodes yet the simulation is easily achieved in real-time at 75fps.

To evaluate the clinical training values of our simulation system, experiments have been conducted based on the percutaneous coronary intervention procedure. We evaluated the performance of trainees based on the metrics of completion time, which was directly related to the total radiation exposure during the procedure. The less completion time, the better the performance is.

We invited 10 medical school students and 3 experienced interventionists to participate in the experiments. The students did not experienced vascular intervention surgery and they had no contact with our simulator before the experiments. They were divided into two groups A and B with 5 students each. The 3 experienced interventionists formed the third group C. First, all students of Group B were asked to finish the training 20 times by using our system. After that, all participants in 3 groups were asked to complete the task in the real environment, in which a vascular phantom and real catheters and guidewires were used. Meanwhile, trainees in Group A and Group C were asked to complete the task in the real environment directly without pre-training. For all the 3 groups, each trainee was asked to repeat the task 10 times and we recorded completion time each time. We then analyzed the experimental results to evaluate if the training on our system can contribute to improvement of vascular intervention skills.


                        Fig. 11
                         shows the evaluation results of Group A, Group B and Group C in the real training environment, where Group B demonstrated better performance than Group A and completed the task in less than 30s. It was also observed that Group C had better performance than Group B in every training, but the difference of timing performance between Group B and Group C was small. This experiment shows that our simulator is able to improve vascular intervention skills.

@&#DISCUSSION AND CONCLUSION@&#

A VR based simulation system has been proposed and developed for vascular intervention training. It focuses on the training of steering the guidewires and catheters to reach a clinical target through blood vessels. The simulation results show the percutaneous coronary intervention simulation procedure can be carried out without difficulty using our method. Furthermore, our method can handle various tipped guidewire and will produce different haptic feedback in real-time interaction. As for other existing method, they mainly used the mass-spring model [4], energy minimization model [5] and finite element model [6,7]. Compared with the mass-spring model, our method can be more realistic since it is more physically plausible in algorithm principle. Energy minimization model and finite element model are relatively accurate, but they hardly satisfy real-time interaction even using some approximate accelerating algorithms.

There still remain some future improvements. Our model neglects the influence of the blood flow inside arteries, whereas the blood flow may increase the difficulty of reaching a desirable subbranch artery. The measurement of the difference between the real manipulation of the guidewire and the simulation results must be carried out before clinical application. However, as this paper presented a pilot research, it could only be visually checked by interventionist that simulation results is realistic compared with the real behavior of guidewire and catheter. The measurement will be implemented in our future work. After quantitative evaluation, the system could train residents the whole surgical procedure with force feedback and an immersive virtual reality environment.

@&#ACKNOWLEDGMENT@&#

This research work is partially supported by the Chinese NSFC research fund (61190120, 61190124 and 61271318).

@&#REFERENCES@&#

