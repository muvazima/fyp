@&#MAIN-TITLE@&#Interactive design exploration for constrained meshes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A general optimization framework for deforming meshes under constraints.


                        
                        
                           
                           Soft constraints and hard constraints are handled in a unified way.


                        
                        
                           
                           An efficient parallel solver suitable for interactive applications.


                        
                        
                           
                           A system for exploring the feasible shapes of constrained meshes in real time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Architectural geometry

Design exploration

Fabrication-aware design

Constraint-based modeling

@&#ABSTRACT@&#


               
               
                  In architectural design, surface shapes are commonly subject to geometric constraints imposed by material, fabrication or assembly. Rationalization algorithms can convert a freeform design into a form feasible for production, but often require design modifications that might not comply with the design intent. In addition, they only offer limited support for exploring alternative feasible shapes, due to the high complexity of the optimization algorithm.
                  We address these shortcomings and present a computational framework for interactive shape exploration of discrete geometric structures in the context of freeform architectural design. Our method is formulated as a mesh optimization subject to shape constraints. Our formulation can enforce soft constraints and hard constraints at the same time, and handles equality constraints and inequality constraints in a unified way. We propose a novel numerical solver that splits the optimization into a sequence of simple subproblems that can be solved efficiently and accurately.
                  Based on this algorithm, we develop a system that allows the user to explore designs satisfying geometric constraints. Our system offers full control over the exploration process, by providing direct access to the specification of the design space. At the same time, the complexity of the underlying optimization is hidden from the user, who communicates with the system through intuitive interfaces.
               
            

@&#INTRODUCTION@&#

Digital tools have become ubiquitous in the architectural design process. For freeform architecture in particular, proper mathematical models, efficient geometry processing algorithms, and interactive shape editing software are essential for effective design. These tools provide great flexibility in creating complex architectural designs, but offer limited support for incorporating constraints imposed by material, fabrication, or assembly. One example is building with planar quadrilateral panels, which are popular for cost-effective realization of freeform structures with glass panels. In such a construction, the distance between the two diagonals of a panel needs to be smaller than a certain threshold to avoid large internal bending stress  [1,2]. These constraints are difficult to control manually and typically require a separate rationalization process that maps the design to physical production. Rationalization needs to negotiate between physical constraints and design intent, often triggering several iterations to enable real-world fabrication of the digital design. This time-consuming process can lead to suboptimal designs or a significant increase in overall cost.

In this paper, we propose a new approach to geometric form finding and design that takes the constraints into account. Given a set of soft constraints and hard constraints, our approach enables the user to explore the space of shapes that satisfy the hard constraints exactly, and the soft constraints as much as possible. By integrating constraints into the design process, our approach yields designs that can be more effectively rationalized with respect to a given construction approach, thus avoiding unnecessary design iterations or suboptimal design solutions.

In our system, a typical design session proceeds as follows (Fig. 1
                     ): first, an initial specification of constraints is provided by the designer. Starting from some initial shape, the user can then freely navigate feasible shapes by directly interacting with the current design. Our optimization algorithm computes a new design that stays within the constraint space, thus satisfying the geometric requirements imposed by the design rationale. This new design provides realtime visual feedback according to the user input, enabling effective exploration of design alternatives. The user can also alter the shape space by introducing new constraints, or by modifying or removing existing constraints. The design is automatically updated to remain in the new shape space. Such flexibility allows the user to test different rationalization options easily.

@&#RELATED WORK@&#

Computational methods for architectural design have become increasingly popular in recent years  [3,4]. With a focus on physical production, various rationalization algorithms have been proposed for many geometric goals such as: planar mesh optimization [5–11], multi-layer structures  [12], single-curved panels  [13], straight panels  [14,15], double-curved panels  [16,17], ruled panels  [18,19], circle and sphere packings  [20], circular arc structures  [21], point-folding structures  [22] and functional webs  [23]. These methods typically take a given freeform surface as input and compute a surface decomposition that relates to a physical layout of panels. Usually such rationalization methods allow some deviation from the input reference surface to improve the quality of the paneling. They do not, however, support interactive exploration of the design alternatives.

Integrating rationalization methods into existing shape editing tools is typically not a viable option, since these algorithms often require minutes or sometimes hours to compute a solution, thus preventing an interactive shape exploration process. Therefore, research efforts have focused on alternative approaches.

Geometric shape spaces have recently become popular as a tool for design exploration. One common interpretation of a shape space is a restriction of the space of all free parameters of a design. For example, Kilian et al.  [24] represented a triangle mesh as a point in a high-dimensional space that treats each vertex coordinate as a free variable. They defined suitable Riemannian metrics on this space to restrict the embedding of the mesh to nearly isometric deformations of a given input surface. This allows exploring the manifold of shapes that approximately preserve lengths.

The method by Yang et al.  [2] introduced a shape exploration tool for constrained meshes. They compute a local approximant of a high-dimensional constrained shape manifold, which the user can navigate efficiently. Based on this work, Zhao et al.  [25] developed a guided exploration tool for the local approximant by automatically sampling new shapes. For these approaches, the generated shapes only satisfy the constraints approximately, and the constraint violation may exceed the tolerance for large deformations. Thus it is usually necessary to project the new mesh onto the constrained shape manifold to obtain feasible results. Compared to these methods, our system directly computes new shapes that satisfy all hard constraints, without the need for projection.

Vaxman  [26] introduced a method for deforming polyhedral meshes while preserving the planarity of faces. In this method, a new mesh is computed by applying affine transformations to the faces of the old mesh. Poranne et al.  [27] provided a characterization of maximal linear subspaces within the manifold of polyhedral surfaces, allowing shape exploration in a larger space than  [26]. For meshes with general shape constraints, Bouaziz et al.  [28] proposed a framework for imposing constraints to mesh elements. To solve the corresponding least squares optimization problem, they employ an alternating minimization approach to decompose the original problem into a sequence of simple subproblems. Similarly, Poranne et al.  [29] combined alternating least squares and penalty method to planarize polygonal meshes. Both  [28] and  [29] enforce shape constraints using penalty methods, so they handle soft constraints only. Deng et al.  [30] presented a constrained optimization approach to compute and explore local modifications for constrained meshes. Using an augmented Lagrangian solver, they computed new shapes that satisfy all constraints exactly, enabling the method to enforce hard constraints.

Our work deals with similar problems as  [28], namely optimization and deformation of meshes subject to shape constraints. Unlike  [28] and  [29] which enforce soft constraints only, and  [30] which only handles hard constraints, we allow both soft constraints and hard constraints at the same time, by unifying the approaches in  [28] and  [30]. The new mesh shape is computed by constrained optimization, where the soft constraints contribute to the objective function. By introducing auxiliary variables, we convert the problem into one with separable objective function and linear side constraints, which is solved using an augmented Lagrangian solver. The special structure of the problem allows us to decompose the solver into a set of simple subproblems. Each subproblem is either evaluating a proximal operator  [31,32], or solving a sparse symmetric positive definite linear system, both of which can be done efficiently. We implement the method on GPU to gain significant speedup from parallelism, which allows interactive exploration of the shape space. Our contribution includes: 
                           
                              •
                              a unified formulation of equivalent conditions for shape constraints, equipped with proximal operators with intuitive geometric meanings;

a general shape optimization framework that enforces both soft constraints and hard constraints, with an augmented Lagrangian solver consisting of simple subproblems that can be efficiently solved. Our solver outperforms the commonly used interior point method for interactive applications.

The paper is organized as follows. Section  2 presents the formulation of the optimization problem. Section  3 provides an efficient numerical solver, based on which a constrained shape exploration system is proposed in Section  4. Examples are given in Section  5 for design exploration using this system, followed by further discussion and conclusion in Section  6.

We focus in this work on polygonal meshes as construction-aware representations for freeform architectural surfaces. For example, such a mesh represents panels as faces  [5], or represents curve elements as edge polylines  [23]. Typically, the mesh is subject to a set of shape constraints related to fabrication or aesthetics. For a mesh with 
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                         vertices 
                           
                              {
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ∣
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    n
                                 
                                 
                                    v
                                 
                              
                              }
                           
                         and fixed connectivity, we represent its shape using a vector 
                           
                              p
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         is the position of vertex 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        . In this paper, we consider constraints that can be represented as equality or inequality conditions about the vertex positions. Namely, each constraint has one of the following forms 
                           
                              
                                 
                                    
                                       
                                          Equality constraint:
                                       
                                       
                                          
                                             f
                                          
                                          
                                             (
                                             
                                                p
                                             
                                             )
                                          
                                          =
                                          
                                             0
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          Inequality constraint:
                                       
                                       
                                          
                                             a
                                          
                                          ≤
                                          
                                             g
                                          
                                          
                                             (
                                             
                                                p
                                             
                                             )
                                          
                                          ≤
                                          
                                             b
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              f
                           
                        , 
                           
                              g
                           
                         are vector-valued functions. A constraint involving 
                           m
                         vertices 
                           
                              
                                 v
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        , whether equality or inequality, can always be represented as 
                           
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                                 ∈
                                 C
                                 .
                              
                           
                         Here matrix 
                           
                              M
                           
                         collects all the involved vertex positions into a vector 
                           
                              (1)
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         and 
                           C
                         is the feasible set for this vector. If a constraint is translation-invariant (i.e., applying a common translation to all involved vertices does not change the status of constraint satisfaction), it can also be represented using one of the following forms of 
                           
                              M
                           
                        : 
                           
                              (2)
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         or 
                           
                              (3)
                              
                                 
                                    M
                                 
                                 
                                    p
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 .
                              
                           
                        
                     


                        
                           Remark
                           Forms (2) and (3) for constraint representation were used in  [28] and  [30] respectively. Compared to the “näive” form (1), they usually lead to faster convergence of alternating minimization solvers (see  [28] for a detailed discussion).

Depending on the importance of each constraint, a designer may want to strictly enforce some constraints, while allowing others to be slightly violated. Therefore, we distinguish two types of constraints: 
                                 
                                    •
                                    
                                       Hard constraints are conditions that need to be satisfied exactly. For example, panel shapes may need to satisfy the constraints imposed by the chosen fabrication technology and construction material.


                                       Soft constraints are criteria that we would like the mesh to meet, but they are allowed to be violated if they conflict with other conditions. For example, the designer may want mesh faces to be regular polygons, in order to achieve more aesthetic shapes. But this condition can be relaxed for the mesh to have more degrees of freedom in its shape.

Assume that we are given 
                           
                              
                                 N
                              
                              
                                 
                                    h
                                 
                              
                           
                         hard constraints 
                           
                              {
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    
                                       h
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 p
                              
                              ∈
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                              ∣
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    
                                       h
                                    
                                 
                              
                              }
                           
                         and 
                           
                              
                                 N
                              
                              
                                 
                                    s
                                 
                              
                           
                         soft constraints 
                           
                              {
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    
                                       s
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 p
                              
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    j
                                 
                              
                              ∣
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    
                                       s
                                    
                                 
                              
                              }
                           
                         for the mesh shape. Starting from an initial mesh, we provide a system where the user can explore other feasible mesh shapes with the same connectivity. In this system, the user first chooses a set of vertices as handles and specifies their target positions in the new shape. A new mesh is computed based on the following criteria: 
                           
                              •
                              The handle vertices are close to their target positions.

The new mesh has a small value of fairness energy.

All hard constraints are satisfied exactly.

The soft constraints are satisfied as much as possible.

The non-handle vertices are close to their initial positions.

This optimization problem (4) usually involves a large number of nonconvex nonlinear constraints and is difficult to solve efficiently. To achieve interactive results, we employ a strategy similar to  [30]: first we introduce a set of auxiliary variables with additional constraints to convert (4) into a problem with separable target function and linear side constraints; the converted problem is then solved using an augmented Lagrangian method  [33]. Similar to  [30], the special structure of this problem enables us to decompose the solver into a set of simple subproblems, which can be solved in parallel to gain significant speedup. This section explains our method in detail.

First for each soft constraint 
                           
                              
                                 
                                    M
                                 
                              
                              
                                 
                                    s
                                 
                              
                              
                                 j
                              
                           
                           
                              p
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                        , we introduce auxiliary variables 
                           
                              
                                 
                                    s
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         to write its violation measure as 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          soft
                                       
                                    
                                    
                                       
                                          (
                                          j
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   s
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             p
                                          
                                          −
                                          
                                             
                                                
                                                   s
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         Next for each hard constraint 
                           
                              
                                 
                                    M
                                 
                              
                              
                                 
                                    h
                                 
                              
                              
                                 i
                              
                           
                           
                              p
                           
                           ∈
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        , we introduce auxiliary variables 
                           
                              
                                 
                                    h
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                         to rewrite the condition as 
                           
                              
                                 
                                    M
                                 
                              
                              
                                 
                                    h
                                 
                              
                              
                                 i
                              
                           
                           
                              p
                           
                           =
                           
                              
                                 
                                    h
                                 
                              
                              
                                 i
                              
                           
                        . Using the function definitions in Section  2, and incorporating new variables 
                           
                              h
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             h
                                          
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             h
                                          
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   h
                                                
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                         and 
                           
                              s
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             s
                                          
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             s
                                          
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                        , we derive the following equivalent problem 
                           
                              
                                 (5)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             p
                                          
                                          ,
                                          
                                             h
                                          
                                          ,
                                          
                                             s
                                          
                                       
                                    
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                D
                                             
                                             
                                                p
                                             
                                             −
                                             
                                                r
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                
                                                   f
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                L
                                             
                                             
                                                (
                                                
                                                   p
                                                
                                                −
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                
                                                   s
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                p
                                             
                                             −
                                             
                                                
                                                   
                                                      s
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   s
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                h
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       s.t.
                                    
                                    
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          
                                             h
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       p
                                    
                                    =
                                    
                                       
                                          
                                             h
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          
                                             h
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 
                                    D
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                          
                                       
                                       
                                          
                                          
                                             ⋱
                                          
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                                 
                                 
                                    r
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 
                                    I
                                 
                              
                              
                                 3
                              
                           
                         being the 3×3 identity matrix, and 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         
                                                            h
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                if
                                             
                                             
                                             i
                                             ∈
                                             Γ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                otherwise
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                if
                                             
                                             
                                             i
                                             ∈
                                             Γ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                otherwise
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 
                                 for  
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                                 .
                              
                           
                         Indicator functions 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       h
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         ensure 
                           
                              
                                 
                                    s
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 H
                              
                              
                                 i
                              
                           
                        , respectively 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             s
                                          
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             +
                                             ∞
                                          
                                          
                                             o
                                             t
                                             h
                                             e
                                             r
                                             w
                                             i
                                             s
                                             e
                                             ,
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             h
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   H
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             +
                                             ∞
                                          
                                          
                                             otherwise .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           Remark
                           In this formulation, auxiliary variables from different constraints are independent from each other. If a vertex is involved in multiple constraints, it will induce different auxiliary variables in each constraint. As a result, there can be a large number of auxiliary variables. This seemingly redundant formulation is actually the key to high efficiency, as it splits the target function into separable terms that can be handled in parallel (see the next section for details).

In optimization problem (5), let the target function be denoted by 
                           F
                           
                              (
                              
                                 p
                              
                              ,
                              
                                 h
                              
                              ,
                              
                                 s
                              
                              )
                           
                        , and the violation of side constraints be denoted by 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              
                                 p
                              
                              ,
                              
                                 h
                              
                              )
                           
                           =
                           
                              
                                 
                                    M
                                 
                              
                              
                                 
                                    h
                                 
                              
                              
                                 i
                              
                           
                           
                              p
                           
                           −
                           
                              
                                 
                                    h
                                 
                              
                              
                                 i
                              
                           
                        . The augmented Lagrangian method solves (5) by searching for a saddle point of the augmented Lagrangian function
                        
                           
                              
                                 L
                                 
                                    (
                                    
                                       p
                                    
                                    ,
                                    
                                       h
                                    
                                    ,
                                    
                                       s
                                    
                                    ,
                                    
                                       λ
                                    
                                    ;
                                    μ
                                    )
                                 
                                 =
                                 F
                                 
                                    (
                                    
                                       p
                                    
                                    ,
                                    
                                       h
                                    
                                    ,
                                    
                                       s
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             
                                                h
                                             
                                          
                                       
                                    
                                 
                                 
                                    [
                                    
                                       
                                          
                                             λ
                                          
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          p
                                       
                                       ,
                                       
                                          h
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                
                                                   p
                                                
                                                ,
                                                
                                                   h
                                                
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         Here 
                           
                              
                                 
                                    λ
                                 
                              
                              
                                 i
                              
                           
                         are Lagrangian multiplier vectors, which together form the dual variable 
                        
                           
                              λ
                           
                           =
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             λ
                                          
                                       
                                       
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             λ
                                          
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   h
                                                
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ]
                                 
                              
                              
                                 T
                              
                           
                        . 
                           
                              p
                           
                           ,
                           
                              h
                           
                         and 
                           
                              s
                           
                         are called the primal variables, and 
                           μ
                           >
                           0
                         is a penalty parameter. Our solver iteratively updates 
                           
                              p
                           
                           ,
                           
                              h
                           
                           ,
                           
                              s
                           
                           ,
                           
                              λ
                           
                         and 
                           μ
                         until convergence. In each iteration, new values 
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    ̂
                                 
                              
                              ,
                              
                                 
                                    
                                       h
                                    
                                 
                                 
                                    ̂
                                 
                              
                              ,
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    ̂
                                 
                              
                              ,
                              
                                 
                                    
                                       λ
                                    
                                 
                                 
                                    ̂
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    ̂
                                 
                              
                              )
                           
                         are computed from current values 
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    
                                       h
                                    
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    
                                       s
                                    
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    
                                       λ
                                    
                                 
                                 ¯
                              
                              ,
                              
                                 
                                    μ
                                 
                                 ¯
                              
                              )
                           
                         using the following steps: 
                           
                              1.
                              
                                 Primal update: 
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                h
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             argmin
                                          
                                       
                                       
                                          
                                             p
                                          
                                          ,
                                          
                                             h
                                          
                                          ,
                                          
                                             s
                                          
                                       
                                    
                                    L
                                    
                                       (
                                       
                                          p
                                       
                                       ,
                                       
                                          h
                                       
                                       ,
                                       
                                          s
                                       
                                       ,
                                       
                                          
                                             
                                                λ
                                             
                                          
                                          ¯
                                       
                                       ;
                                       
                                          
                                             μ
                                          
                                          ¯
                                       
                                       )
                                    
                                 .


                                 Dual update: 
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                             
                                             ¯
                                          
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          μ
                                       
                                       ¯
                                    
                                    
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                h
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                       )
                                    
                                 , 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          
                                             h
                                          
                                       
                                    
                                 .


                                 Penalty update: choose 
                                    
                                       
                                          μ
                                       
                                       
                                          ̂
                                       
                                    
                                    ≥
                                    
                                       
                                          μ
                                       
                                       ¯
                                    
                                 .

The primal update minimizes a function of primal variables 
                              
                                 
                                    L
                                 
                                 
                                    ̂
                                 
                              
                              
                                 (
                                 
                                    p
                                 
                                 ,
                                 
                                    h
                                 
                                 ,
                                 
                                    s
                                 
                                 )
                              
                              =
                              L
                              
                                 (
                                 
                                    p
                                 
                                 ,
                                 
                                    h
                                 
                                 ,
                                 
                                    s
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    ¯
                                 
                                 ;
                                 
                                    
                                       μ
                                    
                                    ¯
                                 
                                 )
                              
                           . For this we employ an alternating minimization strategy: starting from initial values 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       p
                                    
                                 
                                 ¯
                              
                           , 
                              
                                 
                                    
                                       h
                                    
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       h
                                    
                                 
                                 ¯
                              
                           , 
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    
                                       (
                                       0
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       s
                                    
                                 
                                 ¯
                              
                           , we iteratively perform the following updates until convergence: 
                              
                                 1.
                                 Fix 
                                       
                                          p
                                       
                                    , update 
                                       
                                          h
                                       
                                    , 
                                       
                                          s
                                       
                                    : 
                                       
                                          (
                                          
                                             
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                argmin
                                             
                                          
                                          
                                             
                                                h
                                             
                                             ,
                                             
                                                s
                                             
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             ̂
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                             h
                                          
                                          ,
                                          
                                             s
                                          
                                          )
                                       
                                    .

Fix 
                                       
                                          h
                                       
                                    , 
                                       
                                          s
                                       
                                    , update 
                                       
                                          p
                                       
                                    : 
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             
                                                (
                                                k
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                argmin
                                             
                                          
                                          
                                             
                                                p
                                             
                                          
                                       
                                       
                                          
                                             L
                                          
                                          
                                             ̂
                                          
                                       
                                       
                                          (
                                          
                                             p
                                          
                                          ,
                                          
                                             
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   s
                                                
                                             
                                             
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                    .

This problem is separable with respect to the auxiliary variables for each constraint. Thus we have independent subproblems that can be solved in parallel (superscript counters are ignored to simplify notations), 
                                 
                                    
                                       (6)
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            h
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                         
                                                         
                                                            
                                                               h
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         p
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     λ
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            μ
                                                         
                                                      
                                                      )
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      h
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   h
                                                
                                             
                                          
                                          ,
                                       
                                    
                                    
                                       (7)
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      p
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      s
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          .
                                          
                                          j
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                
                                                   s
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                               Geometrically, the solutions are the Euclidean projections of 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       
                                          h
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    p
                                 
                                 +
                                 
                                    
                                       
                                          λ
                                       
                                    
                                    
                                       k
                                    
                                 
                                 /
                                 μ
                               and 
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       
                                          s
                                       
                                    
                                    
                                       j
                                    
                                 
                                 
                                    p
                                 
                               onto feasible sets 
                                 
                                    
                                       H
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       S
                                    
                                    
                                       j
                                    
                                 
                               respectively, which can be computed efficiently for many shape constraints (see Section  3.3).

This is equivalent to 
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                p
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   D
                                                
                                                
                                                   p
                                                
                                                −
                                                
                                                   r
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             
                                                f
                                             
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   L
                                                
                                                
                                                   (
                                                   
                                                      p
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   p
                                                
                                                −
                                                
                                                   
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       μ
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   p
                                                
                                                −
                                                
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                    
                                 
                               which reduces to solving a symmetric positive definite sparse linear system 
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   D
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             D
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                
                                                   f
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             L
                                          
                                          +
                                          μ
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                      
                                                         
                                                            h
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   h
                                                
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                j
                                             
                                             
                                                
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   s
                                                
                                             
                                             
                                                j
                                             
                                          
                                          ]
                                       
                                       
                                          p
                                       
                                       =
                                       
                                          
                                             
                                                D
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          r
                                       
                                       +
                                       
                                          
                                             w
                                          
                                          
                                             
                                                f
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          L
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       μ
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   h
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                μ
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                          
                                             
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                s
                                             
                                          
                                          
                                             j
                                          
                                       
                                       .
                                    
                                 
                              
                           

Our solver can easily be adapted to different types of shape constraints. The only difference is the solution to the primal update subproblem for auxiliary variables, which has a general form 
                           
                              (8)
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          y
                                       
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             y
                                          
                                          −
                                          
                                             x
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       σ
                                    
                                    
                                       C
                                    
                                 
                                 
                                    (
                                    
                                       y
                                    
                                    )
                                 
                                 .
                              
                           
                         Its solution is the so-called proximal operator for indicator function 
                           
                              
                                 σ
                              
                              
                                 C
                              
                           
                           [32]. Geometrically, it is the Euclidean projection of 
                           
                              x
                           
                         onto feasible set 
                           C
                        , which means moving 
                           
                              x
                           
                         by the least amount to satisfy the constraint.

In Section  3.1, we introduce auxiliary variables to convert the original optimization problem. This is an instance of a numerical optimization strategy called variable splitting   [34]. Proximal operators together with variable splitting play an important role in numerical optimization, since they provide simple separable reformulations of the optimization problems. Such reformulations can easily be parallelized and enable efficient solutions to many problems that are otherwise difficult to solve  [31,32]. Our method is most useful when the proximal operators can be efficiently evaluated, which is indeed the case for many shape constraints relevant to architectural design and fabrication  [28]. In the following sections, we present some proximal operators that are used in this paper.

When realizing freeform shapes using planar quadrilateral glass panels, a certain tolerance is usually allowed for the violation of planarity. Such violation is measured using the distance between the two diagonal lines of the quad, leading to the following fabrication constraint for each quad face with vertex positions 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                           , 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                              [2] (see Fig. 3) 
                              
                                 (9)
                                 
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   4
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ≤
                                    ϵ
                                    ,
                                 
                              
                            where 
                              D
                              
                                 (
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 )
                              
                            is the distance between diagonal lines 
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 ¯
                              
                           , 
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                 
                                 ¯
                              
                           , and 
                              ϵ
                              >
                              0
                            is a tolerance value. Since this constraint is translation-invariant, we can represent it as in the form of (2)
                           
                              
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ∈
                                    C
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       m
                                    
                                 
                                 
                                    
                                       p
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           , and 
                              C
                              =
                              
                                 {
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                1
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                2
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                3
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                4
                                             
                                             
                                                T
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ∣
                                 D
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                                 ≤
                                 ϵ
                                 }
                              
                           . The proximal operator problem has the form 
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             y
                                          
                                       
                                    
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          C
                                       
                                    
                                    
                                       (
                                       
                                          y
                                       
                                       )
                                    
                                    ,
                                 
                              
                            with auxiliary variable 
                              
                                 y
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             2
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             3
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             4
                                          
                                          
                                             T
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           , and 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    k
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                           ). If 
                              D
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                              ≤
                              ϵ
                           , then we have a trivial solution 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                            for all 
                              k
                           . Thus we consider only the nontrivial case where 
                              D
                              
                                 (
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       4
                                    
                                 
                                 )
                              
                              >
                              ϵ
                           , namely the distance between diagonal lines of quadrilateral 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    4
                                 
                              
                            is larger than the tolerance 
                              ϵ
                           . The solution is a closest quadrilateral for which the distance between diagonals is exactly 
                              ϵ
                           ; thus we only need to solve (see Fig. 4) 
                              
                                 (10)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             y
                                          
                                       
                                    
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    
                                    s.t.  
                                    D
                                    
                                       (
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                    =
                                    ϵ
                                    .
                                 
                              
                           
                        

For the solution points 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    3
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    4
                                 
                              
                           , there must exist two parallel planes 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            that contain 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    4
                                 
                              
                            respectively, and are distance 
                              ϵ
                            apart. These two planes share a common unit normal vector 
                              
                                 n
                              
                            and can be represented using the linear equations 
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       :
                                       
                                       
                                          {
                                          
                                             z
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                3
                                             
                                          
                                          ∣
                                          
                                             z
                                          
                                          ⋅
                                          
                                             n
                                          
                                          =
                                          d
                                          }
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                       :
                                       
                                       
                                          {
                                          
                                             z
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                3
                                             
                                          
                                          ∣
                                          
                                             z
                                          
                                          ⋅
                                          
                                             n
                                          
                                          =
                                          d
                                          +
                                          ϵ
                                          }
                                       
                                       ,
                                    
                                 
                              
                            where 
                              d
                            is a scalar that represents the signed distance from plane 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            to the origin. Since 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    k
                                 
                              
                            needs to be closest to 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    3
                                 
                              
                            are the closest projections of 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    3
                                 
                              
                            onto 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                           , and 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    4
                                 
                              
                            are the closest projections of 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    4
                                 
                              
                            onto 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           . Thus the target function in (10) can be written as a function 
                              h
                            of 
                              
                                 n
                              
                            and 
                              d
                           , 
                              
                                 
                                    h
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          4
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          3
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ⋅
                                             
                                                n
                                             
                                             −
                                             d
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          2
                                          ,
                                          4
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ⋅
                                             
                                                n
                                             
                                             −
                                             d
                                             −
                                             ϵ
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

From the optimality condition 
                              
                                 
                                    ∂
                                    h
                                 
                                 
                                    ∂
                                    d
                                 
                              
                              =
                              0
                           , we obtain 
                              
                                 
                                    d
                                    =
                                    
                                       n
                                    
                                    ⋅
                                    
                                       
                                          
                                             m
                                          
                                       
                                       
                                          
                                             x
                                          
                                       
                                    
                                    −
                                    
                                       
                                          ϵ
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       m
                                    
                                 
                                 
                                    
                                       x
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    k
                                 
                              
                           . Substituting this into the definition of 
                              h
                           , we obtain 
                              
                                 
                                    h
                                    =
                                    
                                       
                                          
                                             ‖
                                             
                                                X
                                             
                                             
                                                n
                                             
                                             −
                                             
                                                b
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       X
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      T
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      T
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      4
                                                   
                                                   
                                                      T
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                    
                                    
                                       b
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       [
                                       
                                          
                                             
                                                −
                                                ϵ
                                             
                                          
                                          
                                             
                                                ϵ
                                             
                                          
                                          
                                             
                                                −
                                                ϵ
                                             
                                          
                                          
                                             
                                                ϵ
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           Then the unit normal vector 
                              
                                 n
                              
                            is the solution to 
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             n
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                X
                                             
                                             
                                                n
                                             
                                             −
                                             
                                                b
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       s.t.
                                    
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                n
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    1
                                    .
                                 
                              
                            This is a least squares minimization over the unit sphere, which can be solved using the method in Section 12.1.2 of  [35]. From the values of 
                              
                                 n
                              
                            and 
                              d
                           , we obtain 
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    k
                                 
                              
                            (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                           ) as 
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   n
                                                
                                                
                                                   [
                                                   −
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ⋅
                                                   
                                                      n
                                                   
                                                   ]
                                                
                                                ,
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                3
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   n
                                                
                                                
                                                   [
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ⋅
                                                   
                                                      n
                                                   
                                                   ]
                                                
                                                ,
                                             
                                             
                                                k
                                                =
                                                2
                                                ,
                                                4
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

When using a polygonal mesh to represent realizations of freeform designs, we can represent the nodes, beams, and panels of the surface with the vertices, edges, and faces of the mesh, respectively. For such a mesh we can require the corner angles of each face to stay within a given range of values, in order to prevent small angles between adjacent beams and facilitate the fabrication of nodes and panels. Let 
                              α
                              ,
                              β
                              ∈
                              
                                 (
                                 0
                                 ,
                                 π
                                 )
                              
                            be the minimum and maximum values that are allowed for interior angles. For the angle 
                              ∠
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                            between edges 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                           , this constraint means (see Fig. 6) 
                              
                                 (11)
                                 
                                    cos
                                    β
                                    ≤
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          ⋅
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ≤
                                    cos
                                    α
                                    .
                                 
                              
                            This translation-invariant constraint can be represented in the form of (3)
                           
                              
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  i
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ∈
                                    C
                                    ,
                                 
                              
                            where 
                              
                                 
                                    C
                                    =
                                    
                                       {
                                       
                                          
                                             q
                                          
                                          =
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   ]
                                                
                                             
                                             
                                                T
                                             
                                          
                                          |
                                       
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                q
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                       cos
                                       β
                                       ≤
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ⋅
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ≤
                                       cos
                                       α
                                       }
                                    
                                    .
                                 
                              
                            The proximal operator problem is 
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             y
                                          
                                       
                                    
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          2
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          C
                                       
                                    
                                    
                                       (
                                       
                                          y
                                       
                                       )
                                    
                                    ,
                                 
                              
                            with auxiliary variable 
                              
                                 y
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             2
                                          
                                          
                                             T
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                           , and 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       y
                                    
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           . We only consider the non-trivial case where 
                              
                                 
                                    
                                       [
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             2
                                          
                                          
                                             T
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    T
                                 
                              
                              ∉
                              C
                           , i.e. the angle between 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    2
                                 
                              
                            is outside the range 
                              
                                 [
                                 α
                                 ,
                                 β
                                 ]
                              
                           . There are two possibilities:


                           
                              
                                 1.
                                 If the angle between 
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             1
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             2
                                          
                                       
                                     is larger than 
                                       β
                                    , the problem reduces to (see Fig. 7(a)) 
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                             
                                                s.t.
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ⋅
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             =
                                             cos
                                             β
                                             .
                                          
                                       
                                    
                                 

When the angle between 
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             1
                                          
                                       
                                    , 
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             2
                                          
                                       
                                     is smaller than 
                                       α
                                    , the problem becomes (see Fig. 7(b)) 
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                             
                                                s.t.
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ⋅
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             =
                                             cos
                                             α
                                             .
                                          
                                       
                                    
                                 

Below we list other shape constraints that appear in the examples in Section  5. Their proximal operators can be found in  [28]. 
                              
                                 •
                                 
                                    Planar faces: all vertices of a face lie on a common plane.


                                    Regular polygonal faces: all edges of a face form a regular planar polygon.


                                    Bounded edge length: the length of each mesh edge stays within a given range 
                                       
                                          [
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   min
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                          ]
                                       
                                    .

Using the algorithm in the previous section, we implement an interactive exploration system for mesh shapes subject to constraints. First in the specification phase, the user specifies the soft constraints and hard constraints for an initial mesh, and selects handle vertices. Then in the exploration phase, the mesh shape is updated by solving the optimization problem (5). When the user drags the handles, the mesh shape is consecutively updated using a sequence of handle positions obtained during the dragging, providing intuitive visual feedback to the user about feasible shapes and their relations to handle positions. Alternatively, the user can leave the handle vertices at their original positions, which effectively performs rationalization (trading off constraint satisfaction against deviation from the original surface). In the exploration phase, the user is allowed to change their constraint specification (by adding or removing constraints, changing weights, etc.) on the fly, to switch between different shape spaces.

To achieve interactive exploration, it is crucial that we solve the optimization problem efficiently. Since the independent subproblems of our augmented Lagrangian solver enables parallel solving, we implement it on GPU using CUDA. Interested readers are referred to  [36] for more details. Using an NVIDIA GeForce GTX 580 graphics card, we achieve interactive performance for problems with 20K vertices and 80K auxiliary variables (see the accompanying video, Appendix A).

@&#RESULTS@&#

This section presents some examples of shape exploration using our method, as well as comparison between our method and other optimization methods.


                        Fig. 2
                         is a comparison between soft and hard constraints of planar faces, which shows that the our solver is able to produce results that strictly satisfy hard constraints. 
                        
                     

In Fig. 5
                         we compare between the hard constraints of planar faces and bounded diagonal distance on the same quad mesh, showing that bounded diagonal distance provides more degrees of freedom to achieve smoother shapes. In this paper, we always set the diagonal distance tolerance to 
                           1
                           %
                         of the average edge length of the initial mesh, according to  [2]. 
                        
                     


                        Figs. 1 and 9 are examples of shape exploration by dragging handles. Fig. 1 is a tri-hex mesh subject to a hard constraint of face planarity and a soft constraint of regular polygonal faces, while Fig. 9 is a quad mesh subject to a hard constraint of bounded diagonal distance. The exploration sessions of these two models are also shown in the accompanying video (see Appendix A), from which we can see the interactive performance of the system.


                        Figs. 8, 10 and 11
                         show shape exploration for a mesh with different constraint specifications. Figs. 8 and 11 are examples with different constraint types on same meshes, while Fig. 10 is an example under a same set of constraints but different soft constraint weights.
                        
                        
                     

To evaluate the efficiency of our method, Fig. 12
                         compares the performance between our method and the interior point method  [37], which is a popular choice for general constrained optimization problems. The interior point solver is implemented using the commercial software package KNITRO  [38]. Since KNITRO is only available on CPU, we compare it against a CPU implementation of our method. To speed up the interior point solver, we evaluate the Jacobian of the constraint functions in parallel using OpenMP. The two methods are applied to the same optimization problems for handle-based deformation of constrained meshes and converge to the same results. To compare their convergence speed, Fig. 12 plots for each method,
                           
                              (12)
                              
                                 δ
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             p
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                ∗
                                             
                                          
                                          ‖
                                       
                                    
                                 
                                 ,
                              
                           
                         indicating the deviation between intermediate mesh shapes during optimization and the final shape, where 
                           
                              p
                           
                           
                              (
                              t
                              )
                           
                         is the mesh shape at time instance 
                           t
                        , and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 ∗
                              
                           
                         are the initial and final mesh shapes respectively. Our method decreases 
                           δ
                           
                              (
                              t
                              )
                           
                         rapidly at the start. When a user drags the vertex handles continuously, it is important to update the mesh shape promptly to provide visual feedback to the user. An approximate solution is sufficient for intuitive feedback, and our method is well suited for this scenario. With a GPU implementation, the decrease of 
                           δ
                           
                              (
                              t
                              )
                           
                         for our method is even faster (see  [36]), enabling realtime deformation of constrained meshes.

@&#DISCUSSION AND CONCLUSION@&#

A key factor for the efficiency of our method is the use of auxiliary variables, together with the alternating minimization strategy for the primal update. First of all, this leads to separable subproblems for updating auxiliary variables, which gains speedup easily from parallelism. Moreover, the update of vertex variables only requires solving a linear system of fixed size, regardless of the number of constraints of the problem. Additionally, the linear systems are predefined, making it possible to prefactorize them to accelerate the solving. On the contrary, the interior point method needs to solve a linear system involving both the primal and the dual variables at each iteration. Increasing the number of constraints leads to larger linear systems and thus more time needed for each solve. Furthermore, each iteration solves a different linear system, making it difficult to gain speedup from numerical prefactorization. The fast convergence of our method at the beginning of the optimization is typical for numerical solvers that employ auxiliary variables and proximal operators  [32]. On the other hand, the final convergence of such solvers is slow (typically linear), and it might take a long time to converge to a solution of high accuracy  [39]. In the future, in order to improve the final convergence rate, we can either employ a hybrid approach which switches to Newton-type solvers at the final stage, or speed up the dual problem using accelerated gradient descent similar to  [40].

Another limitation of our method is that it cannot handle arbitrary hard constraints. Hard constraints are often desirable in the context of architectural geometry and physical production. It can be tempting for a user to set a large number of constraints as hard constraints. However, if the number of hard constraints is too large, the problem may not have a feasible solution. In this case, our optimization may become unstable and the output may not satisfy any of the prescribed constraints. In future work, we would like to explore heuristics and algorithms to detect if the problem is not feasible and to find a minimal set of constraints to remove in order to make the problem feasible. Another drawback of this method of optimization is that it is not easy to predict how changing the weights for soft constraints influences the final model. An avenue of future work is to perform sensitivity analysis on the weights and give guidance to the user whether small or large changes can have a significant effect on the final result.

To conclude, we have presented a framework for interactive shape exploration of architectural designs based on shape constraints. Our new formulation provides a simple, but effective recipe to enforce soft and hard constraints while allowing interactive performances. Mixing soft and hard constraints during the exploration phase helps to achieve designs that are both aesthetically pleasing and respect constraints imposed by material, fabrication, or assembly.

@&#ACKNOWLEDGMENTS@&#

The models are provided by Yang Liu (Fig. 2), Asymptote Architecture and Waagner Biro (Fig. 8), Zaha Hadid Architects and Amir Vaxman (Fig. 1). The model in Fig. 12 right is taken from [13]. This work has been supported by Swiss National Science Foundation (SNSF) grants 20PA21L_129607 and 200021_137626. This research has received funding from the European Research Council under the European Union’s Seventh Framework Programme
                  (FP/2007–2013)/ERC Grant Agreement 257453, ERC Starting Grant COSYM.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.cad.2014.01.004.

The following is the Supplementary material related to this article. 
                        
                           Video S1
                           
                              Interactive sessions for exploring mesh shapes under given constraints.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

