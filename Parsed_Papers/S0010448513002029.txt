@&#MAIN-TITLE@&#Iterative refinement of hierarchical 
                  T
               -meshes for bases of spline spaces with highest order smoothness

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An iterative refinement strategy for generating hierarchical 
                                 T
                              -meshes is proposed.


                        
                        
                           
                           The required ordering of line-segments which form a 
                                 T
                              -mesh is specified.


                        
                        
                           
                           The construction of spline basis functions is obtained.


                        
                        
                           
                           The proposed algorithm includes standard hierarchical 
                                 B
                              -splines.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hierarchical 




                        T




                     -mesh

Spline space

Local refinement

@&#ABSTRACT@&#


               
               
                  In this paper we propose a strategy for generating consistent hierarchical 
                        T
                     -meshes which allow local refinement and offer a way to obtain spline basis functions with highest order smoothness incrementally. We describe the required ordering of line-segments during refinement and the construction of spline basis functions. We give our strategy for generating consistent hierarchical 
                        T
                     -meshes over any shape of a two-dimensional domain.
               
            

@&#INTRODUCTION@&#

Local mesh refinement algorithms are useful for their ability to localize changes in the set of control points to a limited region; due to their construction, basic tensor-product representation does not allow local refinement. If we allow a row of control points to terminate at a 
                        T
                     -junction, we can refine an underlying domain locally. The spline representations based on a 
                        T
                     -mesh as an underlying structure appear to be efficient for surface modeling and isogeometric analysis introduced in 2005 by T.J.R. Hughes et al. [1,2]. For the interested reader, let us give a short overview of some of the results related to the spline representation techniques using 
                        T
                     -meshes.


                     
                        T
                     -splines were introduced in 2003 by Sederberg et al.  [3]. A practicable refinement algorithm of 
                        T
                     -splines is described in  [4]. The issue of the linear independence of 
                        T
                     -splines  [5], which is relevant to using 
                        T
                     -splines in isogeometric analysis  [6], has been resolved lately by considering analysis-suitable 
                        T
                     -splines by Li et al.  [7]. The refinement algorithm for analysis-suitable 
                        T
                     -splines is presented in  [8]. Dual-compatible 
                        T
                     -splines, which include analysis-suitable 
                        T
                     -splines, have been introduced in  [9].

Multilevel 
                        B
                     -splines for surface modeling were originally introduced in 1988 by Forsey and Bartels  [10]. In 1995 Kraft  [11] suggested a selection mechanism for hierarchical 
                        B
                     -splines, which ensures their linear independence while permitting local control of refinement. Kraft’s construction has been further elaborated in [12,13]. Dokken et al.  [14] have lately proposed locally refinable splines (
                        
                           LR
                        
                     -splines) and the refining process based on so-called hand-in-hand 
                        
                           LR
                        
                     -refinement which starts with a tensor-product mesh.

Polynomial splines over 
                        T
                     -meshes were introduced in 2005 by Deng et al.  [15]. 
                        
                           PHT
                        
                     -splines  [16], which are bicubic polynomial splines with the order of smoothness 
                        
                           (
                           1
                           ,
                           1
                           )
                        
                      over 
                        T
                     -meshes, were introduced in 2006. For applications of 
                        
                           PHT
                        
                     -splines in surface modeling and isogeometric analysis see e.g.  [17,18]. Bases of spline spaces of bi-degree 
                        
                           (
                           m
                           ,
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           )
                        
                      with the order of smoothness 
                        
                           (
                           r
                           ,
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           )
                        
                      (if it is supposed that 
                        m
                        ⩾
                        2
                        r
                        +
                        1
                      and 
                        
                           
                              m
                           
                           
                              ′
                           
                        
                        ⩾
                        2
                        
                           
                              r
                           
                           
                              ′
                           
                        
                        +
                        1
                     ) over 
                        T
                     -meshes have been constructed in terms of the Bernstein–Bézeier representation by Schumaker et al.  [19].

The issue of describing splines of bi-degree 
                        
                           (
                           m
                           ,
                           
                              
                                 m
                              
                              
                                 ′
                              
                           
                           )
                        
                      with the order of smoothness 
                        
                           (
                           r
                           ,
                           
                              
                                 r
                              
                              
                                 ′
                              
                           
                           )
                        
                      (if it is supposed that 
                        m
                        <
                        2
                        r
                        +
                        1
                      and 
                        
                           
                              m
                           
                           
                              ′
                           
                        
                        <
                        2
                        
                           
                              r
                           
                           
                              ′
                           
                        
                        +
                        1
                     ) over an arbitrary 
                        T
                     -mesh seems hardly solvable in a simple and regular way. The dimension of the spline space may itself depend on the geometry of a 
                        T
                     -mesh, and not only on its topology  [20,21]. Therefore, it is desirable to gain an insight into the topology of 
                        T
                     -meshes which admit a practicable algorithm for generating spline basis functions.

In this paper we will focus on a certain type of 
                        T
                     -meshes with a multilevel structure. In particular, we will describe an iterative strategy to construct consistent hierarchical 
                        T
                     -meshes for splines with highest order smoothness; namely, for splines of bi-degree 
                        
                           (
                           m
                           ,
                           m
                           )
                        
                      with the order of smoothness 
                        
                           (
                           m
                           −
                           1
                           ,
                           m
                           −
                           1
                           )
                        
                     . Wu et al. [22,23] have recently introduced consistent hierarchical 
                        T
                     -meshes. A consistent hierarchical 
                        T
                     -mesh is generated by a sequence of edge insertions such that each new edge insertion into the mesh satisfies the so-called surjection condition; in essence that means that one is able to add all new basis functions of a spline space with highest order smoothness at each iteration of edge insertion. The concept of a consistent hierarchical 
                        T
                     -mesh seems to offer natural way to add spline basis functions incrementally. A consistent hierarchical 
                        T
                     -mesh might be generated for any shape of two-dimensional domain, and not just for rectangular domains. However, the generation of a consistent hierarchical 
                        T
                     -mesh and the ordering of the edges or line-segments remain open questions. As an implementation of a consistent hierarchical 
                        T
                     -mesh, Wu et al.  [22] suggest a particular type of crosswise hierarchical 
                        T
                     -mesh that contains a nested sequence of domains.

The essence of our iterative strategy can be described as follows. At each iteration step, the portion of a 
                        T
                     -mesh to be refined is chosen to be as follows: it creates a partition of some domain into cells of a tensor-product mesh. The partition of this domain into cells is of restricted configuration and the constraint on configuration will be given in terms of offset region and curve, which have been recently introduced by Giannelli and Jüttler  [24]. We will determine the ordering of the line-segments to be inserted at each iteration step and give the construction of spline basis functions. This strategy provides a framework in which the concept of consistent hierarchical 
                        T
                     -meshes is feasible. We will show that particular classes of consistent hierarchical 
                        T
                     -meshes  [22] can be obtained by applying this strategy.

Overall, this paper is in the scope of the methods and tools introduced in  [22,24,25], and as a consequence the results presented can be considered as an extension of the construction of classical hierarchical 
                        B
                     -splines originally introduced in  [11].

The rest of this paper is organized as follows. In Section  2 we provide the background needed to explain our strategy, which we then introduce at the beginning of Section  3. We describe the required ordering of line-segments and the construction of spline basis functions for splines of degrees 2 and 3 in Sections  3.1 and 3.2 respectively. We make necessary remarks and discuss the relevant modifications of our strategy in Section  3.3. We conclude the paper in Section  4.

A 
                        T
                     -mesh 
                        T
                      is formed by a set of horizontal and vertical line-segments that creates a partition of a closed domain 
                        Ω
                      into axis-aligned boxes, called the cells of the 
                        T
                     -mesh, in which 
                        T
                     -junctions are allowed  [15]. We do not assume that the boundary 
                        ∂
                        Ω
                      of 
                        Ω
                      is rectangular. However, we assume that a 
                        T
                     -mesh 
                        T
                      is regular (see  [19, Definition 2.2]); or, in other words, we assume that the boundary 
                        ∂
                        Ω
                     , which is a collection of piecewise-linear curves, is free of self-intersections.

An example of a 
                        T
                     -mesh is shown in Fig. 1
                     . In Fig. 1, 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              v
                           
                           
                              5
                           
                        
                      and 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              b
                           
                           
                              11
                           
                        
                      are the vertices of a 
                        T
                     -mesh. An edge of a 
                        T
                     -mesh is a line-segment connecting two adjacent vertices. In Fig. 1, 
                        
                           
                              b
                           
                           
                              8
                           
                        
                        
                           
                              v
                           
                           
                              5
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              1
                           
                        
                        
                           
                              v
                           
                           
                              2
                           
                        
                      are examples of horizontal edges and 
                        
                           
                              b
                           
                           
                              2
                           
                        
                        
                           
                              v
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              4
                           
                        
                        
                           
                              v
                           
                           
                              5
                           
                        
                      are examples of vertical edges. The boundary of a 
                        T
                     -mesh is the boundary 
                        ∂
                        Ω
                      of its domain 
                        Ω
                     . Thus in Fig. 1 the boundary is the piecewise linear closed curve 
                        
                           
                              b
                           
                           
                              1
                           
                        
                        
                           
                              b
                           
                           
                              3
                           
                        
                        
                           
                              b
                           
                           
                              11
                           
                        
                        
                           
                              b
                           
                           
                              10
                           
                        
                        
                           
                              b
                           
                           
                              8
                           
                        
                        
                           
                              b
                           
                           
                              7
                           
                        
                        
                           
                              b
                           
                           
                              5
                           
                        
                        
                           
                              b
                           
                           
                              4
                           
                        
                     . A vertex 
                        b
                      lies on the boundary if 
                        b
                        ∈
                        ∂
                        Ω
                     ; other vertices are called inner vertices.

A maximal segment of a 
                        T
                     -mesh is the longest possible line-segment that can be constructed from several collinear edges; in Fig. 1 the line-segments 
                        
                           
                              b
                           
                           
                              4
                           
                        
                        
                           
                              b
                           
                           
                              6
                           
                        
                        ,
                        
                           
                              b
                           
                           
                              2
                           
                        
                        
                           
                              b
                           
                           
                              10
                           
                        
                      are maximal. A maximal interior segment is a maximal segment that does not intersect with the boundary 
                        ∂
                        Ω
                     ; in Fig. 1
                     
                        
                           
                              v
                           
                           
                              3
                           
                        
                        
                           
                              v
                           
                           
                              4
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              2
                           
                        
                        
                           
                              v
                           
                           
                              5
                           
                        
                      are maximal interior segments.

In Section  2.1 we will state the results that will be used in the analysis of spline space with highest order smoothness defined as follows. 
                           Definition 1
                           
                              [15]
                           


                           Let 
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                               be a space of functions 
                                 f
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                               of class 
                                 
                                    
                                       C
                                    
                                    
                                       m
                                       −
                                       1
                                       ,
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                               which are polynomials of bi-degree 
                                 
                                    (
                                    m
                                    ,
                                    m
                                    )
                                 
                               in 
                                 x
                               and 
                                 y
                              , defined in each cell of a 
                                 T
                              -mesh 
                                 T
                              .

To analyze the dimension and basis functions of a space 
                           S
                           
                              (
                              m
                              ,
                              m
                              ,
                              m
                              −
                              1
                              ,
                              m
                              −
                              1
                              )
                           
                           
                              (
                              T
                              )
                           
                        , we follow the smoothing cofactor method [20,26,27].

For a given element 
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ∈
                           S
                           
                              (
                              m
                              ,
                              m
                              ,
                              m
                              −
                              1
                              ,
                              m
                              −
                              1
                              )
                           
                           
                              (
                              T
                              )
                           
                         and inner vertex 
                           v
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , the conformality factor 
                           
                              
                                 k
                              
                              
                                 v
                              
                           
                         is defined as follows. Suppose that the bivariate function 
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         is respectively equal to the polynomials 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ,
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ,
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ,
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         in each of four cells which form a neighborhood of 
                           v
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         (see Fig. 2
                        ). In the case of 
                           T
                        -junction the corresponding polynomials are supposed to be the same.

Provided that the function 
                           f
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         is of class 
                           
                              
                                 C
                              
                              
                                 m
                                 −
                                 1
                              
                           
                         with respect to 
                           x
                         and 
                           y
                        , the following equalities hold: 
                           
                              
                                 (1)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                 
                              
                              
                                 (2)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                          ,
                                          3
                                       
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                          ,
                                          4
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             y
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                 
                              
                              
                                 (4)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                          ,
                                          1
                                       
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                 
                              
                           
                         for some univariate polynomials 
                           
                              
                                 λ
                              
                              
                                 1
                                 ,
                                 2
                              
                           
                           
                              (
                              x
                              )
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                                 ,
                                 3
                              
                           
                           
                              (
                              y
                              )
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 3
                                 ,
                                 4
                              
                           
                           
                              (
                              x
                              )
                           
                         and 
                           
                              
                                 λ
                              
                              
                                 4
                                 ,
                                 1
                              
                           
                           
                              (
                              y
                              )
                           
                         of degree 
                           m
                        . From Eqs. (1) to (4), we can assert: 
                           
                              (5)
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                          ,
                                          4
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 −
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                          ,
                                          3
                                       
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    +
                                    
                                       
                                          λ
                                       
                                       
                                          4
                                          ,
                                          1
                                       
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       m
                                    
                                 
                                 .
                              
                           
                         Thus, for some constant 
                           
                              
                                 k
                              
                              
                                 v
                              
                           
                         we obtain: 
                           
                              (6)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                       ,
                                       4
                                    
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       v
                                    
                                 
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                       ,
                                       3
                                    
                                 
                                 
                                    (
                                    y
                                    )
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       4
                                       ,
                                       1
                                    
                                 
                                 
                                    (
                                    y
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       k
                                    
                                    
                                       v
                                    
                                 
                                 
                                    
                                       
                                          (
                                          y
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    
                                       m
                                    
                                 
                                 .
                              
                           
                         In addition, the constant 
                           
                              
                                 k
                              
                              
                                 v
                              
                           
                         can be represented in terms of the derivatives on the left-hand side of (5). Indeed, from (5) and (6) we can obtain the following representation for 
                           
                              
                                 k
                              
                              
                                 v
                              
                           
                        : 
                           
                              (7)
                              
                                 
                                    
                                       k
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                (
                                                m
                                                !
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      2
                                                      m
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      m
                                                   
                                                
                                                ∂
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          |
                                       
                                    
                                    
                                       x
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       y
                                       =
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         This means that 
                           
                              
                                 k
                              
                              
                                 v
                              
                           
                         is uniquely defined for a given 
                           f
                           ∈
                           S
                           
                              (
                              m
                              ,
                              m
                              ,
                              m
                              −
                              1
                              ,
                              m
                              −
                              1
                              )
                           
                           
                              (
                              T
                              )
                           
                         and inner vertex 
                           v
                        .

Suppose that 
                           E
                         is a maximal horizontal interior segment with endpoints at the vertices 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 n
                              
                           
                        , and at the inner vertices 
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 n
                                 −
                                 1
                              
                           
                         (see Fig. 3
                        ). For a given function 
                           f
                           ∈
                           S
                           
                              (
                              m
                              ,
                              m
                              ,
                              m
                              −
                              1
                              ,
                              m
                              −
                              1
                              )
                           
                           
                              (
                              T
                              )
                           
                        , let 
                           
                              
                                 P
                              
                              
                                 i
                                 j
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ,
                           i
                           =
                           1
                           ⋯
                           n
                           ,
                           j
                           =
                           1
                           ⋯
                           4
                         denote the polynomials that correspond to the vertices 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , following Fig. 2.

We can then note the following relation: 
                           
                              (8)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       4
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       3
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                         From Eqs. (5), (6) and (8), we obtain the zero identity: 
                           
                              (9)
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          x
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       m
                                    
                                 
                                 ≡
                                 0
                                 ,
                              
                           
                         where 
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ⋯
                           n
                         is the 
                           x
                        -coordinate of the vertex 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        . This identity (9) is equivalent to the following linear system in terms of the conformality factors 
                           
                              
                                 k
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           ,
                           i
                           =
                           1
                           ⋯
                           n
                        : 
                           
                              (10)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             ⋯
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         An analogous linear system for a maximal vertical interior segment can be derived: 
                           
                              (11)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             ⋯
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   k
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           Definition 2
                           
                              [22]
                           


                           For a given 
                                 T
                              -mesh 
                                 T
                              , let 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       N
                                    
                                 
                               be vertices of 
                                 T
                               belonging to maximal interior segments of 
                                 T
                              . The conformality vector space 
                                 W
                                 
                                    [
                                    T
                                    ]
                                 
                               is the space of conformality factors 
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                               which satisfy the linear systems (10) and (11) for all horizontal and vertical maximal interior segments.

Note that, unlike the similar definition given elsewhere  [22,23], this does not involve the conformality factors of boundary vertices.

Thus, by virtue of (10) and (11), and using the direct formula (7), it is possible to define a linear map correctly  [22,23]: 
                           
                              (12)
                              
                                 K
                                 :
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 ⟶
                                 W
                                 
                                    [
                                    T
                                    ]
                                 
                                 .
                              
                           
                        
                     

The definition of a conformal vector space in the univariate case is the following: 
                           Definition 3
                           
                              [22]
                           


                           Given a univariate knot vector 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                               without repeated knots, and the corresponding line-segment 
                                 E
                                 =
                                 
                                    [
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          n
                                       
                                    
                                    ]
                                 
                                 ,
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                               is the space of conformality factors 
                                 
                                    
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       n
                                    
                                 
                               which satisfy the linear system (10).

Note that the space 
                           W
                           
                              [
                              E
                              ]
                           
                         is isomorphic to the space of functions of the class 
                           
                              
                                 C
                              
                              
                                 m
                                 −
                                 1
                              
                           
                         which are polynomials of degree 
                           m
                         within each segment 
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ]
                           
                           ,
                           j
                           =
                           1
                           ⋯
                           n
                           −
                           1
                         and identically zero outside the segment 
                           E
                           =
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              ]
                           
                        ; following previous authors  [22,23], we call this space 
                           
                              
                                 S
                              
                              ¯
                           
                           
                              (
                              m
                              ,
                              m
                              −
                              1
                              )
                           
                           
                              (
                              E
                              )
                           
                        . If we further suppose that 
                           f
                           
                              (
                              x
                              )
                           
                           ∈
                           
                              
                                 S
                              
                              ¯
                           
                           
                              (
                              m
                              ,
                              m
                              −
                              1
                              )
                           
                           
                              (
                              E
                              )
                           
                         such that 
                           f
                           
                              (
                              x
                              )
                           
                           =
                           
                              
                                 P
                              
                              
                                 j
                              
                           
                           
                              (
                              x
                              )
                           
                        , when 
                           x
                           ∈
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              ]
                           
                           ,
                           j
                           =
                           1
                           ⋯
                           n
                           −
                           1
                         and 
                           f
                           ≡
                           0
                        , for 
                           x
                           ∈
                           R
                           ∖
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    n
                                 
                              
                              ]
                           
                        . Since 
                           f
                           
                              (
                              x
                              )
                           
                         is of class 
                           
                              
                                 C
                              
                              
                                 m
                                 −
                                 1
                              
                           
                        , we can write 
                           
                              (13)
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    0
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                    …
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          −
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                    
                                    0
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                    .
                                 
                              
                           
                         This implies that 
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                           
                              
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              
                                 m
                              
                           
                           ≡
                           0
                        ; and the conformality factors 
                           
                              
                                 k
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 k
                              
                              
                                 n
                              
                           
                         can be obtained by solving the linear system (10). Note that 
                           
                              dim
                           
                           
                           W
                           
                              [
                              E
                              ]
                           
                           =
                           n
                           −
                           m
                           −
                           1
                         if 
                           n
                           >
                           m
                           +
                           1
                        , and 
                           
                              dim
                           
                           
                           W
                           
                              [
                              E
                              ]
                           
                           =
                           0
                         if 
                           n
                           ⩽
                           m
                           +
                           1
                        . 
                           Definition 4
                           
                              [22]
                           


                           Let 
                                 E
                               be a maximal interior segment in the 
                                 T
                              -mesh 
                                 T
                              . Then we define 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 :
                                 W
                                 
                                    [
                                    T
                                    ]
                                 
                                 →
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                               to be the projection that preserves the conformality factors of the vertices belonging to 
                                 E
                              .


                              For a maximal interior segment 
                              
                                 E
                               
                              of a given 
                              
                                 T
                              
                              -mesh 
                              
                                 T
                              
                              , let 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               
                              denote the new 
                              
                                 T
                              
                              -mesh that is obtained from 
                              
                                 T
                               
                              by removing line-segment 
                              
                                 E
                               
                              . Assume that there is a set of functions 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       l
                                    
                                 
                                 ∈
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                               
                              such that the conformality vectors 
                              
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                    )
                                 
                               
                              form the basis of a subspace 
                              
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    
                                       im
                                    
                                    
                                    K
                                    )
                                 
                                 ⊂
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                              
                              , where 
                              
                                 
                                    im
                                 
                                 
                                 K
                                 ⊂
                                 W
                                 
                                    [
                                    T
                                    ]
                                 
                               
                              . Then the spline space 
                              
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                               
                              can be expressed as follows:
                              
                                 
                                    
                                       S
                                       
                                          (
                                          m
                                          ,
                                          m
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                          m
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       =
                                       S
                                       
                                          (
                                          m
                                          ,
                                          m
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                          m
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       ⨁
                                       
                                          span
                                       
                                       
                                          {
                                          
                                             
                                                f
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                l
                                             
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           The equality 
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    span
                                 
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                                 =
                                 
                                    0
                                 
                               follows from the simple observation that 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                               for any 
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              . It is then only necessary to represent the spline function 
                                 f
                                 ∈
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                               as the sum of a spline function 
                                 g
                                 ∈
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               and some linear combination of 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       l
                                    
                                 
                              .

For a given function 
                                 f
                                 ∈
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                              , the corresponding projection 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       f
                                       )
                                    
                                    )
                                 
                               is a linear combination of 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 l
                              ; thus, for some 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       l
                                    
                                 
                              , the projection 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       f
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             l
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                              . Thus the function 
                                 g
                                 =
                                 f
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                               is an element of 
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              . Indeed, since 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       g
                                       )
                                    
                                    )
                                 
                                 =
                                 0
                              , all the conformality factors of 
                                 K
                                 
                                    (
                                    g
                                    )
                                 
                               belonging to 
                                 E
                               are zero. Without loss of generality, we may suppose that 
                                 E
                               is the horizontal maximal interior segment that traverses the vertices 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                               (see Fig. 3), and that all its conformality factors 
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                          
                                       
                                    
                                 
                               are zero. Following Fig. 2, 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                                 ,
                                 j
                                 =
                                 1
                                 ⋯
                                 4
                               are polynomials representing 
                                 f
                               in the neighborhoods of the vertices 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                               respectively. Since the 
                                 T
                              -mesh 
                                 T
                               has a 
                                 T
                              -junction at the vertex 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       13
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       14
                                    
                                 
                                 =
                                 0
                               and, by virtue of (5) and (6), 
                                 
                                    
                                       P
                                    
                                    
                                       12
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       11
                                    
                                 
                                 =
                                 0
                              , or equivalently 
                                 
                                    
                                       P
                                    
                                    
                                       23
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       24
                                    
                                 
                                 =
                                 0
                              ; since 
                                 
                                    
                                       k
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 0
                              , a similar argument yields 
                                 
                                    
                                       P
                                    
                                    
                                       22
                                    
                                 
                                 −
                                 
                                    
                                       P
                                    
                                    
                                       21
                                    
                                 
                                 =
                                 0
                              . Going further, to the vertex 
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                              , we see that 
                                 g
                               is of class 
                                 
                                    
                                       C
                                    
                                    
                                       ∞
                                    
                                 
                               with respect to 
                                 y
                               along the whole line-segment 
                                 E
                              . Thus 
                                 g
                                 ∈
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                               and 
                                 f
                                 =
                                 g
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                              . The Lemma 1 is proved.□


                        
                           Remark 1
                           Note that, if the projection 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 :
                                 
                                    im
                                 
                                 
                                 K
                                 →
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                               is surjective, then 
                                 
                                    span
                                 
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          l
                                       
                                    
                                    }
                                 
                               is isomorphic to 
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                              .


                        
                           Corollary 1
                           
                              Suppose that for a given 
                              
                                 T
                              
                              -mesh 
                              
                                 T
                              
                              , there is an ordered sequence of maximal interior segments 
                              
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 ≺
                                 ⋯
                                 ≺
                                 
                                    
                                       E
                                    
                                    
                                       n
                                    
                                 
                              
                              , such that successive deletion of 
                              
                                 
                                    
                                       E
                                    
                                    
                                       n
                                    
                                 
                                 ≻
                                 ⋯
                                 ≻
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                               
                              from the 
                              
                                 T
                              
                              -mesh 
                              
                                 T
                               
                              produces the 
                              
                                 T
                              
                              -mesh 
                              
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                               
                              ; let the 
                              
                                 T
                              
                              -mesh 
                              
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                                 −
                                 1
                               
                              be obtained by successive deletion of the line-segments 
                              
                                 
                                    
                                       E
                                    
                                    
                                       n
                                    
                                 
                                 ≻
                                 ⋯
                                 ≻
                                 
                                    
                                       E
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                               
                              from 
                              
                                 T
                               
                              ; and let 
                              
                                 
                                    
                                       T
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 T
                               
                              . Suppose that all the projections 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 :
                                 
                                    im
                                 
                                 
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 →
                                 W
                                 
                                    [
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                               
                              are surjective, where linear maps 
                              
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 →
                                 W
                                 
                                    [
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                               
                              are given by   (12)
                              . Let 
                              
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    }
                                 
                                 ⊂
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                               
                              be a set of spline functions such that the projections 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 j
                                 =
                                 1
                                 ⋯
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                               
                              form the basis of 
                              
                                 W
                                 
                                    [
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                               
                              . Then, by virtue of   
                                 Lemma  1
                              :
                              
                                 
                                    (14)
                                    
                                       S
                                       
                                          (
                                          m
                                          ,
                                          m
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                          m
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       =
                                       S
                                       
                                          (
                                          m
                                          ,
                                          m
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                          m
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       
                                          
                                             ⨁
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          span
                                       
                                       
                                          {
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                           

One consequence of Corollary 1 is a method of constructing basis functions of a spline space for those classes of 
                           T
                        -meshes that satisfy the conditions of the corollary.

This approach to the construction of basis functions, provided by Corollary 1 but originally introduced by Wu et al.  [22], has been formulated  [23] there in terms of ordered sequence of edges, rather than maximal interior segments. But in demonstrating their concept of consistent hierarchical 
                           T
                        -meshes, Wu et al.  [23] refer only to a particular class of hierarchical 
                           T
                        -meshes  [22]. In the next section we will discuss the problem of generating 
                           T
                        -meshes to satisfy the conditions of Corollary 1, and then to construct basis functions of the corresponding spline space. 
                           Definition 5
                           
                              [25]
                           


                           For a given ordered sequence of maximal interior segments 
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 ≺
                                 ⋯
                                 ≺
                                 
                                    
                                       E
                                    
                                    
                                       l
                                    
                                 
                              , let 
                                 λ
                                 
                                    (
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               be the number of vertices of 
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                               which are not on a maximal interior segment of index greater than 
                                 i
                              .


                              Let 
                              
                                 T
                               
                              be a 
                              
                                 T
                              
                              -mesh on some rectangular domain. Assume that, for a given order of its maximal interior segments, the following inequality holds:
                              
                                 
                                    
                                       λ
                                       
                                          (
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       ⩾
                                       m
                                       +
                                       1
                                       ,
                                    
                                 
                              
                              for every maximal interior segment 
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 l
                               
                              . Then,
                              
                                 
                                    (15)
                                    
                                       
                                          dim
                                       
                                       
                                       S
                                       
                                          (
                                          m
                                          ,
                                          m
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                          m
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                       C
                                       −
                                       m
                                       
                                          (
                                          m
                                          +
                                          1
                                          )
                                       
                                       
                                          
                                             E
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                    
                                 
                              
                              where 
                              
                                 C
                               
                              is the number of cells, 
                              
                                 
                                    
                                       E
                                    
                                    
                                       0
                                    
                                 
                               
                              is the number of inner edges, and 
                              
                                 
                                    
                                       V
                                    
                                    
                                       0
                                    
                                 
                               
                              is the number of inner vertices of 
                              
                                 T
                              
                              .
                           

In Section  2.2 we will recall Giannelli and Jüttler’s definition  [24] of the offset region and curve from a domain 
                           Ω
                         that will be necessary to describe the refinement strategy in Section  3. In addition, we will state the results that will be used in Lemmas 3 and 4 in Sections  3.1 and 3.2, respectively.

Suppose that 
                           Ω
                         is a domain formed by the cells of an infinite tensor-product mesh (see Fig. 4
                        ). The offset region 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                         can be defined recursively as follows: an offset region 
                           
                              
                                 R
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         is defined to be the set of cells 
                           ⊈
                           
                              
                                 ⋃
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 k
                              
                           
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                         which have at least one point in common with the boundary 
                           ∂
                           
                              
                                 ⋃
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 k
                              
                           
                           
                              
                                 R
                              
                              
                                 j
                              
                           
                        ; the zero offset region 
                           
                              
                                 R
                              
                              
                                 0
                              
                           
                         is defined to be 
                           Ω
                        . The offset curve from a domain 
                           Ω
                         is the piecewise linear curve defined as follows: 
                           Definition 6
                           
                              [24]
                           


                           The offset curve 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                               at a distance 0 from a domain 
                                 Ω
                               is defined to be its boundary 
                                 ∂
                                 Ω
                              . Given the offset regions 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                               and 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              , for a nonnegative integer 
                                 k
                              , then: 
                                 
                                    1.
                                    We say that 
                                          Ω
                                        admits an offset at a distance 
                                          k
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                        if any cell in 
                                          
                                             
                                                R
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                        is related to 
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                        by one of the three connections shown in Fig. 5
                                       ; then the offset curve at a distance 
                                          k
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       , written 
                                          
                                             
                                                C
                                             
                                             
                                                k
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       , is a piecewise linear curve obtained by collecting together the contributions of every cell, as shown in Fig. 5.

We say that 
                                          Ω
                                        admits an offset at a distance 
                                          k
                                          +
                                          1
                                        if the relationship between any cell in 
                                          
                                             
                                                R
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                        and 
                                          
                                             
                                                R
                                             
                                             
                                                k
                                             
                                          
                                        falls into one of the three cases shown in Fig. 6
                                       ; then the offset curve at a distance 
                                          k
                                          +
                                          1
                                       , written 
                                          
                                             
                                                C
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       , is the piecewise linear curve that forms the exterior boundary of 
                                          
                                             
                                                R
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                       , as shown in Fig. 6.

We say that 
                                 Ω
                               does not admit an offset at a distance greater than or equal to 
                                 k
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                               or 
                                 k
                                 +
                                 1
                               if the above conditions 1 or 2 respectively are not satisfied.

In Definition 6 the conditions 1 or 2 respectively allow us to be sure that the offset curves 
                           
                              
                                 C
                              
                              
                                 k
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         or 
                           
                              
                                 C
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         are free of self-intersections. Fig. 7
                         shows an example of the offset region 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         from the domain 
                           Ω
                         (shown in Fig. 4 as well) and the corresponding offset curve 
                           
                              
                                 C
                              
                              
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         (dashed red lines). Note that the definition above means that 
                           Ω
                         in Fig. 7 does not admit an offset at a distance greater or equal than 1.


                        Definition 6 constrains the configuration of a domain 
                           Ω
                         in a way which makes it relatively easy to specify the basis functions of a spline space over a 
                           T
                        -mesh.


                        
                           Theorem 1
                           
                              [24]
                           


                           
                              Let 
                              
                                 T
                               
                              be a 
                              
                                 T
                              
                              -mesh which subdivides a bounded domain 
                              
                                 Ω
                               
                              into cells of a tensor-product mesh (see   
                                 Fig.  4
                              ). For a given integer 
                              
                                 m
                                 ⩾
                                 2
                              
                              , suppose that 
                              
                                 Ω
                               
                              admits an offset at a distance 
                              
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               
                              . Let 
                              
                                 B
                               
                              be a set of tensor-product 
                              
                                 B
                              
                              -splines generated from the given tensor-product mesh. Then, the following set provides the basis of the spline space 
                              
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                              
                              :
                              
                                 
                                    
                                       
                                          {
                                          τ
                                          
                                             
                                                |
                                             
                                             
                                                Ω
                                             
                                          
                                          :
                                          τ
                                          ∈
                                          B
                                          
                                          ∧
                                          
                                          
                                             supp
                                          
                                          
                                          τ
                                          ∩
                                          
                                          
                                             int
                                          
                                          
                                          Ω
                                          ≠
                                          ∅
                                          }
                                       
                                       .
                                    
                                 
                              
                           

The following definition of the configuration of a domain 
                           Ω
                        , which is the dual of Definition 6, will be used extensively in the next section. 
                           Definition 7
                           Let 
                                 m
                               be an integer 
                                 ⩾
                                 2
                              . We say that a domain 
                                 Ω
                               admits an inner offset at a distance 
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               if its complement 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 Ω
                               admits an offset at a distance 
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                              . We say that a domain 
                                 Ω
                               does not admit an inner offset at a distance greater than or equal to 
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               if its complement 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 Ω
                               does not admit an offset at a distance greater than or equal to 
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                              . The inner offset curve of 
                                 Ω
                               at a distance 
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               is 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             m
                                             −
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               of 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 Ω
                              .

A condition that 
                           Ω
                         admits an inner offset at a distance 
                           
                              
                                 m
                                 −
                                 1
                              
                              
                                 2
                              
                           
                         allows us to be sure that the inner offset curve of 
                           Ω
                         at a distance 
                           
                              
                                 m
                                 −
                                 1
                              
                              
                                 2
                              
                           
                         is free of self-intersections. Examples of domains which admit inner offset at distances 
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                         and 1 are shown in Fig. 8
                        , together with domains which do not admit an inner offset at distances greater than or equal to 
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                         and 1.

We can make the following simple observation about a domain which admits an inner offset: 
                           Proposition 1
                           
                              For a given integer 
                              
                                 m
                                 ⩾
                                 2
                              
                              , suppose that a domain 
                              
                                 Ω
                               
                              admits an inner offset at a distance 
                              
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               
                              . Further suppose that the corresponding tensor-product mesh is refined by inserting a line 
                              
                                 L
                               
                              . Then, 
                              
                                 Ω
                               
                              admits an inner offset at a distance 
                              
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               
                              for the refined tensor-product mesh as well.
                           


                        Proposition 1 is illustrated, for 
                           m
                           =
                           2
                        , in Fig. 9
                        . The following proposition plays a significant role in proving lemmas in the next section. 
                           Proposition 2
                           
                              Let 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               
                              be a 
                              
                                 T
                              
                              -mesh and 
                              
                                 Ω
                               
                              be a domain composed by a subset of cells of 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               
                              . Suppose that the set of cells comprising 
                              
                                 Ω
                               
                              is a subset of cells of some tensor-product mesh. For a given integer 
                              
                                 m
                                 ⩾
                                 2
                              
                              , we suppose that 
                              
                                 Ω
                               
                              admits an inner offset at a distance 
                              
                                 
                                    
                                       m
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               
                              . Suppose further that 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                               
                              is refined by the line-segment 
                              
                                 E
                                 ⊂
                                 Ω
                               
                              such that 
                              
                                 E
                               
                              is a maximal interior segment of the refined 
                              
                                 T
                              
                              -mesh 
                              
                                 T
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       ′
                                    
                                 
                                 ⋃
                                 E
                               
                              . Then we can assert:
                              
                                 
                                    
                                       S
                                       
                                          (
                                          m
                                          ,
                                          m
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                          m
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          T
                                          )
                                       
                                       =
                                       S
                                       
                                          (
                                          m
                                          ,
                                          m
                                          ,
                                          m
                                          −
                                          1
                                          ,
                                          m
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       ⨁
                                       
                                          span
                                       
                                       
                                          {
                                          
                                             
                                                f
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                l
                                             
                                          
                                          }
                                       
                                       ,
                                    
                                 
                              
                              where 
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       l
                                    
                                 
                               
                              are tensor-product 
                              
                                 B
                              
                              -splines which have supports within the domain 
                              
                                 Ω
                              
                              .
                           


                        
                           Proof
                           Before proving Proposition 2 let us illustrate its nature, for the case 
                                 m
                                 =
                                 3
                              , in Fig. 10
                              . We will prove the proposition for 
                                 m
                                 =
                                 3
                              ; the proof for other positive integers 
                                 m
                               is analogous. Following Lemma 1, we need to provide tensor-product 
                                 B
                              -splines 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       l
                                    
                                 
                                 ∈
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                               such that 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                    )
                                 
                               form a basis of 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    
                                       im
                                    
                                    K
                                    )
                                 
                                 ⊂
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                              . Without loss of generality, we assume that 
                                 E
                               is the vertical maximal interior segment, and let 
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 ⋯
                                 <
                                 
                                    
                                       y
                                    
                                    
                                       k
                                    
                                 
                               be the 
                                 y
                              -coordinates of its knots. If 
                                 k
                                 ⩽
                                 4
                              , then 
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                                 =
                                 
                                    0
                                 
                               and there is nothing to prove. If 
                                 k
                                 >
                                 4
                              , then there are 
                                 l
                                 =
                                 k
                                 −
                                 4
                               tensor-product 
                                 B
                              -splines 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       l
                                    
                                 
                               from the spline space 
                                 S
                                 
                                    (
                                    m
                                    ,
                                    m
                                    ,
                                    m
                                    −
                                    1
                                    ,
                                    m
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                              , such that 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             l
                                          
                                       
                                       )
                                    
                                    )
                                 
                               form a basis of 
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                              . Let us consider a column of four adjacent cells divided by 
                                 E
                               and the corresponding line-segment 
                                 V
                               with knots 
                                 
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          5
                                       
                                    
                                    )
                                 
                              .

Since 
                                 Ω
                               admits an inner offset at a distance 1, then at least one of the three configurations shown in Fig. 11
                               must occur. Consider the following tensor-product 
                                 B
                              -spline having a support within the domain 
                                 Ω
                               (see Fig. 11): 
                                 
                                    (16)
                                    
                                       f
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       =
                                       N
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       N
                                       
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       ;
                                    
                                 
                               then 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       f
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       )
                                    
                                    )
                                 
                               is a nontrivial element 
                                 
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          5
                                       
                                    
                                    )
                                 
                               of the one-dimensional space of conformality factors 
                                 W
                                 
                                    [
                                    V
                                    ]
                                 
                                 ⊂
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                              . Indeed, 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ≠
                                 0
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 5
                              , because otherwise 
                                 
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          5
                                       
                                    
                                    )
                                 
                                 =
                                 0
                               and then, as we saw in the proof of Lemma 1, 
                                 f
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                               would be of class 
                                 
                                    
                                       C
                                    
                                    
                                       ∞
                                    
                                 
                               with respect to 
                                 x
                               along the line-segment 
                                 E
                              , which contradicts the definition of 
                                 f
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                               in (16). From this simple treatment, it is readily apparent that the conformality vectors 
                                 
                                    
                                       P
                                    
                                    
                                       E
                                    
                                 
                                 
                                    (
                                    K
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 l
                               for the 
                                 B
                              -splines 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ⋯
                                 l
                               corresponding to all rows of four consecutive cells divided by 
                                 E
                              , form a basis of the space 
                                 W
                                 
                                    [
                                    E
                                    ]
                                 
                              . Proposition 2 is proved.□

We now describe general refinement strategy that satisfies the conditions introduced in Corollary 1, which allow spline basis functions to be constructed incrementally. We will concentrate on 
                        m
                        =
                        2
                      and 
                        m
                        =
                        3
                     . However, we will start by describing the generic inductive refinement procedure. 
                        Definition 8
                        Let 
                              m
                            be an integer 
                              ⩾
                              2
                           . We say that a 
                              T
                           -mesh 
                              T
                            is of type 
                              m
                            if it is derived from an initial 
                              T
                           -mesh 
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                            by repeating step 2 of the following algorithm from 
                              j
                              =
                              0
                            until 
                              j
                              =
                              N
                              −
                              1
                            and 
                              T
                              =
                              
                                 
                                    T
                                 
                                 
                                    N
                                 
                              
                           , for some integer 
                              N
                              ⩾
                              1
                           . 
                              
                                 1.
                                 The initial 
                                       T
                                    -mesh 
                                       
                                          
                                             T
                                          
                                          
                                             0
                                          
                                       
                                     occupies the domain 
                                       
                                          
                                             Ω
                                          
                                          
                                             0
                                          
                                       
                                    , which is composed of the cells of a tensor-product mesh and admits an offset at a distance 
                                       
                                          
                                             m
                                             −
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    .

Induction from any 
                                       j
                                       ⩾
                                       0
                                     to 
                                       j
                                       +
                                       1
                                     proceeds as follows. For a given 
                                       T
                                    -mesh 
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                       
                                    , it is necessary to find domains 
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ⊂
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                     which satisfy the following assumptions: domains 
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                     and 
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                     are both constructed from the cells of some tensor-product mesh, such that each cell in 
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                     is also a cell of the 
                                       T
                                    -mesh 
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                       
                                    ; and 
                                       
                                          
                                             Ω
                                          
                                          
                                             j
                                          
                                       
                                     admits an inner offset at a distance 
                                       
                                          
                                             m
                                             −
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    . The refined 
                                       T
                                    -mesh 
                                       
                                          
                                             T
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                     is derived from 
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                       
                                     by dividing each cell of the domain 
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                     following the rule illustrated in Fig. 12
                                    , such that the line-segments 
                                       
                                          
                                             E
                                          
                                          
                                             j
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             E
                                          
                                          
                                             j
                                             
                                                
                                                   n
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                     refining 
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                       
                                     have endpoints on 
                                       ∂
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             j
                                          
                                       
                                    . It is supposed that the line-segments 
                                       
                                          
                                             E
                                          
                                          
                                             j
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             E
                                          
                                          
                                             j
                                             
                                                
                                                   n
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                     are maximal interior segments of the 
                                       T
                                    -mesh 
                                       
                                          
                                             T
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                    , i.e.  
                                       
                                          
                                             E
                                          
                                          
                                             j
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             E
                                          
                                          
                                             j
                                             
                                                
                                                   n
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                     do not intersect with the boundary 
                                       ∂
                                       
                                          
                                             Ω
                                          
                                          
                                             0
                                          
                                       
                                    .

A step 2 for an iteration from 
                        j
                      to 
                        j
                        +
                        1
                      for 
                        m
                        =
                        3
                      is shown in Fig. 13
                     . The examples of realization of the refinement strategy are demonstrated in Remarks 2 and 3 below for the cases 
                        m
                        =
                        2
                      and 
                        m
                        =
                        3
                     , respectively.

Since 
                        
                           
                              Ω
                           
                           
                              0
                           
                        
                      admits an offset at a distance 
                        
                           
                              m
                              −
                              1
                           
                           
                              2
                           
                        
                     , the basis functions of a spline space 
                        S
                        
                           (
                           m
                           ,
                           m
                           ,
                           m
                           −
                           1
                           ,
                           m
                           −
                           1
                           )
                        
                        
                           (
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                           )
                        
                      can always be obtained using Theorem 1. In order to show that a 
                        T
                     -mesh 
                        T
                      of type 
                        m
                      satisfies the conditions of Corollary 1, we only need to prove that the induction step (step 2 in the refinement strategy above) satisfies those conditions. We start with the case 
                        m
                        =
                        2
                     .

Let 
                           T
                           =
                           
                              
                                 T
                              
                              
                                 N
                              
                           
                         be a 
                           T
                        -mesh of type 2 for some integer 
                           N
                           ⩾
                           1
                         (see Definition 8). We consider the induction step from 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         to 
                           
                              
                                 T
                              
                              
                                 j
                                 +
                                 1
                              
                           
                        , for a given 
                           0
                           ⩽
                           j
                           ⩽
                           N
                           −
                           1
                        , such that 
                           
                              
                                 T
                              
                              
                                 j
                                 +
                                 1
                              
                           
                         is derived from 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         by refining with maximal interior segments 
                           
                              
                                 E
                              
                              
                                 j
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 E
                              
                              
                                 j
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        , in compliance with step 2 of the algorithm in Definition 8. For a given order of the line-segments 
                           
                              
                                 E
                              
                              
                                 j
                                 1
                              
                           
                           ≺
                           ⋯
                           ≺
                           
                              
                                 E
                              
                              
                                 j
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        , the 
                           T
                        -mesh 
                           
                              
                                 T
                              
                              
                                 j
                                 i
                              
                           
                           ,
                           1
                           ⩽
                           i
                           ⩽
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                         is derived from 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         by successive introduction of the line-segments 
                           
                              
                                 E
                              
                              
                                 j
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 E
                              
                              
                                 j
                                 i
                              
                           
                        ; in particular, 
                           
                              
                                 T
                              
                              
                                 j
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           =
                           
                              
                                 T
                              
                              
                                 j
                                 +
                                 1
                              
                           
                        .

In the following lemma we omit the index 
                           j
                         to simplify the notations, observing that the proof is the same for any 
                           0
                           ⩽
                           j
                           ⩽
                           N
                           −
                           1
                        ; thus 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                         corresponds to 
                           
                              
                                 T
                              
                              
                                 j
                                 i
                              
                           
                           ,
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                         to 
                           
                              
                                 E
                              
                              
                                 j
                                 i
                              
                           
                           ,
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         and 
                           Ω
                         to 
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 j
                              
                           
                         and 
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                         respectively. In formulating the basis functions, we will presume that the cells of the domain 
                           Ω
                         are of the same size and any line-segment that divides a cell of the domain 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         connects the mid-points of opposite edges of that cell. 
                           Lemma 3
                           
                              There exists an ordered sequence of maximal interior segments 
                              
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 ≺
                                 ⋯
                                 ≺
                                 
                                    
                                       E
                                    
                                    
                                       n
                                    
                                 
                               
                              which refine 
                              
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                               
                              such that the projections 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 :
                                 W
                                 
                                    [
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                                 →
                                 W
                                 
                                    [
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                               
                              are surjective for all 
                              
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                              
                              , so for any 
                              
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                              
                              there is a set of spline functions 
                              
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    }
                                 
                                 ⊂
                                 S
                                 
                                    (
                                    2
                                    ,
                                    2
                                    ,
                                    1
                                    ,
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              , such that 
                              
                                 
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                1
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    }
                                 
                               
                              forms a basis of 
                              
                                 W
                                 
                                    [
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                              
                              , where 
                              
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 S
                                 
                                    (
                                    2
                                    ,
                                    2
                                    ,
                                    1
                                    ,
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 →
                                 W
                                 
                                    [
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                               
                              is given in   (12)
                              . Moreover, these spline functions can be chosen such that their supports are contained within 
                              
                                 Ω
                              
                              .
                           


                        
                           Proof
                           The proof could be found in Appendix A.□


                        
                           Remark 2
                           Wu et al.  [22] describe a special classes 
                                 
                                    
                                       T
                                    
                                    
                                       m
                                       ,
                                       m
                                    
                                 
                               of hierarchical 
                                 T
                              -meshes. If 
                                 m
                                 =
                                 2
                              , then 
                                 
                                    
                                       T
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                               is the ordinary class of crosswise hierarchical 
                                 T
                              -meshes with a level structure, which is the same to one used for 
                                 
                                    PHT
                                 
                              -splines  [16]. The following procedure, shown in Fig. 14
                              , can be used to generate a 
                                 T
                              -mesh of class 
                                 
                                    
                                       T
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                              . We begin with a tensor-product mesh over a rectangular domain (the cells of this mesh are defined to be of level 0). In order to generate a cell at level 
                                 j
                                 +
                                 1
                              , a cell at level 
                                 j
                               must be subdivided into four subcells (which are defined to be at level 
                                 j
                                 +
                                 1
                              ). A cell is divided by two line-segments connecting the mid-points of opposite edges.

We observe that a hierarchical 
                                 T
                              -mesh of class 
                                 
                                    
                                       T
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                               is of type 2, following Definition 8. Let 
                                 T
                               be a hierarchical 
                                 T
                              -mesh of class 
                                 
                                    
                                       T
                                    
                                    
                                       2
                                       ,
                                       2
                                    
                                 
                              . The domain 
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              , which is to be divided to obtain cells at level 
                                 j
                                 +
                                 1
                              , is composed of cells at level 
                                 j
                              . We create a domain 
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                                 ⊃
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                               by unifying all the cells at level 
                                 j
                              . If 
                                 j
                                 ⩾
                                 1
                              , then the construction of 
                                 T
                               means that 
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               is composed of 2×2 blocks of cells at level 
                                 j
                               (each corresponding to a single cell at level 
                                 j
                                 −
                                 1
                              ). In order to prove that 
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               admits an inner offset at a distance 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              , we need to show that 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               admits an offset at a distance 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              . The domain 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               is also composed of 2×2 blocks of cells. It is apparent that the cells from the offset region 
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                               of a domain 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               are related to 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               through the connections shown in Fig. 5. This observation implies that 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               admits an offset at a distance 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              . If 
                                 j
                                 =
                                 0
                              , then it suffices to suppose that the original tensor-product mesh extends at least 2 cells in both coordinate directions to guarantee that 
                                 
                                    
                                       Ω
                                    
                                    
                                       0
                                    
                                 
                               admits an inner offset at a distance 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              . We assume that the cells at level 0 having common edges with the boundary of 
                                 T
                               are not divided, i.e. starting at level 1, all introduced line-segments will be maximal interior segments of 
                                 T
                              . Thus, by Definition 8, 
                                 T
                               is of type 2. The spline basis functions of 
                                 S
                                 
                                    (
                                    2
                                    ,
                                    2
                                    ,
                                    1
                                    ,
                                    1
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                               can be obtained by Lemma 3.

Let 
                           T
                           =
                           
                              
                                 T
                              
                              
                                 N
                              
                           
                         be a 
                           T
                        -mesh of type 3 for some integer 
                           N
                           ⩾
                           1
                         (see Definition 8). As we did in the previous subsection, we will consider the induction step from 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         to 
                           
                              
                                 T
                              
                              
                                 j
                                 +
                                 1
                              
                           
                        , for a given 
                           0
                           ⩽
                           j
                           ⩽
                           N
                           −
                           1
                        , which allows us to derive 
                           
                              
                                 T
                              
                              
                                 j
                                 +
                                 1
                              
                           
                         from 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         by refining the 
                           T
                        -mesh 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         by introducing maximal interior segments 
                           
                              
                                 E
                              
                              
                                 j
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 E
                              
                              
                                 j
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        , as we did in step 2 of the algorithm in Definition 8. For a given ordering of the line-segments 
                           
                              
                                 E
                              
                              
                                 j
                                 1
                              
                           
                           ≺
                           ⋯
                           ≺
                           
                              
                                 E
                              
                              
                                 j
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        , the 
                           T
                        -mesh 
                           
                              
                                 T
                              
                              
                                 j
                                 i
                              
                           
                           ,
                           1
                           ⩽
                           i
                           ⩽
                           
                              
                                 n
                              
                              
                                 j
                              
                           
                         can be derived from 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         through the consistent refinement by the line-segments 
                           
                              
                                 E
                              
                              
                                 j
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 E
                              
                              
                                 j
                                 i
                              
                           
                        ; in particular, 
                           
                              
                                 T
                              
                              
                                 j
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           =
                           
                              
                                 T
                              
                              
                                 j
                                 +
                                 1
                              
                           
                        .

In the following lemma we will omit the index 
                           j
                        . In addition, we will suppose that the cells of the domain 
                           Ω
                         are of the same size and any line-segment that divides a cell of the domain 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         connects the mid-points of opposite edges of that cell, as we did in Lemma 3. 
                           Lemma 4
                           
                              There exists an ordered sequence of maximal interior segments 
                              
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 ≺
                                 ⋯
                                 ≺
                                 
                                    
                                       E
                                    
                                    
                                       n
                                    
                                 
                               
                              which refine 
                              
                                 
                                    
                                       T
                                    
                                    
                                       0
                                    
                                 
                               
                              such that the projections 
                              
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             E
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 :
                                 W
                                 
                                    [
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                                 →
                                 W
                                 
                                    [
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                               
                              are surjective for all 
                              
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                              
                              , so for any 
                              
                                 i
                                 =
                                 1
                                 ⋯
                                 n
                              
                              there is a set of spline functions 
                              
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          
                                             
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    }
                                 
                                 ⊂
                                 S
                                 
                                    (
                                    3
                                    ,
                                    3
                                    ,
                                    2
                                    ,
                                    2
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               
                              such that 
                              
                                 
                                    {
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                1
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          
                                             
                                                E
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             K
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                i
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    }
                                 
                               
                              forms a basis of 
                              
                                 W
                                 
                                    [
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                              
                              , where 
                              
                                 
                                    
                                       K
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 S
                                 
                                    (
                                    3
                                    ,
                                    3
                                    ,
                                    2
                                    ,
                                    2
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 →
                                 W
                                 
                                    [
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    ]
                                 
                               
                              is given in   (12)
                              . Moreover, these spline functions can be chosen such that their supports are contained within 
                              
                                 Ω
                              
                              .
                           


                        
                           Proof
                           The proof could be found in Appendix B.□


                        
                           Remark 3
                           Let us briefly revisit the construction of 
                                 T
                              -meshes of class 
                                 
                                    
                                       T
                                    
                                    
                                       3
                                       ,
                                       3
                                    
                                 
                              , as described by Wu et al.  [22], and illustrated in Fig. 15
                              . Their procedure starts with a tensor-product mesh over a rectangular domain (containing cells that are defined to be at level 0). In order to generate a cell at level 
                                 j
                                 +
                                 1
                              , one has to subdivide a quad of four neighboring cells at level 
                                 j
                               into sixteen subcells (which are defined to be at level 
                                 j
                                 +
                                 1
                              ). Any two 2×2 blocks of cells at level 
                                 j
                               which are to be subdivided must either have two common boundary edges, one common boundary vertex, or no common vertices. It must also be assumed that each cell is subdivided by two straight lines connecting the mid-points of the two opposite edges.

We see from Definition 8 that a hierarchical 
                                 T
                              -mesh of class 
                                 
                                    
                                       T
                                    
                                    
                                       3
                                       ,
                                       3
                                    
                                 
                               is of type 3. Let 
                                 T
                               be a hierarchical 
                                 T
                              -mesh of class 
                                 
                                    
                                       T
                                    
                                    
                                       3
                                       ,
                                       3
                                    
                                 
                              . The domain 
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                              , which is to be divided to obtain cells at level 
                                 j
                                 +
                                 1
                              , is composed of 2×2 blocks of cells at level 
                                 j
                              . We can create a domain 
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                                 ⊃
                                 
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       j
                                    
                                 
                               by unifying all the cells at level 
                                 j
                              . If 
                                 j
                                 ⩾
                                 1
                              , then, because of the way in which 
                                 T
                               was constructed, 
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               is composed of 4×4 blocks at level 
                                 j
                               (originally the 2×2 blocks at level 
                                 j
                                 −
                                 1
                              ). In order to prove that 
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               admits an inner offset at a distance 1, we need to show that 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               admits an offset at a distance 1. The domain 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               is also composed of 4×4 blocks of cells. It is apparent that the cells from the offset region 
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                               of a domain 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               are related to 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               through the connections shown in Fig. 6. This observation implies that 
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 ∖
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                               admits an offset at a distance 1. If 
                                 j
                                 =
                                 0
                              , then it suffices to suppose that the original tensor-product mesh has at least 3 cells in both coordinate directions to guarantee that 
                                 
                                    
                                       Ω
                                    
                                    
                                       0
                                    
                                 
                               admits an inner offset at a distance 1. We assume that the cells at level 0 having common edges with the boundary of 
                                 T
                               are not divided, i.e. starting at level 1, all introduced line-segments will be maximal interior segments of 
                                 T
                              . Thus, by Definition 8, 
                                 T
                               is of type 3. From Lemma 4 we have that for the 
                                 T
                              -mesh 
                                 T
                              , the line-segments, which are used to divide the cells of level 
                                 j
                              , may be arranged in the following simple way. The line-segments of length 
                                 ⩾
                                 4
                               need not be ordered. Then, the remaining line-segments, which are of length 2, may also be ordered arbitrarily, except for isolated quads (see Fig. 22, right), which can simply be ordered in a clockwise direction. The spline basis functions of 
                                 S
                                 
                                    (
                                    3
                                    ,
                                    3
                                    ,
                                    2
                                    ,
                                    2
                                    )
                                 
                                 
                                    (
                                    T
                                    )
                                 
                               can be obtained by Lemma 4.

From the proof of Lemma 4, we see that spline basis functions can be obtained; but, for example, this may involve the sophisticated construction shown in Fig. 21 (center). It is more practical to use configurations in which the line-segments can be ordered in a simple or even arbitrary way. From this point of view, it is reasonable to assume that all maximal interior segments are of length 
                           ⩾
                           m
                        . This latter assumption ensures us that the corresponding 
                           T
                        -mesh is regular, defined as in Mourrain  [25].

This assumption enables us to order the line-segments within a step 2 of the refinement strategy in an arbitrary way. Moreover, it enables us not to assume that the line-segments 
                           
                              
                                 E
                              
                              
                                 j
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 E
                              
                              
                                 j
                                 
                                    
                                       n
                                    
                                    
                                       j
                                    
                                 
                              
                           
                         refining 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                         have endpoints on 
                           ∂
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 j
                              
                           
                        . In addition, we do not need to assume that each cell of 
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 j
                              
                           
                         is divided following the rule illustrated in Fig. 12; we may admit that a cell of 
                           
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                              
                              
                                 j
                              
                           
                         is divided by several line-segments in both directions. A step 2 of this modified refinement strategy is illustrated in Fig. 16
                        . From the proofs of Lemmas 3 and 4 we see that the spline basis functions are tensor-product 
                           B
                        -splines except probably those which correspond to the line-segments intersecting in vertices that are close enough to the boundary 
                           ∂
                           
                              
                                 Ω
                              
                              
                                 j
                              
                           
                        . In order to guarantee that all the spline basis functions are tensor-product 
                           B
                        -splines, we need to extend the line-segments intersecting in each vertex 
                           Z
                        , for which 
                           
                              
                                 f
                              
                              
                                 Z
                              
                           
                         cannot be represented as a tensor-product 
                           B
                        -spline, until the boundary of a domain 
                           
                              
                                 Ω
                              
                              
                                 Z
                              
                           
                         (see e.g. Fig. 20).

@&#CONCLUSIONS@&#

We have described an iterative strategy for generating consistent hierarchical 
                        T
                     -meshes. It is based on the concept of a domain of restricted configuration, which is composed of the cells of a tensor-product mesh, and which is divided in successive steps. We have described the required ordering of line-segments during refinement, and the construction of basis functions for splines of degree 2 and 3.

We have shown that hierarchical 
                        T
                     -meshes of classes 
                        
                           
                              T
                           
                           
                              2
                              ,
                              2
                           
                        
                      and 
                        
                           
                              T
                           
                           
                              3
                              ,
                              3
                           
                        
                      are produced by this strategy for degrees 2 and 3 respectively. We have described the relevant modifications of our strategy which substantially simplify the ordering of line-segments and the corresponding construction of basis functions.

The concept of consistent hierarchical 
                        T
                     -meshes is promising for applications as long as they allow local refinement and offer a simple way for describing spline basis functions. Our iterative strategy provides a feasible framework for generating consistent hierarchical 
                        T
                     -meshes. We believe that the results of this paper might help in selection and processing of possible implementations of consistent hierarchical 
                        T
                     -meshes. In our future work we intend to propose analogues of consistent hierarchical 
                        T
                     -meshes for trivariate case and offer a strategy for generating of such meshes.

@&#ACKNOWLEDGMENTS@&#

This research was supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (MEST) (No. 2012-00005043) and partially funded by the Ministry of Knowledge Economy (MKE, Korea) (No. 10035474). Durkbin Cho was supported by the Basic Science Research Program through the National Research Foundation of Korea (NRF) funded by the Ministry of Science, ICT & Future Planning (No. 2012-R1A1A1006109).

In this appendix we will give the proof of Lemma 3. 
                        Proof
                        Given a maximal interior segment 
                              E
                              ∈
                              
                                 {
                                 
                                    
                                       E
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       E
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                           , let 
                              L
                              
                                 (
                                 E
                                 )
                              
                            denote the number of cells of 
                              
                                 
                                    Ω
                                 
                                 
                                    ̂
                                 
                              
                              ⊂
                              Ω
                            that are divided by the line-segment 
                              E
                           ; we will call 
                              L
                              
                                 (
                                 E
                                 )
                              
                            the length of 
                              E
                           . An admissible ordering of the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    E
                                 
                                 
                                    n
                                 
                              
                            can be obtained quite simply by ensuring that all the line-segments of length 
                              ⩾
                              2
                            precede those of length 1.

However, this issue is more easily understood if we arrange the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    E
                                 
                                 
                                    n
                                 
                              
                            as follows. Let 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            be all the vertical line-segments of length 
                              ⩾
                              2
                           , ordered from left to right; similarly let 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            be all the horizontal line-segments of length 
                              ⩾
                              2
                           , ordered from bottom to top. The remaining line-segments 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    n
                                 
                              
                            of length 1 do not need to be ordered.

Since 
                              Ω
                            admits an inner offset at a distance 
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           , the lemma statement above applies to the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            as a direct consequence of Proposition 2.

For a given horizontal line-segment 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              +
                              1
                              ⩽
                              i
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                           , let 
                              Z
                            be the location of the intersection with a vertical line-segment 
                              
                                 
                                    E
                                 
                                 
                                    j
                                 
                              
                              ,
                              j
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                           . Consider two short subsegments 
                              H
                            from 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            and 
                              V
                            from 
                              
                                 
                                    E
                                 
                                 
                                    j
                                 
                              
                            length 2, which intersect at 
                              Z
                           ; such subsegments always exist because 
                              L
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ,
                              L
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              ⩾
                              2
                           . Since 
                              Ω
                            admits an inner offset at a distance 
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           , one of the two configurations of cells shown in Fig. 17
                            must occur.

We can now obtain a spline function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              ∈
                              S
                              
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , using one of two formulas, depending on which of the configurations shown in Fig. 17 actually occurs. For the first configuration, on the left in Fig. 17, the function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            is defined as follows: 
                              
                                 (17)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          Z
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    ;
                                 
                              
                            and for the second configuration, on the right in Fig. 17, as follows: 
                              
                                 (18)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          Z
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    +
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    +
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    .
                                 
                              
                            This latter function is defined in the space 
                              S
                              
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , because the functions: 
                              
                                 
                                    
                                       N
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       +
                                       N
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       N
                                       
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       +
                                       N
                                       
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                    
                                 
                              
                            are all of class 
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                            at the points 
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                           , with respect to 
                              x
                            and 
                              y
                            respectively. The conformality factor 
                              
                                 
                                    k
                                 
                                 
                                    Z
                                 
                              
                            for the vertex 
                              Z
                           , corresponding to the function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           , is nonzero. Indeed, proving this by contradiction, if we suppose that 
                              
                                 
                                    k
                                 
                                 
                                    Z
                                 
                              
                              =
                              0
                           , then the conformality factors for the vertices on the line-segments 
                              H
                            and 
                              V
                            are zero (because only three knots remain on 
                              H
                            and three on 
                              V
                           ), and the function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            is of class 
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                            with respect to 
                              x
                            and 
                              y
                            along the line-segments 
                              V
                            and 
                              H
                            respectively using similar reasoning to Lemma 1, which contradicts formulas (17) and (18).

Let 
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                            denote the set of vertices in line-segment 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                           , such that each element of 
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                            is an intersection of 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            with a vertical line-segment 
                              
                                 
                                    E
                                 
                                 
                                    j
                                 
                              
                              ,
                              j
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                           . Thus, for any vertex 
                              Z
                              ∈
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           , there is a spline function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              ∈
                              S
                              
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , such that the corresponding conformality factor 
                              
                                 
                                    k
                                 
                                 
                                    Z
                                 
                              
                              ≠
                              0
                           ; and 
                              
                                 
                                    k
                                 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          ̂
                                       
                                    
                                 
                              
                              =
                              0
                            for any other vertex 
                              
                                 
                                    Z
                                 
                                 
                                    ̂
                                 
                              
                              ∈
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                                 
                                    Z
                                 
                                 
                                    ̂
                                 
                              
                              ≠
                              Z
                           . Let 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            denote the line-segment which is obtained from 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            by eliminating vertices belonging to the set 
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                           . By virtue of Proposition 2, there are 
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              =
                              L
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              −
                              m
                            tensor-product 
                              B
                           -splines 
                              
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 }
                              
                              ⊂
                              S
                              
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            with supports within the domain 
                              Ω
                            such that the set 
                              
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          K
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 }
                              
                            (where 
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              :
                              S
                              
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              →
                              W
                              
                                 [
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                            is defined by (12)) forms a basis of the space 
                              W
                              
                                 [
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                           . Thus, there are 
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              +
                              #
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                              
                            spline functions 
                              
                                 
                                    ⋃
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                 
                              
                              ∪
                              
                                 
                                    ⋃
                                 
                                 
                                    Z
                                    ∈
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              ⊂
                              S
                              
                                 (
                                 2
                                 ,
                                 2
                                 ,
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            which have projections under the map 
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ∘
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                            that form the basis of the space 
                              W
                              
                                 [
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                           ; moreover, because of the way they are constructed, these functions have supports within the domain 
                              Ω
                           . There is nothing to prove for the remained line-segments 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    n
                                 
                              
                           , because 
                              W
                              
                                 [
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                              =
                              
                                 0
                              
                            for any 
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              +
                              1
                              ⩽
                              i
                              ⩽
                              n
                           . Thus, Lemma 3 is proved.□

In this appendix we will give the proof of Lemma 4. 
                        Proof
                        As we did in the proof of Lemma 3, we arrange the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    n
                                 
                              
                            in order of their lengths 
                              L
                              
                                 (
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ,
                              i
                              =
                              1
                              ⋯
                              n
                           . Line-segments of length 
                              ⩾
                              3
                            can be arranged in an arbitrary way; but we will suppose that 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            are all the vertical line-segments of length 
                              ⩾
                              3
                           , arranged from left to right. Similarly, 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                            are all the horizontal line-segments of length 
                              ⩾
                              3
                           , arranged from bottom to top. The required ordering for line-segments of length 
                              ⩽
                              2
                            will be specified later.

Since 
                              Ω
                            admits an inner offset at a distance 1, the lemma statement above applies to the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            as a direct consequence of Proposition 2.

Let 
                              Z
                            be the vertex at which a horizontal line-segment 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              +
                              1
                              ⩽
                              i
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                            intersects with a vertical line-segment 
                              
                                 
                                    E
                                 
                                 
                                    j
                                 
                              
                           , which has index 
                              j
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                           . We will suppose that 
                              Z
                            is not inside the leftmost or the rightmost cell divided by the horizontal line-segment 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                           . Consider two short subsegments, 
                              H
                            from 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            and 
                              V
                            from 
                              
                                 
                                    E
                                 
                                 
                                    j
                                 
                              
                           , both of length 3, which intersect at 
                              Z
                           , such that the cell that contain 
                              Z
                            is the middle cell divided by 
                              H
                           .

Let 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                            be the possible minimal domain composed of cells from domain 
                              Ω
                           , which contains subsegments 
                              H
                            and 
                              V
                           , and admits an inner offset at a distance 1. The possible configurations of the domain 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                            are shown in Figs. 18 and 20
                            (left). For spline function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                            corresponding to the configuration in Fig. 20 (left) is: 
                              
                                 (19)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          Z
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             6
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    +
                                    
                                       
                                          3
                                       
                                       
                                          5
                                       
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             6
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             6
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    +
                                    
                                       
                                          3
                                       
                                       
                                          5
                                       
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    .
                                 
                              
                            This function is defined in the space 
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            because functions: 
                              
                                 
                                    
                                       N
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       +
                                       
                                          
                                             3
                                          
                                          
                                             5
                                          
                                       
                                       N
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                6
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             3
                                          
                                          
                                             5
                                          
                                       
                                       N
                                       
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       +
                                       N
                                       
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                5
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                6
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                    
                                 
                              
                            are all of class 
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                            at the points 
                              
                                 
                                    x
                                 
                                 
                                    4
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                           , with respect to 
                              x
                            and 
                              y
                            respectively.

We will now suppose that the vertex 
                              Z
                            is inside either the leftmost or the rightmost cell divided by the horizontal line-segment 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                           . Again 
                              H
                            and 
                              V
                            are subsegments, both of length 3, of 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    E
                                 
                                 
                                    j
                                 
                              
                            respectively, which intersect at 
                              Z
                           . The possible configurations of the domain 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                            are shown in the Figs. 19 and 20
                           
                           
                           
                            (right). The spline function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                            corresponding to the configuration in the Fig. 20 (right) is: 
                              
                                 (20)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          Z
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    −
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             6
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             7
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    +
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             6
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             7
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             6
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             7
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    +
                                    N
                                    
                                       [
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    N
                                    
                                       [
                                       
                                          
                                             y
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             5
                                          
                                       
                                       ]
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    .
                                 
                              
                           
                        

This function is in the space 
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            because the functions 
                              
                                 
                                    
                                       N
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       −
                                       N
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                6
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                7
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       N
                                       
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                5
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                       −
                                       N
                                       
                                          [
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                5
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                6
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                7
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          y
                                          )
                                       
                                    
                                 
                              
                            are all of class 
                              
                                 
                                    C
                                 
                                 
                                    ∞
                                 
                              
                            at the points 
                              
                                 
                                    x
                                 
                                 
                                    4
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    4
                                 
                              
                           , with respect to 
                              x
                            and 
                              y
                            respectively.

For the sake of brevity, we will not provide formulas for the spline function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              ∈
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            for all possible configurations of the domain 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                            (these configurations are shown in Figs. 18 and 19). However, we will prove that the function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                            exists by means of the following simple consideration. We extend the subsegments 
                              H
                            and 
                              V
                            inside 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                            until they meet the boundary 
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                           ; let 
                              
                                 
                                    H
                                 
                                 
                                    ˜
                                 
                              
                            and 
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                            denote the extended line-segments. Further, let 
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                            denote some tensor-product mesh over a rectangular domain, such that each cell of 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                            is a cell of 
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                           , and the boundary 
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                            has no common edges with the boundary of 
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                           . Applying Lemma 2 to the 
                              T
                           -mesh 
                              R
                              =
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                              ⋃
                              H
                              ⋃
                              V
                           , we find that 
                              
                                 dim
                              
                              
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 R
                                 )
                              
                              =
                              
                                 dim
                              
                              
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              +
                              1
                           . (Deploying Lemma 2 to deal with such a simple case is like using a steam-hammer to crack a nut; but it wide come into its own when we arrive at a more complicated construction shortly.)

Let 
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                            denote the 
                              T
                           -mesh 
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                              ⋃
                              
                                 
                                    H
                                 
                                 
                                    ˜
                                 
                              
                              ⋃
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                           . Applying Propositions 1 and 2 to refine 
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                            using the subsegments 
                              
                                 
                                    H
                                 
                                 
                                    ˜
                                 
                              
                            and 
                              
                                 
                                    V
                                 
                                 
                                    ˜
                                 
                              
                           , we obtain 
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              
                              =
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ⨁
                              
                                 span
                              
                              
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       l
                                    
                                 
                                 }
                              
                           , where 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    f
                                 
                                 
                                    l
                                 
                              
                            are tensor-product 
                              B
                           -splines that have supports within the domain 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                           . Since 
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ⊂
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 R
                                 )
                              
                              ⊂
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ˜
                                    
                                 
                                 )
                              
                           , an appropriate spline function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                              ∈
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 R
                                 )
                              
                            (such that 
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 R
                                 )
                              
                              =
                              S
                              
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 2
                                 ,
                                 2
                                 )
                              
                              
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                              ⨁
                              
                                 span
                              
                              
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       Z
                                    
                                 
                                 }
                              
                           ) can be obtained by taking a linear combination of 
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    f
                                 
                                 
                                    l
                                 
                              
                           , which will have support within the domain 
                              
                                 
                                    Ω
                                 
                                 
                                    Z
                                 
                              
                           . Thus the existence of a function 
                              
                                 
                                    f
                                 
                                 
                                    Z
                                 
                              
                            for the subsegments 
                              H
                              ⊂
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              ,
                              V
                              ⊂
                              
                                 
                                    E
                                 
                                 
                                    j
                                 
                              
                            and 
                              H
                              ⋂
                              V
                              =
                              
                                 {
                                 Z
                                 }
                              
                            is proved. By exactly the same arguments as we used in Lemma 3, we extend this lemma to all the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           .

We can now see how to order the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                            of length 2, from the following observation. Since the line-segments 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    E
                                 
                                 
                                    n
                                 
                              
                            refining 
                              
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                            have endpoints on 
                              ∂
                              
                                 
                                    Ω
                                 
                                 
                                    ̂
                                 
                              
                           , the set of line-segments of length 2 can be decomposed into chains of three types. A chain of the first type connects two (possibly identical) line-segments of length 
                              ⩾
                              3
                            (see Fig. 21). A chain of the second type intersects with a line-segment of length 
                              ⩾
                              3
                            at just one vertex (see Fig. 22, left). A chain of the third type has no intersections with any line-segment of length 
                              ⩾
                              3
                            (see Fig. 22, center); in a special case a chain of the third type divides four neighboring cells, as shown in Fig. 22 (right). The set of chains does not need to be organized, but the line-segments in each chain must be ordered: for example in Fig. 21 (center) and Fig. 22 (left and center) the line-segments might be ranged from upper-left to lower-right; and in Fig. 22 (right) the line-segments might run clockwise. From Lemma 2, only a chain of the first type (see Fig. 21) and the type of chain shown in Fig. 22 (right) provide a nontrivial spline function. From Propositions 1 and 2 we see that this function can be chosen with a support inside the domain 
                              Ω
                           . There is nothing to prove for the remaining line-segments 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    1
                                 
                              
                              ≺
                              ⋯
                              ≺
                              
                                 
                                    E
                                 
                                 
                                    n
                                 
                              
                            of length 1, because 
                              W
                              
                                 [
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                              =
                              
                                 0
                              
                            for any 
                              
                                 
                                    k
                                 
                                 
                                    3
                                 
                              
                              +
                              1
                              ⩽
                              i
                              ⩽
                              n
                           . Lemma 4 is proved.□

@&#REFERENCES@&#

