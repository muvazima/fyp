@&#MAIN-TITLE@&#Adaptive diffusion flow active contours for image segmentation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A harmonic hypersurface minimal functional is to alleviate the possible leakage.


                        
                        
                           
                           An infinity laplacian functional is incorporated to our model.


                        
                        
                           
                           We adopt the p(x) harmonic maps to make the diffusion process adjust adaptively.


                        
                        
                           
                           Our model possesses the properties of weak edge preserving and concavity convergence etc.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Active contour model

Adaptive diffusion flow (ADF)

Gradient vector flow (GVF)

Image segmentation

@&#ABSTRACT@&#


               
               
                  Gradient vector flow (GVF) active contour model shows good performance at concavity convergence and initialization insensitivity, yet it is susceptible to weak edges as well as deep and narrow concavity. This paper proposes a novel external force, called adaptive diffusion flow (ADF), with adaptive diffusion strategies according to the characteristics of an image region in the parametric active contour model framework for image segmentation. We exploit a harmonic hypersurface minimal functional to substitute smoothness energy term in GVF for alleviating the possible leakage. We make use of the p(x) harmonic maps, in which p(x) ranges from 1 to 2, such that the diffusion process of the flow field can be adjusted adaptively according to image characteristics. We also incorporate an infinity laplacian functional to ADF active contour model to drive the active contours onto deep and narrow concave regions of objects. The experimental results demonstrate that ADF active contour model possesses several good properties, including noise robustness, weak edge preserving and concavity convergence.
               
            

@&#INTRODUCTION@&#

Active contour models, or snakes [1], have been proven to be very effective tools for image segmentation, objects tracking [2–4], shape recovery [5], etc. A traditional active contour model is represented by a curve C(q)=(x(q), y(q)), q
                     ∈[0, 1], and it moves through the spatial domain of an image to minimize the energy functional
                        
                           (1)
                           
                              E
                              (
                              C
                              )
                              =
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       α
                                       ·
                                       |
                                       
                                          
                                             C
                                          
                                          
                                             q
                                          
                                       
                                       (
                                       q
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       β
                                       ·
                                       |
                                       
                                          
                                             C
                                          
                                          
                                             qq
                                          
                                       
                                       (
                                       q
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       +
                                       g
                                       (
                                       C
                                       (
                                       q
                                       )
                                       )
                                    
                                 
                              
                              
                              dq
                              .
                           
                        
                     The first term of the integral stands for the internal force that keeps the contour continuous and smooth during deformation, the second term is the external force that drives the contour toward an object boundary or the other desired features within an image.

According to the representation and implementation, active contour models are classified into two categories: the parametric active contour models [6–9] and the geometric active contour models [10–15]. In this paper, we focus on the parametric active contour models, and our approach can be also integrated into geometric active contour models. Since the external force plays a leading role in driving the active contours to approach objects boundaries in the parametric active contour models, designing a novel external force field has been extensively studied [6,8,16–19]. Among all these external forces, gradient vector flow (GVF) proposed by Xu and Prince [8], has been one of the most successful external forces, which is computed as a diffusion of the gradient vectors of a gray-level or binary edge map derived from a given image, and allowed to increase the capture range. Due to the outstanding properties of GVF, a large number of modified versions have been presented [20,16,18,21] to improve the performance of active contour models. However, researchers found that the GVF suffers from several challenges including narrow and deep concavity convergence as well as weak edge leakage.

This paper aims to provide, in a rigorous mathematical framework, a new method to establish an equivalent framework between GVF diffusion process and image restoration process. We develop a novel external force for active contour models called adaptive diffusion flow (ADF), inspired by [22,23]. Our main contributions are threefold.
                        
                           (1)
                           We adopt a hypersurface minimal functional to substitute smoothness energy term in the original GVF. It tends to degenerate to a uniformly elliptic equation having strong regularizing properties in all directions at locations where the variation of the intensity is weak. And, in a neighborhood of an edge presenting a strong gradient, the hypersurface minimal functional is preferable to diffuse along tangent direction of an edge so as to preserve the weak edge efficiently.

We make use of the p(x) harmonic maps in which p(x) ranges from 1 to 2, such that the diffusion process of the flow field can be adjusted adaptively according to image characteristics.

We also introduce an infinity laplace functional to guarantee the ADF diffusion mainly along normal direction in the homogeneous of an image so that it drives the active contours onto deep and narrow concavity. The ADF is able to efficiently suppress the influence of noise because the diffusion along tangent direction is inclined to smooth the noise while preserving edges.

@&#BACKGROUND@&#

The traditional active contour model is limited to capture range and poor convergence to boundary concavities. GVF was proposed by Xu and Prince [8] as a new external force for active contour model to overcome these issues. It is a dense vector field, generated by diffusing the gradient vectors of a gray-level or binary edge map derived from an image. The GVF field is defined as a vector field 
                           V
                        (x, y)=[u(x, y), v(x, y)] that minimizes the following energy functional:
                           
                              (2)
                              
                                 E
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∬
                                             μ
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             dxdy
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       smoothness
                                       
                                       energy
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ∬
                                             |
                                             ∇
                                             f
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             |
                                             V
                                             -
                                             ∇
                                             f
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             dxdy
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       edge
                                       
                                       energy
                                    
                                 
                                 ,
                              
                           
                        where f is the edge map, ∣∇f∣ is high near the edges and nearly zero in homogeneous regions and μ is a positive weight to control the balance between smoothness energy and edge energy. By the calculus of variation, the minimization of Eq. (2) reduces to solving the following Euler–Lagrange equation:
                           
                              (3)
                              
                                 μ
                                 
                                    
                                       ∇
                                    
                                    
                                       2
                                    
                                 
                                 V
                                 -
                                 (
                                 V
                                 -
                                 ∇
                                 f
                                 )
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        
                     

The Euler–Lagrange equations evolving Eq. (3), embedded into a dynamic scheme by treating 
                           V
                        (x, y) as the function of t, x and y, formally are
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         u
                                                      
                                                      
                                                         ∂
                                                         t
                                                      
                                                   
                                                   =
                                                   μ
                                                   ·
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∇
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               u
                                                            
                                                            
                                                               ︸
                                                            
                                                         
                                                      
                                                      
                                                         diffusion
                                                         
                                                         term
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               u
                                                               -
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               )
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              f
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              f
                                                                           
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ︸
                                                            
                                                         
                                                      
                                                      
                                                         data
                                                         
                                                         attraction
                                                         
                                                         term
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         v
                                                      
                                                      
                                                         ∂
                                                         t
                                                      
                                                   
                                                   =
                                                   μ
                                                   ·
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∇
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                               v
                                                            
                                                            
                                                               ︸
                                                            
                                                         
                                                      
                                                      
                                                         diffusion
                                                         
                                                         term
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               v
                                                               -
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                               )
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              f
                                                                           
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              f
                                                                           
                                                                           
                                                                              y
                                                                           
                                                                           
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ︸
                                                            
                                                         
                                                      
                                                      
                                                         data
                                                         
                                                         attraction
                                                         
                                                         term
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ∇2 is the Laplacian operator. The active contour model with 
                           V
                        (x, y) as external force is called GVF active contour model.

GVF has successfully addressed the issues of building a satisfactory capture range and approaching boundary concavities, e.g. U-shape concavity convergence. However the GVF active contour model still fails to converge to narrow and deep concavity and would leak out around weak edges, especially neighbored by strong ones.
                           
                              (a)
                              
                                 Narrow and deep concavity: GVF can be regarded as a vector field constructed by diffusing original gradient vectors from near image edges to homogeneous regions, or from areas of non-zero vectors to ones of zero-vectors. The directions of vectors in the GVF field indicate the moving directions of Snaxels. The magnitudes of vectors take larger values near the image edges, and they decrease to zero as vectors goes away from image edges. This prevents the active contours moving into the long, thin boundary indentations. In addition, as claimed in [20], excessive smoothing of the field near the boundaries governed by the constant coefficient μ, also results in the failure of narrow and deep concavities convergence.

This drawback of GVF can be seen from the example in Fig. 1
                        a–d. Fig. 1a shows the GVF active contour model initialization and evolution of a synthetic image which is a concavity of 5-pixel width and 80-pixel depth. If we take a close-up to the GVF vector field in Fig. 1c, we can see the contradiction of forces from two opposite directions. This contradiction makes the temporary boundary stop moving. The segmentation result of GVF active contour model is shown in Fig. 1d.

A number of methods have been proposed to address this problem. Xu and Prince [20] introduced the generalized GVF (GGVF) active contour model to improve the original GVF by replacing the constant weighting coefficient μ with two spatially varying weighting function. However, there is no essential difference between GGVF and GVF. The ability of entering into the concavity of edge is also limited. The illustration can be found in Fig. 1e–h. Yu et al.[24] presented the normalized gradient vector diffusion by balancing the effect between weak vectors and strong vectors to improve the performance of GVF active contour model in deep concavity convergence. Hou et al. [25] proposed force field analysis active contour model, based on analyzing force distribution rules via Euclidean distance transformations. Similarly, Rodtook et al. [26] extended GGVF by introducing an adaptive edge map derived from continuous orientation force field analysis. Sum and Cheung [27] proposed the boundary vector field external force, under whcih the active contour evolves in two phases and moves into semi-closed concave region. Decomposing diffusion term in Eq. (4) as weighted sum of the two directional derivatives along normal and tangent direction, Ning et al. [28] exploited the normal gradient vector flow (NGVF) to ameliorate the concavities convergence by only adopting normal direction diffusion. However, it is unreasonable due to the fact that diffusion in tangent direction is inclined to smooth the noise while preserving edges. Wang et al. [29] further elaborated the mechanism of GVF from the perspective of Helmholtz decomposition, and introduced harmonic gradient vector flow (HGVF) which could converge to narrow concavities. Employing the measurement update energy term and separate prior energy term, Mishra et al. [17] demonstrated that the decoupled active contour model (DAC) can capture the regions of very high curvature and is robust to noise.
                           
                              (b)
                              
                                 Weak edge leakage: In GVF active contour model, at the location where a weak edge is very close to a strong one, the active contour readily leads to boundaries leakage. This can be explained by the inherent competition of the diffusion process: It is well known that ∇2
                                 u and ∇2
                                 v are in the nature of very strong isotropic smoothing properties and cannot preserve edges in the diffusion term of Eq. (4), as t increases, the isotropic smoothing effect will dominate the diffusion. Moreover, the better force field highly depends on μ. However, if μ is too large, the active contours will tend to larger deviation from the original data and easily leak from weak edges. If μ is small enough, this over-smoothing efficiency could be depressed, but, at the same time, the force field preserves excessive noise. This is a dilemma for GVF to suppress noise and preserve weak edge simultaneously

In Fig. 2
                        , we construct a particular image to show the performance of GVF active contour model at weak edge preserving. In this image, there is a gap neighbored by a strong line. Fig. 2b shows that GVF force field, and the regions indicated by the dashed rectangle will be enlarged in Fig. 2c such that the vector field can be more clearly displayed. The GVF active contour model is attached incorrectly toward to strong line in Fig. 2a result from the GVF is difficult to prevent the vectors near the boundary gap from being significantly influenced by the nearby strong one (see Fig. 2c). The segmentation result is shown in Fig. 2d.

Recently some modified GVF active contour model have been developed to address this issue. Li et al. [30] proposed edge preserving gradient vector flow (EPGVF), which makes 
                           V
                        (x, y) projection along object edges to be better for preserving edges. Some improved results have been acquired by a robust region-based segmentation method introduced by Xie and Mirmehdi [12]. By generalizing the Laplacian operator from flat space to manifold during diffusion, Lu et al. [21] presented gradient vector flow over manifold (GVFOM) which outperforms GVF in terms of weak edge preserving, concavities convergence. Tang [16] exploited the multi-direction GVF active contour to trace the boundary of the skin cancer even if there are other objects near the skin cancer region. By integrating the gradient vector flow and the prior directional information, Zhu et al. [31] introduced gradient and direction vector flow, which is capable of addressing the issue of weak edge leakage in some cases. Kovacs et al. [32] proposed harris function based active contour external force for detecting complex boundaries with weak contrast and high curvatures.

The GVF field 
                           V
                        (x, y)=[u(x, y), v(x, y)] can be simplified as
                           
                              (5)
                              
                                 E
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∬
                                             μ
                                             ·
                                             |
                                             ∇
                                             V
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             dxdy
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       smoothness
                                       
                                       energy
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ∬
                                             |
                                             V
                                             -
                                             ∇
                                             f
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             dxdy
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       edge
                                       
                                       energy
                                    
                                 
                                 ,
                              
                           
                        where μ is the same as in Eq. (2). From the perspective of image restoration, the GVF finds for a 
                           V
                         that best fits the data ∣∇f∣ so that the force filed is smooth. For convenience of theoretical analysis, Eq. (5) is rewritten as
                           
                              (6)
                              
                                 E
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 ∬
                                 μ
                                 ·
                                 Φ
                                 (
                                 |
                                 ∇
                                 V
                                 |
                                 )
                                 dxdy
                                 +
                                 ∬
                                 |
                                 V
                                 -
                                 ∇
                                 f
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 dxdy
                                 .
                              
                           
                        
                     

Using variational calculus, minimization of Eq. (6) formally satisfies the Euler–Lagrange equation
                           
                              
                                 
                                    
                                       ∂
                                       V
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 μ
                                 ·
                                 div
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                |
                                                ∇
                                                V
                                                |
                                                )
                                             
                                             
                                                |
                                                ∇
                                                V
                                                |
                                             
                                          
                                          ∇
                                          V
                                       
                                    
                                 
                                 -
                                 (
                                 V
                                 -
                                 ∇
                                 f
                                 )
                                 .
                              
                           
                        In [33], the isotropic Laplacian operator are decomposed using the local image structures, that is, ∇2
                        
                           V
                        
                        =
                        
                           V
                        
                        
                           NN
                        
                        +
                        
                           V
                        
                        
                           TT
                        . 
                           V
                        
                        
                           TT
                         and 
                           V
                        
                        
                           NN
                         are the second derivatives of 
                           V
                         in the tangent direction and normal direction, respectively. Accordingly, 
                           
                              
                                 
                                    ∂
                                    V
                                 
                                 
                                    ∂
                                    t
                                 
                              
                           
                         can be written in an expanded form by formally developing the divergence term given by
                           
                              
                                 
                                    
                                       ∂
                                       V
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 μ
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                |
                                                ∇
                                                V
                                                |
                                                )
                                             
                                             
                                                |
                                                ∇
                                                V
                                                |
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                TT
                                             
                                          
                                          +
                                          
                                             
                                                Φ
                                             
                                             
                                                ″
                                             
                                          
                                          (
                                          |
                                          ∇
                                          V
                                          |
                                          )
                                          
                                             
                                                V
                                             
                                             
                                                NN
                                             
                                          
                                       
                                    
                                 
                                 -
                                 (
                                 V
                                 -
                                 ∇
                                 f
                                 )
                                 ,
                              
                           
                        where
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         TT
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         |
                                                         ∇
                                                         V
                                                         
                                                            
                                                               |
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                            -
                                                            2
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         NN
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         |
                                                         ∇
                                                         V
                                                         
                                                            
                                                               |
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            2
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  V
                                                               
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (2), Φ(∣∇
                           V
                        ∣)=∣∇
                           V
                        ∣2 has an isotropic smoothing effect in the field 
                           V
                        (x, y), which is desired for homogeneous regions, but not for edge regions. Compared with the diffusion term in Eq. (2), Φ(∣∇
                           V
                        ∣) in Eq. (6) takes different forms. Since the GVF field can be expressed as the image restoration model form, we can establish an equivalent framework between GVF diffusion process and image restoration model. Consequently, the question addressed in this section is how to modify Φ(∣∇
                           V
                        ∣) which possesses better diffusion properties while preserving weak edge?
                     

To answer this question, the function Φ(∣∇
                           V
                        ∣) should satisfy the following two conditions [33]. One is that at locations where the image gradients are low, function Φ(∣∇
                           V
                        ∣) has isotropic smoothing property, and may be achieved by imposing
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            |
                                                            ∇
                                                            V
                                                            |
                                                            →
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         (
                                                         |
                                                         ∇
                                                         V
                                                         |
                                                         )
                                                      
                                                      
                                                         |
                                                         ∇
                                                         V
                                                         |
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            |
                                                            ∇
                                                            V
                                                            |
                                                            →
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   (
                                                   |
                                                   ∇
                                                   V
                                                   |
                                                   )
                                                   >
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The other is that in a neighborhood of an edge, the image presents a strong gradient. If we wish to better preserve this edge, it is preferable to diffusion only in the direction parallel to edge, i.e., in the tangent direction. Φ(∣∇
                           V
                        ∣) should be satisfied the following requirement
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            |
                                                            ∇
                                                            V
                                                            |
                                                            →
                                                            +
                                                            ∞
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         ″
                                                      
                                                   
                                                   (
                                                   |
                                                   ∇
                                                   V
                                                   |
                                                   )
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            lim
                                                         
                                                         
                                                            |
                                                            ∇
                                                            V
                                                            |
                                                            →
                                                            +
                                                            ∞
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         (
                                                         |
                                                         ∇
                                                         V
                                                         |
                                                         )
                                                      
                                                      
                                                         |
                                                         ∇
                                                         V
                                                         |
                                                      
                                                   
                                                   >
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Many functions Φ(∣∇
                           V
                        ∣) satisfying the conditions both (7) and (8) can be found. In this paper, we adopt 
                           
                              Φ
                              (
                              |
                              ∇
                              V
                              |
                              )
                              =
                              
                                 
                                    1
                                    +
                                    |
                                    ∇
                                    V
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        , usually called the hypersurface minimal function. The diffusion properties of this function can be further elucidated in Appendix A. If we consider 
                           V
                         as a surface defined on image domain, the corresponding diffusion term in Eq. (2) is given by
                           
                              (9)
                              
                                 E
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 ∬
                                 
                                    
                                       1
                                       +
                                       |
                                       
                                          
                                             G
                                          
                                          
                                             σ
                                          
                                       
                                       ⊗
                                       ∇
                                       V
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                 dxdy
                                 ,
                              
                           
                        where G
                        
                           σ
                         is the Gaussian kernel of standard deviation σ which could smooth the force field, ∇
                           V
                         denotes the gradient of 
                           V
                        , ⊗ presents convolution operation. The underlying idea of Eq. (9) is to take 
                           V
                         as a surface, then to minimize the area of the surface. As we will see further, if ∣∇
                           V
                        ∣→∞, then 
                           
                              Φ
                              (
                              ∣
                              ∇
                              V
                              ∣
                              )
                              =
                              
                                 
                                    1
                                    +
                                    |
                                    
                                       
                                          G
                                       
                                       
                                          σ
                                       
                                    
                                    ⊗
                                    ∇
                                    V
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              →
                              |
                              ∇
                              V
                              |
                           
                        . This is similar to the diffusion process of total variation (TV) model [34] which works excellently in preserving edges as the diffusion is along edges.

To obtain a better adaptive diffusion, we build a more effective functional, in a departure from minimal surface and the p(x) harmonic maps. Given an image function defined by 
                           
                              I
                              :
                              [
                              0
                              ,
                              W
                              ]
                              ×
                              [
                              0
                              ,
                              H
                              ]
                              →
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                        , let Ω be a bounded open subset of 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              ,
                              ∂
                              Ω
                           
                         its boundary, f an edge map of I. The harmonic hypersurface functional is defined as
                           
                              (10)
                              
                                 E
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 ∬
                                 
                                    
                                       1
                                    
                                    
                                       p
                                       (
                                       |
                                       ∇
                                       f
                                       |
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   +
                                                   |
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                   ⊗
                                                   ∇
                                                   V
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       p
                                       (
                                       |
                                       ∇
                                       f
                                       |
                                       )
                                    
                                 
                                 
                                 d
                                 Ω
                                 ,
                              
                           
                        where p(·) is a monotonic decreasing function and ranging from 1 to 2, and we choose p(∣∇f∣)=1+1/(1+∣∇G
                        
                           σ
                        
                        ⊗ 
                        f(x)∣). In our case, when ∣∇G
                        
                           σ
                        
                        ⊗
                        f(x)∣→ 0, p(·)→2, Eq. (10) would behave like isotropic diffusion within homogeneous regions. When ∣∇ G
                        
                           σ
                        
                        ⊗
                        f(x)∣→∞, p(·)→1, therefore, on the boundaries Eq. (10) would behave like TV model [34], and only diffusion in the direction parallel to edge works. With this nature, the harmonic hypersurface functional can preserve weak edges as well as yield a smooth force field.

GVF has another limitation of failing to converge to narrow and deep concavity. Under the spatiotemporal varying local coordinate system, the Laplacian operator can be expanded into the sum of two directional derivatives along tangent and normal [33]. As discussed in [28], the diffusion in normal direction plays the key roles on the diffusion of GVF, we would like to encourage the diffusion along normal direction in image smoothing region so as to make vectors downward into the boundary concavity rather than converge from two opposite direction (see Fig. 1b), or disappear far from image concavity edges (see Fig. 1f). Consequently, the second question is how to construct a functional which possesses convergence to narrow and deep concavity?
                     

In this paper, we develop a functional associated with absolutely minimizing Lipschitz extensions. Considering L
                        
                           p
                         functional
                           
                              (11)
                              
                                 
                                    
                                       E
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       p
                                    
                                 
                                 ∫
                                 |
                                 ∇
                                 V
                                 
                                    
                                       |
                                    
                                    
                                       p
                                    
                                 
                                 
                                 dx
                                 .
                              
                           
                        By putting p
                        →∞, the infinity Laplacian functional is given by
                           
                              (12)
                              
                                 
                                    
                                       E
                                    
                                    
                                       ∞
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       p
                                    
                                 
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 |
                                 ∇
                                 V
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                       (
                                       Ω
                                       )
                                    
                                 
                                 
                                 d
                                 Ω
                                 .
                              
                           
                        A minimization of Eq. (12) is an absolutely minimizing Lipschitz interpolant. The infinity Laplace equation is given in Appendix B.

Both the harmonic hypersurface functional and the infinity functional are the theoretical foundation of our method. In this study, we present a unified diffusion framework, called adaptive diffusion flow (ADF). This diffusion is anisotropic. The ADF is given by
                           
                              (13)
                              
                                 E
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∬
                                             g
                                             ·
                                             
                                                
                                                   
                                                      -
                                                      m
                                                      ·
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  ∞
                                                               
                                                            
                                                            (
                                                            Ω
                                                            )
                                                         
                                                      
                                                      +
                                                      (
                                                      1
                                                      -
                                                      m
                                                      )
                                                      ·
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            p
                                                            (
                                                            |
                                                            ∇
                                                            f
                                                            |
                                                            )
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        1
                                                                        +
                                                                        Θ
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            p
                                                            (
                                                            |
                                                            ∇
                                                            f
                                                            |
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             dxdy
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       smoothness
                                       
                                       energy
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             ∬
                                             h
                                             ·
                                             (
                                             |
                                             V
                                             -
                                             ∇
                                             f
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                             dxdy
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       edge
                                       
                                       energy
                                    
                                 
                                 ,
                              
                           
                        where g, h, m are the weighting functions respectively, p(·) is a monotonic decreasing function, and Θ
                        =∣G
                        
                           σ
                        
                        ⊗∇
                           V
                        ∣2. A new active contour model, is defined based on the traditional active contour model in Eq. (1) by adopting ADF as the external force. Choosing appropriate weighting functions is crucial in achieving the goal of preserving weak edge and concavity convergence at the same time. Both g and h are the same as GGVF [20], and
                           
                              (14)
                              
                                 m
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         [
                                                         1
                                                         -
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         /
                                                         5
                                                         
                                                            
                                                               K
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ]
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   5
                                                   ⩽
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Here, K is a parameter computed by K
                        =1.4826·
                        E(∣∣∇ f∣−
                        E(∣∇f∣)∣) [35], where E(·) denotes mean value. The parameter analysis can be further elucidated in Section 4.1.

Next, we turn to the problem of finding the vector field that minimizes Eq. (13). Using variational calculus, minimization of this functional is given by
                           
                              (15)
                              
                                 
                                    
                                       ∂
                                       V
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 g
                                 ·
                                 
                                    
                                       
                                          m
                                          ·
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         |
                                                         ∇
                                                         V
                                                         
                                                            
                                                               |
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                   V
                                                
                                             
                                          
                                          +
                                          (
                                          1
                                          -
                                          m
                                          )
                                          ·
                                          div
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         (
                                                         |
                                                         ∇
                                                         V
                                                         |
                                                         )
                                                      
                                                      
                                                         |
                                                         ∇
                                                         V
                                                         ⊗
                                                         
                                                            
                                                               G
                                                            
                                                            
                                                               σ
                                                            
                                                         
                                                         |
                                                      
                                                   
                                                   (
                                                   ∇
                                                   V
                                                   ⊗
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 h
                                 ·
                                 (
                                 V
                                 -
                                 ∇
                                 f
                                 )
                                 .
                              
                           
                        Here, 
                           V
                        (0)=∇(∣∇G
                        
                           σ
                        
                        ⊗
                        I∣) and Δ
                        ∞
                        
                           V
                         denotes infinity Laplacian equation.

To compare the performance of GVF and ADF, we use the same images as Figs. 1 and 2 to computer ADF field for active contour model. In Fig. 3
                        , each column represents initialization and evolution, segmentation result, close-up of the vector field inside the green rectangle, respectively. The early work was introduced in [19].

The weighting function m is easily to be chosen to divide an image domain into three classes of regions including edge regions, homogeneous regions and transition regions [30]. We see that if f
                           2/5>
                           K
                           2, then m
                           →0, namely, in the image edge regions and transition regions, the smoothness energy is dominated by harmonic hypersurface functional, yielding a preserving weak edge effect. If f
                           2/5⩽
                           K
                           2, then m
                           →1, the infinite Laplacian functional dominates the smoothness energy term in Eq. (13). In the extreme, i.e. m
                           =1, Eq. (15) is reduced to
                              
                                 (16)
                                 
                                    
                                       
                                          ∂
                                          V
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    g
                                    ·
                                    
                                       
                                          1
                                       
                                       
                                          |
                                          ∇
                                          V
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          Δ
                                       
                                       
                                          ∞
                                       
                                    
                                    V
                                    -
                                    h
                                    ·
                                    (
                                    V
                                    -
                                    ∇
                                    f
                                    )
                                    =
                                    g
                                    ·
                                    
                                       
                                          V
                                       
                                       
                                          NN
                                       
                                    
                                    -
                                    h
                                    ·
                                    (
                                    V
                                    -
                                    ∇
                                    f
                                    )
                                    .
                                 
                              
                           In this case, we can achieve a equivalent form of NGVF [28], and thus our ADF model can enter into deep and narrow concavity. Our model is different from NGVF [28], in which, it just contains the diffusion along the normal direction and entirely ignores the diffusion in tangent direction. In contrast, the smoothness energy term in Eq. (13) has a positive impact on the preventing weak edge leakage and efficiently suppressing the influence of noise in ADF active contour model. For more details of Eq. (16), we refer the readers to Appendix B.

The diffusion properties of our ADF can be further elucidated by the orthogonal decomposition of Eq. (15) as follows:
                              
                                 (17)
                                 
                                    div
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   |
                                                   ∇
                                                   V
                                                   |
                                                   )
                                                
                                                
                                                   |
                                                   ∇
                                                   V
                                                   ⊗
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         σ
                                                      
                                                   
                                                   |
                                                
                                             
                                             (
                                             ∇
                                             V
                                             ⊗
                                             
                                                
                                                   G
                                                
                                                
                                                   σ
                                                
                                             
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      Θ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          p
                                          -
                                          2
                                       
                                    
                                    ·
                                    
                                       
                                          V
                                       
                                       
                                          TT
                                       
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             p
                                             -
                                             2
                                             )
                                             ·
                                             Θ
                                             ·
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               +
                                                               Θ
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   p
                                                   -
                                                   4
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               +
                                                               Θ
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   p
                                                   -
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ·
                                    
                                       
                                          V
                                       
                                       
                                          NN
                                       
                                    
                                    ,
                                 
                              
                           where Θ
                           =∣G
                           
                              σ
                           
                           ⊗∇
                              V
                           ∣2. From hereinbefore analysis, in the image edge regions and transition regions, P(x) harmonic hypersurface functional occupies an leading position in the smoothness energy term of Eq. (13). 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   +
                                                   Θ
                                                
                                             
                                          
                                       
                                    
                                    
                                       p
                                       -
                                       2
                                    
                                 
                              
                            represents diffusion coefficient in the tangent direction, in which the diffusion is encouraged because it smoothes noise while preserving edges. Also, 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 (
                                 p
                                 -
                                 2
                                 )
                                 ·
                                 Θ
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   +
                                                   Θ
                                                
                                             
                                          
                                       
                                    
                                    
                                       p
                                       -
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   +
                                                   Θ
                                                
                                             
                                          
                                       
                                    
                                    
                                       p
                                       -
                                       2
                                    
                                 
                              
                            is diffusion coefficient in the local gradient direction which could smooth edges. For GVF, if we rewrite Δ
                              V
                            with 
                              V
                           
                           
                              TT
                            and 
                              V
                           
                           
                              NN
                           , then λ
                           1
                           =
                           λ
                           2
                           =2, consequently, the gradient vector flow smoothes the data in the direction of gradient as same as in the edge direction, this is undesired. In order to preserve weak boundaries, we hope that there is no diffusion or much less diffusion parallel to gradient, that is in the λ
                           2 direction.

In fact, λ
                           2 can be rewritten as
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          p
                                          -
                                          2
                                          )
                                          ·
                                          Θ
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                4
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           Since 1<
                           p
                           <2, that is, 0<1−
                           p/2<1/2 and p
                           −2<0, according to the properties of exponential function, we get
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                      +
                                                      Θ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          -
                                          p
                                          /
                                          2
                                       
                                    
                                    >
                                    0
                                    .
                                 
                              
                           This means
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          p
                                          -
                                          2
                                          )
                                          ·
                                          Θ
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                4
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    <
                                    1
                                    .
                                 
                              
                           Similarly, we have
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          p
                                          -
                                          2
                                          )
                                          ·
                                          Θ
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                4
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          +
                                          (
                                          p
                                          -
                                          1
                                          )
                                          ·
                                          Θ
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            Θ
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                4
                                                -
                                                p
                                             
                                          
                                       
                                    
                                    >
                                    0
                                    .
                                 
                              
                           Thus we have 0<
                           λ
                           2
                           <1 for ADF. As a result, the smooth effect of the ADF is weaker than GVF, so the ADF possesses the property of preserving weak edge.

@&#EXPERIMENTAL RESULTS@&#

In this section, we first discuss the parameters that are involved in our method and their estimation. And then we describe comparison results of our ADF model with the GVF [8], GGVF [20], normal GVF (NGVF) [28], harmonic GVF (HGVF) [29], vector field convolution (VFC) [9] and extrapolation of vector fields using the infinity laplacian (ILGVF) [22], in terms of capture range and initialization insensitivity, narrow and deep concavity convergence, noise robustness, and edge preserving.

Our algorithm relies on several parameters that must be set. In this section, we describe each parameter and how they may be estimated directly from data. The parameters for the proposed active contour model are α, β, σ, κ and time step τ. Although the method contains many parameters, most of these parameters can be set to fixed values (e.g. α
                        =0.5, β
                        =0.5 and τ
                        =1).

Parameter σ is the standard deviation of the Gaussian kernel G
                        
                           σ
                         for controlling the smoothness of the external force filed. It has a correlation with the noise level of the image. The higher the image noise the larger σ should be. In Fig. 4
                        , we consider the behavior of our ADF active contour model varying settings of parameter σ. For the noise-free image, we can choose a small value of σ (see the top row in Fig. 4). For images with noise level, we can use relatively larger σ, as shown in the middle row of Fig. 4. However, our model cannot handle extreme settings (see the right-most two images of the bottom row in Fig. 4), and in these cases the results may not be usable. As σ increases, the smoothing effect will dominate the diffusion of Eq. (15) and the force filed easily leaks from the weak edges. The results indicate that the parameter setting of the proposed model is not critical. There is a wide range from which one can select an appropriate σ. In this experiment, we set α
                        =0.5, β
                        =0.5, κ
                        =0.05 and τ
                        =1.

Parameter κ is a constant that determines the contrast of the edges to be preserved and should be tuned for a particular application. If the edges are weak, κ should be small and vice versa. We tested a wide range of κ and found that κ bounded in the interval [0.03, 0.1] can give us good results for the cardiac image, as shown on the top of Fig. 5
                        . In contrast, the “U-shape” image possessing strong edge gives us a wider range of the parameter κ to choose from. We choose this parameter by trial and error according to the mentioned reference [20]. In this experiment, we set α
                        =0.5, β
                        =0.5, σ
                        =1 and τ
                        =1.

Given special steps Δx
                        =1, Δy
                        =1, the choice of the time step τ must satisfy the Courant-Friedrichs-Lewy (CFL) condition [36] for numerical stability. In our experiments, we set τ
                        =1. As in [8], the partial differential Eq. (15) can be implemented using an explicit finite difference scheme. Its major drawback is that the solution has to be found using an often time-consuming iterative procedure. Accordingly, choosing an appropriate iteration number in diffusion process significantly influences the segmentation performance [37]. We adopt decorrelation criterion [38] for the selection of the optimal diffusion iteration number of our ADF model. By considering two components (u and v) of ADF, the decorrelation criterion is given by T
                        
                           ADF
                        
                        =argmin
                           t
                        ∣corr(u
                        0
                        −
                        u
                        
                           t
                        , u
                        
                           t
                        )+
                        corr(v
                        0
                        −
                        v
                        
                           t
                        , v
                        
                           t
                        )∣, where 
                           
                              corr
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              
                                 
                                    cov
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          var
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          ·
                                          var
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    x
                                 
                              
                           
                         and v
                        0
                        =
                        f
                        
                           y
                        . Fig. 6
                         shows the evolution of correlation with iteration number.

We use the U-shape image of 64×64 pixels to verify the performance of the ADF active contour model in capture range enlargement (see Fig. 7
                        ) The parameters for active contour models in this experiment are α
                        =0.5, β
                        =0.5, and time step τ
                        =1. Both GVF (μ
                        =0.2) and ADF (σ
                        =1, κ
                        =0.01) active contour models after 20 iterations are capable of capturing the correct boundaries from a far-off initialization. The force field vectors within the concave region have downward component, so these two active contour models move onto the concave area progressively (see Fig. 7b). As seen in Fig. 7a, the ADF active contour model has better performance of convergence than GVF active contour model due to the fact that the infinite Laplacian functional of ADF is the principal organizing in forcing an active contour into long, thin boundary indentations within image homogeneous regions.

Furthermore, we increase the size of original U-shape and room-shape images to 128×128 pixels without increasing the size of objects in order to test the ADF active contour model. Fig. 8
                         shows the convergence results with the initial contour placed across, inside and outside the boundaries, where red dashed lines represent initialization curves. These experimental results show that the ADF active contour model is insensitive to initialization.

In this experiment, we demonstrate the success of ADF active contour model in narrow and deep concavity convergence. Fig. 9
                         is a comparison of ADF (σ
                        =0.1, κ
                        =0.05), GVF (μ
                        =0.2), GGVF (κ
                        =0.05), NGVF (μ
                        =0.2), ILGVF (μ
                        =0.2, Δt
                        =0.3) and HGVF (λ
                        =0.4, ρ
                        =0.0002). The parameters for active contour models are α
                        =0.1, β
                        =0.06 and time step τ
                        =1.


                        Fig. 9 shows experimental results on a synthetic image which is a concavity of 3-pixel width and 150-pixel depth for testing the convergence property of ADF active contour model. It is shown that the ADF active contour model enters into the concave region successfully and extracts the object correctly, since the ADF vectors point straight downward the bottom of concavity, while the GVF, GGVF, NGVF and ILGVF active contour models all fail. The GVF and ILGVF force field have upward vectors which block the way of the active contours moving into the concave region (the middle row of Fig. 9a and d). The properties of NGVF are confined in encountering very thin and long boundary indentations because the vectors are attracted by the side boundaries (see the bottom of Fig. 9c). In Fig. 9b, the weighting functions g(∣∇f∣) and h(∣∇ f∣) of GGVF are introduced for obtaining better convergence, but the vectors vanish far from concave region. It should be pointed out that HGVF active contour model also achieves boundary concavity, as shown in Fig. 9e, because of the different roles of the divergence and the curl during the diffusion process [29].

Following the experiment from Xie et al.[12], we compare the accuracy of different active contour models using the simple harmonic curves with different strengths of noise. The curve is generated by equation r
                        =
                        a
                        +
                        bcos (ρθ
                        +
                        c), where a, b and c remain constant, and ρ can be used to produce different numbers of star-shape grayscale images (ρ
                        =4). Impulse noise was added to the original image from 5% to 55%. The images superpose with initial active contours plotted in white dashed lines, and segmentation results are indicated by the white solid lines (see Fig. 10
                        ).

A simple subjective examination manifests the superior segmentation quality of the ADF active contour model. It can be observed that all the active contour models could converge the exact location of the object boundary at low percentages of noise. However, as increasing noise levels, incorrect convergence appears one after another. In case that the noise level indicates more than 5%, errors first occurs in NGVF active contour model, since it abandons the diffusion in tangent direction entirely. When the noise levels reach a certain value (45%), the ADF active contour model outperforms the other active contour models in noise resistance by setting larger standard deviation σ value which makes force field be smoother in general. Yet, considered the convolution by a Gaussian is isotropic, it does not mean the larger σ value could produce the better results because the force field may be over smoothed.

In Fig. 10, six active contour models are evaluated for different strengths of the same noise type. In order to further demonstrate the noise suppression ability of ADF active contour model, another example is shown in Fig. 8. The noisy U-shape image is created by different types of noise including salt and pepper, speckle noise and Gaussian noise. The active contour models convergence to the desired boundary without using any filter, that is, f(x, y)=−I(x, y). It is clear that the results of ADF and VFC active contour models look similar. The initial curves for the VFC and ADF active contour models are red dashed lines, and for the GVF active contour model they are set closer to the true boundary to ensure better results.

The performance of ADF in noise robustness is qualitatively illustrated through the subjective inspection of the visual appearance of segmentation results in Figs. 10 and 11
                        . Next, to quantify the accuracy of the results, we adopt the root mean squared error (RMSE) as a metric for comparison in this section. The RMSE measures a distance between the true boundary and each active contour. In our experiment, the result of GGVF active contour model obtained from the noise-free is taken as ground truth. The RMSE results are plotted in Figs. 12 and 13
                        
                         corresponding to Figs. 10 and 11, respectively.


                        Fig. 14
                        a is a circular object with a blurred area on the upper left boundary, which is commonly used for weak edge leakage analysis. According to the analysis in Section 2, the smoothness energy terms of the GVF and GGVF are well known to smooth the image isotropically without preserving the weak edge (see Fig. 14c and d). The property of preventing weak edge leakage can be meliorated by decreasing μ (GVF) and κ (GGVF), respectively, however, this will significantly increase the computational time. Since the NGVF active contour model only adopts normal direction diffusion, it could not stop at weak edges and move towards stronger edges (see Fig. 14e). HGVF is decomposed as a weighted sum of divergence and curl, which makes it more flexible than the GVF in concavity convergence, yet it would be prone to error in case of weak edge leakage, as shown in Fig. 14f. In contrast, our ADF active contour model is very efficient to solve this issue using harmonic hypersurface functional (see Fig. 14g). Note, there is no discernable difference between the results obtained using ADF and ILGVF (see Fig. 14h).

The next experiment is carried out to illustrate that the ADF active contour model also performs well in neighboring objects separation, especially when the edge of one object is weak and the other is strong. Fig. 15
                        a is a synthetic torus image with 150×150 pixels, where the upper left part is blurred and the edge of the outer circle is weak while the inner circle is strong. Because the intensity changes so gradually in the blurred area that there is ambiguous boundary representation in the edge map, the active contour models except the ADF active contour model are driven to move across week edges to the strong neighbore ones. Especially, ILGVF active contour model is attracted by the inner edge due to strong gradient vectors caused by the inner circle. Fig. 16
                         is another tested image with 128×128 pixels, in which there is one gray disk neighbored by one white rectangle on the black background. It is clear that our ADF active contour model correctly separates these two closely neighbored objects, as shown in Fig. 16h, while the other active contour models fail.

Real images have been used for the validation of the proposed method. Fig. 17
                         gives comparative results on a CT image of the left ventricle of a human heart. In order to extract the endocardium of the left ventricle, we have to cope with noise, inhomogeneity within the blood pool and weak edges even neighbored by strong ones. In GVF and NGVF active contour models, the initial curves are carefully placed closer to the true boundary to achieve as good results as possible (see Fig. 17a and b). However, these two active contour models fail in neighboring strong edges. The VFC active contour model shows very limited improvement and also fails (see Fig. 17c). In contrast, our ADF active contour model gives satisfactory results (see Fig. 17d). Similarly, Fig. 18
                         illustrates a comparison on a cell tissue slide image, and we can see that the GVF, NGVF and VFC active contour models fail. The dashed lines in the images are initial curve and the parameters of active contour models in this experiment are α
                        =0.5, β
                        =0.5, time step τ
                        =1.

In Fig. 19
                        , a human lung CT image is chosen to exemplify to the effectiveness of the ADF active contour model. We aim at extracting the both left and right parenchym, and the difficulties reside in the weak and closely-neighbored boundaries in the right parenchym. Fig. 19c shows the initialization curves. The GVF, NGVF, VFC, ILGVF active contour models collapsed to nearby edges as shown in Fig. 19d–g, respectively. In contrast, Fig. 19h exemplifies the abilities of the ADF active contour model for weak edge preserving and neighbored objects separation.


                        Fig. 20
                         demonstrates the active contour models in processing noisy ultrasound image. It is very clear to see the difference performance of these five methods on the weak edge caused by noise, as shown in the top right part of the images. The segmentation result of the ADF active contour model (Fig. 20g) is obviously more accurate than the corresponding results of the GVF, NGVF, and VFC active contour models. We also note that the ILGVF active contour model could converge to correct boundary if the initialization is closer to the boundary, which exemplifies the robustness to initialization afforded by the ADF approach. More results using the proposed ADF active contour model are shown in Fig. 21
                        .

In considering the computation time in generating the external force, we note that all the simulations are implemented in matlab 7.7 without optimization on a 3.4-GHz Pentium (R) computer. Both the matlab source code and demos of the proposed algorithm can be downloaded at http://mcislab.cs.bit.edu.cn/member/wuyuwei/download.htm. Table 1
                         presents the details about the computation time in generating the external force fields including GVF, GGVF, NGVF, ILGVF, HGVF and ADF. As observed in Table 1, the computation time of proposed approach is roughly as same as GVF method. More computational efficiency can be gained through code optimization (e.g. multigrid method [39]) and by implementing in a compiled language such as C.

@&#CONCLUSION@&#

In this paper, we have proposed an active contour model with a novel external force, named adaptive diffusion flow field (ADF), by adopting hypersurface minimal functional and infinity laplacian functional. We demonstrated the performance of our ADF active contour model, against the GVF, GGVF, NGVF, HGVF and ILGVF active contour models on synthetic and real images. In general, the ADF active contour model has great capture range, and it is much more robust toward detecting and preserving the locations of weak edges, even if very noisy. Also, our method is able to detect objects whose boundaries are narrow and deep, whereas the classical active contour models might not be applicable. The future work is to extend our method to 3-dimensional ADF active surface.

@&#ACKNOWLEDGMENTS@&#

The authors thank both the editor and the reviewers for the invaluable comments and suggestions that help a great deal in improving the manuscript. This work was supported in part by the NSFC-Guangdong Joint Fund under Grant No. U1035004, the Tianjin Commission of Technology of China under Grant No. 11JCZDJC15600, and the Specialized Research Fund for the Doctoral Program of China under Grant No. 20121101110035.

In this paper, we adopt 
                        
                           Φ
                           (
                           |
                           ∇
                           V
                           |
                           )
                           =
                           
                              
                                 1
                                 +
                                 |
                                 ∇
                                 V
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     , usually called the hypersurface minimal function. In this case, we can get
                        
                           
                              
                                 
                                    Φ
                                 
                                 
                                    ′
                                 
                              
                              (
                              |
                              ∇
                              V
                              |
                              )
                              /
                              |
                              ∇
                              V
                              |
                              =
                              1
                              /
                              
                                 
                                    1
                                    +
                                    |
                                    ∇
                                    V
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     and
                        
                           
                              
                                 
                                    Φ
                                 
                                 
                                    ″
                                 
                              
                              (
                              |
                              ∇
                              V
                              |
                              )
                              =
                              1
                              /
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                +
                                                |
                                                ∇
                                                V
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                              .
                           
                        
                     We can observe that Φ(∣∇
                        V
                     ∣) satisfies the condition (7), that is,
                        
                           
                              
                                 
                                    
                                       lim
                                    
                                    
                                       |
                                       ∇
                                       V
                                       |
                                       →
                                       
                                          
                                             0
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    |
                                    ∇
                                    V
                                    |
                                    )
                                 
                                 
                                    |
                                    ∇
                                    V
                                    |
                                 
                              
                              =
                              
                                 
                                    
                                       lim
                                    
                                    
                                       |
                                       ∇
                                       V
                                       |
                                       →
                                       
                                          
                                             0
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    ″
                                 
                              
                              (
                              |
                              ∇
                              V
                              |
                              )
                              =
                              1
                              .
                           
                        
                     
                  

Unfortunately, two sub-conditions of Eq. (8) are incompatible. One must find a compromise. For example, Φ′(∣∇
                        V
                     ∣)/∣∇
                        V
                     ∣ and Φ″(∣∇
                        V
                     ∣) both converge to 0 as ∣∇
                        V
                     ∣→+∞, but at different rates. We can obtain
                        
                           
                              
                                 
                                    
                                       lim
                                    
                                    
                                       |
                                       ∇
                                       V
                                       |
                                       →
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    |
                                    ∇
                                    V
                                    |
                                    )
                                 
                                 
                                    |
                                    ∇
                                    V
                                    |
                                 
                              
                              =
                              
                                 
                                    
                                       lim
                                    
                                    
                                       |
                                       ∇
                                       V
                                       |
                                       →
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    ″
                                 
                              
                              (
                              |
                              ∇
                              V
                              |
                              )
                              =
                              0
                           
                        
                     and
                        
                           
                              
                                 
                                    
                                       lim
                                    
                                    
                                       |
                                       ∇
                                       V
                                       |
                                       →
                                       +
                                       ∞
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          ″
                                       
                                    
                                    (
                                    |
                                    ∇
                                    V
                                    |
                                    )
                                 
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    |
                                    ∇
                                    V
                                    |
                                    )
                                    /
                                    |
                                    ∇
                                    V
                                    |
                                 
                              
                              =
                              0
                              .
                           
                        
                     This means that the rate of change in the normal direction is faster than that of tangent direction during diffusion. Thus, the diffusion along the tangent direction plays the key role on the edge of an image, while the diffusion along the normal direction has little effect. Accordingly, the ADF model is able to preserve the weak edges.

For Eq. (12), let 
                        
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        
                      presents a bounded, open and connected domain with sufficiently smooth boundary. We can obtain the following formulation by minimizing Eq. (11):
                        
                           (18)
                           
                              div
                              (
                              |
                              ∇
                              V
                              
                                 
                                    |
                                 
                                 
                                    p
                                    -
                                    2
                                 
                              
                              ∇
                              V
                              )
                              =
                              0
                              .
                           
                        
                     The infinity Laplace equation is derived as the limit as p
                     → ∞ of the Euler–Lagrange equation
                        
                           (19)
                           
                              div
                              (
                              |
                              ∇
                              V
                              
                                 
                                    |
                                 
                                 
                                    p
                                    -
                                    2
                                 
                              
                              ∇
                              V
                              )
                              =
                              |
                              ∇
                              V
                              
                                 
                                    |
                                 
                                 
                                    p
                                    -
                                    2
                                 
                              
                              Δ
                              V
                              +
                              (
                              p
                              -
                              2
                              )
                              |
                              ∇
                              V
                              
                                 
                                    |
                                 
                                 
                                    p
                                    -
                                    4
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    ∞
                                 
                              
                              V
                              =
                              0
                              ,
                           
                        
                     for approximating Eq. (12), where Δ is Laplacian operator. Formally dividing Eq. (19) by (p
                     −2)∣∇
                        V
                     ∣
                        p−2 and letting p
                     →∞, thus
                        
                           (20)
                           
                              
                                 
                                    1
                                 
                                 
                                    |
                                    ∇
                                    V
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    ∞
                                 
                              
                              V
                              =
                              0
                              ,
                           
                        
                     where 
                        
                           
                              
                                 Δ
                              
                              
                                 ∞
                              
                           
                           V
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 j
                                 =
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 V
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           
                              
                                 V
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                              
                                 V
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           =
                           0
                        
                      in Ω. It can be note that Eq. (20) is equal to the second derivative of 
                        V
                      in the direction of the intensity gradient. The non-linear operator Δ
                     ∞ is called the infinite Laplacian.

@&#REFERENCES@&#

