@&#MAIN-TITLE@&#Coverage planning in computer-assisted ablation based on Genetic Algorithm

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Ablation planning to avoid over-ablation, over-perforation or under-ablation.


                        
                        
                           
                           Complete tumor coverage with minimal number of ablations and trajectories.


                        
                        
                           
                           Genetic Algorithm with exponential weight-criterion fitness function and constraints.


                        
                        
                           
                           Candidate plans can be encoded in chromosomes, evolving based on a fitness function.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ablation planning system

Tumor ablation

Minimally Invasive Surgery

Multi-objective problem

Genetic Algorithm (GA)

@&#ABSTRACT@&#


               
               
                  An ablation planning system plays a pivotal role in tumor ablation procedures, as it provides a dry run to guide the surgeons in a complicated anatomical environment. Over-ablation, over-perforation or under-ablation may result in complications during the treatments. An optimal solution is desired to have complete tumor coverage with minimal invasiveness, including minimal number of ablations and minimal number of perforation trajectories. As the planning of tumor ablation is a multi-objective problem, it is challenging to obtain optimal covering solutions based on clinician׳s experiences. Meanwhile, it is effective for computer-assisted systems to decide a set of optimal plans. This paper proposes a novel approach of integrating a computational optimization algorithm into the ablation planning system. The proposed ablation planning system is designed based on the following objectives: to achieve complete tumor coverage and to minimize the number of ablations, number of needle trajectories and over-ablation to the healthy tissue. These objectives are taken into account using a Genetic Algorithm, which is capable of generating feasible solutions within a constrained search space. The candidate ablation plans can be encoded in generations of chromosomes, which subsequently evolve based on a fitness function. In this paper, an exponential weight-criterion fitness function has been designed by incorporating constraint parameters that were reflective of the different objectives. According to the test results, the proposed planner is able to generate the set of optimal solutions for tumor ablation problem, thereby fulfilling the aforementioned multiple objectives.
               
            

@&#INTRODUCTION@&#

Nowadays the trend of surgeries and interventions is shifting towards being minimally invasive and further being non-invasive. Such surgeries lessen the complications because more precise and sophisticated instruments are now employed to perform the surgeries [1–4]. The increase in performance accuracy and lesser invasiveness of these surgeries therefore extend its potential benefits to a wider population of patients, especially for the groups who are unable to undergo open surgeries [5–13]. Minimally invasive surgeries also result in a shorter surgical duration, which translate into lesser physical trauma and lower financial costs for the patients [14,15].

As one type of minimally invasive interventional procedures, tumor ablation is the removal of tumor tissue using techniques like cryoablation [16,17], high-intensity focused ultrasound (HIFU) [5,18], or radio-frequency (RFA) [5,6,8,10,19]. These techniques rely on minimally invasive principles to ablate tumor tissues, without having to directly expose the affected regions to the environment. Therefore, it has been widely noted that the success of a tumor ablation procedure hinges greatly on its pre-operative planning [5,6,14,18,20]. The proposed ablation planning system in this paper focuses mainly on the radio-frequency ablation (RFA) of hepatic tumors.

Based on pre-operative medical scans, computer-assisted ablation planning systems are used to generate optimal surgical plans. Software modules like IGSTK [15], 3D Slicer [21] are currently used by surgeons and biomedical engineers to assist in the visualization of anatomical structures, registration and navigation of real-time images. By developing optimal treatment plans in these toolkits, it enables surgeons to visualize the 3-D tumor regions as well as the envisioned ablations. It makes feasible for surgeons to exploit and assess the treatments along operations. Heuristical Optimization is an effective approach to obtain acceptable solutions in multi-objective problems. In this paper, the tumor coverage, the number of ablations, the number of trajectories of needles are considered as objectives to optimize [22]. Genetic Algorithm, as a classic heuristic algorithm, is then employed in the optimization.

The rest of this paper is organized as follows. In Section 2, the paper reviews prior studies of ablation planning systems. In Sections 3 and 4, the paper proposes and highlights the relevance of using a Genetic Algorithm (GA) in an ablation planning system, respectively. Section 5 describes how the tumor ablation is planned in GA. Section 6 describes the experiments performed on tumors. Section 7 concludes the paper.

@&#RELATED WORK@&#

There exist several minimally invasive techniques to perform tumor ablation procedures. Unlike cyroablation that freezes the tumor tissues to extremely low temperatures, radiofrequency ablation (RFA) heats up, denatures and coagulates the tumor cells, therefore destroying its cancerous function [17]. RFA is a thermal ablation procedure that inserts a needle-like electrode into the skin towards the tumor, which passes alternating high-frequency current to its tip [5,6,19,14,23]. The high-frequency current then heats up and ablates the tumor tissues. RFA technique has been favored because of its safety, effectiveness and predictability of results [5,6,8,14,23].

Depending on the tumor location and the tumor size, RFA electrodes of different tips can be employed, either having tines that expand out in an umbrella shape, or using a simple needle tip (as shown in Fig. 1
                        ). However, the choice of electrodes and effectiveness of tumor ablation surgeries are also limited by the aforementioned tumor characteristics. Research has shown that a single ablation application is sufficient in the complete destruction of tumors smaller than 2cm in diameter, and for tumors that reside near the peripheral of the organ [14,23,17,19]. Large and deeply localized tumors require multiple ablation applications, which incur more healthy tissue damage and increase the risks of incomplete tumor destruction [8]. Multiple ablation applications of the tumor tissues may also result in decreased opacity of the tumor due to necrosis, therefore compromising the accuracy of a RFA therapy [19].

To overcome the unnecessary risks that the tumor characteristics may pose during the ablation, treatment planning is crucial to get optimal pathways of how the RFA electrode is inserted and to achieve complete tumor coverage. As such, computer-assisted interventions are significant in pre-operative phase of tumor ablations. In this planning phase, optimization algorithms can be used to generate optimized needle trajectories and ablation center-points. It should be noted that every surgical plan should be customized to the patient. Hence, while the ablation planning system can provide optimized candidate solutions based on pre-operative data sets, the surgeon ultimately makes the final decision to adopt the solution for his patients.

RFA typically relies on image guidance to manually place the radiofrequency needle within the tumor, such as ultrasound for guiding liver tumor ablation [24], and CT for guiding lung tumor ablation. However, ultrasound imaging can be problematic for monitoring the ablation region due to hyperechogenicity [17] and imaging artifacts [25], especially in the presence of a metallic RFA probe. In comparison, CT offers better imaging quality but increases the radiation exposure to the patient and potentially the operator. To avoid radiation, one solution is to employ a tracking system to obtain the relative position between ablation probe and target, by landmark registration to a pre-operative CT image [15]. This approach assumes that the target organ deformation is acceptable for treatment purposes by using preoperative images for intra-operative treatment.

The deformation of tissue and tumor is an important topic for improving the accuracy of image-guided procedures and there is a large body of research studies on tissue motion estimation. This paper is focusing on the ablation planning approach and the motion estimation is beyond the scope of this paper. The proposed techniques could be used clinically if care is taken with patient positioning.

This section reviews the ablation planning systems and approaches that have been investigated in the past decade. From these studies, common goals of an ablation planning system have been identified to form the objectives of the proposed ablation planning system.

In [5,6,14,23], the authors have developed a comprehensive planning tool called RF-Sim, which can automatically reconstruct 3D livers based on spiral CT scans. The tumor region was represented by a set of voxels (i.e cubes), where voxels with a direct connection from the skin to the tumor were considered as candidate entry points for needle insertion. The algorithm of RF-Sim was largely based on a volume criterion. It first assumed a spherical shape of the lesion produced by the electrode, and a fixed needle trajectory [6,23]. It then used the Downhill Simplex to return a few optimized trajectories that minimize healthy tissue damage. The method was found to be useful for small tumors; but for larger tumors, an initialization phase had to be incorporated to overcome the drawback of Downhill Simplex, thereby minimizing the healthy tissue damage. In [19], the author have proposed a software application for RFA therapy. The software was able to reconstruct the 3D organ for visualization, to register the images and to optically track the surgical instruments using markers during the intervention phase. The algorithm of this software was independent of the needle and tumor size [19]. Similar to Villard et al., Mundeleer et al. [19] assumed a spherical shape of the RFA target volume, including the 5–10mm security margin. Their algorithm used the concept of sphere covering to cover the whole tumor and thus proposed a cost function that could systematically calculate the desirable ablation volume. Within that volume, Downhill Simplex method was used to obtain the optimal set of positions for RFA application in the tumor. Their approach, however, did not take the optimal needle trajectories into consideration. In short, it only provided an algorithm for the tumor coverage.

On the other hand, Chen et al. [22] have conducted a comprehensive clinical study on their RFA treatment for large tumors, using the concept of sphere covering. For different sizes of tumors, they have calculated the minimum number of spheres necessary to cover the tumor completely [19]. They have taken into consideration the risks involved when the tumor was located near major critical structures, thereby adopting individualized protocol for these tumors. The RFA electrode was inserted into the tumor in different ways, depending on the tumor position relative to the critical structures. The complications that arise from the multiple ablations in this study were dependent on the growth stages of the tumor. Yang et al. [26] have designed a novel robotic system for RFA, and their focus was on how to address the multiple ablations of large tumors in the optimal manner. Thus, they proposed a “voxel growing” algorithm, which in essence followed the tumor contour profile to produce the ablation points, starting from the surface layer. The tumor was “voxelized” in the x-, y-, and z-direction. The algorithm first assumed the needle tip within the tumor-covering voxel, and subsequently a spherical ablation zone of similar voxel size was produced. This approach, however, has to consider the way of how to coincide their algorithm with the tumor location, which was provided by the pre-operative scans. In addition, it was acknowledged in their paper that the algorithm aimed to achieve complete tumor coverage rather than gaining optimal control over the ablation geometry, suggesting that unnecessary healthy tissue may be damaged.

Therefore, the common goals in a feasible ablation planning system include achieving complete tumor coverage, minimizing healthy tissue damage, and minimizing the number of ablation points and needle trajectories [6,15,16]. The results presented in [5,6,19,8,14,23,16] are important prior research for examining the problem of overlapping probe placement in RFA procedures. We further extended the problem to develop a robust treatment planning system by incorporating realistic constraints that are encountered in clinical practice but were not fully addressed before, including (1) relaxation of the assumption of spherical tumors, i.e., no pre-selected geometric models of particular arrangements on tumors; (2) minimize the number of probe insertions and ablations while covering all tumor regions. Most tumors are not spherical and it is often not practical to regularly space overlapping ablations due to other nearby anatomical structures that should be avoided. Also, the number of probe insertions that can be performed in practice is limited by time considerations and the risk of complications with each insertion; and (3) a new optimal planning algorithm is developed based on genetic algorithm (GA), which can effectively address the treatment planning problem as indicated in the paper.

The presence of critical structures within the interventional target region makes it necessary for an ablation planning system to predict any consequences. The rationale of this planning prior to an operation would allow the surgeon to customize an optimal surgical plan for patients. For example, Fig. 2
                      illustrates the different anatomical views of the tumor location. The silver color represents no-fly-zone structures including bones and spinal cords. The yellow color surrounded by the red shell represents the tumor surrounded by safety margins, which are supposed to be ablated in the procedures. The blue region is a set of points of feasible entries for an ablation probe. The presence of structures like bones would obstruct the accessibility of the RFA electrode.

For an ablation planning system, the optimal points of entry for the needle electrode allow direct trajectories from the skin to the tumor without intercepting the critical structures. Based on these trajectories, the ablation planning system should be able to fulfill its multiple objectives, of which the utmost importance is to achieve complete tumor coverage.

The 3D tumor environment is first voxelized and each voxel in a certain region of interest is assigned a unique arbitrary number. For instance, all voxels of the tumor are assigned the value of ‘1’. Table 1
                      summarizes the assigned values for the different regions of interests. As such, the algorithm can identify the voxels covering regions of interest and return feasible solutions to either ablate or avoid certain voxels.

The concept of covering by spheres is adopted to achieve tumor coverage based on the assumption that each ablation approximately covers a spherical region. Sphere covering allows overlapping of spheres of a fixed radius, and it aims to use the minimum number of spheres to cover a fixed volume. As such, when one sphere center (i.e. ablation point) is planned on one specific voxel, and its corresponding coverage volume, given by 
                        
                           
                              
                                 4
                              
                              
                                 3
                              
                           
                        
                        π
                        
                           
                              r
                           
                           
                              3
                           
                        
                      would be the covered region. This is illustrated in Fig. 3
                     .

Following the selection of the sphere centers, trajectories that directly connect the point of entry to the tumor tissues would be optimized and the aim is to use the minimum number of trajectories, which is corresponding to the number of punctures to the target tissue. The criteria for being a feasible trajectory are one that does not intersect any critical structures and one that passes through as many sphere centers as possible. A schematic diagram of possible trajectories that could be extended to the candidate sphere centers on the tumor voxels is illustrated in Fig. 4
                     .

The multi-objective nature of tumor ablation planning problem can be reduced to a problem of minimal covering. In order to determine the minimum number of covering spheres, the planning of tumor ablation can be classified under Non-deterministic Polynomial (NP) problems in terms of computation. In this paper, the problem was approached heuristically using Genetic Algorithm (GA). GA is an evolutionary method that is inspired from natural selection, whereby only the best characteristics are passed on.

A potential solution to a problem is governed by a set of parameters, wherein parameters can be represented as a string of values in binary form [27]. The potential solution is referred to the chromosome and its parameters are called the genes. The suitability of the chromosome (i.e. solution) can be quantified by the fitness function, which is also referred as the cost function. Based on the working principle of GA, the generated solutions are expected to improve over time; and depending on how the parameters of the fitness function are mathematically related, the fitness value of the best solution is either maximized or minimized. The final chromosome in the final generation is thus theoretically the best fitted solution.

For a problem at the scale of 10 by 10 by 10, we design a chromosome with 1000 dimensions which means there are 1000 genes in a chromosome. Each gene presents a candidate area. A gene being 1 means that this candidate area is chosen as ablation center, while the gene being 0 means that the candidate area is not chosen as ablation center. The initial population which includes several chromosome is generated randomly which means that each chromosome is composed of random binary numbers. To integrate the GA algorithm into tumor ablation, encoding of feasible solutions is required. In the context of tumor ablation, each chromosome is an array of binary values (either ‘1’ or ‘0’) that can be encoded onto the 3D tumor environment. As the ablation center will only be localized on the minimum 3D region containing the tumor, the size of the chromosome array was determined by the size of the tumor dimensions. For example, if a tumor has the dimensions of 10 by 10 by 10 voxels, every chromosome should have an array size of 1000. The voxel position, (
                        x
                        ,
                        y
                        ,
                        z
                     ), is determined by the Cartesian coordinates of the bottom left corner voxel . The encoding from chromosome array to the tumor dimensions starts in the positive x-direction first, moves in the positive y-direction next and then continues in the positive z-direction.

For example in Fig. 5
                     , the first position on the chromosome array is encoded onto the voxel (0,0,0); the second position of the array is encoded on the voxel (1,0,0). After the first row of 10 voxels in the positive x-direction is encoded, the 11th position of array is encoded onto voxel (0,1,0). This is continued until the first face of 100 voxels is fully encoded; the 101st position of the array is thus encoded onto voxel (0,0,1) until the 1000th position onto voxel (9,9,9). Since each chromosome array size was determined by the size of tumor simulation, the 1000 voxels would eventually be encoded.

A population of parent chromosomes is first initialized and creates a search space. Every chromosome is assumed as a point in this search space and is considered as a possible solution for the problem [28]. The parent chromosome then undergoes evolution including crossover and mutation to produce the child solutions. These solutions are quantified using a cost function, whose fitness value would determine the best-fitted chromosomes to be the parent population of the next generation. GA repeats this until it achieves a predefined termination criterion. A flow chart illustrating the main flow of GA is shown in Fig. 6
                     . The crossover rate and mutation rate are designed as 1 and 0.01 respectively. Since a large crossover rate could help algorithm be more effective in evolutionary progress and a small mutation rate could help the solutions in algorithms be stable, the value setting is reasonable according to the design of Genetic Algorithms [29].

In one generation, many chromosomes can be produced using recombinant techniques like crossover and mutation. Each chromosome is represented as a bit string of binary values of length n. Depending on the recombinant technique, the production of new offspring can occur on a bit level (i.e. within the same chromosome) or on an individual level (i.e. between two chromosomes). In this paper, the chromosomes were made to undergo crossover first, and then mutation.

Crossover occurs on an individual level, such that 2 parent chromosomes are involved to produce its offspring. Crossover points are randomly selected on these chromosomes; the selected point divides the chromosome to left and right sections, the exchange of sections between the two chromosomes then results in its child solutions. Some possible crossover approaches include a single-point crossover, two-point crossover and uniform crossover [30]. Fig. 7
                         illustrates how crossover takes place between 2 binary chromosomes to produce the offspring.

In this paper, the GA uses a uniform crossover approach. In the case of uniform crossover, a crossover mask containing a string of binary values is used. To create a crossover mask, a probability value is randomly assigned to every bit in the mask. For instance, for bits with a probability of more than 0.5, the bit is assigned the value of ‘1’ and this instructs the corresponding bits of the 2 parent chromosomes to undergo crossover (Fig. 7). Uniform crossover allows a more even distribution of recombinants between the chromosomes, and it is found that uniform crossover generates better quality results than a single-point crossover [31].

Mutation of the chromosome occurs on a bit level, which only involves the same chromosome. Every bit in the chromosome is randomly assigned a probability value; the bit would flip (from ‘1’ to ‘0’ and vice versa) if the assigned probability is lesser than the mutation rate that has been set in the algorithm. This is also known as ‘flip mutation’. For instance, if the mutation rate is set to 0.05, the bits with random probability lower than 0.05 would be mutated, and this creates an offspring chromosome. Fig. 8
                         shows how a parent chromosome is mutated to produce the child chromosome.

In this paper, the crossover rate and mutation rate of the simulations were set at 1 and 0.01 respectively and this was based on the typical range suggested in [32]. These are the probabilities at which the genes of the chromosome would undergo the corresponding recombination. As such, there is a need to select a value that would ensure the success of a GA evolution. For instance, a high crossover rate would lead to a rapid loss of the better genes before it could be passed down to the next generation. A low mutation rate is usually used in a GA algorithm as this would ensure that the information in the offspring solutions does not differ excessively from the parent chromosomes [32].

As aforementioned in Section 3, sphere covering method is adopted in the tumor ablation planning problem as its principle is to use the least number of spheres to cover a fixed volume. The GA first randomly selects sphere centers on the tumor voxels. The number of ablation spheres (G) is minimized, given the constraint that the sum of corresponding coverage volume of these candidate ablation spheres can ablate the whole tumor volume. Individual sphere volumes are calculated using 
                           
                              
                                 
                                    4
                                 
                                 
                                    3
                                 
                              
                           
                           π
                           
                              
                                 r
                              
                              
                                 3
                              
                           
                        , and the sum of their volumes would indicate the total ablated volume (C).

While choosing the locations of candidate sphere centers that ensure complete tumor coverage, trajectories (N) are needed to be optimized. As the associated voxels along a trajectory may not correspond directly onto the locations of candidate sphere centers, this involves a distance offset from the sphere center to the trajectory and is called the Covariance (Co). In other words, an ideal trajectory would be the one that is collinear to as many candidate sphere centers as possible. The tumor ablation and trajectories optimization are combined by the measurement Covariance (Co) because covariance is not only evaluated by the trajectories optimization but also affected by the design of tumor ablation center.

To mathematically model Co, every individual distance can be taken as the orthogonal distance between a point (ablation point) and a line vector (nearest trajectory) in a 3D space. Thus, the sum of these individual offset distances adds up to give Co. To meet the objectives of the tumor ablation system, Co should therefore be minimized. This would then indicate lesser deviance of trajectory from the previously determined ablation points, and a more accurate simulation of the ablated tumor.

Let L
                        1 and L
                        2 be the points that lie on the trajectory line and 
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                         the ablation point. In 3D space, each point has its xyz-coordinate. The orthogonal distance between the ablation point and trajectory line can thus be calculated by taking the magnitude of the vectors, shown in Eq. (1):
                           
                              
                                 CO
                                 =
                                 |
                                 
                                    
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                                 |
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                         x
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                         y
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                         z
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         2
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                         x
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         2
                                                         y
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                         y
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                         z
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                         z
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   l
                                                
                                                
                                                   2
                                                   x
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   l
                                                
                                                
                                                   2
                                                   y
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   z
                                                
                                             
                                             −
                                             
                                                
                                                   l
                                                
                                                
                                                   2
                                                   z
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As GA is capable of producing several generations of solutions, a cost function is required to assess and quantify the suitability of these solutions in the ablation planning problem. This quantification of solutions allows the algorithm to identify the better solutions in the evolution process. The goals of an ablation planning system and possible deviances from the algorithm form the parameters that govern the quality of the solutions, a cost function is proposed by
                           
                              (1)
                              
                                 COST
                                 =
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             G
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             (
                                             N
                                             +
                                             penalty
                                             )
                                          
                                       
                                       
                                          
                                             γ
                                          
                                          
                                             Co
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                              
                           
                        where α, β, γ, λ are positive constant values designed by users׳ requirement and present the weight of corresponding indexes. If the users prefer a smaller G, we then increase the value of α. G is the number of ablation spheres; N is the number of trajectories; Co is the covariance; and C is the coverage volume. Since the planning of tumor ablation is a multi-objective optimization problem, there is no single solution that can resolve the problem. Instead, such problems aim to provide a set of optimal solutions that are able to fulfill the multi-objectives. To decide which objective is more important than the other, an exponential weighted criterion can be adopted in the cost function [33]. Having the constant values (α, β, γ, λ) can serve to add weight to their corresponding parameters (G, N, Co, C), their relative values would therefore reflect the relative importance of that particular parameter [17]. The higher the weight-value, the greater the emphasis placed on the corresponding parameter. In addition, as there are constrained areas such as bone areas which could not be pierced by trajectories, we define the following penalty functions:
                           
                              (2)
                              
                                 penalty
                                 =
                                 const
                                 ⁎
                                 
                                    
                                       1
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        where 10 is an indicator function on the set of {0}. When the trajectory pierces the constrained area (bone area), 10=1, while trajectory does not pierce the bone areas, 10=0. The value of const could be set by users׳ experience.

In Eq. (1), the positive constant values are related to the parameters exponentially in the cost function, where the constant values (i.e. bases) are raised to the powers of the parameters. As such, its gradient change is very steep. In other words, a small change in any of the base-values is expected to result in a significant change in their corresponding parameter values, and in turn causing the fitness value to change rapidly. In turn, such exponential weighted criterion would be able to provide the solution set that is close to optimality [33]. Moreover, as these parameters are dependent on each other, a change in the base-value may return in feasible N values but infeasible G values.

Since the objectives of tumor ablation problem are to use the least number of G, N and Co to achieve complete tumor coverage, it would correspondingly translate into a cost-value that should be minimized. As such, the final solution with the lowest fitness value is returned with the optimal set of ablation and trajectory coordinates.

The experiment was conducted based on the following system setup. The computer system used in algorithm simulation was on 2.5GHz Intel Core 2 Duo processor, and the software run on Visual Studio 2012, 64-bit. To optimize the weight-values of the parameters used in the cost function, the tumor voxels were first simulated in the dimensions of 10 by 10 by 10 voxels; and GA was made to run over 200 generations with a crossover rate of 1 and mutation rate of 0.01.

Since a greater value of the weights (α, β, γ, λ) would place greater emphasis on its corresponding objective, this would in turn return a better feasible value for that parameter. Depending on the relative importance of each objective in the ablation planning system, random values were initially assigned to the weights in the preliminary simulation. Through experience, the weight-values that were able to produce reasonable solutions are denoted in Eq. (3), and were used as the initialized values:
                           
                              (3)
                              
                                 COST
                                 =
                                 
                                    
                                       1
                                       .
                                       
                                          
                                             6
                                          
                                          
                                             G
                                          
                                       
                                       1
                                       .
                                       
                                          
                                             8
                                          
                                          
                                             (
                                             N
                                             +
                                             0.2
                                             )
                                          
                                       
                                       1
                                       .
                                       
                                          
                                             1
                                          
                                          
                                             Co
                                          
                                       
                                    
                                    
                                       1
                                       .
                                       
                                          
                                             001
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To determine the optimal weights for each parameter, 10 simulations using various α, β, γ weights for G, N and Co respectively have been performed. Constant increments (or decrements) were made to the respective weights so as to check how the simulation results change in relation to the preliminary simulation. In each set of simulations, only one weight was varied, while the other weights remained as the initialized values denoted in Eq. (3). The average results of α, β, and γ weights are tabulated in Tables 2, 3 and 4
                        
                        
                         respectively. Since in Eq. (1), the values of α, β, γ, λ are affected by each other, any variant of them could be set as a constant in order to test the influence of others׳ weights to algorithm׳s performance.

From the above tables, it can be inferred that in general a better value of specific objective was achieved when its corresponding weight was increased, but at the cost of compromising other conflicting optimizing objectives. As the planning of tumor ablation is a multi-objective problem, the need to achieve solutions for the multiple objectives prevents over-emphasis on only one objective. For example, alpha is to influence the evaluation of G, which is the number of ablation spheres. To increase the value of alpha could make a good performance of G, but meanwhile this makes other objectives (such as C, N, Co) worse. The objective parameter of G can reach the lower bound of 0 by increasing the value of alpha. However, in this case the coverage rate is also 0, which means that there is no any ablation in operation. As observed in Table 4, the values of G and N were compromised when the algorithm was made to increase its emphasis on Co to a γ-weight of 1.5. This was also explained in Section 5 where Co is measured as a sum of distances between candidate ablation points with respect to the nearest trajectory. As such, in order to minimize Co, the number of trajectory has to increase so that the candidate ablation points can be nearer to more trajectory options. In general, the relationship between large values of N and small values of Co can also be observed in the other average results recorded in Table 2 (α=0.8; α=1.0) and Table 3 (β=0.8; β=1.0). As the four objectives affect each other, we have to make a tradeoff among all of them rather than just emphasizing any specific ones.

As observed in the above tables, there was a range of weight-values that could possibly yield similar results. However, it should be noted that there is no absolute weight-value to be used, as the importance of the multiple objectives in the ablation planning system can be relative.

Using optimized weight-values for the cost function, a set of candidate sphere centers and trajectory locations was obtained at the end of each simulation run. An example of candidate ablation spheres and trajectories is illustrated in Fig. 9
                        , where the trajectory origin has been located at a distance away from the tumor voxels.

One of the goals of a typical tumor ablation procedure is to keep the number of ablations to a minimum. On the average, a RFA electrode can produce an ablated spherical region with diameter of 2–5cm and a single ablation is usually sufficient for a tumor that is smaller than 2cm in diameter. It has been suggested that 6 such overlapping ablation spheres are necessary to completely ablate a 2–3cm tumor [17]; while less ablation spheres can be required when the electrode is capable of producing a larger thermal injury [19]. As such, to determine the minimum number of ablation spheres for ablating a tumor, it is highly dependent on the volume of one thermal injury and the total volume of tumor.

The consideration of the multiple objectives in GA explains why the simulation results recorded in Table 5
                         were comparatively higher than the previous clinical studies on tumor ablation [17,19]. Apart from considering the optimal number of ablation spheres that was required to achieve complete tumor coverage, GA had simultaneously considered other objectives such as minimizing the number of needle trajectories and maximizing the collinearity between the ablation spheres and trajectories. The latter considerations were, however, not taken into account in [19,27].

As such, the number of ablation spheres generated by the algorithm was comparatively greater than the recommended figures and it could be balanced off when the other objectives of an ablation planning system were considered concurrently.

To determine the viability of GA on tumor ablation problems, the algorithm was performed on real tumor data, based on medical CT scans of a pig. The tumor was generated by agar injection into the pig׳s liver region after approved general anesthesia and then immediately scanned by a Siemens CT machine, as shown in Fig. 10
                        . The objective of the experiment on real tumor data was to verify the feasibility of the mathematical protocol in the context of tumor ablation planning. In this experiment, the tumor dimensions in the isotropic medical CT scans were bound in a box region of 26 by 38 by 15 voxels, as shown in Fig. 11
                        . With three different ablation sphere radii, the algorithm was made to perform 10 runs for each variable G-value of each set. In each run, the algorithm was made to undergo 100 generations. The tumor coverage using the different ablation sphere radii is summarized in Table 6
                        .

In Table 6, the tumor coverage generally increases with the number of ablation spheres. However, it should also be highlighted that the tumor coverage increases significantly when the G was assigned a value, for which its minimum ablation spheres required. This can be observed in Table 6 where the difference of tumor coverage achieved was the greatest when G was increased from a number lesser than its minimum required. The above results were generated using a single-objective algorithm to achieve complete tumor coverage.

In order to further evaluate the performance of the proposed approach, we compare it with an Integer Linear Programming (ILP) approach introduced in [8,15], which had comparable multiple optimization objectives including minimizing both number of ablations and number of trajectories. The ILP approach in [15] implements a lung ablation planning scheme, which includes sequential integer programming modules for ablation number minimization, trajectory minimization and normal tissue damage minimization. Table 7
                         is the comparison results of the multi-objective optimization performance between these two approaches. From the experiments, Genetic Algorithm is competent to pursue optimal solutions for the multi-objective optimization problem. Furthermore, compared with integer linear programming (ILP), Genetic Algorithm has four advantages. First, GA can be used for non-integer optimization problems and thus applicable for a broader spectrum of planning problems. Second, ILP is infeasible to solve the complex problems involving non-linear variables such as squared or cubed variables, while Genetic Algorithm runs well for that. Third, constrains in the practical planning problems can be too complicated to solve by ILP, while GA deals well with constrains. Last, the researches on ILP are mostly based on the causalities which are strongly dependent on the mathematical modeling, while GA implements optimizations by objectives or parameters correlations.

With reference to Table 7, it can be observed that the tumor coverage dropped when trajectory number minimization was included in the optimization objectives. This suggests that the inclusion of trajectory optimization compromises the objective of complete tumor coverage, given the same number of ablations for both approaches. It is noted that the proposed Genetic Algorithm (GA) based tumor ablation achieved slightly better coverage rate using the same number of ablations and trajectories.

Based on the above experiments in Tables 6 and 7, it can be concluded that the proposed approach to determine the ablation spheres for tumor coverage is feasible to be a reference in the context of tumor ablation planning.

@&#CONCLUSION@&#

This paper has presented a planning system for tumor ablation and the concept of sphere covering was used to achieve optimal tumor coverage with the minimum number of ablations. Genetic Algorithm (GA) was used to generate feasible and optimal solutions in a finite time. The proposed algorithm has taken into account the multiple objectives of an ablation planning system simultaneously. It can generate feasible solutions with specific number of ablations and needle trajectories to achieve complete tumor coverage. However, the approach to design the cost function in the proposed algorithm was still regarded as a simplified one, as it only combines the multiple objective parameters into one function and was prioritized based on a weight-criterion. Pareto-optimal solutions with a more general multiple-objective problem should be studied in the future.

No related conflict of interest.

@&#REFERENCES@&#

