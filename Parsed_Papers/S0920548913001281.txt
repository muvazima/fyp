@&#MAIN-TITLE@&#Diagnosis mechanism for accurate monitoring in critical infrastructure protection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Development of a diagnosis mechanism based on F-Measure, WSNs and ISA100.11a


                        
                        
                           
                           Situational awareness for critical infrastructure protection


                        
                        
                           
                           Respond to emergency situations and assess the degree of accuracy of the mechanism


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Critical infrastructure protection

Situational awareness

Industrial wireless sensor networks

The ISA100.11a standard

Accuracy

@&#ABSTRACT@&#


               
               
                  Wide-area situational awareness for critical infrastructure protection has become a topic of interest in recent years. As part of this interest, we propose in this paper a smart mechanism to: control real states of the observed infrastructure from anywhere and at any time, respond to emergency situations and assess the degree of accuracy of the entire control system. Particularly, the mechanism is based on a hierarchical configuration of sensors for control, the ISA100.11a standard for prioritization and alarm management, and the F-Measure technique to study the level of accuracy of a sensor inside a neighborhood.
               
            

@&#INTRODUCTION@&#

Being aware of a situation in critical contexts is currently a matter of utmost importance within the research field of Critical Infrastructure Protection (CIP). International organisations and experts are combining efforts to tackle the topic of situational awareness [1]. This is the case at the National Institute of Standards and Technology (NIST), which not only classifies this need in [2] as one of the eight priority areas for protection, but also defines it as a new concept denominated as Wide-Area Situational Awareness (WASA). WASA consists of controlling and optimizing system resources deployed over large geographic areas, as well as delivering smart solutions in charge of prevention and response before interruptions can arise within the system or between systems [2]. This means that it is necessary to address any type of instability, unforeseen event or potential fault caused by malicious actions [3] that may have a local, regional or national effect due to the existing interdependency relationships between Critical Infrastructures (CI) and their sectors [4]. According to the three latest reports of incidents in critical sectors published by the Industrial Control Systems Cyber Emergency Response Team (ICS-CERT) [5–7], these incidents (caused by failures or attacks) have become more and more prevalent in the last few years. Fig. 1
                     , based on statistical values taken from [5–7], illustrates this increase where one of the most affected critical sectors is precisely the energy sector and its control systems, also known as Supervisory Control and Data Acquisition (SCADA) systems.

The consequences of this may be devastating with a high probability of triggering the famous cascading effect between critical systems. Therefore, Fig. 1 clearly shows why operative agents (e.g., human operators) should be made aware of these situations so as to anticipate anomalies or deliver a rapid response. Moreover, this degree of protection should be provided by standalone solutions with proactive and reactive capabilities that help the underlying system work alone, especially, at distant locations, where the control may be reduced to a few human operators in the field. Taking into account the criticality of the application context and the goals of WASA, our main contribution in this paper therefore is to provide a smart mechanism with the capability to offer interactive monitoring and protection of small control sub-domains, such as energy transmission/distribution substations. The mechanism is principally based on the technology of Industrial Wireless Sensor Networks (IWSN) as part of an observation and protection system. Nonetheless, as this technology and its sensory devices can have a significant tendency towards generating operational errors [8] caused by hardware or software failures or some type of threat [8–10], the proposed mechanism also controls the behaviour so as to determine the degree of accuracy in observation and protection tasks.

To compute this accuracy, topics relative to the accurate detection of and response to anomalous behaviour are addressed, together with aspects related to alarm management offered by current industry standards such as the ISA100.11a standard [11]. Any information produced within the observation system, has to be locally monitored by human operators in the field and remotely supervised by the SCADA Centre so as to be aware of the real state of both the underlying system and the protection system at all times. In order to validate the mechanism and show how it is able to offer an attractive way to deal with unforeseen situations and self-evaluate its functional capacities, a critical scenario is stressed (i.e., intentionally provoking emergency situations) to analyse the behaviour of the entire approach. The results show that this is a solution that could help the SCADA system know the real-state of its components, and even improve its governance, risk management, auditing and maintenance as stated in [12].

The paper is organised as follows. Section 2 introduces related work, and Section 3 presents the general architecture and the functional goals of the WASA mechanism together with the technologies described above. Then, we introduce the solution in Section 4, describing the prevention method applied to control the reliability in the observation tasks. Section 5 analyses a use case based on the results obtained from the simulation where a software application is also introduced. Section 6 concludes the paper and outlines future work.

@&#RELATED WORK@&#

There are some experts in the CIP field that are currently developing attractive solutions [13–15] for CIP based on situational awareness. Most of these solutions follow similar architectural designs based on data recollection, analysis, verification, alerting and storage; a set of fundamental procedures that complies with the WASA methodological framework given in [16]. This framework is composed of the combination of two perspectives related to context-awareness and hybrid solutions which aim to contextualize and represent the environment considering human objections. This human interactivity and the degree of automation depend on a series of factors [17]; amongst them, the critical nature of the infrastructure, the application context and conditions.

The WASA methodological framework states the importance of the composition of primary and secondary actions. Primary actions consist of the normalization, understanding and representation of the context (e.g., through finer-scale analysis solutions) in order to offer an efficient and rapid alert and response to emergency situations. An example of this representation of the context is given by Q. Hairong et al. through a conceptual framework in [18], which is able to understand complex context events by applying unsupervised event techniques. W. Xing et al. in [15] present a comprehensive security monitoring and warning system with the capacity to constantly visualize emerging power system applications. In contrast, secondary actions are related to the additional capabilities of the system to ensure state recovery, stabilization, learning and updating, assessment and report. Orchestration of these actions and the use of complementary systems, such as technologies, protocols and applications [16,19] through regulatory frameworks and standards [20], benefit the entire system and its interaction with the environment.

International organisations, such as NIST or the European Network and Information Security Agency (ENISA), are also wholly motivated to introduce topics of situational awareness to provide protection benefits at different levels, either at cyber or physical level [2,12]. For example, preparedness, response and recovery plans could be improved using context information and activity within such a context [12]. However, M. Endsley et al. state in [1] that despite this progress and motivations, investigation in the area of CI is still needed; and according to [2] this research should focus on control and resource optimization, prevention and response from ‘anywhere’ and ‘at any time’. The reason for this lies in dimension issues of the infrastructure itself and its location within the system.

The solution proposed in this paper is illustrated in Fig. 2
                     . In this figure, one is able to see that the solution follows a hierarchical distribution based on clusters of nodes. Each cluster is composed of a small set of smart devices which are near to each other, known as industrial sensor nodes. These sensory devices have enough capability (microprocessor of 13–180MHz, 256–512KB of RAM, 4–32MB of ROM) to sense real states of an observed object or its surroundings, and provide useful services for its control, such as constant monitoring, diagnostics, tracking and reporting services. The control of each cluster is managed by certain trustworthy entities within each cluster, known as Cluster Head (denoted in this paper as CH), which have the inherent ability to manage, validate, aggregate and filter information [21].

Considering all this, it is possible to think that CHs may be single points of failure. However, our motivation by considering such a configuration is for several reasons. Firstly, if the local supervision was specified in a (flat) distributed configuration, the approach should then have to be integrated in each sensor device. This may increase the costs associated with computation (each node must compute information from their neighbours) and communication (any information must be sent to the controller). Secondly, current communication standards, such as the ISA100.11a, have diagnosis mechanisms available with the ability to check the lifetime and the existence of network devices [11]. Thirdly, we assume that the control system follows a rigorous security policy to protect these critical points and their communication, using for example re-clustering techniques, frequent diagnosis mechanisms, lightweight intrusion detection mechanisms, redundant configuration, use of surveillance systems or strict and well-executed maintenance procedures [22,9]. Fourthly, and lastly, it would be useful to be able to exploit the capabilities and intelligence of the CHs (normally they have greater capabilities than the rest of the sensors) to carry out a great part of the approach at different points of the system.

Any information received from these types of devices has to be sent to their respective CHs to manage, check, filter and aggregate the information received. When the information is aggregated, the CH also has to send this information to an intermediary interface between the observation system (i.e., the IWSN) and the SCADA Centre. This interface is a powerful gateway that is able to process and manage a large amount of information received from the acquisition network, and interpret and translate different types of industrial communication protocols (e.g., ISA100.11a messages to Modbus/TCP messages, and vice versa). In order to link this concept of network configuration and its functionality to our mechanism, sensor nodes are responsible for diagnosing anomalous behaviour and alerting their CH to the situation. These in turn are responsible for filtering and aggregating valid information as well as analysing the recent past behaviour of each sensor. This also means that the gateway has to manage any information received from the CH (e.g., alarms or measurements), alert both the SCADA Centre and the nearest human operator of any critical situation in the affected area, and evaluate the final behaviour of each sensor. However, it is also necessary to understand the importance of the Internet and the use of heterogeneous communication technologies (e.g., Mobile Ad-Hoc NETworks (MANETs)) for control over large geographic areas. Moreover, redundancy aspects should also be considered in these types of solutions, given the criticality of the applications and their environments. The use of redundant components (e.g., two gateways) and protocols (e.g., store and forward) would help the control system maintain its supervision and monitoring at all times.

Regarding human operators, they can visualize the scenario and their surroundings using their hand-held devices (e.g., cellular or PDA devices). These interfaces facilitate local automation in the field, by managing: (i) Measurements associated with observation (e.g., voltage magnitude), (ii) alarms with relevant information on real states from the observed infrastructure, or (iii) commands that include a particular control action (e.g., stop/activate turbines). For communication from/to sensors, it is currently possible to apply wireless industrial communication protocols, such as ZigBee PRO [23], WirelessHART™ [24] or ISA100.11a. However, our mechanism is mainly based on the ISA100.11a standard, which is an extended version of WirelessHART™ and by providing useful high-level services, was specifically designed for industrial environments. These services include coexistence with other technologies, reliability of the communication through hopping and blacklisting methods for radio frequency change, security based on cryptographic services, and prioritization and warning services for control systems and industry. More specifically, ISA100.11a classifies the alarms into four types: Device diagnostics, communication diagnostics, security, and processes with five levels of priority: Urgent, high, medium, low, journal. These alarms are managed by each network device, but only one of them (generally, the gateway) is responsible for buffering them, using organized queues according to their given levels of priority. Regarding ZigBee PRO, its security is still weak, as an attacker could deduce the security credentials through an attack of differential power analysis (variations of power consumption of the microprocessor/memory whilst performing cryptographic operations) and by knowing a priori both the master key and the Symmetric-KeyKey-Exchange (SKKE) scheme [9].

For reasons of simplicity, we assume that the communication link ‘sensor–sensor’ and ‘sensor–gateway’ are protected by using the key management schemes of ISA100.11a [25]; whereas the communication links ‘gateway-hand-held’ and ‘gateway-the SCADA Centre’ are protected through security services belonging to the TCP/IP standard such as Socket Secure Layer/Transport Layer Security (SSL/TLS) and Virtual Private Networks (VPN) using the Internet Protocol Security (IPSEC) tunnel mode. Note that some of these security services can also be found in the new version of the Internet Protocol IPv6 known as RFC-6272, Internet Protocols for the Smart Grid [26]. This RFC has been defined to allocate a considerable number of smart network devices, where it is expected that the vast majority of them will be connected with automated energy substations, such as smart meters or sensory devices. This is in accordance with the proposal of the American Recovery and Reinvestment Act (ARPA) of 2009 [27], which includes an investment of hundreds of automated substations with thousands of sensor nodes to detect unforeseen changes and prevent local or regional power blackouts.

Considering the capabilities of the IWSN technology and the functional services of ISA100.11a, three chief functional characteristics are highlighted below, which represent the main benefits of this approach for critical contexts.
                        
                           1.
                           ‘Control and diagnosis’ of disturbances or faults registered within a particular CI and/or in its industrial equipment, such as electricity pylons or generators. A disturbance could be, for example, abrupt changes of temperature registered in industrial engines or transformers, or peaks in voltage in electricity pylons. Part of this control is also focused on ‘Identifying behaviour-based anomalies’ within a cluster of sensors. The idea is to increase the intelligent capabilities of CHs to detect local anomalous behaviours with respect to the general conduct of the rest of the nodes of a cluster. Existing local deficiencies caused by energy exhaustion, malfunction or an attack may also hamper the general supervision of the infrastructure and it is necessary to anticipate such situations since the protection of the entire system has been entrusted to these types of devices.

‘Respond to emergency situations’ to prevent any effect that may produce a cascading effect, and in this way comply with the conditions given in [16]. In addition, the hierarchical configuration helps the system locate problems by knowing, a priori, the network deployment.

‘Evaluate the level of accuracy of each sensory device’ with respect to a set of factors: Its activity noted in the recent past, the activity noted by each member of its neighbourhood and the feedback on the true situation received after a manual inspection. For this study, an accuracy statistical technique known as the F-Measure or F-Score [28] is applied. According to the Joint Committee for Guides in Metrology (JCGM) [29], accuracy can be defined as the “closeness of agreement between a measured quantity value and a true quantity value” and where “the measurement accuracy is then said to be more accurate when it offers with a smaller measurement error”. This concept is often confused with the concept of precision, which means the “closeness of agreement between indications or measured quantity values obtained by replicate measurements on the same or similar objects under specified conditions” [29]; i.e., obtain repeated sequences of samples under similar conditions with similar results. Given this and taking into account the focus of this paper, we need to determine the degree of correctness in the observation tasks through the concept of accuracy.

For the sake of clarity, all these goals, characteristics and their importance within the WASA mechanism are described in more detail in the remainder of this paper.

Considering the architecture and the goals stated in Section 3, the next step is to provide each system element with a set of WASA functionalities.

Each sensor node of a cluster has to be deployed near to the observed CI with the mission of monitoring a particular object (e.g., electrical generators) or its surroundings. For a constant monitoring, sensor nodes have to continuously sense, through their sensors, physical events (i.e., measurements) from the system under observation such as levels of temperature, voltage or pressure. Given that the proposed mechanism focuses on power scenarios, such physical events relate to values of voltage, denoted as vi
                        .

The left hand side of Fig. 3
                         illustrates the software architecture of the observation system, which includes two chief modules: Behaviour Pattern (BP) module and Alarm Manager (AM) module. The BP module is in charge of analysing, through behaviour patterns, two types of states: Normal states and anomalous states. Normal states refer to those samples that are inside the normality thresholds defined by the organisation or its security policies. In contrast, anomalous states correspond to the behaviour of the object under observation, which deviates from the standard, expected, or usual.

In order to link normal and anomalous states with respect to the expected performance of the observed CI, our analysis focuses on infrastructural states to examine whether physical events (e.g., values of voltage, vi) deviate, or not, from the norm. Moreover, a normal state can likewise be subdivided into two further categories: Satisfactory states and acceptable states. A satisfactory state refers to valid voltage readings that are within predefined thresholds, i.e., vi
                         ∈ [Vmin
                        ,Vmax
                        ], where Vmin
                        , Vmax
                         represent the minimum and maximum values of voltage. An acceptable state corresponds to those infrastructural states that slightly deviate from the norm, but are acceptable according to security policies. This latter category is related to those alarms labelled with levels of minor priority.

To represent all these states, the BP module not only has to analyse each event received but it also has to tag it according to the five levels of criticality defined by ISA100.11a: Journal with value 1, low with 2, medium with 3, high with 4 and urgent with 5. Namely:
                           
                              •
                              Normal states are signalled with values (0–3), where the zero is reserved for satisfactory states and (1–3) for acceptable states. In other words:
                                    
                                       -
                                       Satisfactory states correspond to vi
                                           ∈ [Vmin
                                          ,Vmax
                                          ].

Acceptable states correspond to vi
                                           ∉ [Vmin
                                          ,Vmax
                                          ], but they are within normal requirements. As it is possible to find three types of acceptable states (journal, low and medium), it is necessary to define the respective thresholds for each of them.

Anomalous states are associated with values (4–5) to represent unstable states as well as an indicator of urgency (high and urgent, respectively).

Once the BP module has identified, through behaviour patterns, the different types of states and their levels of criticality, it has to warn the AM module of the situation. This module is responsible for generating a new ISA100.11a alarm and sending it to its CH through the ARMO (Alert Reporting Management Object) class. ARMO is a class of ISA100.11a, in charge of generating alerts with different priorities using the AlertReport service belonging to the DMAP (Device Management Application Process) class, which includes a set of objects for local or remote configuration and supervision of network parameters.

Although sensor nodes are able to disseminate information to their respective CH, the main core of the mechanism is primordially distributed and located between the CH and the gateway. The goal at this point is to provide simple and straightforward diagnostic techniques to offer support for situational awareness. These techniques, described below, have to be implemented in each CH in order to diagnose any activity performed by their sensors. This diagnosis is fundamental because it could be assumed that each new node joining the observation system is a reliable and trustworthy node. However, their conduct can change over time due to internal faults (caused by hardware or software errors), external faults (produced by unplanned accidents or incidents) or simply because the node itself is a compromised device with malicious actions.

The module in charge of the diagnosis is illustrated in Fig. 3 on the right hand side, labelled Incident Manager (IM
                           CH
                        ). However, its functionality does not end there. It has to forward the information received from its sensors to the gateway. If the information received is labelled with the value zero corresponding to a ‘satisfactory state’ (i.e., v
                        
                           i
                        
                        ∈[V
                        
                           min
                        ,V
                        
                           max
                        ]), it has to be filtered and aggregated by the Aggregation module. Otherwise, it has to be sent to the Alarm Manager (AM) to produce an ISA100.11a alarm. In either of these two cases and before sending any information to the gateway, the IM
                           CH
                         also has to store the aforementioned information in a temporal buffer so that it can periodically analyse anomalous behaviour shown by any sensor with respect to its neighbourhood.

Diagnostics basically concerns the definition of a discrete probability distribution between those states in which a node can remain or transit to. The transition of these states can be represented through a directed graph where the edges are labelled with probabilities of transiting from one state to another. Given this, and considering the five levels of criticality of ISA100.11a, we define G as the transition graph between states where each state belongs to S
                        ={s
                        0,s
                        1,s
                        2,s
                        3,s
                        4,s
                        5}. The probability of going from a sβ
                         state to another s
                        α state takes the following transition distribution:
                           
                              (1)
                              
                                 
                                    Pr
                                    
                                       
                                          
                                             s
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             α
                                          
                                          
                                             s
                                             k
                                          
                                          =
                                          β
                                       
                                    
                                    =
                                    
                                       p
                                       βα
                                    
                                 
                              
                           
                        
                     

In order to represent the transition graph G, we assume that the probability of moving from a state of greater criticality is lower than moving to a state of lower criticality, the criticality of which depends on the priority of the messages received from sensors with values (0–5) ∈ S. We provide, in Eq. (2), an initial approach to calculate the probability of transition of each state s
                        α assuming a priority order; i.e., 
                           
                              
                                 p
                                 
                                    s
                                    0
                                 
                              
                              >
                              
                                 p
                                 
                                    s
                                    1
                                 
                              
                              >
                              
                                 p
                                 
                                    s
                                    2
                                 
                              
                              >
                              
                                 p
                                 
                                    s
                                    3
                                 
                              
                              >
                              
                                 p
                                 
                                    s
                                    4
                                 
                              
                              >
                              
                                 p
                                 
                                    s
                                    5
                                 
                              
                           
                        .
                           
                              (2)
                              
                                 
                                    
                                       p
                                       
                                          s
                                          α
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          4
                                          ×
                                          α
                                       
                                    
                                 
                              
                           
                        
                     

Note that this transition probability distribution is very general where we mainly consider the priorities given by ISA100.11a to facilitate the experimentation in the laboratory. In practice, we recommend that a set of factors to determine the real distribution of a context should be taken into account, such as the characteristics of the application, the frequencies given by a situation and its restrictions. A learning process based on classification and labelled can become a requirement to identify the different criticality thresholds of a context [30]. This procedure may involve (i) an initial training phase to detect several priority classes, in which a classifier learns of the situation using for example a labelled dataset; and (ii) a testing phase to classify situations using the classifier. Once the priority classes have been identified, it is then possible to determine the distribution degree and the priority order to be considered for the approach. We, for example, assume for the experimentation that less critical situations are more probable than critical situations; i.e., 
                           
                              
                                 p
                                 
                                    s
                                    i
                                 
                              
                              >
                              
                                 p
                                 
                                    s
                                    j
                                 
                              
                           
                         and i
                        <
                        j; however, this assumption is dependent on the application context.

As Eq. (2) is only feasible when α>0, the calculation of moving from a sβ
                         state to a sα state with β
                        ≥0 is therefore defined in the following way:
                           
                              (3)
                              
                                 
                                    Pr
                                    
                                       
                                          
                                             S
                                             
                                                k
                                                +
                                                1
                                             
                                          
                                          =
                                          α
                                          |
                                          
                                             S
                                             k
                                          
                                          =
                                          β
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                1
                                                −
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            a
                                                            =
                                                            1
                                                         
                                                         5
                                                      
                                                      
                                                         
                                                            p
                                                            
                                                               s
                                                               α
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                   
                                                      s
                                                      α
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             if
                                             
                                             α
                                             =
                                             0
                                             ;
                                          
                                       
                                       
                                          
                                             if
                                             
                                             α
                                             >
                                             0
                                             ;
                                          
                                       
                                    
                                 
                              
                           
                        where, ∑
                           α
                           =0
                        5(Pr
                        
                           βα
                        )=1. The result of calculating Eq. (3) is represented in Table 1
                         and illustrated from Figs. 4 to 9
                        
                        
                        
                        
                        
                        .

To detect anomalous behaviours, each CH must periodically analyse the evidence streams registered in the temporal buffer. This buffer is divided into several arrays with size ∆
                           size
                         designated to each sensor (sensori
                         with ID
                           sensori
                           
                        ) of their neighbourhood, where the cells of the arrays contain different values of criticality s
                        α, where α ∈ (0–5). To compute criticality decisions taken by sensors in the recent past, the system has to recover the criticality values in order to calculate the total sum of probabilities of transitions between states. The result is an average criticality value obtained from the sum of the criticality probabilities of moving to states. In other words, taking into consideration the notation represented in Eq. (1), the behaviour of a sensori
                         in the past
                           1
                        
                        
                           1
                           The time window for diagnosis could be established by the ∆
                                 size
                              .
                         is computed as follows:
                           
                              (4)
                              
                                 
                                    
                                       
                                          prob
                                          =
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   Δ
                                                   
                                                      size
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                Pr
                                                
                                                   
                                                      
                                                         s
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      =
                                                      arra
                                                      
                                                         y
                                                         i
                                                      
                                                      
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                            k
                                                         
                                                      
                                                      =
                                                      arra
                                                      
                                                         y
                                                         i
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   0
                                                
                                                
                                                   Δ
                                                   
                                                      size
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                P
                                                
                                                   r
                                                   
                                                      arra
                                                      
                                                         y
                                                         i
                                                      
                                                      
                                                         j
                                                      
                                                      arra
                                                      
                                                         y
                                                         i
                                                      
                                                      
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where, the array
                        
                           i
                        [j] represents the state β and the array
                        
                           i
                        [j
                        +1] is the state α. Note that in the case where an array
                        
                           i
                         maintains ‘anomalous states’ with values of high or urgent criticality, it is important to consider further two situations:
                           
                              4.
                              Calculate the number of critical states (s
                                 4–s
                                 5) included within the array
                                 
                                    i
                                 . We denote this type of computation with the variable freq
                                 
                                    alarms
                                 .

Calculate the number of jumps generated from normal states (s
                                 0–s
                                 3) to anomalous states (s
                                 4–s
                                 5), and vice versa. The variable that contains this value is denoted as changes
                                 
                                    states
                                 .

In the case of the first, it is necessary to count the frequency of critical alarms (4–5), and for the second an analysis of the abrupt changes between states is required. These changes can be analysed by pre-computing the sequence of alarms stored in array
                        
                           i
                        , generating another sequence based on binary values named here as binarySeq
                        
                           i
                        , with values 0 or 1 and an array size with 
                           
                              Δ
                              
                                 siz
                                 
                                    e
                                    i
                                 
                              
                           
                        . Any entry in array
                        
                           i
                         with high criticality (4–5) is assigned to the sequence binarySeq
                        
                           i
                         with value one, otherwise with value zero. This can be better understood with an example. Let us consider an alarm sequence with 
                           
                              
                                 Δ
                                 
                                    siz
                                    
                                       e
                                       i
                                    
                                 
                              
                              =
                              10
                           
                         and values 0510500420. As this sequence stores critical values, its binary sequence would then be 0100100100. With this new sequence, it is possible to calculate the difference (Eq. (5)) between consecutive values and the total number of abrupt jumps between states.
                           
                              (5)
                              
                                 
                                    change
                                    
                                       s
                                       states
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             Δ
                                             
                                                size
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                binarySe
                                                
                                                   q
                                                   i
                                                
                                                
                                                   j
                                                
                                                −
                                                binarySe
                                                
                                                   q
                                                   i
                                                
                                                
                                                   
                                                      j
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Depending on the variables freq
                        
                           alarms
                         and changes
                        
                           states
                         given above, three situations can occur and one of them has to be computed to obtain the general behaviour of a sensor. They are as follows:
                           
                              •
                              Case A: freq
                                 
                                    alarms
                                 
                                 >0 and changes
                                 
                                    states
                                 
                                 >0; e.g., 0505050505. This means that the sensor sends irregular values that can indicate a hardware or software problem, or even a threat.

Case B: freq
                                 
                                    alarms
                                 
                                 >0 and changes
                                 
                                    states
                                 
                                 ==0; e.g., 4544444455. This situation indicates that the sensor considers that an emergency situation exists.

Case C: freq
                                 
                                    alarms
                                 
                                 ==0 and changes
                                 
                                    states
                                 
                                 ==0; e.g., 1233322221. This means that the sensor considers that the scenario does not present any critical situation.

According to these three scenarios, three further equations are defined.
                           
                              (6)
                              
                                 
                                    b
                                    
                                       h
                                       
                                          senso
                                          
                                             r
                                             i
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                Eq
                                                .
                                                6.1
                                                :
                                                
                                                   
                                                      prob
                                                      
                                                         
                                                            Δ
                                                            
                                                               siz
                                                               
                                                                  e
                                                                  i
                                                               
                                                            
                                                         
                                                         ×
                                                         fre
                                                         
                                                            q
                                                            alarms
                                                         
                                                         ×
                                                         change
                                                         
                                                            s
                                                            states
                                                         
                                                      
                                                   
                                                
                                                
                                                if
                                                
                                                Case
                                                
                                                A
                                                ;
                                             
                                          
                                          
                                             
                                                Eq
                                                .
                                                6.2
                                                :
                                                
                                                   
                                                      prob
                                                      
                                                         
                                                            Δ
                                                            
                                                               siz
                                                               
                                                                  e
                                                                  i
                                                               
                                                            
                                                         
                                                         ×
                                                         fre
                                                         
                                                            q
                                                            alarms
                                                         
                                                      
                                                   
                                                
                                                ;
                                                
                                                if
                                                
                                                Case
                                                
                                                B
                                                ;
                                             
                                          
                                          
                                             
                                                Eq
                                                .
                                                6.3
                                                :
                                                
                                                   
                                                      prob
                                                      
                                                         Δ
                                                         
                                                            siz
                                                            
                                                               e
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                ;
                                                if
                                                
                                                Case
                                                
                                                C
                                                ;
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Once the individual behaviour of a set of sensors of a cluster has been calculated and temporally stored within a list of behaviours (denoted in this paper as List_BehaviourSensor), the CH has to determine their conduct using a particular threshold of normality. To define the threshold, we consider the concept of ‘acceptable state’ with 
                           
                              p
                              
                                 s
                                 3
                              
                           
                         defined above, the value of which would indicate that any behaviour with a probability of less than 
                           
                              p
                              
                                 s
                                 3
                              
                           
                         would be considered a critical situation. In other words, through this threshold the CH can detect the behaviour of its neighbourhood by analysing discrepancies of criticality taken by its sensors in their recent past. For the analysis, the CH has to run through the entire List_BehaviourSensor to observe whether any 
                           
                              b
                              
                                 h
                                 
                                    senso
                                    
                                       r
                                       i
                                    
                                 
                              
                           
                         on the list is equal to or different from the rest; inferring the existence of a discrepancy of perceived situations within a cluster or a consensus in the observation tasks. Namely, let us suppose that we have a list List_BehaviourSensor
                        =
                        
                           
                              
                                 b
                                 
                                    h
                                    
                                       senso
                                       
                                          r
                                          1
                                       
                                    
                                 
                                 <
                                 
                                    p
                                    
                                       s
                                       3
                                    
                                 
                                 ,
                                 b
                                 
                                    h
                                    
                                       senso
                                       
                                          r
                                          2
                                       
                                    
                                 
                                 ≥
                                 
                                    p
                                    
                                       s
                                       3
                                    
                                 
                                 ,
                                 b
                                 
                                    h
                                    
                                       senso
                                       
                                          r
                                          3
                                       
                                    
                                 
                                 ≥
                                 
                                    p
                                    
                                       s
                                       3
                                    
                                 
                              
                           
                        , this means that the 
                           
                              I
                              
                                 D
                                 
                                    senso
                                    
                                       r
                                       1
                                    
                                 
                              
                           
                         has perceived a critical situation, contrary to what has been detected by its neighbours. In contrast, a List_BehaviourSensor
                        =
                        
                           
                              
                                 b
                                 
                                    h
                                    
                                       senso
                                       
                                          r
                                          1
                                       
                                    
                                 
                                 ≥
                                 
                                    p
                                    
                                       s
                                       3
                                    
                                 
                                 ,
                                 b
                                 
                                    h
                                    
                                       senso
                                       
                                          r
                                          2
                                       
                                    
                                 
                                 ≥
                                 
                                    p
                                    
                                       s
                                       3
                                    
                                 
                                 b
                                 
                                    h
                                    
                                       senso
                                       
                                          r
                                          3
                                       
                                    
                                 
                                 ≥
                                 
                                    p
                                    
                                       s
                                       3
                                    
                                 
                              
                           
                         states that all nodes in a cluster have perceived the same situation. Only in the case where the CH deduces discrepancies between criticality values, does it have to generate a new ISA100.11a alarm with a high priority through the ARMO class and send it to the gateway in charge of evaluating the level of accuracy for each 
                           
                              I
                              
                                 D
                                 
                                    senso
                                    
                                       r
                                       1
                                    
                                 
                              
                           
                        . This evaluation serves as an attractive way to assess how the detection was really done by each sensor belonging to a particular cluster. To this end, the ISA100.11a alarm should include, at least, the ID of the CH (
                           
                              I
                              
                                 D
                                 
                                    C
                                    
                                       H
                                       i
                                    
                                 
                              
                           
                        ) the type of event that has occurred (i.e., event_instabilityCH), and the list of behaviours that has been previously generated. All of these steps and equations are summarized in Algorithm 4.1.
                           Algorithm 4.1
                           Analysis of behaviour per Neighbourhood(IDCH
                              
                              
                                 i
                              )
                                 
                                    
                                 
                              
                           

The main functionalities of the gateway focus on: Location, warning and response of the nearest human operator within the affected area, assessment of the degree of accuracy in the observation and protection tasks, and reporting. These three high-level services are described in detail in the following sections.

As mentioned, the gateway is in charge of managing any alarm received from the observation system and evaluating the real behaviour of its sensors. The architecture proposed in Fig. 10
                            is based on three chief modules: ARO, Incident Manager (IM
                              g
                           ) and Diagnostic Manager (DM). The idea basically consists of receiving alerts through the ARO (Alert Receiving Object) class belonging to the DMAP class of ISA100.11a (see Section 4.2). This class is organized into five priority queues and each queue stores a type of alarm according to its level of criticality. In addition, the ARO module must perform three main tasks:
                              
                                 •
                                 Send any information received (either ‘normal states’ or ‘anomalous states’) from the observation system to the SCADA Centre.

Send those ‘anomalous states’ with criticality (4–5) to the IM
                                       g
                                     so that it can locate the nearest human operator to the affected area. For the search for the nearest operator, the IM
                                       g
                                     has to maintain a database with information related to the human operators (e.g., availability according to their contracts) and use global positioning technologies to identify their positions in the field. Once located, the system provides him/her with information about the situation, such as the location of the affected area, the type of event detected, the ID
                                       CH
                                     or the ID
                                       sensor
                                    . All the information has to be easily visualized through hand-held interfaces in a legible format to locally enable the mobility within the area to ensure a timely reaction.

Notify the operator of the discrepancies of criticality detected by a CH, and help the WASA system compute the level of accuracy of each node belonging to such a cluster. In this case, the IM
                                       g
                                     has to store, in a temporal memory cache, the list of the sensors' identifiers together with their anomalous behaviour to later assist in the assessment tasks managed by the Assessment of Accuracy (AA) module (introduced later).

When the operator provides the system with the required feedback for evaluating the behaviour of each sensor of a neighbourhood after receiving the event ‘event_instabilityCH’, he/she has to indicate the type of situation: ‘Critical’ or ‘non-critical’. With this information, the system is then able to evaluate the level of accuracy attributing it to four different perspectives:
                              
                                 •
                                 A True Positive (TP): The sensor (sensors) observed a crisis scenario, and this coincides with the operator's feedback; i.e., a correct warning.

A False Positive (FP): The sensor (sensors) observed a crisis scenario, but it is non-critical according to the operator's feedback; i.e., a false warning.

A False Negative (FN): The sensor (sensors) did not observe a crisis scenario, when the system was threatened; i.e., a missed warning.

A True Negative (TN): The sensor (sensors) did not observe any crisis scenario, and this coincides with the operator's feedback; i.e., a correct no warning.

Through the human operators' feedback, the DM can update the level of accuracy (see Section 3) of the observation system through the AA module. This module is in charge of maintaining four main counters for each sensor: (i) A 
                              
                                 countT
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            to control the correct warnings, (ii) a 
                              
                                 countF
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            to control the false warnings, (iii) a 
                              
                                 countF
                                 
                                    N
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            to control the missed warnings, and (iv) 
                              
                                 countT
                                 
                                    N
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            to control correct no warnings. Each of these counters has to be initialized to zero in the deployment and joining phases (i.e., during the commissioning phase), and are updated by one unit according to the conduct of the sensors in their detection and protection tasks. Note that the control of FNs is carried out when a CH observes an irregularity in its cluster. If all sensors except one (
                              
                                 I
                                 
                                    D
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                           ) warn of a critical situation and the operator's feedback verifies such a situation, then the rate of FNs associated to the node 
                              
                                 I
                                 
                                    D
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            should be increased by one unit.

Once the counters involved have been updated, the system also has to compute the level of accuracy using the F-Measure technique [28]. This technique consists of computing the weighted harmonic mean (a mathematical concept related to the average) of precision and recall, the resulting value (probabilistic) of which, falls in the interval [0,1]. Zero indicates poor accuracy (i.e., a measurement with a significant error rate) and a value close to one represents good accuracy (i.e., a measurement with a small error rate). Observing Eq. (7), the precision comprises the ratio of correct warnings (
                              
                                 countT
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                           ) with respect to the rate of failure warnings (the sum of 
                              
                                 countT
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            and 
                              
                                 countF
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                           ), whereas the recall specifies (see Eq. (8)) the ratio of correct warnings with respect to the rate of real failures (the sum of 
                              
                                 countT
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            and 
                              
                                 countF
                                 
                                    N
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                           ), both of which also fall in the interval [0,1].
                              
                                 (7)
                                 
                                    
                                       precision
                                       =
                                       
                                          
                                             countT
                                             
                                                P
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             countT
                                             
                                                P
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                             +
                                             countF
                                             
                                                P
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       ∈
                                       
                                          0
                                          1
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       recall
                                       =
                                       
                                          
                                             countT
                                             
                                                P
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             countT
                                             
                                                P
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                             +
                                             countF
                                             
                                                N
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       ∈
                                       
                                          0
                                          1
                                       
                                    
                                 
                              
                           
                        

According to [28], the F-Measure is computed as follows:
                              
                                 (9)
                                 
                                    
                                       F
                                       −
                                       Measure
                                       =
                                       
                                          
                                             2
                                             ×
                                             precision
                                             ×
                                             recall
                                          
                                          
                                             precision
                                             +
                                             recall
                                          
                                       
                                       ∈
                                       
                                          0
                                          1
                                       
                                    
                                 
                              
                           
                        

The F-Measure value is a probabilistic variable that will change according to the operator's feedback, who acts as a supervisor (see Section 4.3.2). To this end, the module AA needs to run through the whole List_BehaviourSensor stored in cache to compute the level of accuracy taken by a sensor in its recent past. To this end, the system proceeds as shown in Table 2
                           , to increase by one unit one of the four counters mentioned above: 
                              
                                 countT
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                           , 
                              
                                 countF
                                 
                                    P
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                           , 
                              
                                 countT
                                 
                                    N
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            and 
                              
                                 countF
                                 
                                    N
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                            ∀ sensor
                           
                              i
                            of the cluster. For the computation of these counters, a threshold of criticality is required to delimit those critical and non-critical situations. This threshold will depend on the security policies and the owner organisation. We, for example, define as threshold, the value specified for 
                              
                                 p
                                 
                                    s
                                    3
                                 
                              
                            (defined in Section 4.2) given that it is the point of intersection between a critical situation and a non-critical situation; i.e., ‘acceptable state’.

As these counters have been updated, the system then has to calculate their new value F-Measure considering Eq. (9). If the new value of F-Measure is close to zero or it is less than or equal to the minimum threshold (defined by the organisation), the AA module has to warn the system of the inefficacy or unreliability of the 
                              
                                 I
                                 
                                    D
                                    
                                       senso
                                       
                                          r
                                          i
                                       
                                    
                                 
                              
                           . The new warning should contain, at least, the identifier of the sensor, its location and the type of event event_discardSensor. The output should be managed by the IM
                              g
                            to search for the nearest human operator to the affected node (see Section 4.3.1). For the sake of clarity, Algorithm 4.2 summarises this proposal.
                              Algorithm 4.2
                              Accuracy per neighbourhood(List_BehaviourSensor,OpFeedback)
                                    
                                       
                                    
                                 
                              

As the system manages information for each sensor, the Reporter module should periodically and/or on-demand generate and send frequent reports to the SCADA Centre. These reports help the system maintain a clearer vision of the functionality of the observation network by showing, through certain formats, (e.g., statistical graphics) the level of accuracy and functioning of its control elements. Likewise, it should be noted that although the rate of TN is not considered by the F-Measure technique in Eq. (9) (see Section 4.3.2), it is considered in our mechanism in order to deliver a high degree of information in the reports to the SCADA Centre.

In order to validate the first part of the mechanism defined in Section 4.2, we have implemented it in nesC and simulated it using the Avrora simulator under the de-facto standard operating system for sensor nodes TinyOS 2.× [31]. Avrora is able to interpret conventional sensor nodes such as the Mica2, which belong to category II defined in [32] with typically 4–8MHz, 4–10KB RAM, 48–128KB ROM with 2–8mA of energy. Table 3
                      illustrates the results of the simulation, which indicate that a cluster working as a Mica2, requires less than 7MHz to execute the software, consuming around 0,67 for CPU and 1.69J for radio, approximately reaching a maximum of 2.8% for reading (r) and 3% for writing (w) in memory. Therefore, if traditional sensors are able to work as CHs, then ISA100.11a sensors belonging to category III with higher capabilities (13–180MHz, 256–512KB RAM, 4–32MB ROM and 40mA of energy) are also able to serve as CHs.

The second part has been implemented in Java, in which we have designed an emergency scenario based on two substations (substation A and substation B) under the control of two CHs (
                        
                           I
                           
                              D
                              
                                 C
                                 
                                    H
                                    1
                                 
                              
                           
                        
                     , 
                        
                           I
                           
                              D
                              
                                 C
                                 
                                    H
                                    2
                                 
                              
                           
                        
                     ) placed in each substation. Each CH has been configured with two sensors each (
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    3
                                 
                              
                           
                        
                     , 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    4
                                 
                              
                           
                        
                     , 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    5
                                 
                              
                           
                        
                      and 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    6
                                 
                              
                           
                        
                     ) with all their counters countTP
                     
                        i
                     , countFP
                     
                        i
                     , countFN
                     
                        i
                      and countTN
                     
                        i
                      set to value zero. Each sensor node synchronously produces events with values that can range from valid readings, labelled with priority 0, to alarms, labelled with priority (1–5) (see Section 4.1). These events correspond to (either satisfactory or acceptable) normal and anomalous states, which are, respectively, linked to (
                        
                           p
                           
                              s
                              0
                           
                        
                     –
                        
                           p
                           
                              s
                              3
                           
                        
                     ) and (
                        
                           p
                           
                              s
                              4
                           
                        
                     –
                        
                           p
                           
                              s
                              5
                           
                        
                     ) (see Section 4.2). This also means that any alarm that exceeds the limits of normality (which should be established by the organisation and its security policies) should be treated correctly. For the simulation, we have considered as the limit of normality the threshold (0–3) (non-critical alarms with normal states), and any event with criticality (4–5) (critical alarms that are considered as anomalous states) must be sent to one of the six virtual human operators that have been implemented for the simulation. These agents are chosen according to their availability (work time) defined through their virtual ‘contracts’ where their feedback is determined, probabilistically. Note that the scenario has been objectively stressed so as to intentionally generate the four different situations associated with TP, FP, FN and TN. This enables a more extensive study of the mechanism including each of the four cases possible.

Any event generated has to be analysed by CHs, as specified in Section 4.2. To understand the functionalities of these devices, a small example extracted from the simulation is further analysed below, where event sequences are received from sensors, such as 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    3
                                 
                              
                           
                        
                      and 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    4
                                 
                              
                           
                        
                      belonging to the 
                        
                           I
                           
                              D
                              
                                 C
                                 
                                    H
                                    1
                                 
                              
                           
                        
                      of substation A. Considering these notions together with graph 
                        G
                      and Eqs. (6), (7) and 8 defined in Section 4.2, the study carried out by each CH with size of buffer Δ
                        size
                     
                     =15 is as follows:
                        
                           •
                           Sensor 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             3
                                          
                                       
                                    
                                 
                               has received the sequence 100100101300301. As the freq
                              
                                 alarms
                               is equal to zero, the 
                                 
                                    I
                                    
                                       D
                                       
                                          C
                                          
                                             H
                                             1
                                          
                                       
                                    
                                 
                               computes the 
                                 
                                    b
                                    
                                       h
                                       
                                          senso
                                          
                                             r
                                             3
                                          
                                       
                                    
                                 
                               using Eq. (6.3). As a result, the behaviour of the sensor, 
                                 
                                    b
                                    
                                       h
                                       
                                          senso
                                          
                                             r
                                             3
                                          
                                       
                                    
                                 
                              , is 
                                 
                                    0.3066
                                    ∈
                                    
                                       
                                          
                                             p
                                             
                                                s
                                                0
                                             
                                          
                                          −
                                          
                                             p
                                             
                                                s
                                                1
                                             
                                          
                                       
                                    
                                 
                              . Given that 
                                 
                                    b
                                    
                                       h
                                       
                                          senso
                                          
                                             r
                                             3
                                          
                                       
                                    
                                    ≥
                                    
                                       p
                                       
                                          s
                                          3
                                       
                                    
                                 
                              , 
                                 
                                    I
                                    
                                       D
                                       
                                          C
                                          
                                             H
                                             1
                                          
                                       
                                    
                                 
                               infers that the sensor has not observed a critical situation in the last few minutes.

Sensor 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             4
                                          
                                       
                                    
                                 
                               has received the sequence 301401455555550. As the freq
                              
                                 alarms
                               is equal to nine and there are four changes in the state (changes
                              
                                 states
                              ), the cluster head calculates its behaviour through Eq. (6.1). The result is 
                                 
                                    b
                                    
                                       h
                                       
                                          senso
                                          
                                             r
                                             4
                                          
                                       
                                    
                                 
                               of 
                                 
                                    0.0055
                                    ∈
                                    
                                       
                                          
                                             p
                                             
                                                s
                                                4
                                             
                                          
                                          −
                                          
                                             p
                                             
                                                s
                                                5
                                             
                                          
                                       
                                    
                                 
                              . As 
                                 
                                    b
                                    
                                       h
                                       
                                          senso
                                          
                                             r
                                             4
                                          
                                       
                                    
                                    <
                                    
                                       p
                                       
                                          s
                                          3
                                       
                                    
                                 
                              , 
                                 
                                    I
                                    
                                       D
                                       
                                          C
                                          
                                             H
                                             1
                                          
                                       
                                    
                                 
                               concludes that the sensor detected a critical situation in the past.

As one of the sensors of the cluster has detected an emergency situation, 
                        
                           I
                           
                              D
                              
                                 C
                                 
                                    H
                                    1
                                 
                              
                           
                        
                      has to send a new critical alert with a high priority to the gateway in order to observe the behaviour of the entire neighbourhood. The new alert should contain, at least, 
                        
                           I
                           
                              D
                              
                                 C
                                 
                                    H
                                    1
                                 
                              
                           
                        
                      and the list List_BehaviourSensor with 
                        
                           
                              b
                              
                                 h
                                 
                                    senso
                                    
                                       r
                                       3
                                    
                                 
                              
                              ,
                              b
                              
                                 h
                                 
                                    senso
                                    
                                       r
                                       4
                                    
                                 
                              
                           
                        
                     . Likewise, a human operator has to be warned of this situation to obtain from him/her certain feedback which would correspond to the true nature of the situation. In this way, it is also possible to determine whether 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    3
                                 
                              
                           
                        
                      and 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    4
                                 
                              
                           
                        
                      were right in their observation tasks; i.e., Has there really been an emergency situation in the last few minutes or not? If so, this means that the 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    4
                                 
                              
                           
                        
                      was right, but: Why didn't 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    3
                                 
                              
                           
                        
                      detect this situation? Moreover, exactly the opposite can happen.

In these circumstances, the system has to penalize/compensate the operation of both nodes in some way (the node in question and its neighbour). To this end and depending on the human operator's feedback, two types of situation can appear.
                        
                           •
                           Case A: The operator's feedback denotes a critical situation, so the AA module integrated inside the DM has to compute two specific cases:
                                 
                                    -
                                    An FN: 
                                          
                                             I
                                             
                                                D
                                                
                                                   senso
                                                   
                                                      r
                                                      3
                                                   
                                                
                                             
                                          
                                        did not detect the situation properly (see Table 2 with 
                                          
                                             b
                                             
                                                h
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                             ⩾
                                             
                                                p
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       ). The AA module therefore increases its counter 
                                          
                                             countF
                                             
                                                N
                                                
                                                   senso
                                                   
                                                      r
                                                      3
                                                   
                                                
                                             
                                          
                                       .

A TP: 
                                          
                                             I
                                             
                                                D
                                                
                                                   senso
                                                   
                                                      r
                                                      4
                                                   
                                                
                                             
                                          
                                        did detect the emergency situation correctly. Hence, the AA increases its 
                                          
                                             countT
                                             
                                                P
                                                
                                                   senso
                                                   
                                                      r
                                                      4
                                                   
                                                
                                             
                                          
                                        (see Table 2 with 
                                          
                                             b
                                             
                                                h
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                             <
                                             
                                                p
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       ).

Case B: The operator's feedback indicates a non-critical situation, therefore:
                                 
                                    -
                                    A TN: 
                                          
                                             I
                                             
                                                D
                                                
                                                   senso
                                                   
                                                      r
                                                      3
                                                   
                                                
                                             
                                          
                                        did not detect an emergency scenario properly (see Table 2 with 
                                          
                                             b
                                             
                                                h
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                             ⩾
                                             
                                                p
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       ). The AA module therefore increases its counter 
                                          
                                             countT
                                             
                                                N
                                                
                                                   senso
                                                   
                                                      r
                                                      3
                                                   
                                                
                                             
                                          
                                       .

An FP: 
                                          
                                             I
                                             
                                                D
                                                
                                                   senso
                                                   
                                                      r
                                                      4
                                                   
                                                
                                             
                                          
                                        the sensor made a mistake in the observation and the AA increases its 
                                          
                                             countF
                                             
                                                P
                                                
                                                   senso
                                                   
                                                      r
                                                      4
                                                   
                                                
                                             
                                          
                                        (see Table 2 with 
                                          
                                             b
                                             
                                                h
                                                
                                                   senso
                                                   
                                                      r
                                                      i
                                                   
                                                
                                             
                                             <
                                             
                                                p
                                                
                                                   s
                                                   3
                                                
                                             
                                          
                                       ).

Once these two situations and the updating of the counters have been taken into account, the AA module then calculates the new F-Measure value using Eq. (9) defined in Section 4.3.2. As a result, Fig. 11
                      depicts, on the one hand, the relevance of maintaining the rates of TP, TN, FP and FN, and on the other hand, the importance of the F-Measure for each sensor involved (also including the sensors 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    5
                                 
                              
                           
                        
                      and 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    6
                                 
                              
                           
                        
                     ). In order to understand the significance of this illustration, a brief analysis for each substation is given below.
                        
                           •
                           Substation A: The cluster head 
                                 
                                    I
                                    
                                       D
                                       
                                          C
                                          
                                             H
                                             1
                                          
                                       
                                    
                                 
                               together with 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             3
                                          
                                       
                                    
                                 
                               and 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             4
                                          
                                       
                                    
                                 
                               have produced 82 events, of which 49 indicated a real critical situation (the sum of rates of both TP and FN). Moreover, 52 warnings (between TP and FP) were managed: 25 for 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             3
                                          
                                       
                                    
                                 
                               and 27 for 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             4
                                          
                                       
                                    
                                 
                              .

Looking at Fig. 11, we observe that the worst scenario is caused by 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    4
                                 
                              
                           
                        
                     , receiving 19 FN and 17 FP according to the operators' virtual feedback. This fact means that its F-Measure value significantly decreases in Fig. 11 until it falls to the minimum value permitted (we have considered the value zero). Moreover, the node 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    4
                                 
                              
                           
                        
                      presents an irregular behaviour in its control tasks the whole time. This not only may obstruct the protection tasks of its neighbourhood but it may also put the welfare of the CI at risk. To the contrary, 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    3
                                 
                              
                           
                        
                      decreases its F-Measure (≃0.9) but maintains its F-Measure value within the acceptable permitted threshold (between 1 and 0.5). This also means that this node has behaved appropriately for the protection during the simulation.
                        
                           6.
                           Substation B: The cluster head 
                                 
                                    I
                                    
                                       D
                                       
                                          C
                                          
                                             H
                                             2
                                          
                                       
                                    
                                 
                               together with 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             5
                                          
                                       
                                    
                                 
                               and 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             6
                                          
                                       
                                    
                                 
                               generated 131 events, of which 76 indicated a real emergency situation (TP). In addition, 93 warnings (between TP and FP) were managed: 46 for 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             5
                                          
                                       
                                    
                                 
                               and 47 for the 
                                 
                                    I
                                    
                                       D
                                       
                                          senso
                                          
                                             r
                                             6
                                          
                                       
                                    
                                 
                              .

The worst scenario is to be found in 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    6
                                 
                              
                           
                        
                     , receiving 13 FP whereas 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    5
                                 
                              
                           
                        
                      demonstrates a correct conduct at all times (see Fig. 11). Note that although the F-Measure of 
                        
                           I
                           
                              D
                              
                                 senso
                                 
                                    r
                                    6
                                 
                              
                           
                        
                      is significantly reduced (≃0.8), its value falls between the values of acceptable threshold of the F-Measure [1,0.5]. This means that although its behaviour is suitable for the control, the frequent semi-abrupt changes taken by the F-Measure should put those human operators on alert so as to anticipate a response when this is needed. Nonetheless, both sensors have shown suitable behaviour during the simulation.

As mentioned, the WASA mechanism has been implemented to offer an interactive solution applicable for critical contexts. The software application is based on three main interfaces, which are depicted in Figs. 12 and 13
                     
                     . Fig. 12 corresponds to the principal interface of the operator in which he/she can visualize:
                        
                           •
                           The alarms received from the observation system, which are categorized by the five levels of priority given by the ISA100.11a standard [11]. Each alarm is associated with: The sensor identifier, the location of the sensor within the cluster, the criticality of the alarm, a brief explication of the problem (e.g., type of event) and the time when such an alarm was received. Despite the fact that this WASA solution has mainly been based on the ISA.100.11a standard, both the mechanism and the software application can be configured to define other ways of classifying, managing and representing other formats of alarm. In a nutshell, both the proposed mechanism and its application can be customized for application in different types of application contexts (e.g., transportation systems, water treatment systems, Smart Grids, etc.).

The list of available operators according to their virtual ‘contracts’ and the operator attending (or has attended) to the alarm.

The rate of TP, FP, TN and FN carried out in each substation at all times.


                     Fig. 13 shows, on the one hand, the rate of TP, FP, TN and FN carried out by each sensor in each substation (at the top of Fig. 13); and on the other hand, the test of accuracy of such sensors with respect to the time line (at the bottom of Fig. 13). As a result, human operators and the SCADA Centre are not only made aware of the real nature of its observation system through these interfaces (running at the time), but they can also understand the degree of severity of a situation by using easy and legible graphical interfaces. For example, they can control the values taken by the rates of FN and FP at all times. In fact, a significant increase of their values could trigger a serious operational problem not only for the control infrastructure itself, but also for those controlled infrastructures [8].

@&#CONCLUSIONS AND FUTURE WORK@&#

Given that situational awareness is a priority topic for the protection of energy control systems, we have presented, in this paper, a diagnosis mechanism based on industrial wireless sensor networks, on the ISA100.11a standard and on the F-Measure technique. Combining these three components, together with other communication technologies, such as mobile ad-hoc networks or the Internet, the system is able to: (i) Know natural conditions of both the critical infrastructure observed and the monitoring system itself, (ii) respond to (critical or anomalous) situations, and (iii) assess the degree of accuracy reached in the control tasks. In order to validate and verify the feasibility of the mechanism for critical contexts, a software application has been implemented together with a critical scenario consisting of two substations based on a hierarchical configuration. Each cluster head receives a set of (critical and non-critical) events from the sensors so as to evaluate their behaviour according to their levels of accuracy in detection and protection tasks.

As for future work, it would be useful to extend the mechanism to include forecasting models that help the system anticipate irregular behaviour and respond in advance. In addition, and taking advantage of the accuracy concept, the system could even assess these forecasting models and the reliability of the assessment modules to deliver a much more complete tool, which is able to evaluate, by itself, the entire mechanism. Moreover, it would be interesting to explore the benefits of other accuracy techniques (e.g., reputation) and other existing technologies for wide-area situational awareness, such as cloud computing or the Internet of Things, where aspects relative to privacy of critical information and location of devices have to be carefully considered.

@&#ACKNOWLEDGEMENTS@&#

This work has been partially supported by the Spanish Ministry of Science and Innovation through the research project ARES (CSD2007-00004), by the Andalusian government through the PISCIS project (P10-TIC-06334), and by the EU FP7 through the FACIES project (HOME/2011/CIPS/AG/4000002115). Additionally, in the particular case of the first author, the research leading to these results has received funding from the Marie Curie COFUND programme “U-Mobility” co-financed by the University of Malaga and the European Community Seventh Framework Programme under Grant Agreement No. 246550.

@&#REFERENCES@&#

