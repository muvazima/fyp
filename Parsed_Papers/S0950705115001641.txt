@&#MAIN-TITLE@&#A gradient approach for value weighted classification learning in naive Bayes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Propose a new weighting method in the context of naive Bayes classification learning.


                        
                        
                           
                           Assign different weights for each feature value.


                        
                        
                           
                           A gradient approach for automatically calculating the weights of each feature value.


                        
                        
                           
                           Its performance is compared with that of other state-of-the-art methods.


                        
                        
                           
                           Experiments show the method could improve the performance of naive Bayes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Classification

Bayesian learning

Feature weighting

Gradient descent

@&#ABSTRACT@&#


               
               
                  Feature weighting has been an important topic in classification learning algorithms. In this paper, we propose a new paradigm of assigning weights in classification learning, called value weighting method. While the current weighting methods assign a weight to each feature, we assign a different weight to the values of each feature. The proposed method is implemented in the context of naive Bayesian learning, and optimal weights of feature values are calculated using a gradient approach. The performance of naive Bayes learning with value weighting method is compared with that of other state-of-the-art methods for a number of datasets. The experimental results show that the value weighting method could improve the performance of naive Bayes significantly.
               
            

@&#INTRODUCTION@&#

In some classifiers, the algorithms operate under the implicit assumption that all features are of equal value as far as the classification problem is concerned. However, when irrelevant and noisy features influence the learning task to the same degree as highly relevant features, the accuracy of the model is likely to deteriorate. Since the assumption that all features are equally important hardly holds true in real world application, there have been some attempts to relax this assumption in classification. Zheng and Webb [22] provide a comprehensive overview of work in this area.

The first approach for relaxing this assumption is to combine feature subset selection with classification learning. It is to combine a learning method with a preprocessing step that eliminates redundant features from the data.

Feature selection methods usually adopt a heuristic search in the space of feature subsets. Since the number of distinct feature subsets grows exponentially, it is not reasonable to do an exhaustive search to find optimal feature subsets. In the literature, it is known that the predictive accuracy of naive Bayes can be improved by removing redundant or highly correlated features [13]. This makes sense as these features violate the assumption that each feature is independent on each other.

Another major way to help mitigate this weakness, feature independence assumption, is to assign different weights to different features in classification learning. Since features do not play the same role in many real world applications, some of them are more important than others. Therefore, a natural way to extend classification learning is to assign each feature different weight to relax the conditional independence assumption. Feature weighting is a technique used to approximate the optimal degree of influence of individual features using a training set. While feature selection methods assign 0/1 values as the weights of features, feature weighting is more flexible than feature subset selection by assigning continuous weights. Therefore, feature selection can be regarded as a special case of feature weighting where the weight value is restricted to have only 0 or 1.

Even though there have been many feature weighting methods proposed in the literature, many of them have been applied in the domain of nearest neighbor algorithms [20], and have significantly improved the performance of nearest neighbor methods.

In this paper, we propose a new paradigm of weighting method, called value weighting method. While the current weighting methods assign a weight to each feature, we assign a weight to each feature value. Therefore, the value weighting method is a more fine-grained weighting method than the feature weighting method. While there have been a few work focused on feature weighting in the literature, to our best knowledge, there has been no work which assigns different weight to each feature value in classification leaning. We extended the current hypothesis space of classification learning into next level by introducing a new set of weight space to the problem. Therefore, this paper proposes a new dimension of weighting method by assigning weights to feature values.

The new value weighting method provides a potential of expanding the expressive power of classification learning, and possibly improves its performance. Since features weighting methods improve the performance of the classification learning, we will investigate whether assigning weights to feature values can improve the performance even further.

The main contribution of this paper is to provide a new paradigm of weighting method in classification learning. In this paper, we study the value weighting method in the context of naive Bayesian algorithm. We have chosen naive Bayesian algorithm as the template algorithm since it is one of the most common classification algorithms, and many researchers have studied the theoretical and empirical results of this approach. It has been widely used in many data mining applications, and performs surprisingly well on many applications [5].

There have been only a few methods for combining feature weighting with naive Bayesian learning [10,11,21]. The feature weighting methods in naive Bayes are known to improve the performance of classification learning. We will investigate, in this paper, whether the value weighting method provides enhanced performance in the context of naive Bayes.

The basic assumption behind the value weighting method in this paper is that each feature value has different significance with respect to class value. When we say a certain feature is important/significant, we believe that the importance of the feature can be decomposed. For instance, suppose we are to learn about a rare form of pregnancy-related disease, and try to calculate the importance of feature gender. Obviously, if the value of gender is male, that observation has no effect with respect to the target feature(pregnancy-related disease). On the other hand, the value of female in gender feature surely has significant impact to the target feature. If we assign the same weight to each feature value, we will lack the capability to discriminate the predicting power residing across feature values.

The rest of this paper is structured as follows. In Section 2, we describe the related work on weighting methods in naive Bayesian learning. Section 3 shows the basic concepts of value weighted naive Bayesian learning, and Section 4 discusses the mechanisms of the new value weighting method. Section 5 shows the experimental results of the proposed method, and Section 6 summarizes the contributions made in this paper.

@&#RELATED WORK@&#

A number of approaches have been proposed in the literature of feature selection [19,13,14,9]. While feature selection methods assign 0/1 value to each feature, feature weighting assigns a continuous value weight to each feature. While there have been many research for assigning feature weights in the context of nearest neighbor algorithms [20], very little work of weighting features is done in naive Bayesian learning.

Hall [11] proposed a feature weighting algorithm for naive Bayes using decision tree. The method is called DTNB, and it estimates the degree of feature dependency by generating full decision trees and looking at the depth at which features are tested in the decision tree. They show that DTNB could improve the performance of traditional naive Bayes.

Lee et al. [15,16] proposed an information-theoretic method for calculating feature weights in naive Bayes. They calculated the feature weights of naive Bayes using Kullback–Leibler measure. The averaged amount of information for a feature is calculated, and it showed improvement over normal naive Bayes and other supervised learning methods.

Cardie [3] used an information gain based on the position of a feature in a decision tree to derive feature weights for nearest neighbor algorithm. They designed case-based learning algorithms to improve the performance of minority class predictions. They used local weighting method, and weights are derived for each test instance based on their path it takes in the tree.

Gartner [10] employs SVM algorithm for feature weighting. The algorithm looks for an optimal hyperplane that separates two classes in given space. The weights associated with the hyperplane can be regarded as feature weights in the naive Bayes. It can solve the binary classification problems and the feature weight is based on conditional independence. They showed that the method shows better performance than other state-of-the-art machine learning methods.

@&#BACKGROUND@&#

In this paper, we propose a new value weighting method in the context of naive Bayesian learning. The naive Bayesian classifier is a straightforward and widely used method for supervised learning. It is one of the fastest learning algorithms, and can deal with any number of features or classes. Despite of its simplicity in model, naive Bayes performs surprisingly well in a variety of problems. Furthermore, naive Bayesian learning is robust enough that small amount of noise does not perturb the results.

Two fundamentally different approaches to this optimization problem can be identified, the filter-based and the wrapper-based. The class of filter-based methods contains algorithms that use no input other than the training data itself to calculate the feature weights, whereas wrapper-based algorithms use feedback from a classifier to guide the search. Wrapper-based algorithms are inherently more powerful than their filter-based counterpart as they implicitly take the inductive bias of the classifier into account. In this paper we implement the value weighting method in the context of naive Bayes using wrapper method.

The naive Bayesian learning uses Bayes theorem to calculate the most likely class label of the new instance. Since all features are considered to be independent given the class value, the classification on d is defined as follows
                        
                           
                              
                                 
                                    V
                                 
                                 
                                    NB
                                 
                              
                              (
                              d
                              )
                              =
                              
                                 
                                    argmax
                                 
                                 
                                    c
                                 
                              
                              P
                              (
                              c
                              )
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ij
                                          
                                       
                                       ∈
                                       d
                                    
                                 
                              
                              P
                              (
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                              
                              |
                              c
                              )
                           
                        
                     where 
                        
                           
                              
                                 a
                              
                              
                                 ij
                              
                           
                        
                      represents the j-th value of the i-th feature. In spite of its good performance, naive Bayesian classifier is known to be a linear classifier, and thus has some difficulties with solving non-linearly separable problems.

The naive Bayesian classification with feature weighting is now represented as follows.
                        
                           (1)
                           
                              
                                 
                                    V
                                 
                                 
                                    FWNB
                                 
                              
                              (
                              d
                              )
                              =
                              
                                 
                                    argmax
                                 
                                 
                                    c
                                 
                              
                              P
                              (
                              c
                              )
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ij
                                          
                                       
                                       ∈
                                       d
                                    
                                 
                              
                              P
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          ij
                                       
                                    
                                    |
                                    c
                                    )
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           ∈
                           R
                        
                      represents the weight of feature. In this formula, unlike traditional naive Bayesian approach, each feature i has its own weight 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                     . Feature weighting is a generalization of feature selection, and involves a much larger search space than feature selection.

The feature weighted naive Bayesian classifier provides weight to each feature, and could improve the performance of regular naive Bayesian learning, However, as shown in Lemma 1, the feature weighted naive Bayesian classifier still belongs to the category of linear classifier. For simplicity, suppose an instance d has n binary features, such as 
                        
                           d
                           =
                           (
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           )
                        
                     , and there are only two classes, 
                        
                           c
                           =
                           1
                        
                      and 
                        
                           c
                           =
                           0
                        
                     . From the definition of linear classifier, a classifier is linear if it can be represented in a form of 
                        
                           V
                           =
                           sign
                           (
                           
                              
                                 ∑
                              
                              
                                 i
                              
                           
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           )
                        
                      (assuming 
                        
                           
                              
                                 a
                              
                              
                                 0
                              
                           
                           =
                           1
                        
                     ) where 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      is the constant coefficient associated with 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                        
                     . 
                        Lemma 1
                        
                           Suppose
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    log
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          1
                                          |
                                          c
                                          =
                                          1
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          1
                                          |
                                          c
                                          =
                                          0
                                          )
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    log
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          0
                                          |
                                          c
                                          =
                                          1
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          0
                                          |
                                          c
                                          =
                                          0
                                          )
                                       
                                    
                                 
                              
                           
                           respectively. The feature weighted naive Bayesian classifier in Eq. 
                           
                              (1)
                            
                           is a linear classifier given as
                           
                              
                                 
                                    V
                                    =
                                    sign
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             log
                                             
                                                
                                                   p
                                                   (
                                                   c
                                                   =
                                                   1
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   c
                                                   =
                                                   0
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The proof of Lemma 1 is given in Appendix. Current feature weighting methods have some limitations that each feature value has the same significance with respect to the target concept. A feature takes on a number of discrete values, and each value might have different importance with respect to the target values. Since the current feature weighting methods assign a weight to each feature, all values of the given feature are given the same weight. As an illustrative example of value weighting paradigm, let us consider the following example.
                        Example 1
                        Suppose the Gender feature has values of male and female, and the target feature has the value of y and n. Suppose their corresponding probabilities are given as {
                              
                                 p
                                 (
                                 y
                                 )
                                 =
                                 0.9
                                 ,
                                 p
                                 (
                                 n
                                 )
                                 =
                                 0.1
                                 ,
                                 p
                                 (
                                 y
                                 |
                                 female
                                 )
                                 =
                                 0.1
                                 ,
                                 p
                                 (
                                 n
                                 |
                                 female
                                 )
                                 =
                                 0.9
                                 ,
                                 p
                                 (
                                 y
                                 |
                                 male
                                 )
                                 =
                                 0.99
                                 ,
                                 p
                                 (
                                 n
                                 |
                                 male
                                 )
                                 =
                                 0.01
                              
                           .}

Traditional feature weighting methods give the same weight to both cases whether the feature value is either male or female. When female value is observed, it significantly impacts the probability distribution of the target feature. Meanwhile, the observation of male value does not change much of the target distribution. Majority of the significance of Gender feature takes place when its value is female.

The proposed value weighting method is more fine-grained and provides a new weighting paradigm in classification learning. The basic assumption behind the value weighting method is that each feature value has different significance with respect to class value. When we say a certain feature is important/significant, we think the importance of the feature can be decomposed. As we have seen in Example 1, feature values are not equally important. Some feature values are more important than other feature values. In the case of Example 1, we can see that the value of female is much more important than that of male with respect to the target feature (pregnancy-related disease). If we assign the same weight to each feature value, we will lack the capability to discriminate the predicting power residing across feature values.

In this paper, we think of a problem in which weights are assigned in a more fine-grained way. Unlike feature weighting methods, we assign different weight for each feature value. We call this method as value weighting method. The value weighting method in the context of naive Bayes can be defined as follows.
                        
                           (2)
                           
                              
                                 
                                    V
                                 
                                 
                                    VWNB
                                 
                              
                              (
                              d
                              )
                              =
                              
                                 
                                    argmax
                                 
                                 
                                    c
                                 
                              
                              P
                              (
                              c
                              )
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ij
                                          
                                       
                                       ∈
                                       d
                                    
                                 
                              
                              P
                              
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          ij
                                       
                                    
                                    |
                                    c
                                    )
                                 
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 w
                              
                              
                                 ij
                              
                           
                           ∈
                           R
                        
                      represents the weight of feature value 
                        
                           
                              
                                 a
                              
                              
                                 ij
                              
                           
                        
                     . You can easily see that each feature value is assigned a different weight. The 
                        
                           
                              
                                 w
                              
                              
                                 ij
                              
                           
                        
                      can be any real value, representing the significance of feature value 
                        
                           
                              
                                 a
                              
                              
                                 ij
                              
                           
                        
                     .

Another advantage of value weighting method is Linear classifier works quite well in classification if a learning problem is linear separable. However, if a problem is not linearly separable and its class boundaries cannot be approximated well with linear hyperplanes, then non-linear classifiers are often proper than linear classifiers. Unlike the feature weighted naive Bayes classifier, the value weighted naive Bayes classifier is not linear classifier any more as described in Lemma 2.
                        Lemma 2
                        
                           Suppose
                           
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    log
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          1
                                          |
                                          c
                                          =
                                          1
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          1
                                          |
                                          c
                                          =
                                          0
                                          )
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          t
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    log
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          0
                                          |
                                          c
                                          =
                                          1
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          0
                                          |
                                          c
                                          =
                                          0
                                          )
                                       
                                    
                                 
                              
                           
                           respectively. The value weighted naive Bayesian classifier in Eq. 
                           
                              (2)
                            
                           is represented as follows.
                           
                              
                                 
                                    V
                                    =
                                    sign
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ij
                                                
                                             
                                             (
                                             
                                                
                                                   s
                                                
                                                
                                                   ij
                                                
                                             
                                             -
                                             
                                                
                                                   t
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                             
                                                
                                                   a
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   ij
                                                
                                             
                                             +
                                             log
                                             
                                                
                                                   p
                                                   (
                                                   c
                                                   =
                                                   1
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   c
                                                   =
                                                   0
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The proof of Lemma 2 is very similar to that of Lemma 1, and thus omitted. In Lemma 2, the 
                        
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                        
                      which determines the degree of slope for the linear classifier is changed to 
                        
                           
                              
                                 w
                              
                              
                                 ij
                              
                           
                        
                     . This difference is subtle but critical. The value of 
                        
                           
                              
                                 w
                              
                              
                                 ij
                              
                           
                        
                      changes depending on the value of 
                        
                           
                              
                                 a
                              
                              
                                 ij
                              
                           
                        
                     , which makes the shape of class boundary non-linear. The value weighted naive Bayesian classifier is no longer represented in the form of 
                        
                           V
                           =
                           sign
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        
                     , which makes it non-linear classifier. The value weighted naive Bayes classifier has more expressive power and flexible hypothesis space, which effectively finds a non-linear class boundaries.

By providing more parameters in naive Bayes learning, it expands the dimension of hypothesis space of naive Bayes learning. Introducing a new dimension in naive Bayes increases the expressive power of naive Bayes, which in turn can possibly improve the performance of naive Bayesian learning. Therefore, we will investigate whether the proposed value weighting method can improve the performance of naive Bayesian learning even further, and its performance will be compared with that of other state-of-the-art methods.

In this paper, we develop a new paradigm of assigning weights to feature values in the context of naive Bayesian learning. The main point of the paper is (1) define the importance (weight) of each feature value explicitly, (2) propose a method to automatically calculate the weight of it, and (3) develop a learning algorithm which utilizes these weights and thus improves the current learning algorithm. In addition, value-weighting provide more extended hypothesis space, and more expressive power. For example, 1 of n coding in nave Bayes is a linear classifier method with extended hypothesis dimension, while value weighting makes nave Bayes a non-linear classifier. Therefore, it is worth trying to analyze the importance of feature in a more fine-grained way, and use the weights in classification learning. The main contribution of the paper is that by assigning more fine-grained weights, the classification learning can be improved significantly. Even though there have been a few research on feature weighting in naive Bayesian learning, to the best of our knowledge, there has been no attempt to assign weights to feature values in classification learning.

We use an optimization approach as the basic tool to find the optimal weights of feature values, which minimize the value of the error function. We employ batch gradient descent instead of stochastic gradient descent method. We define the error function of value weighted naive Bayes model as the sum of squared error between predicted value and observed value. When there are N data instances, the error function of the proposed model is given as
                        
                           (3)
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          o
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                        
                      and 
                        
                           
                              
                                 o
                              
                              
                                 k
                              
                           
                        
                      represent the correct target value and predicted target value of k-th instance, respectively. The function is divided by 2 for the computational convenience.

Many different symbols and variables are defined in this section, and to make the reading of paper more clear, the symbols/variables used in Section 4 are explained in Table 1
                     .

From the definition of value weighted naive Bayesian learning (VWNB) in Eq. (2), the value of 
                        
                           
                              
                                 o
                              
                              
                                 k
                              
                           
                        
                      is defined as
                        
                           (4)
                           
                              
                                 
                                    o
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    argmax
                                 
                                 
                                    c
                                 
                              
                              
                                 
                                    
                                       P
                                       (
                                       c
                                       )
                                       
                                          
                                             
                                                ∏
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       P
                                       
                                          
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   ij
                                                
                                             
                                             |
                                             c
                                             )
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The goal of this work is to find a set of weights for feature values which minimizes Eq. (3). However, since the 
                        
                           
                              
                                 o
                              
                              
                                 k
                              
                           
                        
                      function is not differential, we can not solve this problem analytically.

We first transform multi-class problems into multiple binary class problems. The main reason for doing this is to make the 
                        
                           
                              
                                 o
                              
                              
                                 k
                              
                           
                        
                      function Eq. (4) to be continuous and differentiable. In this work, the single column (multiclass value) of target feature is expanded into multiple binary columns (multiple binary values). In other words, suppose the original multiclass data is in a form of (
                        
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 p
                              
                           
                        
                     ), where 
                        
                           
                              
                                 c
                              
                              
                                 p
                              
                           
                        
                      represents the multiclass value, it is transformed into (
                        
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 a
                              
                              
                                 n
                              
                           
                           ,
                           
                              
                                 C
                              
                              
                                 ̂
                              
                           
                        
                     ). The 
                        
                           
                              
                                 C
                              
                              
                                 ̂
                              
                           
                        
                      is expanded as 
                        
                           〈
                           0
                           ,
                           0
                           ,
                           …
                           ,
                           0
                           ,
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           ,
                           0
                           ,
                           …
                           ,
                           0
                           〉
                        
                      where the 
                        
                           
                              
                                 c
                              
                              
                                 p
                              
                           
                        
                     -th element of 
                        
                           
                              
                                 C
                              
                              
                                 ̂
                              
                           
                        
                      is 
                        
                           1
                           /
                           2
                        
                      and the rest are zero. For example, suppose that the target feature contains four values. For the original data (
                        
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 4
                              
                           
                           ,
                           3
                        
                     ), it is transformed into (
                        
                           
                              
                                 a
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 a
                              
                              
                                 4
                              
                           
                           ,
                           0
                           ,
                           0
                           ,
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           ,
                           0
                        
                     ). Notice that the last column (target value) of the original data now becomes four columns in its transformed format. The reason why we put 
                        
                           1
                           /
                           2
                        
                      instead of 1 in transformed format is that, since we transformed the original problem into multiple binary class problem, the error occurs twice along the class values. Therefore, in the transformed data, both the target value and the predicted value becomes 
                        
                           1
                           /
                           2
                        
                      instead of 1. Fig. 1
                      shows an example of transforming multi-class dataset into multiple binary class dataset.

Suppose 
                        
                           
                              
                                 t
                              
                              
                                 kl
                              
                           
                        
                      and 
                        
                           
                              
                                 o
                              
                              
                                 kl
                              
                           
                        
                      represent the correct target value and predicted target value of l-th class value in k-th instance, respectively. Since the error is now the summation of errors across all class values, the original error function, (Eq. (4)), now becomes the following in the transformed model.
                        
                           (5)
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       L
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          kl
                                       
                                    
                                    -
                                    
                                       
                                          o
                                       
                                       
                                          kl
                                       
                                    
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        
                     where L means the number of class values.

In this newly transformed problem, the value of 
                        
                           
                              
                                 o
                              
                              
                                 kl
                              
                           
                        
                      is now defined as
                        
                           (6)
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                l
                                                =
                                                
                                                   
                                                      argmax
                                                   
                                                   
                                                      l
                                                   
                                                
                                                P
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         ∏
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                P
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 c
                              
                              
                                 kl
                              
                           
                        
                      represents the l-th class value of k-th learning record. Notice that 
                        
                           
                              
                                 o
                              
                              
                                 kl
                              
                           
                        
                      produces 1/2 for the highest prediction value, instead of 1.

As logarithm is strictly monotonically increasing, applying it to both terms of Eq. (6) does not change the classification.
                        
                           (7)
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                if
                                                
                                                l
                                                =
                                                
                                                   
                                                      argmax
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ln
                                                P
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               ij
                                                            
                                                         
                                                         ∈
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                ln
                                                P
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                |
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

If we let
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                kl
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   ln
                                                   P
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         kl
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ln
                                                   (
                                                   P
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         kl
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                          
                                          
                                          and
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                k
                                                ∗
                                             
                                          
                                          =
                                          max
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         kl
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     respectively, then, Eq. (7) can be rewritten as
                        
                           (9)
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                /
                                                2
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                =
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      k
                                                      ∗
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                <
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      k
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The goal of the problem is to find an optimal set of weights for feature values which minimizes the error function. The set of value weights which minimizes the error function in Eq. (5) is considered to be a solution of the learning problem. Since we use an optimization method, we need the derivative form of the error function at each iteration step. However, the above 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                           
                         is not differential and nor is the error function.

We will use an approximate function for the value 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                           
                        , which (1) is continuous, (2) is differentiable, and (3) satisfies the following property
                           
                              
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       |
                                       a
                                       |
                                    
                                 
                                 →
                                 
                                    
                                       
                                          0
                                          ,
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              |
                              a
                              |
                           
                         means the total number of feature values in data.

One of the candidate function is the sigmoid function, and, given a value of x, the output function 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                              (
                              x
                              )
                           
                         can be approximated by the expression
                           
                              (10)
                              
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             e
                                          
                                          
                                             -
                                             rx
                                          
                                       
                                    
                                 
                              
                           
                        The constant r can be selected arbitrarily and the shape of the sigmoid changes according to the value of c. Higher values of c bring the shape of the sigmoid closer to that of the step function. In order to simplify the expressions, we set 
                           
                              r
                              =
                              1
                           
                         in this paper. According to our experiments, the values of r do not make major difference in classification performance.

Let the values of 
                           
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    k
                                    ∗
                                 
                              
                              )
                           
                         and 
                           
                              P
                              (
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    k
                                    ∗
                                 
                              
                              )
                           
                         be defined as the values of 
                           
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    kl
                                 
                              
                           
                        ) and 
                           
                              P
                              (
                              
                                 
                                    a
                                 
                                 
                                    ij
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    kl
                                 
                              
                              )
                           
                         in 
                           
                              
                                 
                                    A
                                 
                                 
                                    k
                                    ∗
                                 
                              
                           
                        , respectively. If we let 
                           
                              x
                              =
                              
                                 
                                    A
                                 
                                 
                                    kl
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    k
                                    ∗
                                 
                              
                           
                         in Eq. (10), the value of x is always non-positive. Therefore, 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                           
                         function is defined only on the value of 
                           
                              x
                              ⩽
                              0
                           
                        . The approximation function for 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                           
                         is now defined as follows
                           
                              (11)
                              
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             1
                                             +
                                             exp
                                             (
                                             -
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   kl
                                                
                                             
                                             -
                                             
                                                
                                                   A
                                                
                                                
                                                   k
                                                   ∗
                                                
                                             
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             1
                                             +
                                             exp
                                             
                                                
                                                   
                                                      ln
                                                      
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  k
                                                                  ∗
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  kl
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               
                                                                  
                                                                     a
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                               ∈
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      ln
                                                      
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  k
                                                                  ∗
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  kl
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                              
                           
                        It is clear that this function is differentiable, continuous, and it ranges between 0 and 
                           
                              1
                              /
                              2
                           
                        . It also increases monotonically as the value of 
                           
                              x
                              =
                              
                                 
                                    A
                                 
                                 
                                    kl
                                 
                              
                              -
                              
                                 
                                    A
                                 
                                 
                                    k
                                    ∗
                                 
                              
                           
                         increases. Fig. 2
                         shows the characteristics of 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                           
                         function. As the input ranges from negative infinity to 0, we can see that the function value increases from 0 to 1/2 as the input increases.

Suppose W represents the vector of 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                           
                         value. Our goal now is to find the optimal values of W which minimize the following error function.
                           
                              (12)
                              
                                 
                                    
                                       argmin
                                    
                                    
                                       W
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             kl
                                          
                                       
                                       -
                                       
                                          
                                             o
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                           
                         is the approximation function given in Eq. (11).

Since the value weighting method is a more fine-grained method, the value weighting method increases the number of parameters in naive Bayes model. For the case of binary classification in naive Bayes with m features, the number of parameters to estimate in normal naive Bayes is 
                           
                              2
                              m
                              +
                              1
                           
                        . When we use feature weighting methods in naive Bayes, there are additional m parameters for feature weights. Therefore, the number of parameters in feature weighted naive Bayes is 
                           
                              2
                              m
                              +
                              1
                              +
                              m
                              =
                              3
                              m
                              +
                              1
                           
                        . In value weighting method, assuming each feature has the same number of values r, the number of parameters in value weighted naive Bayes becomes 
                           
                              2
                              m
                              +
                              1
                              +
                              m
                              ·
                              r
                              =
                              (
                              2
                              +
                              r
                              )
                              m
                              +
                              1
                           
                        .

Larger number of parameters usually means that the model has more expressive power in classification learning. At the same time, the model may be more adaptable to the characteristics of training data. If the training data contains a certain degree of noise in it, there is possibility that the value weighting method is more sensitive to the noise of training data. Overfitting problem can happen especially when the data has high dimensions and training data is sparse.

To solve this problem, we modify the error function by adding a penalty term which penalizes large values of W. One approach is to use 
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                           
                         regularization term such as 
                           
                              λ
                              ‖
                              W
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                           
                        . The 
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                           
                         regularization term adds a penalty proportional to the magnitude of W, where 
                           
                              λ
                           
                         is a constant that decides the strength of this penalty term. However, the 
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                           
                         regularization usually makes many of 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                           
                         values to be zero, which is not exact intent of this paper. In this paper, we use 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         regularization, and therefore add 
                           
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ‖
                              W
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                           
                         penalty term in the error function. The final form of our objective function with regularization is now given as
                           
                              (13)
                              
                                 
                                    
                                       argmin
                                    
                                    
                                       W
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             kl
                                          
                                       
                                       -
                                       
                                          
                                             o
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 W
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        There is no closed form answer for this problem. Instead, we use gradient approach for this problem. Since above formula is a quadratic function and convex, the gradient approach is guaranteed to lead us to a global optimal solution for value weighting method.

The gradient method can properly choose the weights 
                           
                              
                                 
                                    w
                                 
                                 
                                    ij
                                 
                              
                           
                         which minimize the objective function given in Eq. (13). If we let
                           
                              
                                 E
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             kl
                                          
                                       
                                       -
                                       
                                          
                                             o
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                                 W
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        the update rule using gradient descent method is represented as
                           
                              (14)
                              
                                 W
                                 ←
                                 W
                                 -
                                 η
                                 ∇
                                 E
                              
                           
                        
                        
                           Algorithm 1
                           Value weighted NB 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: 
                                                N: total number of records, T: training data, S: test data, C: target feature,
                                          
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                : learning rate, 
                                                   
                                                      λ
                                                   
                                                 : regularization factor
                                          
                                          
                                             initialize 
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             initialize 
                                                   
                                                      η
                                                   
                                                 and 
                                                   
                                                      λ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                while
                                                
                                                
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                 changes 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                for
                                                each training data 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                do
                                             
                                          
                                          
                                             
                                                
                                                
                                                for
                                                each feature value j of each feature i
                                                
                                                do
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                for 
                                                each class value l
                                                
                                                do
                                             
                                          
                                          
                                             
                                                
                                                calculate 
                                                   
                                                      P
                                                      (
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      )
                                                   
                                                 and 
                                                   
                                                      P
                                                      (
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                end
                                                
                                                for
                                             
                                          
                                          
                                             
                                                
                                                
                                                calculate 
                                                   
                                                      P
                                                      (
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            k
                                                            ∗
                                                         
                                                      
                                                      )
                                                   
                                                 and 
                                                   
                                                      P
                                                      (
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            k
                                                            ∗
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                for
                                                each class value l
                                                
                                                do
                                             
                                          
                                          
                                             
                                                
                                                
                                                calculate 
                                                   
                                                      
                                                         
                                                            o
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                   
                                                 = 
                                                   
                                                      1
                                                      +
                                                      exp
                                                      
                                                         
                                                            
                                                               
                                                                  ln
                                                                  
                                                                     
                                                                        P
                                                                        (
                                                                        
                                                                           
                                                                              c
                                                                           
                                                                           
                                                                              k
                                                                              ∗
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        P
                                                                        (
                                                                        
                                                                           
                                                                              c
                                                                           
                                                                           
                                                                              kl
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              ij
                                                                           
                                                                        
                                                                        ∈
                                                                        
                                                                           
                                                                              D
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                                  ln
                                                                  
                                                                     
                                                                        P
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              ij
                                                                           
                                                                        
                                                                        |
                                                                        
                                                                           
                                                                              c
                                                                           
                                                                           
                                                                              k
                                                                              ∗
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                     
                                                                        P
                                                                        (
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              ij
                                                                           
                                                                        
                                                                        |
                                                                        
                                                                           
                                                                              c
                                                                           
                                                                           
                                                                              kl
                                                                           
                                                                        
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                
                                                end
                                                
                                                for
                                             
                                          
                                          
                                             
                                                
                                                
                                                update 
                                                   
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      (
                                                      1
                                                      -
                                                      η
                                                      λ
                                                      )
                                                      -
                                                      η
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            o
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            o
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      (
                                                      1
                                                      -
                                                      
                                                         
                                                            o
                                                         
                                                         
                                                            kl
                                                         
                                                      
                                                      )
                                                      ln
                                                      
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  kl
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            P
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  k
                                                                  ∗
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                end for
                                             
                                          
                                          
                                             
                                                
                                                
                                                end for
                                             
                                          
                                          
                                             
                                                
                                                update 
                                                   
                                                      
                                                         
                                                            η
                                                         
                                                         
                                                            new
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  old
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            +
                                                            t
                                                            /
                                                            N
                                                         
                                                      
                                                   
                                                 /* t: number of iteration */
                                          
                                          
                                             
                                                end while
                                             
                                          
                                          
                                             
                                                for
                                                each test data 
                                                   
                                                      d
                                                      ∈
                                                   
                                                 S
                                                do
                                             
                                          
                                          
                                             
                                                class value of 
                                                   
                                                      d
                                                      =
                                                      
                                                         
                                                            argmax
                                                         
                                                         
                                                            c
                                                            ∈
                                                            C
                                                         
                                                      
                                                      P
                                                      (
                                                      c
                                                      )
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                            ∈
                                                            d
                                                         
                                                      
                                                      P
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                            |
                                                            c
                                                            )
                                                         
                                                         
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                end for
                                             
                                          
                                       
                                    
                                 
                              
                           

In this formula, 
                           
                              η
                           
                         is a learning rate which decides the step size in gradient descent search, respectively.

From Eq. (13), we can get
                           
                              (15)
                              
                                 ∇
                                 E
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                       
                                    
                                 
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 -
                                 
                                    
                                       t
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 ∇
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ∇
                                 ‖
                                 W
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where
                           
                              (16)
                              
                                 ∇
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      kl
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      11
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      kl
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                      |
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      kl
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      21
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      kl
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                      |
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      kl
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      M
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ∂
                                                
                                                   
                                                      o
                                                   
                                                   
                                                      kl
                                                   
                                                
                                             
                                             
                                                ∂
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      M
                                                      |
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        If we let
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ln
                                          
                                             
                                                P
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      k
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                                P
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                ij
                                             
                                          
                                          ln
                                          
                                             
                                                P
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                |
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      k
                                                      ∗
                                                   
                                                
                                                )
                                             
                                             
                                                P
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                |
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        then, from Eq. (11), 
                           
                              
                                 
                                    o
                                 
                                 
                                    kl
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    1
                                    +
                                    exp
                                    (
                                    
                                       
                                          r
                                       
                                       
                                          ij
                                       
                                    
                                    )
                                 
                              
                           
                        . Therefore,
                           
                              
                                 
                                    
                                       ∂
                                       
                                          
                                             o
                                          
                                          
                                             kl
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             w
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       
                                          
                                             o
                                          
                                          
                                             kl
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             r
                                          
                                          
                                             ij
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             w
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 ln
                                 
                                    
                                       
                                          
                                             
                                                P
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                |
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      kl
                                                   
                                                
                                                )
                                             
                                             
                                                P
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                |
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      k
                                                      ∗
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Since
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ∇
                                 ‖
                                 W
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∂
                                       ‖
                                       W
                                       
                                          
                                             ‖
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             w
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 =
                                 λ
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                              
                           
                        by combining Eq. (14) and (15), the final weight update formula is given as
                           
                              (17)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 ←
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 η
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                       
                                    
                                 
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 -
                                 
                                    
                                       t
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 
                                    
                                       ∂
                                       
                                          
                                             o
                                          
                                          
                                             kl
                                          
                                       
                                    
                                    
                                       ∂
                                       
                                          
                                             w
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 -
                                 η
                                 λ
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 ←
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 1
                                 -
                                 η
                                 λ
                                 )
                                 -
                                 η
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                       
                                    
                                 
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 -
                                 
                                    
                                       t
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       o
                                    
                                    
                                       kl
                                    
                                 
                                 )
                                 ln
                                 
                                    
                                       P
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             ij
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             kl
                                          
                                       
                                       )
                                    
                                    
                                       P
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             ij
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             k
                                             ∗
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        The scheduling of learning rates often has a major impact on the convergence speed in gradient descent training. Instead of using constant value for learning rate 
                           
                              η
                           
                        , we use a more typical choice of learning rate proposed in [4] as follows:
                           
                              
                                 
                                    
                                       η
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       t
                                       /
                                       N
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    η
                                 
                                 
                                    t
                                 
                              
                           
                         is the learning rate at t-th iteration. Algorithm 1 shows the pseudo code of the value weighted naive Bayes algorithm.

In this section, we provide empirical results on several benchmark datasets and compare the value weighted naive Bayes (VWNB) algorithm against other state-of-the-art supervised algorithms.

The proposed value weighted algorithm is implemented using Matlab software. We selected 19 datasets from the UCI repository [7]. When a dataset contains numeric features, the total number of feature values of the dataset mainly depends on the number of intervals we discretize with. Since each feature value is assigned a different weight, the continuous features in datasets were discretized using [6].

We used 10-fold cross validation method and the initial weights of feature values are randomly chosen around 1, and regularization factor (
                        
                           λ
                        
                     ) is given as 2.

Firstly, since the NB-related algorithm is the gold standard algorithm for the work, we compared the performance of VWNB with that of naive Bayes (NB), decision tree weighted NB(DTNB) [11] and feature weighted NB(FWNB) [16], respectively. We used Wilcoxon rank-sum test to make pairwise significance test because (1) the experimental results are not necessarily normal distribution, and (2) the data set folds are not completely independent of each other. We use 10-fold cross-validation for our experiments, the data sets are not perfectly independent of each other, which degrades the accuracy of t-test. We use two-tail test and the alpha value of the test is assumed to be 0.05. The critical value of Wilcoxon test for this alpha value is 8. 
                        
                           †
                        
                      symbol means the accuracy of the algorithm is significantly better than that of VWNB, and 
                        
                           ∗
                        
                      means the accuracy is significantly worse than that of VWNB.


                     Fig. 3
                      shows the results of these experiments. Compared with NB, we can see from Fig. 3 that VWNB is significantly better than NB on 14 data sets and significantly worse on only two. In three datasets, there was no significant difference between two algorithms. When compared with DTNB, VWNB is significantly better on 16 data sets and no significant difference in 3. DTNB is insignificantly better than VWNB on 3 cases. We ran DTNB with no regularization since DTNB in Weka does not have regularization parameters. Compared with FWNB, VWNB is significantly better on 11 data sets and no significant difference in 6. FWNB is significantly better than VWNB in 2 cases.

As we can see in Fig. 3, VWNB shows an excellent performance compared to these NB and feature weighted NB algorithms. These results demonstrate that the value weighting method can significantly improve the classification learning of naive Bayes. Both DTNB and FWNB assign weights to features while, in VWNB, weights are assigned on the basis of feature values. Therefore, the main reason behind these improvements in performance is due to assigning different weights to feature values.

Secondly, VWNB is also compared with three other state-of-the-art classification methods including Support Vector Machine(SMO) [18], CART [1], and Random Forests(RF) [2]. We used Weka software [12] to run these programs. To make the experiments fair, every algorithm used these prediscretized data sets. We selected Polynomial for the kernel of SOM, and the number of trees in RF is given as 100 since these parameters gave the best performance in SOM and RF, respectively. From Fig. 3, we can see that VWNB is significantly better than SVM(SMO) on 8 datasets and significantly worse on 7 cases. VWNB significantly outperforms CART as it shows significantly better performance on 12 datasets and worse performance on 5 cases. Compared to RF, VWNB is significantly better than RF on 11 cases and significantly worse on 6 cases. Fig. 3 demonstrates that the performance of VWNB is very promising and competitive. VWNB showed significantly better performance than RF and is very competitive with SOM.


                     Fig. 4
                      shows the weights of each feature value in solar flare data. It clearly shows that values of a certain feature have different weights as a result of value weighted learning. For example, the feature largest spot size in solar flare data contains 6 values, and the weights of these feature values range from 0.55 to 1.55, as shown in Fig. 4(a). For the binary feature of Activity, feature values show larger differences in their weights, described in Fig. 4(d).

Even though the proposed value weighting method uses iterative approach, it converges fast to the optimal weights. As shown in Fig. 4, most of value weights converge to optimal values within the iteration of 20. In light of these, we can see that the proposed value weighting method is a very effective learning method and can learn the optimal weight values fast.

We also tested the performance of VWNB by changing 
                        
                           λ
                        
                      values. Fig. 5
                      shows the results of accuracies with different 
                        
                           λ
                        
                      values. It is not easy to decide the optimal values of 
                        
                           λ
                        
                      since the optimal value of 
                        
                           λ
                        
                      varies depending on datasets. In our implementation, for the sake of simplicity, we choose to set the value 
                        
                           λ
                        
                      to 2 for our experiments.

We carried out another set of experiments using a dataset with a larger feature set. The dataset we used for second experiment is isolet dataset, which is also obtained from the UCI repository. The isolet data contains 617 features, and, after discretization, it contains 2797 feature values. The weight space of this data is significantly larger than that of other datasets tested in previous experiments.

The main purpose of using isolet dataset is to test the scalability of VWNB method. We used 5-fold cross validation, and compared the running time of VWNB with that of SMO, Neural Network, LibSVM, and naive Bayes. Fig. 6
                      shows the results of these tests. As we can see in Fig. 6, VWNB could learn relatively fast. It finished third in learning time, faster than SMO and Neural Network. The accuracies of these algorithms against isolet dataset are shown in Fig. 7
                      for reference. In Fig. 7, VWNB again shows excellent performance among others and its performance quite competitive with that of SVM.

In light of these experimental results, we see that the value weighting method could significantly improve the performance of naive Bayes in most cases. It shows excellent performance and its performance is quite compatible with other state-of-the-art methods such as SVM and RF.

In this paper, a new paradigm of weighting method, called value weighting method, is proposed. Unlike the current feature weighting methods, we propose a more fine-grained weighting methods, and assign a weight to each feature value.

The proposed weighting method is implemented and tested in the context of naive Bayes. The experimental results show that the value weighting method is successful and shows better performance in most cases than its counterpart algorithms. As a result, this work suggests that we could improve the performance of weighted naive Bayesian learning even further by using value weighting approach.

As future work, we will combine the value weighting method with other classification algorithms, and study whether the value weighting method could improve the classification performance regardless of algorithms. For example, multinomial naive Bayes learning can be also optimized by using value weighting method.

These days, the size of data increases dramatically in many applications. Therefore, the proposed method will be applied to a number of new domains with massive datasets. For example, social network analysis is an important application where many Bayes-related algorithms have been studied [8,17]. We will apply our new method to some domains with massive data (e.g. social network or bioinformatics), and its performance will be compared that of other well-known algorithms. By doing so, we will be able to demonstrate the true effectiveness of using value weighting method in naive Bayes.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the National Research Foundation of Korea grant funded by the Korea government (MSIP) (No. 2014R1A2A1A11051011)


                     
                        Proof of Lemma 1
                        sketch


                        Applying logarithm to the definition of feature weighted naive Bayes, we get
                              
                                 (18)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ̂
                                       
                                    
                                    =
                                    
                                       
                                          argmax
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             log
                                             p
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             y
                                             )
                                             +
                                             log
                                             p
                                             (
                                             y
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Therefore,
                              
                                 (19)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ̂
                                       
                                    
                                    =
                                    sign
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      log
                                                      p
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      |
                                                      y
                                                      =
                                                      1
                                                      )
                                                      +
                                                      log
                                                      p
                                                      (
                                                      y
                                                      =
                                                      1
                                                      )
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            w
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      log
                                                      p
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      |
                                                      y
                                                      =
                                                      -
                                                      1
                                                      )
                                                      +
                                                      log
                                                      p
                                                      (
                                                      y
                                                      =
                                                      -
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    sign
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             log
                                             
                                                
                                                   p
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   y
                                                   =
                                                   1
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   y
                                                   =
                                                   -
                                                   1
                                                   )
                                                
                                             
                                             +
                                             log
                                             
                                                
                                                   p
                                                   (
                                                   y
                                                   =
                                                   1
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   y
                                                   =
                                                   -
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We can represent
                              
                                 (20)
                                 
                                    log
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          y
                                          =
                                          1
                                          )
                                       
                                       
                                          p
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          y
                                          =
                                          -
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        

From Eqs. (19) and (20),
                              
                                 (21)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ̂
                                       
                                    
                                    =
                                    sign
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             +
                                             log
                                             
                                                
                                                   p
                                                   (
                                                   y
                                                   =
                                                   1
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   y
                                                   =
                                                   -
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

@&#REFERENCES@&#

