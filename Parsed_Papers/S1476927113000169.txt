@&#MAIN-TITLE@&#Using volcano plots and regularized-chi statistics in genetic association studies

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We use volcano plot to simultaneously display odds-ratio and chi-square statistics.


                        
                        
                           
                           We introduce a new measure of genetic association, the regularized-chi.


                        
                        
                           
                           Rare variants tend to be ranked higher by the regularized-chi statistic than by chi-square test p-values.


                        
                        
                           
                           Regularized-chi could aid prioritization of candidate genes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Volcano plot

Regularized-chi

Genetic association analysis

Rare variants

SNPs

Type-2 diabetes

@&#ABSTRACT@&#


               
               
                  Labor intensive experiments are typically required to identify the causal disease variants from a list of disease associated variants in the genome. For designing such experiments, candidate variants are ranked by their strength of genetic association with the disease. However, the two commonly used measures of genetic association, the odds-ratio (OR) and p-value may rank variants in different order. To integrate these two measures into a single analysis, here we transfer the volcano plot methodology from gene expression analysis to genetic association studies. In its original setting, volcano plots are scatter plots of fold-change and t-test statistic (or −log of the p-value), with the latter being more sensitive to sample size. In genetic association studies, the OR and Pearson's chi-square statistic (or equivalently its square root, chi; or the standardized log(OR)) can be analogously used in a volcano plot, allowing for their visual inspection. Moreover, the geometric interpretation of these plots leads to an intuitive method for filtering results by a combination of both OR and chi-square statistic, which we term “regularized-chi”. This method selects associated markers by a smooth curve in the volcano plot instead of the right-angled lines which corresponds to independent cutoffs for OR and chi-square statistic. The regularized-chi incorporates relatively more signals from variants with lower minor-allele-frequencies than chi-square test statistic. As rare variants tend to have stronger functional effects, regularized-chi is better suited to the task of prioritization of candidate genes.
               
            

@&#INTRODUCTION@&#

Volcano plots are graphical tools that are commonly used in the analysis of mRNA expression levels as obtained from microarray technology (Jin et al., 2001; Cui and Churchill, 2003; Li, 2012). In principle, volcano plots are scatter plots, with each point representing a probe set or a gene, and the x-coordinate being the (log) fold-change (FC) and y being the t-statistic or −log
                     10 of the p-value from a t-test. The reason for the popularity of volcano plot in microarray data analysis is due to its simultaneous display of two, albeit correlated, pieces of information – fold-change and t-statistic. Ranking genes by fold-change and by t-test does not necessarily lead to the same order in the differential expressed gene list, and can give rise to different biological conclusions.

However, there is a fundamental relationship between log-fold-change and t-statistic: while log(FC) is a measure of the magnitude of a “signal”, the t-statistic is approximately log(FC) divided by its standard error, i.e., a signal-to-noise ratio (Zhang and Cao, 2009; Li, 2012). This means that the log(FC) is an unstandardized measure of differential expression, whereas t-statistic is a noise-level-adjusted standardized measure. The distinction between the two types of measures of differential expression has parallels to the long standing discussions in behavioral science, psychology, epidemiology, meta-analysis, and engineering under the theme of “effect size” (Cohen, 1988). As one possible strategy to address this issue, volcano plots display both measures simultaneously.

In genetic association study, there has been a similar issue on deciding which measure of association is more useful: odds-ratio (OR) or χ
                     2 test (either the chi-square test statistic or the p-value from χ
                     2 test) (Li, 2008). Currently, most association analyses apply a χ
                     2 test as the primary single-nucleotide-polymorphism (SNP) selection criterion in the initial screening, and use the OR as a secondary measure in a re-examination. However, the distinction between the role of two measures and their connection has not always been explained. Because selecting candidate SNPs and regions from the first stage for the replication stage is of great practical importance, one would like to add more information in the screening stage. We believe the application of volcano plots can be beneficial towards this goal.

One particular advantage of volcano plot in microarray analysis is that it provides a natural context in addressing “joint gene filtering” (Zhang and Cao, 2009; Li, 2012), which are the measures of differential expressions using both log-FC and t-statistic. In comparison, the ad hoc selection criterion such as “FC >1.5, and p-value <10−3” could be called “double gene filtering” (Zhang and Cao, 2009; Li, 2012).

In a volcano plot, the discriminant lines for double filtering are right-angled lines formed by the vertical and the horizontal lines, whereas those in joint filtering are smooth curves. The well known significance analysis of microarray (SAM) (Tusher et al., 2001; Chu et al., 2007) has a discriminant line in the form of y
                     =
                     c
                     0
                     +
                     c
                     1/tan(θ), where θ is the angle between the y-axis and the line connecting the gene point and the plot origin (Li, 2012).

Our goal in transferring volcano plots from expression analysis to genetic association analyses is to find SNP-filtering criteria that incorporate information from both OR and χ
                     2 test results. This effort may help the prioritization of SNPs and chromosome regions in a genome-wide association study (Cantor et al., 2010). Prioritization of candidate genes has wide application in every “omics” field (Tranchevent et al., 2011; Moreau and Tranchevent, 2012). Usually, the prioritization strategies rely on external information of gene products, such as protein–protein interaction (Pattin and Moore, 2009) and pathways (Chen et al., 2009; Wang et al., 2010; Peng et al., 2010). In contrast, our approach is purely statistical, with the underlying assumption that OR may provide more biological information than χ
                     2-test p-value in a realistic setting (finite sample size and sample heterogeneity).

The questions that are discussed in this paper are as follows: (i) How does the minor allele frequency of markers appear in a volcano plot?, (ii) How can one choose the penalty term in a regularized-chi statistic for genetic data, and is the choice of this term important?, (iii) Do any other unstandardized and standardized measurements exist that may be used for x- and y-axes in the volcano plot, besides OR and χ
                     2 test statistic?

Denote the 2×2 allele count contingency table as {n
                        
                           ij
                        } (i, j
                        =1,2) where row i is the case (i
                        =1) or control (i
                        =2) label, and column j is the minor (j
                        =1) or major (j
                        =2) allele label. The minor-allele-frequency (MAF) in the case (control) group is p
                        1
                        =
                        n
                        11/(n
                        11
                        +
                        n
                        12)=
                        n
                        11/n
                        1* (p
                        2
                        =
                        n
                        21/n
                        2*). The major-allele-frequencies are q
                        1
                        =1−
                        p
                        1 (q
                        2
                        =1−
                        p
                        2) for the case (control) group.

One can define several “differential allele frequency” measures that are insensitive to the sample size, for instance, the odds-ratio (OR) which is defined as n
                        11
                        n
                        22/(n
                        12
                        n
                        21) or p
                        1
                        q
                        2/(p
                        2
                        q
                        1). It is well known that the log-transformed OR, log(OR)=log(n
                        11
                        n
                        22)−log(n
                        12
                        n
                        21), approximately follows a normal distribution (Woolf, 1955). Another unstandardized measure is the direct calculation of allele frequency difference between the case and control group: d
                        
                           MAF
                        
                        =
                        p
                        1
                        −
                        p
                        2
                        =
                        n
                        11/n
                        1*
                        −
                        n
                        21/n
                        2*
                        =(n
                        11
                        n
                        22
                        −
                        n
                        12
                        n
                        21)/(n
                        1*
                        n
                        2*). Furthermore, Wright's fixation index, 
                           
                              F
                              st
                           
                           =
                           1
                           −
                           (
                           
                              p
                              1
                           
                           
                              q
                              1
                           
                           +
                           
                              p
                              2
                           
                           
                              q
                              2
                           
                           )
                           /
                           (
                           2
                           
                              
                                 p
                                 ¯
                              
                           
                           ·
                           
                              
                                 q
                                 ¯
                              
                           
                           )
                           =
                           1
                           −
                           0.5
                           
                              n
                              2
                           
                           (
                           
                              n
                              11
                           
                           
                              n
                              12
                           
                           /
                           
                              n
                              
                                 1
                                 *
                              
                           
                           +
                           
                              n
                              21
                           
                           
                              n
                              22
                           
                           /
                           
                              n
                              
                                 2
                                 *
                              
                           
                           )
                           /
                           (
                           
                              n
                              
                                 *
                                 1
                              
                           
                           
                              n
                              
                                 *
                                 2
                              
                           
                           )
                         (
                           
                              
                                 p
                                 ¯
                              
                           
                           =
                           (
                           
                              p
                              1
                           
                           +
                           
                              p
                              2
                           
                           )
                           /
                           2
                           ,
                           
                              
                                 q
                                 ¯
                              
                           
                           =
                           (
                           
                              q
                              1
                           
                           +
                           
                              q
                              2
                           
                           )
                           /
                           2
                           =
                           1
                           −
                           
                              
                                 p
                                 ¯
                              
                           
                        ) provides an unstandardized measure of differential allele frequency (Wright, 1951). F
                        
                           st
                         is a measure of allele frequency difference between two subpopulations that is used in population genetics and estimates the proportion of variations explained by population stratification. Here we assume for simplicity the two subpopulations are case and control population, with a 50:50 mixing ratio.

As a standardized and sample-size sensitive measure of differential allele frequency, the χ
                        2 statistic (n
                        =
                        n
                        **
                        =∑
                           ij
                        
                        n
                        
                           ij
                        ) (e.g., Yates, 1984; Suh and Li, 2007)
                           
                              (1)
                              
                                 
                                    X
                                    2
                                 
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                n
                                                11
                                             
                                             
                                                n
                                                22
                                             
                                             −
                                             
                                                n
                                                12
                                             
                                             
                                                n
                                                21
                                             
                                             )
                                          
                                          2
                                       
                                       n
                                    
                                    
                                       
                                          n
                                          
                                             1
                                             *
                                          
                                       
                                       
                                          n
                                          
                                             2
                                             *
                                          
                                       
                                       
                                          n
                                          
                                             *
                                             1
                                          
                                       
                                       
                                          n
                                          
                                             *
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 n
                                 
                                    
                                       (
                                       
                                          p
                                          1
                                       
                                       −
                                       
                                          p
                                          2
                                       
                                       )
                                    
                                    2
                                 
                                 
                                    
                                       
                                          n
                                          
                                             1
                                             *
                                          
                                       
                                       
                                          n
                                          
                                             2
                                             *
                                          
                                       
                                    
                                    
                                       (
                                       
                                          p
                                          1
                                       
                                       
                                          n
                                          
                                             1
                                             *
                                          
                                       
                                       +
                                       
                                          p
                                          2
                                       
                                       
                                          n
                                          
                                             2
                                             *
                                          
                                       
                                       )
                                       (
                                       
                                          q
                                          1
                                       
                                       
                                          n
                                          
                                             1
                                             *
                                          
                                       
                                       +
                                       
                                          q
                                          2
                                       
                                       
                                          n
                                          
                                             2
                                             *
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        is clearly proportional to sample size n, in the asymptotic limit, given p
                        1
                        ≠
                        p
                        2. Alternatively, log-OR itself can be standardized by its standard error, log(OR)/SE(log(OR)), where (Woolf, 1955)
                           
                              (2)
                              
                                 SE
                                 (
                                 log
                                 (
                                 OR
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          1
                                          
                                             
                                                n
                                                11
                                             
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             
                                                n
                                                12
                                             
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             
                                                n
                                                21
                                             
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             
                                                n
                                                22
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          
                                             
                                                p
                                                1
                                             
                                             
                                                q
                                                1
                                             
                                             
                                                n
                                                
                                                   1
                                                   *
                                                
                                             
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             
                                                p
                                                2
                                             
                                             
                                                q
                                                2
                                             
                                             
                                                n
                                                
                                                   2
                                                   *
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The standardized log(OR) is of the form of a Wald statistic.

For illustration purpose, we first use a genotyping data of an autoimmune disease on one chromosome only (chromosome 6) with 809 cases and 505 controls (Freudenberg et al., 2011). The initial 38,735 SNPs are reduced to 35,855 SNPs by requiring that both the case and the control group to have at least one copy of the minor allele (which allele is the minor is defined by the control group). This removes many SNPs with minor allele frequency (MAF) less than 0.05, though many low-MAF SNPs remain. These data are used in Figs. 1, 2 and 4
                        
                        .

We use The Wellcome Trust Case Control Consortium (WTCCC) data for the type 2 diabetes (T2D), with 1924 T2D cases and 2938 controls (The Wellcome Trust Case Control Consortium, 2007; Zeggini et al., 2007). Differing from several other autoimmune diseases including rheumatoid arthritis and type 1 diabetes, there is no major susceptibility locus in MHC region for type 2 diabetes. The genotyping was carried out by the Affymetrix GeneChip 500k array. There are 459,446 autosomal SNPs which had already passed a quality control (QC) procedure by WTCCC.

We impose a further filtering criterion: (i) p-value for testing unbiased typing ratio is larger than 10−4; (ii) p-value for testing Hardy-Weinberg equilibrium in both the control and the case group is larger than 10−4; (ii) MAF in both control and case group is larger than 0.005. This reduces the number of SNPs to 388,023 (84.45% of the original number).

Our MAF criterion is more relaxed than the 0.01 used in early analysis of these data (The Wellcome Trust Case Control Consortium, 2007; Zeggini et al., 2007), which leads to the inclusion of more rare variants. Although violation of HWE in the case group might be considered as part of disease signal (Feder et al., 1996; Nielsen et al., 1998; Song and Elston, 206; Suh and Li, 2007; Li et al., 2008; Zheng et al., 2012), we noticed that in this data, it actually leads to SNPs with genotype distribution inconsistent between the case and the control group (e.g. the SNP rs3777582 on chromosome 6). This data is used in Fig. 3
                        .

@&#RESULTS@&#

To evaluate the role of the MAF of SNPs, we are using the volcano plots with x
                        =log(OR)=log(n
                        11
                        n
                        22)−log(n
                        12
                        n
                        21), and y
                        =log(OR)/SE(log(OR)). In microarray analysis, the angle θ between the y-axis and the line linking a gene dot and the origin is directly related to the standard error of the log-fold-change (Li, 2012), tan(θ)=
                        SE(log(FC)), and SE in turn is roughly the standard deviation of log-expression level divided by 
                           
                              n
                           
                        . Consequently, points closer to the y-axis are genes with low-variances. There is a parallel situation here by replacing fold-change with odds-ratio.

Using the formula in Eq. (2), we can write SE(log(OR)) as (assuming equal number of case and control samples: n
                        1*
                        =
                        n
                        2*
                        =
                        n/2):
                           
                              (3)
                              
                                 SE
                                 (
                                 log
                                 (
                                 OR
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          2
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             2
                                             +
                                             (
                                             1
                                             /
                                             
                                                p
                                                2
                                             
                                             +
                                             1
                                             /
                                             
                                                q
                                                1
                                             
                                             )
                                             
                                                d
                                                MAF
                                             
                                          
                                          
                                             
                                                p
                                                2
                                             
                                             
                                                q
                                                1
                                             
                                             (
                                             1
                                             +
                                             
                                                d
                                                MAF
                                             
                                             /
                                             
                                                p
                                                2
                                             
                                             )
                                             (
                                             1
                                             +
                                             
                                                d
                                                MAF
                                             
                                             /
                                             
                                                q
                                                1
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If MAF is approaching zero (e.g. p
                        2
                        →0), then 
                           SE
                           (
                           log
                           (
                           OR
                           )
                           )
                           ∼
                           1
                           /
                           
                              
                                 
                                    p
                                    2
                                 
                              
                           
                           →
                           ∞
                         and θ
                        →90°. These are the points close to the x-axis which can have any OR values.


                        Fig. 1 shows how the angle θ stratifies SNPs with different MAFs. The SNPs colored with red, orange, purple, blue correspond to those with control MAF <0.01, (0.01, 0.05), (0.05, 0.2), and >0.2. Note that the quality control step has already removed SNPs with very low MAFs and the control MAFs are greater than 0.00198. Also note that points with different colors may overlap, because according to Eq. (3), tan(θ) is a function of both p
                        2 (control MAF) and p
                        1 (case MAF).

Later in this section, we will establish that standardized log(OR) is approximately equal to the square-root of χ
                        2 statistic, or simply χ. By following the similar definition of regularized t-statistic, or SAM for significance of analysis of microarray (Tusher et al., 2001; Chu et al., 2007), we define the regularized χ-statistic as (through standardized log(OR)):
                           
                              (4)
                              
                                 
                                    χ
                                    reg
                                 
                                 =
                                 
                                    
                                       |
                                       log
                                       (
                                       OR
                                       )
                                       |
                                    
                                    
                                       SE
                                       (
                                       log
                                       (
                                       OR
                                       )
                                       )
                                       +
                                       
                                          s
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       log
                                       
                                          n
                                          11
                                       
                                       
                                          n
                                          22
                                       
                                       −
                                       log
                                       
                                          n
                                          12
                                       
                                       
                                          n
                                          21
                                       
                                       |
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   n
                                                   
                                                      1
                                                      *
                                                   
                                                
                                             
                                             /
                                             
                                                
                                                   n
                                                   11
                                                
                                                
                                                   n
                                                   12
                                                
                                             
                                             )
                                             +
                                             (
                                             
                                                
                                                   n
                                                   
                                                      2
                                                      *
                                                   
                                                
                                             
                                             /
                                             
                                                
                                                   n
                                                   21
                                                
                                                
                                                   n
                                                   22
                                                
                                             
                                             )
                                          
                                       
                                       +
                                       
                                          s
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       log
                                       
                                          p
                                          1
                                       
                                       
                                          q
                                          2
                                       
                                       −
                                       log
                                       
                                          p
                                          2
                                       
                                       
                                          q
                                          1
                                       
                                       |
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             /
                                             
                                                
                                                   p
                                                   1
                                                
                                                
                                                   q
                                                   1
                                                
                                                
                                                   n
                                                   
                                                      1
                                                      *
                                                   
                                                
                                             
                                             )
                                             +
                                             (
                                             1
                                             /
                                             
                                                
                                                   p
                                                   2
                                                
                                                
                                                   q
                                                   2
                                                
                                                
                                                   n
                                                   
                                                      2
                                                      *
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       +
                                       
                                          s
                                          0
                                       
                                    
                                 
                              
                           
                        
                     

If we use i to index SNPs, χ
                        
                           reg,i
                         contains SNP-specific allele frequencies (p
                        1, p
                        2)
                           i
                        , but s
                        0 is the same for all SNPs. The introduction of the constant s
                        0 makes the χ-statistic more robust – less sensitive to chance fluctuation of SNP-specific standard error estimation.

Though not further used in this paper, we note that there are other ways to define a regularized test statistic. For example, we may use the definition of χ
                        2-statistic and add an extra constant in the denominator (this is parallel to a proposed regularized t-test in microarray analysis, Baldi and Long, 2001):
                           
                              (5)
                              
                                 
                                    χ
                                    reg
                                    2
                                 
                                 =
                                 
                                    
                                       
                                          
                                             (
                                             
                                                p
                                                1
                                             
                                             −
                                             
                                                p
                                                2
                                             
                                             )
                                          
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          (
                                          
                                             p
                                             1
                                          
                                          
                                             n
                                             
                                                1
                                                *
                                             
                                          
                                          +
                                          
                                             p
                                             2
                                          
                                          
                                             n
                                             
                                                2
                                                *
                                             
                                          
                                          )
                                          (
                                          
                                             q
                                             1
                                          
                                          
                                             n
                                             
                                                1
                                                *
                                             
                                          
                                          +
                                          
                                             q
                                             2
                                          
                                          
                                             n
                                             
                                                2
                                                *
                                             
                                          
                                          )
                                       
                                       )
                                       /
                                       (
                                       
                                          
                                             nn
                                             
                                                1
                                                *
                                             
                                          
                                          
                                             n
                                             
                                                2
                                                *
                                             
                                          
                                       
                                       )
                                       +
                                       
                                          s
                                          0
                                          2
                                       
                                    
                                 
                              
                           
                        where the first term in the denominator is approximately the variance of p
                        1
                        −
                        p
                        2; or
                           
                              (6)
                              
                                 
                                    χ
                                    reg
                                    ′
                                 
                                 =
                                 
                                    
                                       |
                                       
                                          p
                                          1
                                       
                                       −
                                       
                                          p
                                          2
                                       
                                       |
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                   1
                                                
                                                
                                                   n
                                                   
                                                      1
                                                      *
                                                   
                                                
                                                +
                                                
                                                   p
                                                   2
                                                
                                                
                                                   n
                                                   
                                                      2
                                                      *
                                                   
                                                
                                                )
                                                (
                                                
                                                   q
                                                   1
                                                
                                                
                                                   n
                                                   
                                                      1
                                                      *
                                                   
                                                
                                                +
                                                
                                                   q
                                                   2
                                                
                                                
                                                   n
                                                   
                                                      2
                                                      *
                                                   
                                                
                                                )
                                             
                                             )
                                             /
                                             (
                                             
                                                
                                                   nn
                                                   
                                                      1
                                                      *
                                                   
                                                
                                                
                                                   n
                                                   
                                                      2
                                                      *
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       +
                                       
                                          s
                                          0
                                       
                                    
                                 
                              
                           
                        where the first term in the denominator is approximately the SE of p
                        1
                        −
                        p
                        2.

If we select SNPs by the criterion χ
                        
                           reg
                        
                        ≥
                        c, it is equivalent to (Li, 2012) y
                        =|log(OR)|/SE
                        =[|log(OR)|/(SE
                        +
                        s
                        0)]·[(SE
                        +
                        s
                        0)/SE]≥
                        c(1+
                        s
                        0/log(θ)). In other words, instead of the horizontal line, the discriminant line is a smooth curve which moves up as it is closer to the y-axis (Fig. 1). The regularized-χ combines information from both χ
                        2 test and OR.

The regularization constant s
                        0 in SAM for expression analysis is chosen to minimize the dependence of relative variation of the SAM statistic on the standard error (Tusher et al., 2001; Chu et al., 2007; Åstrand, 2008). The more detailed procedure in choosing s
                        0 in SAM is the following: genes are grouped into 100 bins by their percentile of standard errors; within each bin, the variability of the SAM statistic is measured by the median absolute deviation (MAD); the dependency of relative variation of MAD on bin is calculated by sd(MAD)/mean(MAD); the constant s
                        0 is chosen to minimize sd(MAD)/mean(MAD).

In Fig. 2(A), we examine the MAD of 100 bins of SE values at different s
                        0's: 10%, 90%, 95%, and 100% percentiles of SE. There are several observations: first, the non-robust behavior mainly occurs at bins with large SE's. Second, in terms of absolute variation, the choice of s
                        0
                        =max(SE) seems to lead to lowest variation. Third, even if the lowest absolute variation occurs at s
                        0
                        =max(SE), because the averaged MAD level is low, it is unclear whether the relative variation is also low.


                        Fig. 2(B) and (C) shows indeed that the absolute variation of MAD decreases with s
                        0, but relative variation increases, for both the parametric and non-parametric version of the measure of variation (sd, MAD
                           bin
                         for absolute variation, sd/mean, MAD
                           bin
                        /median for relative variation). If the relative variation is considered, as in the original discussion of SAM, then the s
                        0
                        =min(SE) would be chosen.

Here, we consider an alternative measure of the robustness by combining both absolute and relative variation of MAD's. For all s
                        0 values, we rank absolute (and relative) variation from low to high; then we add these two ranks; the s
                        0 with the lowest total rank is the value we use to regularize χ. From Fig. 2(D), either the min(SE) or 3% or 4%-percentile of SE depending on whether the parametric or non-parametric measure is used. For non-parametric measure, one can see that the averaged rank is quite stable for all s
                        0 values.

The consequence of s
                        0 is illustrated in Fig. 1. Four discriminant lines are shown for χ
                        =|log(OR)|/(SE
                        +
                        s
                        0)=
                        χ
                        0. The SNP filtering criterion is χ
                        ≥
                        χ
                        0. All four lines plus the horizontal line (or s
                        0
                        =0) selects top 70 SNPs (the corresponding p-value for the unregularized χ
                        2 test is 10−4). This can be accomplished by tuning χ
                        0 as the same time when various s
                        0 values are chosen. It can be seen that with a small s
                        0 value (0% or 4% percentile), there is already a great change in the shape of discriminant line (from straight line to curve), and many SNPs with less significant χ
                        2 test result but larger ORs will be selected. The discriminant line with large s
                        0 (e.g. 100% percentile) should probably be avoided because it is too different from a unregularized χ
                        2 test.

We draw the volcano plot for 388,023 SNPs (see the Methods and Materials section) from The Wellcome Trust Case Control Consortium type 2 diabetes data in Fig. 3. The three strongest signals are from the gene TCF7L2 (chr10), KIAA1005 (chr16) and CDKAL1 (chr6), consistent with the report in Table 3 of (The Wellcome Trust Case Control Consortium, 2007). In the subsequent validation stage, TCF7L2 and KIAA1005 signal remains (Table 1 of Zeggini et al., 2007) whereas KIAA1005 is dropped from the top gene list.


                        Fig. 3 shows strikingly that the top results in such a GWAS run are biased towards common variants, as these genes are located at the inner envelope with the highest possible MAFs (smallest θ angle values). We have added two more genes further down the list:TSPAN8 (chr12) and RBMS1 (chr2). Interestingly, there are SNPs on both sides of the gene TSPAN8, and there are also both positive (OR >1) and negative (OR <1) signals. More data on TSPAN8 was reported in Zeggini et al. (2008), and the RBMS1 region has later been validated by more GWAS projects (Qi et al., 2010)

There are usually no published GWAS results for rare variants using the commercial genotyping arrays with the typical SNP density (e.g. 500k). To illustrate this in volcano plot, we highlight the two SNPs near the gene HAPLN1 (chr5) in Fig. 3, whose rankings increase the most when regularized-χ is used. These two SNPs pass the Hardy-Weinberg equilibrium tests in control (p-value=0.7) as well as in case (p-values=0.47, 0.52), and they pass the differential typing test (p-value=0.31, 0.11), lacking an indication of bad typing quality. The MAF is increased from 0.0065 in control to 0.015 in case, with χ
                        2-statistic of 20.36, 14.93 (p-values= 6×10−6), 1×10−4, and ORs 2.5, 2.2. However, these two SNPs would not have passed the filtering in the original WTCCC analysis because the MAF is lower than 0.01. Using volcano plot and regularized-χ, these rare variants are easily highlighted and deserve further attention.

Besides the log-odds-ratio, other candidate for the unstandardized variables for the x-axis include minor allele frequency difference d
                        
                           MAF
                         and the fixation index F
                        
                           st
                        . The MAF difference d
                        
                           MAF
                        
                        =(n
                        11
                        n
                        22
                        −
                        n
                        12
                        n
                        21)/(n
                        1*
                        n
                        2*) may look very different from log(OR), but under the null hypothesis (i.e. zero allele frequency difference), the two measures are related, because:
                           
                              (7)
                              
                                 log
                                 (
                                 OR
                                 )
                                 =
                                 log
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   d
                                                   MAF
                                                
                                             
                                             
                                                
                                                   p
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                
                                                   d
                                                   MAF
                                                
                                             
                                             
                                                
                                                   q
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          d
                                          MAF
                                       
                                    
                                    
                                       
                                          p
                                          2
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          d
                                          MAF
                                       
                                    
                                    
                                       
                                          q
                                          1
                                       
                                    
                                 
                                 +
                                 O
                                 (
                                 
                                    d
                                    MAF
                                    2
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          d
                                          MAF
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          p
                                          1
                                       
                                       )
                                       
                                          p
                                          2
                                       
                                    
                                 
                                 +
                                 O
                                 (
                                 
                                    d
                                    MAF
                                    2
                                 
                                 )
                              
                           
                        
                     

Thus, if d
                        
                           MAF
                         is far from zero, there is no simple relationship between the two. Fig. 4(A) shows the existence of two distinct branches in the d
                        
                           MAF
                         vs. log(OR) scatter plot. The first branch is for rare-allele SNPs (low p
                        1, p
                        2 value), which more or less trace the line 
                           log
                           (
                           OR
                           )
                           ∼
                           
                              p
                              2
                              
                                 −
                                 1
                              
                           
                           
                              d
                              MAF
                           
                        . The second branch is for common alleles (p
                        1
                        ≈
                        p
                        2
                        ≈0.5), where log(OR)∼4d
                        
                           MAF
                        . Both approximations can be obtained from Eq. (7). SNPs with low MAF are more likely to achieve high OR values, but never high d
                        
                           MAF
                        ; whereas SNPs with common MAF tend to have large d
                        
                           MAF
                        , but only limited OR. Note that SNPs which rank high by χ
                        2 test result shown in Fig. 3 belong to the common variant branch, whereas those ranking relatively high in regularized-χ (Fig. 3) tend to belong to the rare variant branch.

The fixation index F
                        
                           st
                         is highly correlated with log(OR) (Fig. 4(B)). Interestingly, points (SNPs) with different MAF values overlap with each other on Fig. 4(B), thus not stratified by MAF (result not shown). It can be shown that
                           
                              (8)
                              
                                 
                                    F
                                    st
                                 
                                 =
                                 
                                    
                                       
                                          d
                                          MAF
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          p
                                          1
                                       
                                       +
                                       
                                          p
                                          2
                                       
                                       )
                                       (
                                       2
                                       −
                                       
                                          p
                                          1
                                       
                                       −
                                       
                                          p
                                          2
                                       
                                       )
                                    
                                 
                                 ,
                              
                           
                        
                     

so F
                        
                           st
                         scales as the square of allele frequency differences.

Here we used the standardized log(OR) as the y-axis, but could instead also have used the χ
                        2-statistic. In fact, the two are very similar (see Fig. 4(C)), and both are expected to approximate a standard normal distribution. Fig. 4(D) and Fig. 1 show two versions of a volcano plot, with the former uses χ
                        2 vs. log(OR), and second uses log(OR)/SE(log(OR)) vs. log(OR). The difference between the two is mostly due to the fact that χ
                        2 is the square of a normally distributed variable, so that straight lines in Fig. 1 become parabola in Fig. 4(D).

@&#DISCUSSION@&#

Like any graphical representation of data or analysis results, such as effect size vs. sample size in the funnel plot (Egger et al., 1997), true positive rate vs. false positive rate in receiver operating characteristic (ROC) curve (Swets and Pickett, 1982), etc., the introduction of volcano plot to the genetic association studies brings in new perspectives. The role of MAF in balancing test p-value and OR, and in the biased selection of variants in GWAS, can be easily concluded from the volcano plot.

The idea of regularized-χ is the same as that of regularized-t (or SAM) in microarray analysis: the avoidance of over-confidence in the ability to exactly estimate variances. The consequence is that those SNPs (or genes in microarray data) with extremely good test result (due to low standard error estimations) – but mediocre signal strength – move down in the ranking list.

The goal of the current paper is to introduce the concept of regularized-χ, whereas more details have to be worked out in future publications. For example, the choice of s
                     0 here is not based on a solid theoretical ground. However, the same comment may also be made on the SAM in microarray analysis. And we have shown that for s
                     0 being non-zero is more important than having a specific value. Also, we mainly focus on the effect of regularization on the ranking order of SNPs, thus the choice of the threshold value and the resulting distribution of type I and type II error rates has not been discussed.

Regularized-χ can be applied to published GWAS results even when only the summary statistics are available. We have known in Fig. 4(C) that the square-root of χ
                     2-statistic is approximately equal to the standardized log(OR), or log(OR)/SE(log(OR)). Consequently, SE(log(OR)) is equal to 
                        log
                        (
                        OR
                        )
                        /
                        
                           
                              
                                 χ
                                 2
                              
                           
                        
                     . Even if we may not know the distribution of SE(log(OR)) for all SNPs when a publication only provides the top-ranking results, these SNPs tend to have lower value of SE(log(OR)); the minimum of them could be the s
                     0 value in defining regularized-χ.

Unlike the regularized-t in microarray analysis, in genetic association analysis we have a clear understanding of the cause for a low standard error. This can be seen from Fig. 1 where the points/SNPs forming small angles with the y-axis, thus having low standard errors, are all common variants with higher MAFs. Indeed, common SNPs have more statistical power than rare variants, but the true disease susceptibility genes with low allele frequencies are likely to be missed if p-values are used as the filtering criterion. The purpose or consequence of regularized-χ then becomes clear: it puts the signal originating from rare variants as measured by OR in the context of common variant association signals.

On the practical side, this effect of regularized-χ to select rare variants can come in conflict with the quality control, because genotyping errors can be mistaken as rare variants. Points/SNPs with the lowest MAFs form the bottom layer of the envelope in Fig. 1, and the only way these would pass the regularized-χ threshold is to have large OR values. In fact, the OR could be infinity when one of the allele count is zero (though in principle, it could be avoided by a Yate's correction). As a result, requiring a minimum number of minor allele (in both case and control group) to be included in the dataset can be an effective way to exclude low-quality SNPs to be selected. However, as sample size increases and genotyping technology matures, this becomes less of a concern. Ultimately, appropriate filtering threshold for MAF depends on the genotyping technology (e.g. microarray versus exome sequencing) and its error rate.

It is well known that genetic association signals from rare variants using array-based genotyping data is difficult. With the low density (500k) SNPs and low number of samples, rare disease-gene-containing haplotype may not be tagged effectively. However, with the next-generation sequencing (NGS) data, rare variances are called with more confidence, and we expect the volcano plot could play an important role in the analysis of such data.

@&#ACKNOWLEDGMENTS@&#

W.L. and J.F. acknowledge the support from the Robert S. Boas Center for Genomics and Human Genetics.

@&#REFERENCES@&#

