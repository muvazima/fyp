@&#MAIN-TITLE@&#Combine color and shape in real-time detection of texture-less objects

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Augmenting Hinterstoisser et al.’s DOT method with color naming.


                        
                        
                           
                           Efficiently implementing the proposed method using SIMD operations.


                        
                        
                           
                           Combining the color and shape matching scores based on logistic regression.


                        
                        
                           
                           An acceleration strategy to fast eliminate unpromising cluster templates.


                        
                        
                           
                           Extensive experiments on three different datasets containing more than 40 objects.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Real-time texture-less object detection

The Dominant Orientation Templates (DOT) method

Color name

Speed-up strategy

@&#ABSTRACT@&#


               
               
                  Object instance detection is a fundamental problem in computer vision and has many applications. Compared with the problem of detecting a texture-rich object, the detection of a texture-less object is more involved because it is usually based on matching the shape of the object with the shape primitives extracted from an image, which is not as discriminative as matching appearance-based local features, such as the SIFT features. The Dominant Orientation Templates (DOT) method proposed by Hinterstoisser et al. is a state-of-the-art method for the detection of texture-less objects and can work in real time. However, it may well generate false detections in a cluttered background. In this paper, we propose a new method which has three contributions. Firstly, it augments the DOT method with a type of illumination insensitive color information. Since color is complementary to shape, the proposed method significantly outperforms the original DOT method in the detection of texture-less object in cluttered scenes. Secondly, we come up with a systematic way based on logistic regression to combine the color and shape matching scores in the proposed method. Finally, we propose a speed-up strategy to work with the proposed method so that it runs even faster than the original DOT method. Extensive experimental results are presented in this paper to compare the proposed method directly with the original DOT method and the LINE-2D method, and indirectly with another two state-of-the-art methods.
               
            

@&#INTRODUCTION@&#

Object instance detection is a fundamental problem in computer vision, and many applications require it as a necessary step. For instance, image-based tracking usually needs an object detection step in order to initialize the tracking. However, it is not a trivial problem because the object to be detected can undergo viewpoint, scale, and illumination changes, and sometimes can even be subject to partial occlusions. Generally, methods in this area are divided into two types. The first type of methods aims to identifying an instance of a specific object, while the other type of methods means to recognize an instance of an object that belongs to a generic object category, e.g., buildings, cars, or daily used items. In a recent tutorial, Gauman and Leibe [1] discuss both of these two types of methods. Of the methods in the first type, the solution to the detection of a texture-rich object has become quite standard and very successful [2,3], with its pipeline summarized as follows: (1) Construct a sparse model of features for an object using local features (e.g., SIFT features) extracted from multiple views of the object and the Structure from Motion (SfM) technique. (2) Match the features of the constructed model with those extracted from an input image, establishing the 3D–2D correspondences between the matched ones. After that, the pose of the object can be estimated [2] and wrong matches eliminated. This paper is focused on the detection of a specific object that has very few textures on its surface. Compared with the previous problem of detecting a texture-rich object, this problem is more involved because the detection is usually based on matching the shape of the object with the shape primitives extracted from an image, which is not as discriminative as matching appearance-based local features, such as the SIFT features. Hsiao and Hebert [4] compare invariant and non-invariant approaches for shape-based object instance detection. “Invariant” methods create a unified object representation across different viewpoints by explicitly modeling the structural relationships of high level shape primitives (e.g., curves and lines). In contrast, “non-invariant” methods use view-based templates and capture viewpoint variations by sampling the view space and matching each template independently. They conclude that non-invariant approaches are well-suited for specific object recognition and meanwhile can also be computationally efficient.

In this paper, we propose a new method for the detection of texture-less objects in an image by extending the Dominant Orientation Templates (DOT) method proposed by Hinterstoisser et al. [5], which is one of the state-of-the-art methods for the detection of texture-less objects and can work in real time. The DOT method represents the sparse shape of an object at a given view using the dominant orientations of the gradients of the view’s image. However, one issue with the DOT method is that it may well generate false detections in a cluttered background, due to the fact that many shapes partially similar to an instance of the object can exist in a cluttered background. Intuitively, the performance of shape-based object detection can be enhanced by combining with complementary information. Inspired by the very recent success of fusing color and shape information in visual object recognition [6,7], in this paper we propose a new method that incorporates color information into the DOT method. The new method significantly enhances the robustness of texture-less object detection in a cluttered background, but does not compromise the real-time speed of the original method. In the rest of this section, we will discuss the related work and argue the contributions of the paper.

@&#RELATED WORK@&#

In this subsection, we will mainly discuss the related work in the area of specific texture-less object detection. Also, we will touch upon the pertinent work in color-based object recognition.

Since the object to be detected has very few textures on its surface, appearance-based methods are not likely to work well. Let’s take one powerful appearance-based object detection method, the Implicit Shape Model (ISM) [8], as an example. Assume that one has a codebook of entries containing local appearances of a specific object observed under various viewpoints, represented by image patches extracted around interest points in the various views of the object. At the detection stage, image patches are also extracted around interest points in an input image, and compared against the entries of the codebook. The matched codebook entries then cast probabilistic Hough votes, which lead to object location hypotheses that can later be refined. If the object were rich in texture, one could expect that many of the hypotheses are generated by the matches within the “interior” of the object, which abounds with interest points. However, when the object is largely texture-less, the interest points will mostly be located along the boundaries of the object. As a result, the image patches will inevitably contain contents not belonging to the object and thus easily lead to false matches. For this reason, most methods for the detection of text-less objects are shape-based.

One type of shape-based methods relies on matching contours or edge segments. Among them, some methods [9–11] are meant to detect objects of a generic category. Ferrari et al. [9] propose a contour structure called kAS (k Adjacent Segments), which consists of k roughly straight contour segments adjacent to each other. They use the kAS histograms of the training samples of an object category to train a Support Vector Machine (SVM) classifier, which in turn is used to detect new instances of the object category. Although the kAS structures are invariant to scale and translation changes, the accuracy of matching them is heavily dependent on the consistent continuity of the extracted contours across images. To overcome the difficulty of one-to-one matching when the contours of the input image are fragmented, Srinivasan et al. [10] allow multiple contours of the input image to match to one contour of the object model (many-to-one matching). Since in both methods a detector only works for a particular view of the object category, if they were to be used to detect a specific object that can appear under arbitrary viewpoints, one would need to train a different detector for each different view of the object. Given that each detector is relatively slow (in [9], the kAS method requires one second to process an input image on a standard workstation with a C++ implementation; in [10], a trained detector further works in conjunction with a separate linear programming optimization procedure to perform the many-to-one matching), it is not likely for both methods to work in real time in the specific object detection case. Payet and Todorovic [11] use Bag of Boundaries (BoBs) to jointly match the contours of all the object templates to the contours of the input image, and at the same time estimate the pose of the object in the input image. Also, their method is not ready to be implemented in real time (requiring several minutes in processing a single image with a MATLAB® implementation).

By contrast, some researchers devise real-time contour-based methods particularly for the detection of texture-less specific objects [12–17]. Damen et al. [12,13] propose to match contours using constellations of edgelets, where an edgelet is a short straight segment represented by its center point and orientation. A descriptor is constructed for each constellation of edgelets to encode the relative orientations and positions of the edgelets in the constellation. The scalability of their method is achieved by using hash tables to store configurations of edgelets shared across different objects. At the detection stage, the descriptors of the various templates of an object are compared with the descriptors of the input image along a fixed-path (a path is the order of how the edgelets in a constellation are connected) to generate candidate detection results. Because the direct matching of the constellations of edgelets has limited accuracy, the candidate detection results need to be verified by establishing a homography from the matched template to the input image using the matched constellations of edgelets, followed by an Iterative Closest Edgelet (ICE) refinement which registers the template to the image. For this reason, when there are more clutters present in the input image, the speed of this method will drastically drop and meanwhile will result in significantly increased false matches. Tombari et al. [14] come up with Bunch Of Lines Descriptor (BOLD) features to describe and detect line segments in the pipeline of SIFT-feature description and detection [3]. A BOLD feature describes the relative position and orientation of a straight line segment with respect to its multiple adjacent neighbors. Obviously, their method also heavily relies on the accuracy and continuity of line segment extraction. To match edge segments at different scales, Lee and Soatto [15] construct pyramids for the template images and the input image, and extract edge segments at the various levels of the pyramids. The edge segments are then aligned to some “canonical” reference frame so that they are locally invariant to scale and rotation changes. Afterwards, the features of the edge segments can be represented and compared in a way similar to the DOT method. However, while their method works very well for the detection of planar objects, it is not likely to work equally well for the detection of 3D objects, because the transformations between the different views of a 3D object cannot be sufficiently approximated using the similarity transformation as assumed in their method. Seo et al. [16] increase the robustness of locating a texture-less object in a cluttered background with the aid of a 3D model of the object. In their method, the object location problem reduces to an optimization problem of finding the correspondences between the projections of the 3D model’s contours and the edges extracted from the input image. However, they have not addressed the issue of how to initialize the camera pose which is required to start the optimization. In light of this, their method is better to be used for tracking where the camera pose can be easily initialized using the tracking results of the previous frame, rather than be used for detection where the camera pose is mostly unknown. In addition, constructing a 3D model of a texture-less object almost always requires a 3D imaging scanner, which is not always at hand. Similarly, Choi and Christensen [17] also construct 3D polygonal mesh models of the objects of interest. However, rather than directly match a 3D model to the input image, they first obtain edge templates by projecting the 3D model onto a 2D plane, and then match the edge templates to the input image using a fast chamfer matching [18]. However, chamfer matching has the disadvantage of being sensitive to outliers.

Instead of image contours, other researchers [19,20,5,21,22] favor image gradients because they are more robust to illumination changes. Malisiewicz et al. [19] train a separate linear SVM classifier for each positive exemplar represented using Histograms of Oriented Gradients (HoG) [23] in the training set. At the detection stage, each classifier is independently run on the input image and non-maximum suppression is used to create a final set of detections. HoG matching has proven to give reliable results but tends to be slow due to its relatively high computational complexity [21]. Hinterstoisser et al. [5] divide a template into many small non-overlapping regions, representing it using the quantized dominant orientations of the image gradients in these regions. By extending Steger’s gradient-orientation-based similarity measure [20], they propose a new similarity measure which is robust to small deformations and translations. They further significantly simplify the computation of the similarity measure by assuming independence between all the regions in a template. When comparing a template to the input image, they perform a very efficient SIMD (Single Instruction, Multiple Data) implementation similar to [24]. In their follow-up work [21], they spread the dominant gradient orientations of the input image and pre-compute a response map, which is then stored in linearized memories. Thereafter, the similarity measure over the input image for a given template is computed by adding up the linearized memories for the different orientations of the template. To distinguish from the DOT method, they name this method as LINE-2D (where “LINE” is for LINEearizing the memory). When a depth sensor is available, the surfaces of the object can be captured and their normals computed. The quantized orientations of the surface normals can then be combined with the gradient orientations to enhance robustness of object detection in cluttered scenes. To alleviate the tedious work of collecting templates for an object, in [22] they first build a 3D model of the object with the aid of a depth sensor, and then use the 3D model to render templates for the object.

Several researchers [25–29] have since proposed improvements to Hinterstoisser et al.’s work [5,21]. Hsiao and Hebert [25] incorporates penalty terms into the matching score output by the LINE-2D detector [21]. The penalty terms give high penalties to locations hypothesized to be occluded but have a high occlusion prior or occlusion conditional likelihood of being visible. The occlusion prior and the occlusion conditional likelihood are estimated based on the assumption that occlusions are caused by another object resting on the same surface as the object of interest. Therefore, a detection in which the top of an object is hypothesized to be occluded while the bottom is visible will be severely penalized. However, the extension of their method to estimate the occlusion prior and the occlusion conditional likelihood to other occlusion scenarios (e.g., objects occluding each other are not located on the same surface) is not straightforward. Rios-Cabrera and Tuytelaars [26,27] use an SVM to learn which parts of a template are more important in matching than other parts of the template, and accordingly discard those parts of the template which are damaging the matching performance. To further speed up the matching, they construct a strong classifier for each template cluster using AdaBoost, and then convert each strong classifier into a cascade by using Multiple Instance Pruning (MIP) [30], resulting in much fewer number of template clusters for each object class. Konishi et al. [28] construct image pyramids to accelerate the matching process. Specifically, they first implement the DOT method at the coarser levels of the image pyramids, and then refine the results using the Iterative Closest Point (ICP) [31] at the finer levels of the image pyramids. Obviously, the robustness of their method is still dominated by the DOT object detection which provides the candidate results. In addition to matching the gradient orientations between a template and the input image, Lee and Soatto [29] also match the two’s histograms of normalized intensities. However, as pointed out by Gevers et al. [32,33], the image intensity is not invariant to illumination changes. Therefore, their method is likely to be illumination sensitive.

The topic of object recognition/detection based on color is largely outside the scope of this paper, and the interested reader is referred to a very recent monograph [33] which covers various aspects of this topic. Color has proven to be strongly complementary to shape in object recognition in the context of bag-of-words-based object retrieval [34,7]. Khan et al. [6] combine the color name descriptor [35] with the HoG descriptor [23] in a part-based framework [36] for generic object detection.

In order for color to work in conjunction with shape, the color information used must be insensitive to illumination changes. The earlier work by Gevers and Smeulders [32] compares different color models in the resistance to changing illumination conditions. The recent work by Van de Sande et al. [37] evaluates the performances of color histograms, color moments, and color-SIFT descriptors in object and scene recognition.

In this paper, we propose a new method that augments Hinterstoisser et al.’s DOT method [5] for texture-less object detection with a type of illumination insensitive color information. It has three contributions argued as follows.

Firstly, we introduce color templates that are insensitive to illumination conditions to work with the dominant orientation templates of [5], significantly enhancing the robustness of texture-less object detection in a cluttered background. Compared with previous work that also fuses different information for object detection, our work is different in three aspects. To begin with, we choose color, which is inherently complementary to shape and can be directly extracted from a given image. In contrast to the previous work [21,22] that uses a depth sensor to obtain surface normals as complementary information, we favor color because depth sensors are not as ubiquitous as the commonly-used color cameras. Next, contrary to Lee and Soatto’s additional templates of normalized intensities [29], we choose the color name [35] to build our color templates which are illumination insensitive while theirs are not. Finally, we represent our color templates in a way similar to the dominant orientation templates of [5], enableing us to perform a very efficient SIMD implementation of the comparison of the color templates with the input image. This is in contrast to Khan et al.’s work [6], which concatenates the color name descriptor and the HoG descriptor into a vector to fit within a part-based framework [36] for the detection of generic objects.

Secondly, we weigh the respective matching scores output by the color templates and the dominant orientation templates in a systematic manner. In previous work, Hinterstoisser et al. [21] simply add up the matching scores of the image gradients and the surface normals, which is more or less arbitrary. In this paper, we formulate a logistic regression problem to assign different weights to the respective matching scores (details will be given in Section 2.2). In the previous work where there are many weights to be learned, a latent SVM [10] or a linear SVM [26,27] can be used. No evidence shows SVM is superior to logistic regression or vice versa, because the performance of these two classification models is very problem-dependent [38,39]. We opt for logistic regression because it has a nice probabilistic interpretation and is easy to be trained using a stochastic gradient method.

Finally but importantly, we come up with a speed-up strategy to compensate for the slowdown in the speed of the proposed method caused by the increased computational load of comparing the color templates to the input image. Inspired by the branch and bound constrained search strategy of [40], Hinterstoisser et al. [5] first match a cluster template to the input image in the DOT method. Unless the cluster template is successfully matched, the successive templates that belong to the cluster template will not be tested. We observed that if a cluster template fails to match the input image, it is highly unlikely for those cluster templates similar to it to be matched. In light of this observation, we create two matrices called the Cluster Dissimilarity Matrix(CDM) and the Cluster Dissimilarity Index Matrix (CDIM) to fast eliminate unpromising cluster templates.

In the remainder of the paper, we first describe the proposed method in detail in Section 2. Then in Section 3, we present experiments and results. Finally, we conclude the paper in Section 4 with discussions and future work.

In this section, we first introduce our color templates. Next, we describe how to combine the respective matching scores output by the color templates and the dominant orientation templates in a logistic regression formation. Thirdly, we delineate how to accelerate the proposed method by using the CDM and the CDIM. Finally, we make a detailed complexity analysis of the proposed method.

Like the dominant orientation templates of [5], our color templates are constructed using rectangular regions extracted from a sequence of training images containing the object of interest. Unlike the dominant orientation templates in which the image gradients are weak in their backgrounds and can therefore be ignored, the backgrounds in the color templates cannot be neglected. For example, assume that we have a template image containing a small blue object but a large white background. When we match it to an input image containing only white pixels, we can still obtain a large matching score contributed by the unwanted background of the template image. For this reason, we need to separate the object from its background in each of the color templates despite the cleanness of the background. We choose an automatic seeded region growing method [41] for color image segmentation for this purpose, with the steps given as follows. First, each RGB color template image is transformed into an YCbCr version. After that, we choose the four corners of the YCbCr image as seeds, and begin to segment it into disjoint regions, each region corresponding to one chosen seed. When this segmentation process is finished, the remaining region in the image corresponds to the object of interest. This method works very well and can fully segment the object from its background, since the two are pretty distinct from each other. According to the segmentation results, we create a binary mask image in which the “one” pixels denote the object pixels and the “zero” pixels the background pixels.

We represent the color templates in a way similar to the representation of the dominant orientation templates of [5]. For this reason, we first briefly discuss below the dominant orientation templates.

To construct a dominant orientation template, Hinterstoisser et al. [5] divide a given template image into disjoint small square regions, and record the orientations of up to k (defaulted to seven in their work) most dominant image gradients inside each region. The orientations of the dominant image gradients are discretized into a small number of bins so as to be stored afterwards in a memory-economic manner. Let us denote the template image as 
                              
                                 O
                              
                            and a small square region in it as 
                              
                                 R
                              
                           . The following function [5] returns the set of dominant gradient orientations in region 
                              
                                 R
                              
                           ,
                              
                                 (1)
                                 
                                    DO
                                    (
                                    O
                                    ,
                                    R
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                      (
                                                      O
                                                      ,
                                                      R
                                                      )
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      S
                                                      (
                                                      O
                                                      ,
                                                      R
                                                      )
                                                      
                                                      ≠
                                                      
                                                      ∅
                                                   
                                                
                                                
                                                   
                                                      {
                                                      ⊥
                                                      }
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           where “
                              
                                 ⊥
                              
                           ” denotes region 
                              
                                 R
                              
                            is uniform and 
                              
                                 S
                                 (
                                 O
                                 ,
                                 R
                                 )
                              
                            is written as
                              
                                 (2)
                                 
                                    S
                                    (
                                    O
                                    ,
                                    R
                                    )
                                    =
                                    
                                       
                                          
                                             ori
                                             (
                                             O
                                             ,
                                             l
                                             )
                                             :
                                             l
                                             ∈
                                             
                                                max
                                             
                                             
                                             
                                                
                                                   mag
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             R
                                             )
                                             ∧
                                             
                                             mag
                                             
                                             (
                                             O
                                             ,
                                             l
                                             )
                                             >
                                             τ
                                          
                                       
                                    
                                    .
                                 
                              
                           In Eq. (2), 
                              
                                 l
                              
                            is a pixel location in 
                              
                                 R
                                 ;
                                 ori
                                 (
                                 O
                                 ,
                                 l
                                 )
                              
                            is the gradient orientation at 
                              
                                 l
                              
                            in template image 
                              
                                 O
                              
                           , and 
                              
                                 mag
                                 (
                                 O
                                 ,
                                 l
                                 )
                              
                            is its magnitude; 
                              
                                 max
                                 
                                    
                                       mag
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 R
                                 )
                              
                            is the set of locations for the k strongest gradients in 
                              
                                 R
                                 ;
                                 τ
                              
                            is a threshold used to determine whether the region is uniform or not. Now let 
                              
                                 I
                              
                            denote an input image that is also divided into disjoint small square regions (which have the same size as 
                              
                                 R
                              
                           ). The search of template image 
                              
                                 O
                              
                            in input image 
                              
                                 I
                              
                            is conducted by shifting 
                              
                                 O
                              
                            to different locations of 
                              
                                 I
                              
                            and matching the square regions of 
                              
                                 O
                              
                            with their counterparts of 
                              
                                 I
                              
                           . At a given location 
                              
                                 c
                              
                           , the similarity measure between 
                              
                                 O
                              
                            and 
                              
                                 I
                              
                            is defined as
                              
                                 (3)
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    I
                                    ,
                                    O
                                    ,
                                    c
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             R
                                             
                                             in
                                             
                                             O
                                          
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             do
                                             (
                                             I
                                             ,
                                             c
                                             +
                                             R
                                             )
                                             ∈
                                             DO
                                             (
                                             O
                                             ,
                                             R
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 do
                                 (
                                 I
                                 ,
                                 c
                                 +
                                 R
                                 )
                              
                            returns the orientation of the strongest gradient (whose magnitude also exceeds 
                              
                                 τ
                              
                           ) in 
                              
                                 R
                              
                           ’s corresponding region of 
                              
                                 I
                                 ;
                                 δ
                                 (
                                 ·
                                 )
                              
                            is an indicator function that returns one if “·” is true and zero otherwise. Furthermore, to account for invariance to small translations during the above process, Hinterstoisser et al. [5] adopt the following similarity measure:
                              
                                 (4)
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          DOT
                                       
                                    
                                    
                                    (
                                    I
                                    ,
                                    O
                                    ,
                                    c
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             R
                                             in
                                             O
                                          
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             do
                                             (
                                             I
                                             ,
                                             c
                                             +
                                             R
                                             )
                                             ∈
                                             L
                                             (
                                             O
                                             ,
                                             R
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where
                              
                                 (5)
                                 
                                    L
                                    (
                                    O
                                    ,
                                    R
                                    )
                                    =
                                    
                                       
                                          
                                             o
                                             :
                                             ∃
                                             M
                                             ∈
                                             M
                                             
                                             such that
                                             
                                             o
                                             ∈
                                             DO
                                             
                                                
                                                   
                                                      w
                                                      (
                                                      O
                                                      ,
                                                      M
                                                      )
                                                      ,
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           and 
                              
                                 w
                                 (
                                 O
                                 ,
                                 M
                                 )
                              
                            is the warped image of 
                              
                                 O
                              
                            using a small translation 
                              
                                 M
                                 ∈
                                 M
                              
                            (where 
                              
                                 M
                              
                            is the set of all small translations that are allowed for). Note that 
                              
                                 L
                                 (
                                 O
                                 ,
                                 R
                                 )
                              
                            can be pre-computed offline.

A very efficient computation of Eq. (4) is implemented by representing 
                              
                                 L
                                 (
                                 O
                                 ,
                                 R
                                 )
                              
                            and 
                              
                                 do
                                 (
                                 I
                                 ,
                                 c
                                 +
                                 R
                                 )
                              
                            using bit strings and matching them in SIMD operations. In [5], the gradient orientations are discretized into eight bins, such that 
                              
                                 L
                                 (
                                 O
                                 ,
                                 R
                                 )
                              
                            and 
                              
                                 do
                                 (
                                 I
                                 ,
                                 c
                                 +
                                 R
                                 )
                              
                            can be compactly represented using one byte (eight bits) and compared using very fast bitwise operations. The comparison of the bytes is further accelerated by processing 16bytes in parallel, thanks to the Streaming SIMD Extensions (SSE) technology. In our implementation, if 
                              
                                 L
                                 (
                                 O
                                 ,
                                 R
                                 )
                              
                            or 
                              
                                 do
                                 (
                                 I
                                 ,
                                 c
                                 +
                                 R
                                 )
                              
                            is nonempty, they are represented by a non-zero byte; otherwise, they are represented by a zero byte.

When constructing a color template for template image 
                              
                                 O
                              
                           , we have two things to bear in mind. On the one hand, the color information must be robust to illumination conditions. On the other hand, in order for the color information to be efficiently processed, it must be represented in a way compatible with the representation of the dominant orientation templates, i.e., also using bit strings. To this end, we experimented with the following existing color descriptors: (1) the normalized color rgb 
                           [32], (2) the saturation S and hue H 
                           [32], (3) the 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                              
                            color model [32], (4) the 
                              
                                 
                                    
                                       l
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       3
                                    
                                 
                              
                            color model [32], (5) the transformed color distribution [37], and (6) the color name [35]. We exclude more complex color descriptors (such as the color SIFT descriptors [37]) from consideration, because they require much more bits to encode and are thus time-consuming during matching. Among the six color descriptors we experimented with, the color name [35] works the best in terms of robustness to illumination changes. Color names present strong invariance to photometric changes because multiple shades of a color are mapped to the same color name. For example, a blue jacket always looks “blue” no matter one wears it indoors or outdoors, though it may appear to be “deep blue” in the indoor case and “light blue” in the outdoor case. There are eleven basic color names of the English language: black, blue, brown, gray, green, orange, pink, purple, red, white, and yellow. Van de Weijer et al. [35] learn a matrix that maps RGB values to these eleven basic color names using sets of images collected for each of the eleven color names. In our implementation, we compute the mean vector 
                              
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   R
                                                
                                                
                                                   r
                                                
                                             
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   R
                                                
                                                
                                                   g
                                                
                                             
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   R
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                            of each region 
                              
                                 R
                              
                            in 
                              
                                 O
                              
                           , where 
                              
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                    
                                       g
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                    
                                       b
                                    
                                 
                              
                            are the mean values of the R, G and B channels of region 
                              
                                 R
                              
                           , and map 
                              
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                 
                              
                            to the basic color names using the mapping matrix of [35]. Since region 
                              
                                 R
                              
                            is generally uniform (because the object of interest has very few textures on its surface), it is reasonable for us to represent its color using 
                              
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                 
                              
                           .
                              1
                              One alternative for constructing 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             R
                                          
                                       
                                    
                                  is to use the median values of the R, G and B channels of region 
                                    
                                       R
                                    
                                  instead of the mean values 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             R
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             R
                                          
                                          
                                             g
                                          
                                       
                                    
                                 , and 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             R
                                          
                                          
                                             b
                                          
                                       
                                    
                                 . However, there is not a corresponding Intel® IPP function for the purpose of computing median values, unlike the case of computing mean values. Therefore, using median values would slow down our implementation.
                           
                           
                              1
                            When mapping 
                              
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                 
                              
                            to the eleven color names, we obtain an 11-vector whose elements are the probabilities of each of the 11 color names to which 
                              
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                 
                              
                            belongs. To represent the results using bit strings, we simply assign the color name corresponding to the largest element of the 11-vector to region 
                              
                                 R
                              
                           . Specifically, we use two bytes (16bits) to store the results. For example, if 
                              
                                 R
                              
                            looks “black”, it is represented as 00000100 00000000; if it looks like “yellow”, it is represented as 00000000 00000001. We obtain a color template for template image 
                              
                                 O
                              
                            by concatenating all the color name representations of its constituting regions. In fact, since only the object part of 
                              
                                 O
                              
                            is useful in matching, we utilize the binary mask image obtained from segmenting 
                              
                                 O
                              
                            to exclude those regions belonging to the background from the construction of the color template.

Now we define below the color-based similarity measure of matching template image 
                              
                                 O
                              
                            to input image 
                              
                                 I
                              
                            at location 
                              
                                 c
                              
                           :
                              
                                 (6)
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    I
                                    ,
                                    O
                                    ,
                                    c
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             R
                                             
                                             in
                                             
                                             O
                                             ∩
                                             
                                                
                                                   O
                                                
                                                
                                                   mask
                                                
                                             
                                          
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             cn
                                             (
                                             I
                                             ,
                                             c
                                             +
                                             R
                                             )
                                             ⊗
                                             
                                             CN
                                             
                                             (
                                             O
                                             ,
                                             R
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       O
                                    
                                    
                                       mask
                                    
                                 
                              
                            is the binary mask image obtained from segmenting 
                              
                                 O
                                 ;CN
                                 (
                                 O
                                 ,
                                 R
                                 )
                              
                            returns the color name (represented in bytes) of region 
                              
                                 R
                              
                            in 
                              
                                 O
                                 ;cn
                                 (
                                 I
                                 ,
                                 c
                                 +
                                 R
                                 )
                              
                            returns the color name (also represented in bytes) of 
                              
                                 R
                              
                           ’s corresponding region in 
                              
                                 I
                              
                           ; “
                              
                                 ⊗
                              
                           ” denotes the bitwise AND operation. As in Eq. (3), 
                              
                                 δ
                                 (
                                 ·
                                 )
                              
                            is an indicator function.

Like the dominant orientation templates, we also allow for small translations of a color template. To this end, we modify 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 I
                                 ,
                                 O
                                 ,
                                 c
                                 )
                              
                            to define the similarity measure finally used in this paper:
                              
                                 (7)
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          COLOR
                                       
                                    
                                    (
                                    I
                                    ,
                                    O
                                    ,
                                    c
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             R
                                             
                                             in
                                             
                                             O
                                             ∩
                                             
                                                
                                                   O
                                                
                                                
                                                   mask
                                                
                                             
                                          
                                       
                                    
                                    δ
                                    
                                       
                                          
                                             cn
                                             (
                                             I
                                             ,
                                             c
                                             +
                                             R
                                             )
                                             ⊗
                                             CL
                                             (
                                             O
                                             ,
                                             R
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where
                              
                                 (8)
                                 
                                    CL
                                    (
                                    O
                                    ,
                                    R
                                    )
                                    =
                                    
                                       
                                          
                                             o
                                             :
                                             ∃
                                             M
                                             ∈
                                             M
                                             
                                             such that
                                             
                                             o
                                             ∈
                                             CN
                                             
                                             
                                                
                                                   
                                                      w
                                                      (
                                                      O
                                                      ,
                                                      M
                                                      )
                                                      ,
                                                      R
                                                   
                                                
                                             
                                             ∧
                                             R
                                             
                                             in
                                             
                                             O
                                             ∩
                                             
                                                
                                                   O
                                                
                                                
                                                   mask
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           and 
                              
                                 w
                                 (
                                 O
                                 ,
                                 M
                                 )
                              
                            is the same as in Eq. (3) and 
                              
                                 M
                              
                            the set of all small translations allowed for. Note that 
                              
                                 CL
                                 (
                                 O
                                 ,
                                 R
                                 )
                              
                            is also represented using two bytes by bitwise ORing the results of 
                              
                                 CN
                                 
                                    
                                       
                                          w
                                          (
                                          O
                                          ,
                                          M
                                          )
                                          ,
                                          R
                                       
                                    
                                 
                              
                            for all 
                              
                                 M
                                 ∈
                                 M
                              
                           . Since the color templates and the input image are both represented in bytes and stored in a cache-friendly manner as in [5], the computation of Eq. (8) is also implemented using the SSE technology. Fig. 1
                            gives an illustrative scheme of matching a template image to an input image using both the dominant orientation and color representations.

In the DOT method [5], optimal matches have the largest values of 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                           
                         (Eq. (4)). However, we found this criterion can be problematic because it is prone to favor larger templates over smaller ones. A toy example of three templates of different sizes matching to an object instance is shown in Fig. 2
                        .

In Fig. 2, though the largest template yields the largest 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                           
                        , obviously it is not the optimal match. An observation of the figure also suggests that a good match requires sufficient portions of the template be matched to the object instance. However, though the smallest template has a similar proportion being matched as the medium-sized template, it is also not a good match. To conclude, a large template with a large 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                           
                         or a small template with a high matched proportion may neither be an optimal match. In view of this, we introduce two ratios, 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    2
                                 
                              
                           
                        , to define a new matching score 
                           
                              
                                 
                                    m
                                 
                                 
                                    DOT
                                 
                              
                           
                         for a dominant orientation template:
                           
                              (9)
                              
                                 
                                    
                                       m
                                    
                                    
                                       DOT
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       DOT
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       DOT
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       DOT
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       DOT
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    1
                                 
                              
                           
                         is the ratio of 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                           
                         to the number of non-zero 
                           
                              L
                              (
                              O
                              ,
                              R
                              )
                           
                         of this template, and 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    2
                                 
                              
                           
                         the ratio of 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                           
                         to the number of non-zero 
                           
                              L
                              (
                              O
                              ,
                              R
                              )
                           
                         of the “largest” template.
                           2
                           To enable a parallel matching of the templates using SIMD implementations, all the template images are of the same size (as shown in Fig. 7). However, as the objects are viewed from various distances and viewpoints, the proportions of pixels they occupy in their respective template images are distinct. By “largest”, we mean the template that contains the most number of non-zero 
                                 
                                    L
                                    (
                                    O
                                    ,
                                    R
                                    )
                                 
                               regions.
                        
                        
                           2
                         Note that neither 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    1
                                 
                              
                           
                         nor 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    2
                                 
                              
                           
                         will be greater than one, and the larger 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    1
                                 
                              
                           
                        , the more proportion of this template is matched; the larger 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    2
                                 
                              
                           
                        , the “larger” this template. 
                           
                              
                                 
                                    β
                                 
                                 
                                    DOT
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    DOT
                                 
                                 
                                    2
                                 
                              
                           
                         are two weights to balance 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    DOT
                                 
                                 
                                    2
                                 
                              
                           
                        .

Similarly, we define the following 
                           
                              
                                 
                                    m
                                 
                                 
                                    COLOR
                                 
                              
                           
                         for a color template:
                           
                              (10)
                              
                                 
                                    
                                       m
                                    
                                    
                                       COLOR
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       COLOR
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       COLOR
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       COLOR
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       COLOR
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    COLOR
                                 
                                 
                                    1
                                 
                              
                           
                         is the ratio of 
                           
                              
                                 
                                    ε
                                 
                                 
                                    COLOR
                                 
                              
                           
                         (Eq. (7)) to the number of non-zero 
                           
                              CL
                              (
                              O
                              ,
                              R
                              )
                           
                         of this template, and 
                           
                              
                                 
                                    r
                                 
                                 
                                    COLOR
                                 
                                 
                                    2
                                 
                              
                           
                         the ratio of 
                           
                              
                                 
                                    ε
                                 
                                 
                                    COLOR
                                 
                              
                           
                         to the number of non-zero 
                           
                              CL
                              (
                              O
                              ,
                              R
                              )
                           
                         of the largest template. The 
                           
                              
                                 
                                    β
                                 
                                 
                                    COLOR
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    COLOR
                                 
                                 
                                    2
                                 
                              
                           
                         are two weights to balance 
                           
                              
                                 
                                    r
                                 
                                 
                                    COLOR
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    COLOR
                                 
                                 
                                    2
                                 
                              
                           
                        . The sum of 
                           
                              
                                 
                                    m
                                 
                                 
                                    DOT
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    COLOR
                                 
                              
                           
                         is the final matching score for template image 
                           
                              O
                           
                         at location 
                           
                              c
                           
                         with the input image 
                           
                              I
                           
                        :
                           
                              (11)
                              
                                 
                                    
                                       m
                                    
                                    
                                       combined
                                    
                                 
                                 (
                                 I
                                 ,
                                 O
                                 ,
                                 c
                                 )
                                 =
                                 
                                    
                                       m
                                    
                                    
                                       DOT
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       COLOR
                                    
                                 
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       DOT
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       DOT
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       DOT
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       DOT
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       COLOR
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       COLOR
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       COLOR
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       COLOR
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        For simplicity, we write 
                           
                              β
                              =
                              
                                 
                                    [
                                    
                                       
                                          β
                                       
                                       
                                          DOT
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          β
                                       
                                       
                                          DOT
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          β
                                       
                                       
                                          COLOR
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          β
                                       
                                       
                                          COLOR
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         and 
                           
                              r
                              =
                              
                                 
                                    [
                                    
                                       
                                          r
                                       
                                       
                                          DOT
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          r
                                       
                                       
                                          DOT
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          r
                                       
                                       
                                          COLOR
                                       
                                       
                                          1
                                       
                                    
                                    
                                    
                                       
                                          r
                                       
                                       
                                          COLOR
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        , and rewrite Eq. (11) as 
                           
                              
                                 
                                    m
                                 
                                 
                                    combined
                                 
                              
                              =
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              r
                           
                        . Now we describe how to learn 
                           
                              β
                           
                         in a logistic regression [42] formation. Assume that in the input image there is only one object instance and we have a correct match and an incorrect match. By “correct” we mean the match is close to the actual position of the object instance in the input image. Otherwise, we say the match is “incorrect”. Without causing confusion, let us use 
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                         to respectively denote the correct match and the incorrect match, and define 
                           
                              Δ
                              r
                              =
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              -
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                        . Obviously, we wish that 
                           
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              >
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                        , i.e. 
                           
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              (
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              -
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              Δ
                              r
                              >
                              0
                           
                        . Now assume that we have collected a data set 
                           
                              
                                 
                                    
                                       
                                          Δ
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                              
                           
                        . If 
                           
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              Δ
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              >
                              0
                           
                        , the associated 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        ; otherwise, 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        . We further divide 
                           
                              
                                 
                                    
                                       
                                          Δ
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    N
                                 
                              
                           
                         into two classes, 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                        , with the data associated with 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                         falling into 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and the remaining data categorized into 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                        . With the assumption of independence among the data, the likelihood function can be written:
                           
                              (12)
                              
                                 p
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                N
                                             
                                          
                                          |
                                          β
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              =
                              p
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              |
                              Δ
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              σ
                              (
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              Δ
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , and 
                           
                              σ
                              (
                              x
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    1
                                    +
                                    exp
                                    (
                                    -
                                    x
                                    )
                                 
                              
                           
                         is called the logistic sigmoid function.

Logistic regression aims at seeking an optimal 
                           
                              β
                           
                         such that Eq. (12) reaches its maximum. To this end, the gradient of the negative logarithm of 
                           
                              p
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             N
                                          
                                       
                                       |
                                       β
                                    
                                 
                              
                           
                         with respect to 
                           
                              β
                              ,
                              ▽
                              β
                              =
                              -
                              ∂
                              
                                 
                                    
                                       log
                                       
                                          
                                             
                                                p
                                                
                                                   
                                                      
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                         |
                                                         β
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              /
                              ∂
                              β
                           
                        , is obtained and 
                           
                              β
                           
                         can be updated 
                           
                              β
                              ←
                              β
                              +
                              λ
                              ▽
                              β
                           
                        , where 
                           
                              λ
                           
                         is the step length. To avoid the heavy computational load of directly computing 
                           
                              β
                           
                         caused by a large number N, the stochastic gradient method is used to get a random approximation of the partial derivatives in much less time. Also, the training examples are randomly sorted, and the parameters are updated for each example sequentially. For example, the stochastic gradient update of the jth element of 
                           
                              β
                           
                         is:
                           
                              (13)
                              
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 ←
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 λ
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 Δ
                                 
                                    
                                       r
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              Δ
                              
                                 
                                    r
                                 
                                 
                                    ij
                                 
                              
                           
                         is the jth element of 
                           
                              Δ
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                           
                        , and i is randomly chosen with uniform probability. A sweep of all the training examples is called an epoch. Typically, a small constant number of epochs is used, e.g., three. In Eq. (13), 
                           
                              λ
                           
                         is called the learning rate, determined by 
                           
                              λ
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        , where t denotes the tth epoch.

To overcome the overfitting problem that may arise with logistic regression, a regularized term 
                           
                              P
                              (
                              β
                              )
                           
                         called priors is usually introduced into Eq. (12) such that
                           
                              (14)
                              
                                 
                                    
                                       β
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          β
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                
                                                   p
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ,
                                                            …
                                                            ,
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  N
                                                               
                                                            
                                                            |
                                                            β
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          μ
                                          P
                                          (
                                          β
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              μ
                           
                         controls the trade-off between the two terms. Empirically we found 
                           
                              μ
                              =
                              0.05
                           
                         works well in our implementation. Initially, we set 
                           
                              β
                              =
                              
                                 
                                    [
                                    1
                                    
                                    1
                                    
                                    1
                                    
                                    1
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         because we have no previous knowledge about which ratio in Eq. (11) plays a more important role. Thus, we use 
                           
                              P
                              (
                              β
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    -
                                    1
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        . Accordingly, the stochastic gradient update of the jth element of 
                           
                              β
                           
                         becomes:
                           
                              (15)
                              
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 ←
                                 
                                    
                                       β
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 λ
                                 
                                    
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          Δ
                                          
                                             
                                                r
                                             
                                             
                                                ij
                                             
                                          
                                          -
                                          2
                                          μ
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          1
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Since we match both the dominant orientation templates and the color templates to the input image, the overall computational load is drastically increased compared with matching the dominant orientation templates alone. To compensate for the slowdown in the object detection process, we come up with a speed-up strategy. In particular, we create two matrices, called the Cluster Dissimilarity Matrix (CDM) and the Cluster Dissimilarity Index Matrix (CDIM), to efficiently rule out those cluster templates not likely to be successfully matched. Prior to the discussion of the speed-up strategy, we first briefly describe below the so called “cluster templates”.

For the construction of a library of template images for an object of interest, we collect many views of the object under different poses and scales, and for each of the views we build the corresponding dominant orientation template and the color template. Like the DOT method, the templates are clustered into cluster templates. A cluster template is generated by uniting several templates similar in appearances. The similarity between two templates is measured by the Hamming distance between their bit string representations.
                           3
                           The Hamming distance between two strings of equal length is the number of positions at which the corresponding symbols are different. The smaller the distance, the more similar the two strings. For example, given three strings (a) 10111011, (b) 11010011, and (c) 10111010, the Hamming distance between (a) and (b) is 3, while the Hamming distance between (a) and (c) is 1. Obviously, (c) is more similar to (a) compared with (b). As our cluster templates are also represented using bit strings, the similarity between them can also be measured by the Hamming distance.
                        
                        
                           3
                         Since in our case a template image has two representations, the dominant orientation representation and the color representation, we have two corresponding bit strings. In light of this, the Hamming distance between two template images is computed based on their respective concatenations of the two bit strings. Accordingly, our cluster templates each also have two bit string representations; each representation is the union of the associated dominant orientation or color templates. An example of a cluster template generated by uniting the DOT and color representations of three template images is shown in Fig. 3
                        . Only when a cluster template is matched that the successive templates belonging to the cluster template will be tested.

Now let us assume that we have a total of 
                           
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                           
                         cluster templates for an object of interest. To illustrate the idea of CDM and CDIM, we use the DOT representation as an example. Given the DOT representations of cluster template i and cluster template j (
                           
                              1
                              ⩽
                              i
                              ,
                              j
                              ⩽
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                           
                        ), 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                        , we count the number of non-zero 
                           
                              L
                              (
                              O
                              ,
                              R
                              )
                           
                         in them, denoted as 
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                           
                        , respectively. We then proceed to tally up the number of small regions that are mutually matchable between 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                        , denoted by 
                           
                              
                                 
                                    n
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        . We call 
                           
                              R
                           
                         a mutually matchable region if 
                           
                              L
                              (
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              R
                              )
                              ∩
                              L
                              (
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              R
                              )
                              
                              ≠
                              
                              ∅
                           
                        , that is, 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         have at least one common dominant orientation in 
                           
                              R
                           
                        . Now define the 
                           
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                              ×
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                           
                         
                        Cluster Dissimilarity Matrix (CDM) whose 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         entry is 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    n
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        , and whose 
                           
                              (
                              j
                              ,
                              i
                              )
                           
                         entry is 
                           
                              CDM
                              (
                              j
                              ,
                              i
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    n
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        . The CDM measures how dissimilar cluster template i is to cluster template j. For example, 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    n
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         is the number of non-zero 
                           
                              L
                              (
                              O
                              ,
                              R
                              )
                           
                         in 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         that are dissimilar to the non-zero 
                           
                              L
                              (
                              O
                              ,
                              R
                              )
                           
                         in 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                        .

Let us assume a situation where 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                         fails to match to input image 
                           
                              I
                           
                         at location 
                           
                              c
                           
                        , while 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         succeeds in matching to 
                           
                              I
                           
                         at the same location, as shown in Fig. 4
                        . Mathematically, this means 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                              <
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         is a pre-defined threshold. Furthermore, assume that among the mutually matchable regions between 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         of them contribute to both 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                           
                        . In order for 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         to hold, we must have a sufficient number of dissimilar 
                           
                              L
                              (
                              O
                              ,
                              R
                              )
                           
                         in 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         with respect to 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                        . Dividing 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                           
                         into two parts, 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              =
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        , we must have
                           
                              (16)
                              
                                 CDM
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 >
                                 
                                    
                                       m
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       ε
                                    
                                    
                                       DOT
                                    
                                 
                                 (
                                 I
                                 ,
                                 
                                    
                                       DOT
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 c
                                 )
                                 -
                                 
                                    
                                       m
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ⩾
                                 
                                    
                                       ε
                                    
                                    
                                       D
                                    
                                 
                                 -
                                 
                                    
                                       m
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 >
                                 
                                    
                                       ε
                                    
                                    
                                       D
                                    
                                 
                                 -
                                 
                                    
                                       ε
                                    
                                    
                                       DOT
                                    
                                 
                                 (
                                 I
                                 ,
                                 
                                    
                                       DOT
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 c
                                 )
                                 .
                              
                           
                        To clarify the first inequality in Eq. (16), 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        , note that 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                           
                         is contributed by two types of non-zero regions in 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                        ; the first type is 
                           
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         mutually matchable regions between 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                        , while the other type is from the non-zero regions of 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         that are completely dissimilar from those non-zero regions of 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                        . Since 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                           
                         is the total of such dissimilar regions of 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                        , and not all of them will contribute to 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                           
                        , we must have 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                           
                        . To clarify the second inequality in Eq. (16), 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        , note that 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                        . The third inequality 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              >
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              -
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                         of In Eq. (16) holds because 
                           
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              <
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                        . Combining the second and third inequality, we have 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              >
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              -
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                        .

Below we use an incarnation of Fig. 4 to verify Eq. (16). Let us assume a simple yet illustrative configuration of 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         and the sub-region of input image 
                           
                              I
                           
                         at location 
                           
                              c
                           
                        , denoted 
                           
                              I
                              (
                              c
                              )
                           
                        , each containing five non-zero bytes. Further, let 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              =
                              3
                           
                        . Their configurations and the bitwise AND results of the corresponding bytes are listed in Table 1
                        , from which it can be seen that 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                              =
                              2
                              <
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              ,
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              =
                              3
                              =
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              2
                              ,
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              1
                              ,
                              
                                 
                                    m
                                 
                                 
                                    j
                                 
                              
                              =
                              2
                           
                        , and 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              =
                              
                                 
                                    n
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    n
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              3
                           
                        . It is easy to verify that all the relationships in Eq. (16) hold.

Now let us consider the following problem: if a cluster template 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                           
                         fails to match to 
                           
                              I
                              (
                              c
                              )
                           
                        , i.e., 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                              <
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                        , how should we decide whether another cluster template 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         could potentially match to 
                           
                              I
                              (
                              c
                              )
                           
                         (namely 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                        ) without explicitly computing 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                           
                        , given that we know 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                         and 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                           
                        ? Obviously, if 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        , then 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         is promising to be matched to 
                           
                              I
                              (
                              c
                              )
                           
                        . However, since 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         are both unknown, we are not able to determine whether or not 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         holds. Nevertheless, from In Eq. (16) we know that if 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         holds, we must at least have 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              -
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                        . If 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              ⩽
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              -
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                        , we immediately know that 
                           
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                           
                         cannot be promising; on the other hand, if 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                           
                         is considerably larger than 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              -
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                           
                        , hopefully the condition 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    j
                                 
                              
                              ,
                              c
                              )
                              -
                              
                                 
                                    m
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         might also be met. For this reason, we require that 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              r
                              
                                 
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             D
                                          
                                       
                                       -
                                       
                                          
                                             ε
                                          
                                          
                                             DOT
                                          
                                       
                                       (
                                       I
                                       ,
                                       
                                          
                                             DOT
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       c
                                       )
                                    
                                 
                              
                           
                        , where 
                           
                              r
                              (
                              ⩾
                              1
                              )
                           
                         is a positive real number, called acceleration coefficient in this paper. Since r cannot be analytically solved, its suitable value is empirically determined which has proven to work well in all the experiments. This way, our speed-up strategy applied to the DOT representations is described as: if 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              
                                 
                                    DOT
                                 
                                 
                                    i
                                 
                              
                              ,
                              c
                              )
                              <
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                        , eliminate the jth cluster templats whose 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                           
                         is less than 
                           
                              r
                              
                                 
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             D
                                          
                                       
                                       -
                                       
                                          
                                             ε
                                          
                                          
                                             DOT
                                          
                                       
                                       (
                                       I
                                       ,
                                       
                                          
                                             DOT
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       c
                                       )
                                    
                                 
                              
                           
                        . When r ranges from small to large, the proposed speed-up strategy performs from conservatively to aggressively: the smaller the r, the slower the detection process, as more cluster templates are considered; to the contrary, the larger the r, the faster the detection process, but at the risk of eliminating promising cluster templates and increasing detection misses. Since the CDM is not symmetric, in our implementation, we sort each row of CDM in ascending order, and at the same time store the corresponding j indices into the CDIM. This enables us to set a “cutoff” threshold such that, when we traverse the i th row of 
                           
                              CDM
                           
                         and encounter some j for which 
                           
                              CDM
                              (
                              i
                              ,
                              j
                              )
                              >
                              r
                              
                                 
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             D
                                          
                                       
                                       -
                                       
                                          
                                             ε
                                          
                                          
                                             DOT
                                          
                                       
                                       (
                                       I
                                       ,
                                       
                                          
                                             DOT
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       c
                                       )
                                    
                                 
                              
                           
                         is met, the remaining entries of 
                           
                              CDIM
                           
                         in this row beyond j are considered promising. Now let us clarify this strategy with a simple example. Assume that we have four cluster templates indexed from one to four, and 
                           
                              CDM
                              (
                              1
                              ,
                              1
                              )
                              =
                              0
                              ,
                              CDM
                              (
                              1
                              ,
                              2
                              )
                              =
                              6
                              ,
                              CDM
                              (
                              1
                              ,
                              3
                              )
                              =
                              4
                              ,
                              CDM
                              (
                              1
                              ,
                              4
                              )
                              =
                              7
                           
                        . Note that according to our definition of CDM, 
                           
                              CDM
                              
                                 
                                    (
                                    i
                                    ,
                                    i
                                    )
                                 
                                 
                                    i
                                    =
                                    1
                                    -
                                    4
                                 
                              
                           
                         must be zero. After sorting the values of 
                           
                              CDM
                              (
                              1
                              ,
                              1
                              )
                           
                        -
                           
                              CDM
                              (
                              1
                              ,
                              4
                              )
                           
                         in ascending order, the first row of 
                           
                              CDM
                           
                         is {0, 4, 6, 7} while the first row of 
                           
                              CDIM
                           
                         is {1, 3, 2, 4}. Now if we judge cluster template #2 as “promising”, we immediately know that all the cluster templates whose indices are ranked after “2” in 
                           
                              CDIM
                           
                         must also be promising (because they have even larger 
                           
                              CDM
                           
                         values). In this simple example, cluster template #4 is also promising.
                           Algorithm 1
                           The proposed speed-up strategy for fast eliminating unpromising cluster templates at location 
                                 
                                    c
                                 
                               of input image 
                                 
                                    I
                                 
                               
                              
                                 
                                    
                                       
                                       
                                          
                                             1: Initialize a Boolean array 
                                                   
                                                      A
                                                   
                                                 of length 
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                   
                                                , setting all elements of 
                                                   
                                                      A
                                                   
                                                 to true
                                          
                                          
                                             2: for 
                                                
                                                
                                                   
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             3: 
                                                if 
                                                
                                                
                                                   
                                                      A
                                                      (
                                                      i
                                                      )
                                                      =
                                                      =
                                                      true
                                                   
                                                 
                                                
                                                then
                                             
                                          
                                          
                                             4: Compute 
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            DOT
                                                         
                                                      
                                                      (
                                                      I
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      c
                                                      )
                                                   
                                                 (Eq. (4)) and 
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            COLOR
                                                         
                                                      
                                                      (
                                                      I
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      c
                                                      )
                                                   
                                                 (Eq. (4)), where 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                 is the Ith cluster template
                                          
                                          
                                             5: 
                                                if 
                                                
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            DOT
                                                         
                                                      
                                                      
                                                      (
                                                      I
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      c
                                                      )
                                                      ⩾
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                      
                                                      ∧
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            COLOR
                                                         
                                                      
                                                      
                                                      (
                                                      I
                                                      ,
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      c
                                                      )
                                                      ⩾
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                   
                                                 
                                                
                                                then
                                             
                                          
                                          
                                             6: Test each template that belongs to 
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             7: 
                                                else
                                             
                                          
                                          
                                             8: 
                                                
                                                   
                                                      ▷
                                                   
                                                 for DOT representation
                                          
                                          
                                             9: 
                                                for 
                                                
                                                
                                                   
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                   
                                                 
                                                
                                                do
                                             
                                          
                                          
                                             10: 
                                                
                                                if 
                                                
                                                
                                                   
                                                      
                                                         
                                                            CDM
                                                         
                                                         
                                                            DOT
                                                         
                                                      
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      <
                                                      r
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     D
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     DOT
                                                                  
                                                               
                                                               (
                                                               I
                                                               ,
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               c
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                 
                                                
                                                then
                                             
                                          
                                          
                                             11: 
                                                
                                                
                                                   
                                                      A
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     CDIM
                                                                  
                                                                  
                                                                     DOT
                                                                  
                                                               
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                      =
                                                      false
                                                   
                                                
                                             
                                          
                                          
                                             12: 
                                                
                                                else
                                             
                                          
                                          
                                             13: 
                                                break this loop
                                          
                                          
                                             14: 
                                                
                                                end if
                                             
                                          
                                          
                                             15: 
                                                end for
                                             
                                          
                                          
                                             16: 
                                                
                                                   
                                                      ▷
                                                   
                                                 for color representation
                                          
                                          
                                             17: 
                                                for 
                                                
                                                
                                                   
                                                      j
                                                      =
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                   
                                                 
                                                
                                                do
                                             
                                          
                                          
                                             18: 
                                                
                                                if 
                                                
                                                
                                                   
                                                      
                                                         
                                                            CDM
                                                         
                                                         
                                                            COLOR
                                                         
                                                      
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      <
                                                      r
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     C
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     ε
                                                                  
                                                                  
                                                                     COLOR
                                                                  
                                                               
                                                               (
                                                               I
                                                               ,
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               ,
                                                               c
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                 
                                                
                                                then
                                             
                                          
                                          
                                             19: 
                                                
                                                
                                                   
                                                      A
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     CDIM
                                                                  
                                                                  
                                                                     COLOR
                                                                  
                                                               
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                      =
                                                      false
                                                   
                                                
                                             
                                          
                                          
                                             20: 
                                                
                                                else
                                             
                                          
                                          
                                             21: 
                                                break this loop
                                          
                                          
                                             22: 
                                                
                                                end if
                                             
                                          
                                          
                                             23: 
                                                
                                                end for
                                             
                                          
                                          
                                             24: 
                                                end if
                                             
                                          
                                          
                                             25: 
                                                end if
                                             
                                          
                                          
                                             26: end for
                                             
                                          
                                       
                                    
                                 
                              
                           

Since our cluster templates have two associated representations, the DOT representation and the color representation, we build offline two separate CDMs for each representations, along with two corresponding CDIMs.
                           4
                           An alternative is to arrange the cluster templates using a graph. In this regard, we need to construct an adjacency list for each cluster template, which accommodates cluster templates that are similar (in terms of the Hamming distance) in appearance to that cluster template. If a cluster template is judged as “unpromising”, we can skip all the cluster templates in its adjacency list so that they will not be considered.
                        
                        
                           4
                         Denoting them as 
                           
                              
                                 
                                    CDM
                                 
                                 
                                    DOT
                                 
                              
                              ,
                              
                                 
                                    CDM
                                 
                                 
                                    COLOR
                                 
                              
                              ,
                              
                                 
                                    CDIM
                                 
                                 
                                    DOT
                                 
                              
                           
                         and 
                           
                              
                                 
                                    CDIM
                                 
                                 
                                    COLOR
                                 
                              
                           
                        , respectively, we present below our speed-up strategy in Algorithm 1.

In Algorithm 1, 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                           
                         is another pre-defined threshold. Finally, it is worth pointing out that the binary-tree search strategy of [24] is not suitable to our case where the cluster templates are arranged in a “circular” manner (as shown in Fig. 5
                        ). 
                           5
                           Note that there is no actual image corresponding to a cluster template. For this reason, in Fig. 5 template images are shown instead for the purpose of illustration.
                        
                        
                           5
                         By contrast, in [24] the views of an object are artificially generated by warping a single reference image, and therefore can be efficiently arranged in a tree structure.

Matching both the DOT templates and the color templates to the input image are performed using the SSE technology by processing 16bytes in parallel. To make a detailed complexity analysis of the proposed method, several assumptions are made below along with the corresponding analyses.
                           
                              (1)
                              A template image is divided into 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                    
                                  disjoint small square regions. Under this assumption, 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      16
                                                   
                                                
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      8
                                                   
                                                
                                             
                                          
                                       
                                    
                                  SSE bit-wise AND operations, respectively, are required to match the template image’s DOT representation and color representation to input image 
                                    
                                       I
                                    
                                  at specified location 
                                    
                                       c
                                    
                                 . This also applies to a cluster template, as it is generated by ORing its associated templates.

There are a total of 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             C
                                          
                                       
                                    
                                  cluster templates for an object of interest, each cluster template having 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             A
                                          
                                       
                                    
                                  associated DOT and color templates; among the 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             C
                                          
                                       
                                    
                                  cluster templates, only 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             C
                                          
                                       
                                    
                                  (
                                    
                                       0
                                       <
                                       
                                          
                                             r
                                          
                                          
                                             T
                                          
                                       
                                       <
                                       1
                                    
                                 ) of them are promising cluster templates. To match each promising cluster template and its associated templates to the input image, we need to perform 
                                    
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             A
                                          
                                       
                                       +
                                       1
                                       )
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               16
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                  SSE bit-wise AND operations.

For the remaining 
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             r
                                          
                                          
                                             T
                                          
                                       
                                       )
                                       
                                          
                                             N
                                          
                                          
                                             C
                                          
                                       
                                    
                                  unpromising cluster templates, when eliminating one cluster template, we can rule out 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                    
                                  (
                                    
                                       >
                                       1
                                    
                                 ) cluster templates from further consideration that are similar to it using 
                                    
                                       
                                          
                                             CDM
                                          
                                          
                                             DOT
                                          
                                       
                                       ,
                                       
                                          
                                             CDM
                                          
                                          
                                             COLOR
                                          
                                       
                                       ,
                                       
                                          
                                             CDIM
                                          
                                          
                                             DOT
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             CDIM
                                          
                                          
                                             COLOR
                                          
                                       
                                    
                                 . Note that compared with the complexity of judging one unpromising cluster template (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               16
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                  SSE bit-wise AND operations), the complexity of eliminating its similar counterparts consists of only “<” comparison operations and is thus negligible. This way, the complexity of eliminating all the unpromising cluster templates is approximately 
                                    
                                       
                                          
                                             (
                                             1
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                             
                                                
                                                   N
                                                
                                                
                                                   C
                                                
                                             
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   B
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               16
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                  SSE bit-wise AND operations.

Based on the above assumptions and analyses, we show below that the proposed method can be even faster than the DOT method, whose complexity is approximately 
                           
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                              (
                              
                                 
                                    N
                                 
                                 
                                    A
                                 
                              
                              +
                              1
                              )
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   R
                                                
                                             
                                          
                                          
                                             16
                                          
                                       
                                    
                                 
                              
                              +
                              (
                              1
                              -
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              )
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   R
                                                
                                             
                                          
                                          
                                             16
                                          
                                       
                                    
                                 
                              
                              =
                              (
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    A
                                 
                              
                              +
                              1
                              )
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   R
                                                
                                             
                                          
                                          
                                             16
                                          
                                       
                                    
                                 
                              
                           
                         SSE bit-wise AND operations. By contrast, the complexity of the proposed method is approximately 
                           
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                              (
                              
                                 
                                    N
                                 
                                 
                                    A
                                 
                              
                              +
                              1
                              )
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      16
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      8
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    (
                                    1
                                    -
                                    
                                       
                                          r
                                       
                                       
                                          T
                                       
                                    
                                    )
                                    
                                       
                                          N
                                       
                                       
                                          C
                                       
                                    
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          B
                                       
                                    
                                    +
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      16
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      8
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             T
                                          
                                       
                                       (
                                       
                                          
                                             N
                                          
                                          
                                             A
                                          
                                       
                                       +
                                       1
                                       )
                                       +
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   B
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      16
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      8
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         SSE bit-wise AND operations. The ratio of the latter to the former is
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      T
                                                   
                                                
                                                (
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      A
                                                   
                                                
                                                +
                                                1
                                                )
                                                +
                                                
                                                   
                                                      1
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             C
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               16
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                            
                                                            
                                                               8
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             r
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             A
                                          
                                       
                                       +
                                       1
                                       )
                                       
                                          
                                             N
                                          
                                          
                                             C
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      16
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       3
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      T
                                                   
                                                
                                                (
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      A
                                                   
                                                
                                                +
                                                1
                                                )
                                                +
                                                
                                                   
                                                      1
                                                      -
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             A
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 .
                              
                           
                        In Eq. (17), we assume that 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      16
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                   
                                                      8
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ≈
                              3
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   R
                                                
                                             
                                          
                                          
                                             16
                                          
                                       
                                    
                                 
                              
                           
                        . For example, if 
                           
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              =
                              0.05
                              ,
                              
                                 
                                    N
                                 
                                 
                                    A
                                 
                              
                              =
                              4
                              ,
                              
                                 
                                    N
                                 
                                 
                                    B
                                 
                              
                              =
                              8
                           
                        , the above ratio is 
                           
                              
                                 
                                    3
                                    ∗
                                    [
                                    0.05
                                    ∗
                                    (
                                    4
                                    +
                                    1
                                    )
                                    +
                                    (
                                    1
                                    -
                                    0.05
                                    )
                                    /
                                    (
                                    8
                                    +
                                    1
                                    )
                                    ]
                                 
                                 
                                    0.05
                                    ∗
                                    4
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    1.07
                                 
                                 
                                    1.2
                                 
                              
                              =
                              0.89
                           
                        .

Finally, it is worth pointing out that our acceleration strategy is inexact, as the 
                           
                              (
                              1
                              -
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                              )
                              
                                 
                                    N
                                 
                                 
                                    C
                                 
                              
                           
                         cluster templates we judge as “unpromising” and subsequently eliminated from consideration might contain matchable templates. In addition, 
                           
                              
                                 
                                    r
                                 
                                 
                                    T
                                 
                              
                           
                         is indirectly determined by the acceleration coefficient r. As will be seen in Section 3.1, the larger the r, the higher the risk of eliminating promising cluster templates which will in turn increase miss detection rates. However, with a suitable choice of r, we can achieve a much increased speed of the proposed method while at a low risk of missing detections.

@&#EXPERIMENTAL RESULTS@&#

We implement the proposed method using Microsoft Visual Studio® 2008 in conjunction with Intel® OpenCV and Intel® Integrated Performance Primitives (IPP) 6.0. First, in Section 3.1 we use one object to determine a suitable value for the acceleration coefficient r and the weights vector 
                        
                           β
                        
                     , which is used in Eq. (11). After that, we test the proposed method on three datasets. The first dataset was constructed by us and contains five objects. We present the experimental results on this dataset in Section 3.2, in which we also compare the proposed method against two benchmark methods, the original DOT method [5] and the LINE-2D method [21], due to their public availability (for the DOT method) and sufficient implementation details (for the LINE-2D method). Then in Section 3.3, we test the proposed method on a 30-object dataset and compare its performance with that of a state-of-the-art method [13]. The challenge of this dataset is that all the 30 objects will be investigated together in searching an image. Finally, we present the experimental results of testing the proposed method on another publically available dataset [26] in Section 3.4. Contrast to the 30-object dataset [13] in which the objects have limited changes in their poses and almost no occlusions, the objects in this dataset undergo various viewpoint and illumination changes and in some cases, are subject to considerable occlusions. We also compare the performance of the proposed method with that of another state-of-the-art method [26]. The two above-mentioned state-of-the-art methods have proven to outperform the DOT method and the LINE-2D method. As will be seen in Sections 3.3 and 3.4, the proposed method compares favorably with these two methods. The experiments reported below are run on a DELL® laptop equipped with an Intel® Core® i5-2450 @ 2.50GHz CPU, 4GB memory, and 32-bit Windows® 7.

We use the “stapler” test image sequence of dataset [26] to determine r and 
                           
                              β
                           
                        . The specifics of dataset [26] are seen in Section 3.4. Our strategy is to first solve for the optimal 
                           
                              β
                           
                        , and then seek a suitable r.

First, we construct a library of templates for this particular object using all its 1025 training images. Then, in each frame of the “stapler” test image sequence, we use all the template images to search for the object, keeping all matches that satisfy 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              O
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    COLOR
                                 
                              
                              (
                              I
                              ,
                              O
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                           
                         at location 
                           
                              c
                           
                         of the frame, where 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              =
                              60
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                              =
                              50
                           
                         are two pre-selected thresholds. From these matches, we choose a “correct” match that is close to the ground truth
                           6
                           The ground truth is available from the dataset.
                        
                        
                           6
                         (the overlap between the matched template and the ground truth bounding box exceeds 70%), and an “incorrect” match which is far from the ground truth. Denoting the correct match and the incorrect match by 
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                        , respectively, and their difference 
                           
                              Δ
                              r
                              =
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              -
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                        , we wish that 
                           
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              Δ
                              r
                              >
                              0
                           
                        . Recall that in Section 2.2, in order for logistic regression to work, we need to construct two classes 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                        , such that 
                           
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              Δ
                              r
                              >
                              0
                           
                         for 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                              
                              Δ
                              r
                              <
                              0
                           
                         for 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                        . In our implementation, we randomly divide the 
                           
                              Δ
                              r
                           
                        s into two classes, with a half of the 
                           
                              Δ
                              r
                           
                        s assigned into the first class and the remaining half of them negated and assigned into the other class. Running the logistic regression for ten epochs, we achieve 
                           
                              β
                              =
                              
                                 
                                    [
                                    1.23
                                    
                                    1.21
                                    
                                    2.03
                                    
                                    1.14
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         which will be used for all the remaining experiments reported in this paper.

Recall that the role of r is to balance the detection misses and the detection speed. To explore the impact of r on these two factors, at given values of 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                           
                         we vary the value of r and record the resulting detection miss rate and detection time. The detection time is defined as the average time used for object detection in one frame. To calculate the detection miss rate, if a template image 
                           
                              O
                           
                         of the object satisfies both 
                           
                              
                                 
                                    ε
                                 
                                 
                                    DOT
                                 
                              
                              (
                              I
                              ,
                              O
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    COLOR
                                 
                              
                              (
                              I
                              ,
                              O
                              ,
                              c
                              )
                              ⩾
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                           
                         at location 
                           
                              c
                           
                         of a frame 
                           
                              I
                           
                        , we compare 
                           
                              c
                           
                         with the ground truth; if in addition 
                           
                              c
                           
                         is close to the ground truth, we say an instance of the object has been detected. If for a frame no instances of the object are detected, we call it a detection miss. The detection miss rate is defined as the total number of detection misses divided by the number of frames in the test image sequence. The results for three different sets of 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                           
                         are given in Fig. 6
                        , in which we can see that the detection time uniformly decreases as r is increased. Also can be seen from Fig. 6, one should choose r according to 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                           
                        : when they are low (e.g., 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              =
                              50
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                              =
                              40
                           
                        ), choosing a large r can still maintain a very low detection miss rate; however, when 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                           
                         are high (e.g., 
                           
                              
                                 
                                    ε
                                 
                                 
                                    D
                                 
                              
                              =
                              70
                           
                         and 
                           
                              
                                 
                                    ε
                                 
                                 
                                    C
                                 
                              
                              =
                              60
                           
                        ), a relatively small r should be chosen.

In this section, first we present the details of building a library of templates for each of the five objects and clustering, as well as establishing the ground truth for the experiments. Then, we compare the proposed method with the DOT method and the LINE-2D method on this dataset. The source code of the DOT method (DOT v. 1.0) is publicly available from [43] which is written in C++ in conjunction with Intel® OpenCV and Intel® IPP, enabling us to compare the proposed method with it on a fair basis in terms of running time. As of the writing of the paper, the source code of the LINE-2D method is not publicly available, so we implement it in our own version, also using Intel® OpenCV and Intel® IPP where possible.

For an object of interest, we build its library of template images (called “library” for short afterwards) as follows. To begin with, we put the object in a clean background, and move a camera around it to capture an image sequence of the object under various viewpoints. Next, we manually choose a region containing the object as a template in the first frame of the image sequence, and track it in subsequent frames using the Normalized Cross Correlation (NCC) matching measure. To account for the constantly changing appearances of the object, we manually reset the template after every 100 frames. This way, we obtain the trajectory of the object in the image sequence. Then, we begin to detect the object from the first frame of the image sequence using the DOT method. To avoid the unnecessary search of the object through each whole frame of the image sequence, the detection is only conducted near the object’s location in each frame. At the beginning of this stage, the library contains only one template image, clipped from the first frame of the image sequence at the object’s location. If the matching measure (Eq. (4)) of the template image to the current frame is lower than a threshold, we add a second template image to the library, generated by clipping a region from the current frame at the object’s location. Then for the next frame of the image sequence, we use both template images to detect the object. This strategy can be generated as: if at a given frame all the matching measures (Eq. (4)) of the template images in the library for this frame are lower than a threshold, augment the library by generating a new template image clipped from this frame at the object’s location. To account for scale changes, during this stage we scale each frame of the image sequence from 0.8 to 1.2 times and repeat the detection in each of the scaled frames. In addition, we flip the template images from left to right to further increase the instances of the object. Note that at the moment, the library is built solely based on the DOT representations. When the color representations are also considered, there will be a redundancy of the template images, because the discriminability of each template image is enhanced. For this reason, we finally decimate the template images in the library. In our implementation, we keep about one third of the template images in the library. The DOT and color representations of the template images are further clustered as described in Section 2.3, with one cluster template having up to four associated DOT and color representations. In all, we have five objects whose representative template images are shown in Fig. 7
                            and the number of template images for each object summarized in Table 2
                           . Note that due to their relatively simpler shapes, the tape measure and the flashlight have much fewer template images than the other three objects.

All the template images are of equal size, 
                              
                                 100
                                 ×
                                 100
                              
                            pixels, and divided into 
                              
                                 
                                    
                                       N
                                    
                                    
                                       R
                                    
                                 
                              
                            disjoint small square regions of 
                              
                                 7
                                 ×
                                 7
                              
                            pixels. We choose 
                              
                                 
                                    
                                       N
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 13
                                 ×
                                 13
                                 =
                                 169
                              
                            through all the experiments reported in this section.

The proposed method is run on a few image sequences in the remaining experiments reported in this section. To investigate the results yielded by the proposed method, the ground truth of the objects’ locations in these image sequences needs to be established. For this purpose, we annotate a rectangular bounding box which closely encloses the object of interest in each frame of the image sequences, a technique so far the most commonly used in the visual object tracking community [45,46]. In a very recent survey paper on visual object tracking, Smeulders et al. [45] manually annotate their Amsterdam Library of Ordinary Videos (ALOV++) dataset using a rectangular bounding box of flexible size every fifth frame. The ground truth for the intermediate frames is acquired by linear interpolation. Using annotated bounding boxes as the ground truth has also been adopted in the 2014 Visual Object Tracking Challenge (VOT2014) [46]. Since we also detect the objects in consecutive image sequences, it is reasonable for us to annotate the objects in the image sequences and use the results as the ground truth.

To avoid the tedious work of annotating every frame of the image sequences, we adopt a semi-automatic method for this purpose. Specifically, we manually select the object in the first frame of an image sequence, and subsequently track it using the inverse compositional algorithm of [47], which is a Lucas-Kanade-type tracker that can yield sub-pixel tracking results. We monitor the tracking results in terms of the Sum of Square Differences (SSD) measure, that is, if the SSD between the selected object and its matched portion in the current frame exceeds a given threshold, we re-select the object in the current frame and restart the tracking. This way, we end up with a trajectory of the bounding boxes’ locations in the image sequence. This method works well for image sequences that have few occlusions to the objects. However, when there exists considerable occlusions to the object, it would be difficult for us to place an appropriate bounding box to enclose the object. In this case, we manually choose one template from the object’s library of template images that is most similar in appearance to the occluded object, align the template to the object and overlay the results on the current frame. Then, we can easily place a bounding box around the (warped) template which overlaps with the occluded object.

Like the proposed method, the DOT representations of the template images in the DOT method are also clustered such that one cluster template has up to four associated DOT representations. For the LINE-2D method, the Gradient Response Map (GRM) of each template image has approximately 100 gradients, as suggested in [21]. The acceleration coefficient r is set to 4 for the proposed method.

Our first experiment is done on an image sequence of 1162 frames containing all the five objects, each frame having 
                              
                                 640
                                 ×
                                 480
                              
                            pixels. The five objects appear in each frame of the image sequence, which also has a very cluttered background containing some other objects. We use 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 30
                              
                            and 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 20
                              
                            for the proposed method and 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 30
                              
                            for the DOT method. As to the LINE-2D method, we require that the 
                              
                                 ε
                                 (
                                 I
                                 ,
                                 T
                                 ,
                                 c
                                 )
                              
                            (see Eq. (7) of [21]) be larger than 40 in order for an object instance to be detected. For the proposed method and the DOT method, at each specified location 
                              
                                 c
                              
                            of a frame 
                              
                                 I
                              
                           , we search for an object instance with all the cluster templates (and the promising cluster templates’ associated DOT or DOT/color templates), keeping the best match along with the corresponding object label and template image. The “best match” is the one that achieves the maximal 
                              
                                 
                                    
                                       m
                                    
                                    
                                       combined
                                    
                                 
                                 (
                                 I
                                 ,
                                 O
                                 ,
                                 c
                                 )
                              
                            (Eq. (11)) for the proposed method, or the maximal 
                              
                                 
                                    
                                       m
                                    
                                    
                                       DOT
                                    
                                 
                              
                            (Eq. (9)) for the DOT method. This way, when the search in the whole frame is finished, we end up with a list of detection results for each of the five objects. We choose from the list of a given object the element that has the largest 
                              
                                 
                                    
                                       m
                                    
                                    
                                       combined
                                    
                                 
                                 (
                                 I
                                 ,
                                 O
                                 ,
                                 c
                                 )
                              
                            or 
                              
                                 
                                    
                                       m
                                    
                                    
                                       DOT
                                    
                                 
                              
                           , and compare the object label and the location of the detected object instance with the ground truth. If the detected object instance and the ground truth’s object labels agree and meanwhile their locations are close, we call the detection result a correct one; otherwise, we call the detection result a false one. For the LINE-2D method, no clustering is applied and all the specified locations 
                              
                                 c
                              
                            are searched simultaneously using a given GRM, as in [21]. Thus, for each of the specified locations 
                              
                                 c
                              
                           , we keep the best match that has the largest 
                              
                                 ε
                                 (
                                 I
                                 ,
                                 T
                                 ,
                                 c
                                 )
                              
                            (Eq. (7) of [21]) using all the GRMs, along with the corresponding object label and template image. We then compare the detection results with the ground truth in the same manner as the proposed method and the DOT method. The correct detection rate and the false detection rate for each of the five objects using the three methods are summarized in Table 3
                           , along with the average running times per frame. The correct detection rate and false detection rate are defined, respectively, as the number of correct detections and the number of false detections divided by the total number of frames. Some examples of testing the three methods are shown in Fig. 8
                           .

From Table 3, the proposed method outperforms the other two methods, due to the fact that it uses both the shape information (encoded in the DOT representation) and the color information (encoded in the color representation). Overall, the LINE-2D method works better than the DOT method, which is also verified in [21], but still performs worse than the proposed method. The reason is that, though the GRMs are constructed from the RGB channels of corresponding template images, they still encodes only the shape information “around” an object’s boundary (where the gradient magnitudes are high), while not considering the information “inside” the object (where the gradient magnitudes are low). The proposed method worked very well for the dolphin, tape measure, flashlight, and stapler object, achieving more than 99% correct detection rate; but only achieved a 83.56% correct detection rate for the massager, because its color is similar to the color of other objects (see the left most image in the second row of Fig. 8) from the perspective of the color name [35] representation. Because the color name representation has a very limited resolution (only 11 colors), it cannot distinguish between colors with same hues but different in saturations, such as light blue and dark blue. This is one limitation of the proposed method.

Our implementation of the LINE-2D method is much slower than the other two methods. We suppose there are two reasons for this. One reason is that unlike the other two methods, the GRMs cannot be clustered in the LINE-2D method and therefore, there is no “early stop” mechanism to stop searches at locations that are not likely to contain an object instance. The other possible reason, however, is that our implementation of the LINE-2D method is not as optimized as its original implementation of [21]. However, in Section 3.4, from experiments run on a same dataset, it will be seen that the proposed method could be much faster than the LINE-2D method.

The image sequence mentioned above has few occlusions to the objects. To test the robustness of the proposed method to occlusions, we put each of the fives objects separately in a complex scene, moving and rotating it with a hand while capturing an image sequence of the scene. This way, we introduce some occlusions to the object in the image sequence. To account for the occlusions, we use 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 20
                              
                            and 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 15
                              
                            for the proposed method and 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 20
                              
                            for the DOT method. We require that the 
                              
                                 ε
                                 (
                                 I
                                 ,
                                 T
                                 ,
                                 c
                                 )
                              
                            (Eq. (7) of [21]) in the LINE-2D method to be larger than 20 in order for an object instance to be detected. We test the image sequences using all the three methods and summarize the results in Table 4
                           . Because there exists heavy occlusions (more than 50% in some cases), we use the 50% PASCAL overlap criterion [44] to define a “correct detection”—that is, if the template image of a detection result has more than a 50% overlap with the ground truth, we call it a correct detection.

From Table 4, the proposed method significantly outperforms the other two methods with some examples shown in Fig. 9
                           . The DOT method and the LINE-2D method perform poorly in these experiments because occlusions decrease the shape discriminability of the objects, resulting in rising mismatches. However, the proposed method still performs quite stably thanks to the color information complementary to shape.

Though the proposed method achieved a high correct detection rate in terms of the 50% PASCAL overlap criterion in these experiments, a close look at the results reveals another limitation of the method, as shown in Fig. 10
                           . Because an object can appear in different sizes in its template images, the proposed method is unable to tell whether the detected object instance is a whole small object or part of a large one.

Finally, it is worth pointing out that all the template images were captured outdoors, while the image sequences used in all the experiments were recorded indoors, showing that the color representation adopted in the proposed method is robust to illumination changes.

The 30-object dataset [13] is so far the richest publicly available dataset that contains the most types of texture-less objects. The biggest challenge with this dataset is that when searching in an image, we should test the templates of all the 30 objects; as some objects are similar in part with each other, one can expect many potential false matches, even if they were laid on a relatively simple background. As will be seen in the following section, this challenge is addressed by representing an object instance using multiple templates along with a verification step to eliminate false matches.

There are two issues with the 30-object dataset [13]. First, though the dataset contains the training images of the objects, they are gray-scale images and thus are not usable in our method. Fortunately, the objects in the testing images undergo limited changes in pose. In view of this fact, we choose one image as training image from all the test images of one particular object, scaling and rotating the image to render the templates for this object. During the testing stage, we leave this image out. The second issue is that in contrast to the previous five-object dataset, in which all the object instances are enclosed into template images of equal size, the objects in this dataset drastically vary in size, some occupying areas of several hundred pixels in width and height (e.g. the headphone), while others being much smaller (e.g. the staple remover). However, to exploit the power of SIMD operations to its greatest extent, we require all the templates are of equal size, like the DOT method. For this reason, we use multiple equal-sized templates to represent a large object, with some examples shown in Fig. 11
                           .

In this regard, on the training image of an object, we anchor the centers of N (N is two or three in this paper) templates at specified locations of the object. Then, when the training image is scaled and rotated, we keep track of these locations on the scaled and rotated training image and center templates at these locations, so that we end up with N sets of templates, each set of templates delineating the various appearances of a portion of the object. At the same time, we record the difference vectors of the centers of the corresponding templates into a list 
                              
                                 
                                    
                                       List
                                    
                                    
                                       vc
                                    
                                 
                              
                            for the later verification purpose. By “corresponding”, we mean a pair of templates that belong to two different sets of templates, but are clipped from the same scaled and rotated training image. We have one or two difference vector(s) per scaled and rotated training image, according to the value of N, as shown in Fig. 11.

All the template images are of equal size, 
                              
                                 149
                                 ×
                                 149
                              
                            pixels, and divided into 
                              
                                 
                                    
                                       N
                                    
                                    
                                       R
                                    
                                 
                                 =
                                 20
                                 ×
                                 20
                                 =
                                 400
                              
                            disjoint small square regions of 
                              
                                 7
                                 ×
                                 7
                              
                            pixels. In all, we collected 3944 template images to construct a library of 64 classes of models to represent the 30 objects in this dataset, with most objects represented by more than one class of model. The DOT and color representations of the template images are further clustered such that one cluster template has up to four associated DOT and color representations. In all, we have 1014 clusters.

We show in Fig. 12
                            successful detection examples of the 30 objects. It can be seen from this figure that most objects are represented by more than one class of model. Some objects, e.g., the“star” and the“scissors”, though large in size, can still be represented by one class of model due to their unique appearances. For a test image 
                              
                                 I
                              
                           , we search at each specified location 
                              
                                 c
                              
                            on the image using all the 64 classes of models, keeping the best match along with the corresponding model label and the center of the matched template image. As in Section 3.2, the “best match” is the one that achieves the maximal 
                              
                                 
                                    
                                       m
                                    
                                    
                                       combined
                                    
                                 
                                 (
                                 I
                                 ,
                                 O
                                 ,
                                 c
                                 )
                              
                            (Eq. (11)). In the case where an object is represented by multiple classes of models, it is expected that if an instance of that object is detected, we should have multiple matched template images, each belonging to a different class of model. In that case, we need to verify whether the matched template images correspond to each other. For this purpose, we compare the difference vectors of the centers of these template images against those difference vectors stored in the list 
                              
                                 
                                    
                                       List
                                    
                                    
                                       vc
                                    
                                 
                              
                            mentioned in Section 3.3.1. Take the “hammer 2” object shown in Fig. 11 as an example and assume that we have constructed a “head” model and a “tail” model for that object. Further, suppose that we find that the ith template image in the “head” model and the jth image in the “tail” model are matched to the test image, and the difference vector of their centers is 
                              
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                              
                           . Then, we use the index i to retrieve from 
                              
                                 
                                    
                                       List
                                    
                                    
                                       vc
                                    
                                 
                              
                            a vector v,
                              7
                              Note that during the construction of 
                                    
                                       
                                          
                                             List
                                          
                                          
                                             vc
                                          
                                       
                                    
                                 , we only keep one direction of the difference vector, e.g. from “head” to “tail” in the “hammer 2” example.
                           
                           
                              7
                            and compute the similarity between v and 
                              
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                              
                           , which is defined as 
                              
                                 sim
                                 (
                                 v
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                min
                                                (
                                                ‖
                                                v
                                                ‖
                                                ,
                                                ‖
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ‖
                                                )
                                             
                                             
                                                max
                                                (
                                                ‖
                                                v
                                                ‖
                                                ,
                                                ‖
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ‖
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                ‖
                                                v
                                                ‖
                                                ‖
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ‖
                                             
                                          
                                       
                                    
                                 
                              
                           . The defined similarity ranges between [0, 1], with a larger value denoting a better matching between v and 
                              
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                              
                           . We require that 
                              
                                 sim
                                 (
                                 v
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⩾
                                 0.75
                              
                            in order for the detection result to be confirmed. Otherwise, it is declined.

The results of applying the proposed method on the test images are compared with the ground truth to calculate the precision and recall of the proposed method. The original ground truth provided by the dataset [13] has only “qualitative” information, in that it only indicates which objects exist in which test images, while not giving the objects’ locations in these test images. For this reason, we use the method described in Section 3.2.2 to obtain the objects’ locations and complement the ground truth.

The proposed method achieves an overall precision/recall performance of 98.78%/88.04%. By judging the detection results of individual objects, we find that the lowest recall rate (about 60%) occurs at the detection of the “tape dispenser” object (an instance is shown in Fig. 12, extreme right in the second row from bottom), because its color is quite similar to the background. The lowest precision rate (about 76%) occurs at the detection of the “wrench” object (an instance is shown in Fig. 12, middle in the third row from top), because its appearance is similar to the “knife” object.

A straightforward comparison between the performance of the proposed method with that of a state-of-the-art method [13] (an overall precision/recall performance of 75%/50%) is not feasible, because the two methods use different training data. Due to the lack of color training images, we render the template images from a small portion of the test images, which could “favor” the detection results, though we exclude these test images from the testing stage. However, as the method of [13] uses a set of training images different from the test images, it is expectable that it yields less excellent results compared with the proposed method. Nevertheless, the proposed method still has two potential advantages, as we argue below. First, the method of [13] has difficulty in detecting particular objects because these objects share similar primitives with other objects. For example, from the confusion matrix of Fig. 4 of [13], we can see that the “hammer 2” object is easily to be misclassified as the “wood” or the “toy” objects, because the three all have long straight contours. However, the proposed method can readily distinguish between these three objects because their distinctive features are captured in different classes of models. Second, the method of [13] verifies the candidate detection results by establishing a homography from the matched template to the input image, followed by an Iterative Closest Edgelet (ICE) refinement which registers the template to the image. This verification step is hard to implement in parallel processing, thus will tend to slow down the overall object detection process if there are many candidate detection results caused by a complex background. By contrast, the verification step we propose in this section is easy to implement, whose running time is negligible compared with that of template searching.

The average running time of the proposed method on the test images is 0.113s, or 8.8fps. To reveal that the proposed method has scalability to the number of templates, we show in Fig. 13
                            the statistics of the fraction of clusters eliminated by the acceleration strategy described in Section 2.3. For every test image, we compute 
                              
                                 
                                    
                                       m
                                    
                                    
                                       combined
                                    
                                 
                                 (
                                 I
                                 ,
                                 O
                                 ,
                                 c
                                 )
                              
                            (Eq. (11)) at each specified location 
                              
                                 c
                              
                            of that test image, and count the number of eliminated clusters into a binned histogram, which is normalized such that the area under the distribution is unity. It can be seen from Fig. 13 that in most cases (more than 90%) the proposed method can eliminate 90–94% template clusters from being considered.

In this section, we present the experimental results of testing the proposed method on a nine-object dataset [26].
                           8
                           Rios-Cabrera et al. use a 12-object dataset to test their methods in [26]. However, only ten objects in this dataset are publicly available. Of the ten objects, we use the “stapler” object to determine the acceleration coefficient r and the weights vector 
                                 
                                    β
                                 
                               (Section 3.1). Therefore, we use the remaining nine objects to test the proposed method.
                        
                        
                           8
                         All the nine objects have both color training images and test images of 
                           
                              640
                              ×
                              480
                           
                         pixels, along with the ground truth of these objects’ locations in their associated images.
                           9
                           Note that in a test image of a given object, though there exists other objects besides this particular one, the ground truth only covers this object’s location in the test image.
                        
                        
                           9
                         In their respective test images, all the nine objects undergo various viewpoint changes, and in some cases are subject to considerable occlusions and drastic illumination changes.

During the training stage, we use all the training images (around 1000) and the ground truth of an object to build a library of templates for that object. To compare with the two methods of [26], the DTT (Discriminatively Trained Templates) method and the DTT-OPT (DDT Optimized Scheme) method, we divide each template image into disjoint small square regions of 
                           
                              5
                              ×
                              5
                           
                         pixels. Then during the testing stage, we run the proposed method on the object’s test images and compare with the ground truth. Fig. 14
                         shows some successful detection results of the nine objects.

To comply with the comparison benchmark of [26], we also compute the precision-recall curves for the results of detecting each object, and calculate the Area under the curve (AuC) of each precision-recall curve. The results are listed in Table 5
                        , in which the AuC values in the last two columns are from [26].

As can be seen in Table 5, the proposed method compares favorably with the other two methods. The most noticeable differences in the performance of the threes methods occur at the detection of the “pincers” object and the “camera” object. In the former case, the proposed method distinctly outperforms the other two methods. We believe this is caused by the unique combination of its shape and color, i.e., it has two curved and red handles. However, in the latter case, the proposed method significantly underperforms the other two methods. The reason is that the “camera” object is “similar” to some other objects (the “toy car” and the “coke can”) in the background of the test images, both in color (red) and in shape (rectangular). The average running time of the proposed method on this dataset is 8fps at about 70% recall rate, which is also comparable with the two methods of [26], and much faster than the LINE-2D method.
                           10
                           Note that in [26] the platform for running their methods is i7@2.8GHz, 8GB RAM, and the LINE-2D method runs at 1.4fps on this platform. Our platform for running the proposed method is i5-2450@2.50GHz CPU, 4GB memory.
                        
                        
                           10
                        
                     

In this paper, we propose a new method that augments Hinterstoisser et al.’s DOT method [5] for texture-less object detection with color name, a type of illumination insensitive color information. Since color is complementary to shape, the proposed method significantly outperforms the original DOT method in the detection of texture-less object in cluttered scenes. We also come up with a systematic way to combine the different matching scores output by the color representation and the DOT representation of the proposed method. In addition, in order to compensate for the slowdown in the speed of object detection caused by the increased computational load of incorporating color into matching, we propose a speed-up strategy and analyze its complexity.

We have done extensive experiments to test the proposed method on three different datasets, and compare the results directly with two benchmark methods, the original DOT method [5] and the LINE-2D method [21], and indirectly with two other state-of-the-arts methods. We also reveal the limitations of the proposed method.

The future work will include two directions. One direction is to seek better color representations that are not only robust to illumination changes, but also have a finer resolution so that the proposed method will better discriminate objects with subtle color differences. The proposed method is also open to combining with other useful strategies, such as the strategy of reducing the number of template images [27], and the strategy of enhancing the robustness to occlusions [25]. This will be the other direction of our future work.

@&#ACKNOWLEDGMENTS@&#

The work in this paper was financially supported by the Institute of Optics and Electronics (IOE), Chinese Academy of Sciences. It was also partially supported by a research fund (No. 61471407) from National Natural Science Foundation of China. The author would also like to thank the anonymous reviewers for their invaluable comments and suggestions, and Dima Damen of University of Bristol and Reyes Rios-Cabrera of CINVESTAV, for providing their datasets for the experiments of the paper.

@&#REFERENCES@&#

