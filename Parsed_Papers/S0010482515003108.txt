@&#MAIN-TITLE@&#Thalamic segmentation based on improved fuzzy connectedness in structural MRI

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An improved fuzzy connectedness based thalamic segmentation method was proposed.


                        
                        
                           
                           Image local gradient was incorporated in calculation of fuzzy affinity.


                        
                        
                           
                           The weight of intensity and local gradient can be automatic adjusted.


                        
                        
                           
                           Confidence connectedness was used in automatic ROI update.


                        
                        
                           
                           Only one seed point was needed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Thalamic

Segmentation

Fuzzy connectedness

Magnetic resonance imaging (MRI)

@&#ABSTRACT@&#


               
               
                  Thalamic segmentation serves an important function in localizing targets for deep brain stimulation (DBS). However, thalamic nuclei are still difficult to identify clearly from structural MRI. In this study, an improved algorithm based on the fuzzy connectedness framework was developed. Three-dimensional T1-weighted images in axial orientation were acquired through a 3D SPGR sequence by using a 1.5T GE magnetic resonance scanner. Twenty-five normal images were analyzed using the proposed method, which involved adaptive fuzzy connectedness combined with confidence connectedness (AFCCC). After non-brain tissue removal and contrast enhancement, the seed point was selected manually, and confidence connectedness was used to perform an ROI update automatically. Both image intensity and local gradient were taken as image features in calculating the fuzzy affinity. Moreover, the weight of the features could be automatically adjusted. Thalamus, ventrointermedius (Vim), and subthalamic nucleus were successfully segmented. The results were evaluated with rules, such as similarity degree (SD), union overlap, and false positive. SD of thalamus segmentation reached values higher than 85%. The segmentation results were also compared with those achieved by the region growing and level set methods, respectively. Higher SD of the proposed method, especially in Vim, was achieved. The time cost using AFCCC was low, although it could achieve high accuracy. The proposed method is superior to the traditional fuzzy connectedness framework and involves reduced manual intervention in time saving.
               
            

@&#INTRODUCTION@&#

Many putative targets for deep brain stimulation (DBS) exist [1,2]. With the wide application of DBS, the precise identification of thalamic nuclei is a key issue that can improve the accuracy of the electrode placement. Moreover, the accurate localization of thalamic nuclei can help investigate the morphology of these nuclei and their mechanism across a range of diseases. Thalamus facilitates the understanding of human brain connectivity, and most of the sensory information coming from the neurons and into the cortex goes through this structure [3]. Thus, thalamic segmentation is a meaningful task for both patients and healthy subjects.

Currently, identifying thalamic structures from structural MR images with insufficient contrast is still difficult because thalamic structures have relatively smaller sizes and significant shape variations. The primary methods for brain structure segmentation include principal component analysis (PCA) [4–6], fuzzy logic control [7–9], level sets [10–12], and registration-based framework [3,13–16]. However, applying these methods on the thalamic nuclei leads to unsatisfactory results and requires improvement.

Several techniques have recently been proposed to improve the accuracy of subcortical structure identification. The value of nonlinear registration for automated atlas-based subcortical target identification in functional neurosurgery was demonstrated using a new digital atlas of the basal ganglia and thalamus [17]. Thereafter, multiple templates were used to improve the segmentation accuracy for subcortical structures, including the hippocampus [18]. In addition, high-resolution anatomic MRI with 7T provided an advanced method for thalamic nucleus identification [19,20]. Recent work focused on the differences in diffusion characteristics from diffusion MRI [21–23]. Thalamic sub-regions were identified based on connections from the thalamic voxels to various cortical regions; this approach is called alternative “probabilistic tractography” method [24,25]. Several methods have been used to enhance thalamic nucleus visualization [26–28]. In particular, a method for identifying sub-regions within the thalamus based on the differences between T1 and T2 values was explored [29].

In practice, T1-weighted MRI is among the most commonly used examinations for patients. Based on traditional MRI, studies using multiple algorithms were conducted to improve the effect of substructure segmentation, and results from such studies will be helpful to clinicians. For example, knowledge-based methods that combined neuro-anatomical information with the requirement for user interaction in deformable models showed high accuracy in many segmentation tasks, such as corpus callosum and knee bone from MR image [30,31]. Similarly, He et al. combined k-means clustering and deformable models [32]. Amini et al. proposed a mixed method incorporating fuzzy clustering theory with dynamic condition theory [33].

Thalamic nuclei are small, and the boundaries of the substructures are blurred in structural MRI. However, the neighboring subcortical structures have some degree of spatial dependence. Based on our previous work, fuzzy connectedness described this relationship and measured the degree of dependence [34]. Rosenfeld first proposed the fuzzy connectedness theory in 1979 [35]. Then, Udupa et al. established the fuzzy connectedness theoretical framework [36]. Fuzzy connectedness is an emerging framework in image segmentation. The intensities of object regions are heterogeneous because the object materials are different. However, a knowledgeable observer could identify a certain object even when their intensities vary. Fuzzy connectedness is a fuzzy topological notion describing the way how image elements hang together spatially. The concept of fuzzy connectedness was first exploited by Dellepiane et al. [37] and Udupa et al. [38] to facilitate image segmentation. In the past decade, fuzzy connectedness has been successfully applied to image segmentation. For example, Harati et al. identified brain tumors using an improved fuzzy connectedness algorithm, in which the seed point is automatically selected [39]. The segmentation evaluation results indicated higher performance than conventional methods.

In this study, an improved method based on fuzzy connectedness framework was proposed to realize semi-automatic segmentation of thalamic nuclei. A local gradient was incorporated to increase accuracy, and confidence connectedness involving a single seed point was used to decrease manual intervention.

The remainder of this paper is organized as described in the following statements. First, the image data used in this study and the proposed methodology are presented. The experimental results, discussions, and conclusions are provided.

The structural MRI data were acquired from PLA NAVY General Hospital. MRI was conducted using a 1.5T GE magnetic resonance scanner. 3D T1-weighted images in axial orientation were acquired using a 3D SPGR sequence (TR/TE=2957/9ms, flip angle=15°, FOV=24cm, slice thickness=1.25mm, spacing between slices=1.0mm, pixel spacing=1.0mm×1.0mm) with a 256×256 in-plane resolution.

First, bias field correction was performed using non-parametric non-uniform gray normalization [40]. Second, brain tissue was extracted from the original image. Non-brain tissues, such as scalp and skull tissues, were removed using a brain extraction tool. These two steps were performed using Medical Image Processing, Analysis, and Visualization (MIPAV, http://mipav.cit.nih.gov/) software [41].

In this study, a morphology-based method with White and Black top-hat transformation was performed to improve the image contrast [42].

White top-hat transformation refers to the subtraction of the result of opening operation from the image itself. By contrast, Black top-hat transformation refers to the subtraction of the image from the result of closing operation. The two above mentioned transformations (White and Black top-hat) are illustrated in Eqs. (1) and (2), respectively. In these equations, 
                              
                                 
                                    I
                                 
                                 
                                    G
                                 
                              
                            represents the image and 
                              
                                 S
                                 E
                              
                            represents the structuring element, as follows:
                              
                                 (1)
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             t
                                             o
                                             p
                                             -
                                             h
                                             a
                                             t
                                          
                                       
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             G
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             I
                                          
                                          
                                             G
                                          
                                       
                                       -
                                       (
                                       
                                          I
                                          G
                                       
                                       ∘
                                       S
                                       E
                                       )
                                    
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    
                                       
                                          B
                                          
                                             t
                                             o
                                             p
                                             -
                                             h
                                             a
                                             t
                                          
                                       
                                       (
                                       
                                          I
                                          G
                                       
                                       )
                                       =
                                       (
                                       
                                          I
                                          G
                                       
                                       ∙
                                       S
                                       E
                                       )
                                       -
                                       
                                          I
                                          G
                                       
                                    
                                 
                              
                           
                        

A structuring element with a size of 5×5×5 voxels was used (see Section 3 for more details in size selection). After White and Black top-hat transformations were performed, the edges between the tissues became clearer (see 
                           Fig. 1). As a result, the structures could be easily identified from the surrounding tissues.

In this study, an algorithm based on improved fuzzy connectedness was proposed. First, confidence connectedness was used in an automatic ROI selection. During the fuzzy connectedness calculation, image gradient was an important feature in the calculation of the fuzzy affinity besides image intensity. Moreover, an adaptive weight control was used. The algorithm for implementing the proposed algorithm is as follows:
                           
                              
                                 
                                 
                                    
                                       
                                          
                                          Select seed point according to the relative criterion (see details in Section 2.3.1).
                                    
                                    
                                       
                                          
                                          Repeat the following steps until no more neighboring pixel could be accepted:
                                    
                                    
                                       Calculate the range of intensity 
                                             
                                                
                                                   m
                                                   -
                                                   l
                                                   σ
                                                   ,
                                                   
                                                   m
                                                   +
                                                   l
                                                   σ
                                                
                                             
                                           within the current ROI.
                                    
                                    
                                       Accept and add the neighboring pixel as the element of updated ROI if its intensity falls into the above mentioned range.
                                    
                                    
                                       
                                          
                                          Within the final update ROI:
                                    
                                    
                                       
                                          
                                          
                                          Calculate the fuzzy connectedness between each pixel and the seed point,
                                    
                                    
                                       
                                          
                                          
                                          
                                          If the fuzzy connectedness is higher than the threshold,
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                          Label the corresponding pixel as the target.
                                    
                                    
                                       
                                          
                                          
                                          
                                          Otherwise,
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                          Label the corresponding pixel as the background.
                                    
                                 
                              
                           
                        
                     

The details of the flowchart will be represented as the following parts. Two primary steps were included, namely, ROI selection and developed calculation of fuzzy affinity.

The experimental results showed that segmentation based on traditional fuzzy connectedness should have more than one seed point to achieve a satisfactory result in thalamic nucleus applications (see 
                           Fig. 2). In addition, the region for fuzzy affinity calculation needs to be manually defined. To solve these problems, confidence connectedness was used in the proposed method.

First, the criteria of seed point selection should be as follows. For the thalamus, the point within the distance of 3–5 pixels around its centroid was chosen. For the Vim and subthalamic nucleus (STN), choosing the point within the distance of 1–2 pixels around its centroid was ideal. The initial ROI was the region sized by 3×3×3 voxels centered from the seed point. Then, it could be updated automatically using confidence connectedness.

The concept of confidence connectedness is very similar to the region-based segmentation method (see Section 2.4 for details of classification of intensity image segmentation) [43–45]. The concept was based on the clustering of voxels by computing the intensity mean 
                              m
                            and standard deviation 
                              σ
                            in the current ROI. The calculation started from a seed point indicated by the user. First, the mean and standard deviation of image intensity was computed in the initial ROI. Then, a pre-defined multiple factor 
                              l
                            was used to acquire the range, which was 
                              
                                 [
                                 m
                                 −
                                 l
                                 σ
                                 ,
                                 m
                                 +
                                 l
                                 σ
                                 ]
                              
                           . Neighboring voxels with intensities within this range were included in the region. Then, the ROI was updated. After the first iteration, the intensity mean and standard deviation were re-calculated within the updated ROI. A new inclusion range was acquired, and the procedure was repeated. The iteration step was performed until no more voxels were added into the region or the maximum number of algorithm iterations was reached.

The acceptance criteria for a neighboring voxel 
                              X
                            to be included in the update ROI could be represented by the following equation, where 
                              
                                 I
                                 (
                                 )
                              
                            is the image region containing voxel 
                              X
                           :
                              
                                 (3)
                                 
                                    
                                       I
                                       (
                                       X
                                       )
                                       ∈
                                       [
                                       m
                                       −
                                       l
                                       σ
                                       ,
                                       m
                                       +
                                       l
                                       σ
                                       ]
                                    
                                 
                              
                           
                        

For the value selection of multiple factor 
                              l
                           , experiments were performed to achieve the best results. If the value was too low, only the pixels whose intensities were very near were clustered to construct the ROI. In this case, the size of ROI was regular, and ROI update was difficult during the calculation. However, if the value was too high, the acceptance condition for ROI update would be too lenient, thereby leading to mis-segmentation, and the separate structures would be segmented as one target. In this study, 
                              l
                            was set at 2.5 (the details of the value selection are presented in Section 3).

From the above mentioned discussion, only one seed point was needed, and the ROI could be updated automatically.

Segmentation based on fuzzy connectedness began by setting a seed point in ROI. The fuzzy connectedness between the characteristics of the seed point and the other points was calculated. The points with higher fuzzy connectedness than the predetermined threshold were highlighted in the object region. The detailed steps are represented as follows:
                              
                                 (1)
                                 The function of fuzzy connectedness and the fuzzy affinity of space elements were defined;

the fuzzy affinity value of each fuzzy connection pair was calculated;

the seed point c was identified;

the paths between the seed point c and other points were defined;

the minimum fuzzy affinity of each path was calculated; and

the map of fuzzy connectedness was acquired.

The fuzzy affinity of two points c and d can be illustrated as follows:
                              
                                 (4)
                                 
                                    
                                       
                                          μ
                                          k
                                       
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       
                                          
                                             
                                                μ
                                                α
                                             
                                             (
                                             c
                                             ,
                                             d
                                             )
                                          
                                          
                                             1
                                             +
                                             k
                                             |
                                             f
                                             (
                                             c
                                             )
                                             −
                                             f
                                             (
                                             d
                                             )
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       α
                                    
                                 
                                 (
                                 c
                                 ,
                                 d
                                 )
                              
                            is a monotonic increasing function of the distance between the points c and 
                              d
                           , and 
                              k
                            is a constant. Both of these two terms ranged from 0 to 1. Commonly,
                              
                                 (5)
                                 
                                    
                                       
                                          μ
                                          α
                                       
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      ‖
                                                      c
                                                      −
                                                      d
                                                      ‖
                                                   
                                                   ≤
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   others
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The fuzzy connectedness between points 
                              c
                            and 
                              d
                            is defined as follows:
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             ξ
                                          
                                       
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       
                                          
                                             max
                                          
                                          
                                             p
                                             ∈
                                             P
                                             c
                                             d
                                          
                                       
                                       [
                                       
                                          
                                             μ
                                          
                                          
                                             χ
                                          
                                       
                                       (
                                       p
                                       )
                                       ]
                                    
                                 
                              
                           where 
                              p
                            is the sequence of space elements 
                              
                                 〈
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 ..
                                 .
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       m
                                    
                                 
                                 〉
                                 ,
                                 m
                                 ≥
                                 2
                              
                            from point 
                              c
                            to point 
                              d
                           ; and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 c
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 d
                              
                           . 
                              
                                 
                                    
                                       μ
                                    
                                    
                                       χ
                                    
                                 
                                 (
                                 p
                                 )
                              
                            is the strength of one path from points 
                              c
                            to 
                              d
                           , which is defined as the minimum value of the fuzzy affinity for any two points on this path. Therefore, fuzzy connectedness is the maximum strength among all the strengths of the paths.

In Eq. (3), 
                              
                                 f
                                 (
                                 c
                                 )
                              
                            and 
                              
                                 f
                                 (
                                 d
                                 )
                              
                            are the functions of point 
                              c
                            and 
                              d
                           , respectively, and represent the image features located at the two points. Traditionally, image intensity was used. However, the use of a single feature often resulted in mis-segmentation or under-segmentation.

In this study, image gradient was also regarded as an important feature because of the blurred boundaries of thalamic nuclei. The features that can extract information on the edges should be considered to improve the identification effects. Accordingly, the fuzzy affinity is redefined as follows:
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             κ
                                          
                                       
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       
                                          
                                             μ
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       
                                          [
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             f
                                             (
                                             c
                                             )
                                             ,
                                             f
                                             (
                                             d
                                             )
                                             )
                                             +
                                             
                                                
                                                   ω
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             f
                                             (
                                             c
                                             )
                                             ,
                                             f
                                             (
                                             d
                                             )
                                             )
                                          
                                          ]
                                       
                                    
                                 
                              
                           in which
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       f
                                       (
                                       c
                                       )
                                       ,
                                       f
                                       (
                                       d
                                       )
                                       )
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            f
                                                            (
                                                            c
                                                            )
                                                            +
                                                            f
                                                            (
                                                            d
                                                            )
                                                            )
                                                            /
                                                            2
                                                            −
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       f
                                       (
                                       c
                                       )
                                       ,
                                       f
                                       (
                                       d
                                       )
                                       )
                                       =
                                       
                                          
                                             e
                                          
                                          
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            (
                                                            f
                                                            (
                                                            c
                                                            )
                                                            −
                                                            f
                                                            (
                                                            d
                                                            )
                                                            )
                                                            −
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                            represent the Gaussian measurement of image intensity and image gradient in ROI, respectively; 
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                            is the mean of the image intensity; 
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                            is the mean of the image gradient; 
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                            are the standard deviations of the image intensity and gradient, respectively.

Meanwhile, determining the weight of the two terms was a key issue in the computation of fuzzy connectedness. An automatic adaptive weight assignment was used in the present study, and the equation was as follows:
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       1
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        

Therefore, with Eq. (9), we avoided using the same weight parameter for the whole image, and we may describe the fuzzy connectedness accurately. Accordingly, the calculation of fuzzy affinity should be as follows:
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             κ
                                          
                                       
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       =
                                       
                                          
                                             μ
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       c
                                       ,
                                       d
                                       )
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   f
                                                   (
                                                   c
                                                   )
                                                   ,
                                                   f
                                                   (
                                                   d
                                                   )
                                                   )
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   f
                                                   (
                                                   c
                                                   )
                                                   ,
                                                   f
                                                   (
                                                   d
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   f
                                                   (
                                                   c
                                                   )
                                                   ,
                                                   f
                                                   (
                                                   d
                                                   )
                                                   )
                                                   +
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   f
                                                   (
                                                   c
                                                   )
                                                   ,
                                                   f
                                                   (
                                                   d
                                                   )
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        

For convenience, we called the method of fuzzy connectedness based on this adaptive fuzzy affinity AFC (adaptive fuzzy connectedness), and the proposed hybrid algorithm proposed was called AFCCC (adaptive fuzzy connectedness combined with confidence connectedness).

@&#EVALUATION@&#

The experimental results were evaluated using several rules. In the following equations, the area of round S was the number of pixels that are recognized as the target, whereas T was the manual segmentation results that experts had acquired. Accordingly, the criteria for evaluation were defined as follows:
                           
                              (12)
                              
                                 
                                    Similarity
                                    
                                    degree
                                    
                                    
                                       (
                                       SD
                                       )
                                    
                                    
                                    is
                                    
                                    defined
                                    
                                    as
                                    
                                    SD
                                    =
                                    2
                                    
                                       
                                          |
                                          S
                                          ∩
                                          T
                                          |
                                       
                                       
                                          
                                             |
                                             S
                                             |
                                          
                                          +
                                          
                                             |
                                             T
                                             |
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    Union
                                    
                                    overlap
                                    
                                    
                                       (
                                       UO
                                       )
                                    
                                    
                                    is
                                    
                                    defined
                                    
                                    as
                                    
                                    UO
                                    =
                                    
                                       
                                          |
                                          S
                                          ∩
                                          T
                                          |
                                       
                                       
                                          |
                                          S
                                          ∪
                                          T
                                          |
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    False
                                    
                                    positive
                                    
                                    
                                       (
                                       FP
                                       )
                                    
                                    
                                    is
                                    
                                    defined
                                    
                                    as
                                    
                                    FP
                                    =
                                    
                                       
                                          |
                                          S
                                          /
                                          T
                                          |
                                       
                                       
                                          |
                                          S
                                          |
                                       
                                    
                                 
                              
                           
                        
                     

SD represented the ratio of the pixels that are correctly segmented into the whole segmentation result, which includes both manual and automatic results. The union overlap was also called Jaccard coefficient, which was often used in algorithm performance evaluation and was regarded as a criterion for comparing the similarity of different sample collections. FP represented the ratio of pixels incorrectly identified as targets in the automatic results.

Besides the framework of fuzzy connectedness, the experiments were also performed by segmentation methods of region growing and level set. Segmentation results achieved from these various methods were compared for evaluation. Generally, the intensity image segmentation methods could be classified into threshold techniques, region-based methods, boundary-based methods, and hybrid techniques. The framework of fuzzy connectedness belonged to the region-based methods which use the similarity of the neighboring pixels. Therefore, in this study, we performed the experiments using classical region-growing method, which is best known for comparisons [46]. Here, the seed point selected was the same as that used in the experiments based on the framework of fuzzy connectedness. In addition, the level set method has been increasingly applied to image segmentation in the past decade, as proposed by Osher and Sethian in 1988 [47]; thus, we also performed the experiment using level set by using MIPAV software for comparisons [48]. One of the advantages of level set method is that the contours of the targets could be represented with complex topology, and their topology could be changed naturally.

For each method, the false segmentation results that included both overestimation and underestimation were also respectively shown in  
                        Fig. 3(1). The statistical evaluation parameters were shown in 
                        
                        Figs. 5 and 6. In this study, a statistical test for significant difference was performed to determine the probability of the difference between our proposed method and other methods. Since the experiments were performed on the same data, paired t-tests were selected. SD values derived from the proposed method and other different methods were compared (see 
                        
                        Table 2).

Since speed is another criterion for evaluating the segmentation method, the time cost of various segmentation methods was compared (see 
                        Table 3).

To explore the influence to the proposed method caused by selection of parameter value, several group of experiments focused on the parameters used in the proposed method were also performed. First, the algorithm sensitivity to different size of structuring element used in the image contrast enhancement was evaluated (see 
                        Fig. 7 and 
                        Table 4). Second, the algorithm sensitivity and false positive to different values of multiple factor used in the confidence connectedness were evaluated (see 
                        Fig. 8 and 
                        Table 5). Finally, the algorithm sensitivity to different position of seed point was also evaluated (see 
                        Fig. 9 and 
                        Table 6).

@&#RESULTS@&#

The experiments were performed on T1 images with traditional fuzzy connectedness (FC), AFC, and AFCCC. Results were compared with the methods of region growing and level set. The manual segmentation from experts was regarded as the gold standard for evaluation. To eliminate differences occurring during the manual work, all experimental data were segmented by one expert.

The original image and the segmentation result of one normal data point for thalamus, Vim, and STN were shown in Fig. 3. In addition, 3D reconstruction results were shown in 
                     Fig. 4. The segmentation results of 25 normal images were evaluated (see Table 1). From Table 1, SD of the thalamus segmentation results was over 85%, which showed that the proposed method had high accuracy with reduced manual intervention. In addition, SD and FP of the segmentation results for thalamus, Vim, and STN using the framework of fuzzy connectedness (FC, AFC, and AFCCC), region growing, and level set methods were also compared (see Figs. 5 and 6). From Table 2, AFCCC showed a significant difference with other methods according to SD values for segmentations of not only thalamus, but also Vim and STN (P<0.05). Moreover, from the results of Figs. 5 and 6, AFCCC showed better accuracy than region growing and level set methods, especially in small nuclei, such as Vim.

For the time cost comparison of various segmentation methods (see Table 3), AFCCC has about the same speed as AFC. However, AFCCC achieved the highest accuracy among the frameworks of fuzzy connectedness. For segmentation of thalamus and STN, AFCCC was faster than the method of level set. For the manual segmentation (for example, after an expert training), thalamus segmentation needed about 2min. Therefore, the proposed method can save time while obtaining accurate results.

In addition, sensitivities of the parameters used in the proposed method were evaluated. From the sensitivity result of structuring element (see Fig. 7 and Table 4), the size of 5×5×5 voxels is most appropriate for all three target structures. In fact, all the sizes from 2×2×2 voxels to 15×15×15 voxels at intervals of 1×1×1 voxel have been tested for the limited space, and only representative results were shown. If we neglect contrast enhancement, the segmentation results were difficult to accept. For the value selection of multiple factor used in confidence connectedness (see Fig. 8 and Table 5), although both the value of 2.5 and 3.0 achieved the high sensitivity, only the value of 2.5 was proper because the false positive by using value of 3.0 was not acceptable.

Since the proposed method is semi-automatic, the sensitivity to different seed point selection should be evaluated. From the experimental results (see Fig. 9 and Table 6), the sensitivities were acceptable for these target structures.

@&#DISCUSSION@&#

In this study, an improved fuzzy connectedness framework-based method was explored. The proposed algorithm had the following several advantages:
                        
                           (1)
                           Image gradient was incorporated in the calculation of fuzzy affinity, which counteracted the disadvantage of blurred edges by strengthening the information focused on edges. The traditional algorithm only considered the basic intensity as the image feature, in which the gradient was not incorporated.

The weights of image intensity and gradient, which determined their contributions to the calculation of fuzzy affinity, could be automatically adjusted. According to the fuzzy connectedness framework, the weight of the features was an important parameter that determined the quality of the result when multi-features were considered. In this study, the weight can be automatically and reasonably adjusted during computation.

Only one seed point was needed. By contrast, more than one seed point was needed to achieve a satisfactory segmentation when traditional fuzzy connectedness method was used. The effective area could expand accurately and equably because the confidence connectedness was applied in searching for the updated ROI.

This method served as a helpful starting point for achieving a satisfactory result. After segmentation using AFCCC, the result could be further adjusted by an appropriately trained physician. AFCCC showed a better accuracy than region growing and level set methods, especially in small nucleus. Compared among the framework of fuzzy connectedness, AFCCC could compete with AFC, but fast speed was achieved. Moreover, AFCCC’s speed could also compete with the method of level set. Without the proposed method, manual segmentation required about one hundred times of the usual processing time.

Similar to other related works on the subcortical structure segmentation, the proposed method also showed limitations. First, although the number of seed points was reduced, which consequently decreased manual intervention, the seed point should still be manually selected within the target region. Second, the robustness of the algorithm was expected to improve. The experimental data were derived from the commonly relative low-field intensity (1.5T), and high-quality data with high field intensities could lead to better results. The proposed algorithm with traditional structural MRI may not be an efficient tool for precise nuclei recognition because of difficulties in achieving high-quality subcortical nuclei imaging, especially for small-sized nuclei within the thalamus that have blurred or nuclei with missing nuclei boundaries. Thus, other data modalities and data identification method should be developed for precise segmentation.

@&#CONCLUSIONS@&#

Thalamic segmentation is a key issue in DBS. An improved fuzzy connectedness algorithm based on the traditional structural MRI was proposed in this study. Image gradient was incorporated with the exception of a single image feature, which was only based on the image intensity used in the traditional framework. Moreover, the weight of each image feature was adjusted during the calculation of fuzzy connectedness. Meanwhile, only one seed point was needed by using confidence connectedness for automatic ROI update. Thus, manual intervention was reduced. Experimental results demonstrated that the proposed method achieved higher accuracy with decreased manual intervention than the traditional method. Furthermore, effective image features may be incorporated to improve the performance of the proposed method.

None declared.

@&#ACKNOWLEDGMENT@&#

This work is partially supported by the Natural Scienceition of Beijing (Grant no. 3112005) and the National Natural Science Foundation of China (Grant no. 81101107)

Supplementary data associated with this article can be found in the online version at 10.1016/j.compbiomed.2015.09.002.


                     
                        
                           
                              Supplementary material
                           
                           
                        
                     
                  

@&#REFERENCES@&#

