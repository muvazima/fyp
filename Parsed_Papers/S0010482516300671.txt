@&#MAIN-TITLE@&#Automatic segmentation of maxillofacial cysts in cone beam CT images

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Accurate segmentation of cysts and tumors is important step in computer assisted surgery.


                        
                        
                           
                           Manual segmentation performed by radiologists is tedious and time consuming.


                        
                        
                           
                           Normal head and face structure is roughly symmetric with respect to midsagittal plane.


                        
                        
                           
                           An automatic method based on asymmetry analysis is proposed which is general enough to segment various types of jaw cysts.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Asymmetry

Jaw cyst

Computer-aided diagnosis

Cone Beam Computed Tomography

Registration

Segmentation

@&#ABSTRACT@&#


               
               
                  Accurate segmentation of cysts and tumors is an essential step for diagnosis, monitoring and planning therapeutic intervention. This task is usually done manually, however manual identification and segmentation is tedious. In this paper, an automatic method based on asymmetry analysis is proposed which is general enough to segment various types of jaw cysts.
                  The key observation underlying this approach is that normal head and face structure is roughly symmetric with respect to midsagittal plane: the left part and the right part can be divided equally by an axis of symmetry. Cysts and tumors typically disturb this symmetry. The proposed approach consists of three main steps as follows: At first, diffusion filtering is used for preprocessing and symmetric axis is detected. Then, each image is divided into two parts. In the second stage, free form deformation (FFD) is used to correct slight displacement of corresponding pixels of the left part and a reflected copy of the right part. In the final stage, intensity differences are analyzed and a number of constraints are enforced to remove false positive regions.
                  The proposed method has been validated on 97 Cone Beam Computed Tomography (CBCT) sets containing various jaw cysts which were collected from various image acquisition centers. Validation is performed using three similarity indicators (Jaccard index, Dice's coefficient and Hausdorff distance). The mean Dice's coefficient of 0.83, 0.87 and 0.80 is achieved for Radicular, Dentigerous and KCOT classes, respectively. For most of the experiments done, we achieved high true positive (TP). This means that a large number of cyst pixels are correctly classified. Quantitative results of automatic segmentation show that the proposed method is more effective than one of the recent methods in the literature.
               
            

@&#INTRODUCTION@&#

The accurate segmentation of lesions and tumors is an important step in computer-aided diagnosis systems. This step is usually performed manually by a radiologist, however manual segmentation becomes tedious in the presence of small sized lesions and time consuming due to the large amount of data to be analyzed. Hence, developing an automatic method can save radiologists time. Automatic segmentation of jaw cysts from volume images is a challenging task and by applying prior knowledge about healthy tissues we can simplify this task.

CBCT is a rapidly advancing area of imaging specifically designed for maxillofacial region and can provide three dimensional images of hard and soft tissue structures with lower dose of radiation [1–2]. This is an important aspect since sensitive tissues and organs are located in head and face. In evaluating cysts or benign tumors, OPGs
                        3
                     
                     
                        3
                        Orthopantomogram
                      may not fully record the dimension and location of the lesion. Multi-planar sections (axial, coronal and sagittal planes) and 3D reconstruction are required in examining cysts or tumors. In several studies, accuracy of CBCT images in diagnosing jaw cysts is evaluated [3–8]. Many researchers reported that the accuracy of CBCT imaging is comparable to conventional CT with no significant statistical difference [3,5,8]. However, like other imaging technologies, surgical biopsy and histopathological evaluation are needed for further accurate differential diagnosis of some lesions [4]. Thus, it can be concluded that CBCT is a reliable tool for preoperative radiological assessment of cyst and tumors when compared with conventional CT.

Several methods for automatic segmentation of jaw tissues are proposed in the literature. Rueda et al. utilized a combination of Active Appearance Models and semi-automatic landmarking for automatic segmentation of jaw tissues [9]. Segmentation of mandibular canal, cortical bone and trabecular core is performed by shape modeling and semi-automatic landmarking is used to improve the AAM method and decrease annotation time. The proposed AAM method is robust against small shape variability in mandibular canal and cortical bone, however due to high shape variability in trabecular core, the fitting result is not accurate and the training set was annotated to avoid trabecular details during the segmentation. In [10], Fuzzy connectedness based algorithm is proposed for segmentation of jaw tissues. The segmentation results are promising; however the algorithm is very sensitive to parameters and seed selection. Later, they extended this approach to 3D [11] and employed morphological processing to obtain a closed surface. Kale et al. proposed Level Set and Bayesian methods for automatic segmentation of human facial tissues [12]. They compared the accuracy and speed of both methods and the best results were achieved using Bayesian overall. The main drawback of the methods is that the accuracy of segmentation is heavily dependent on the correct choice of mean intensity values for four tissue classes (air, fat, muscle and bone). Wavelet density model (WDM) was proposed by Chang et al. [13] to segment the outer surface of the anterior wall of maxilla. This method is specifically developed for accurate segmentation of maxilla in CBCT data.

To the best of our knowledge, there are very few researches performed in automatic segmentation of jaw cysts. Okada et al. [14] combined graph-based random walks segmentation with machine learning-based boosted classifiers in order to segment dental periapical lesions. The accuracy of this method depends on the choice of initial seeds. In [15], an algorithm is developed to identify dental cyst using morphologic descriptors of the shape, margin and area at an early stage. Then, a neural network is trained to diagnose and measure severity of cysts with high classification accuracy in dental X-rays. In clinical applications, it is difficult to find a suitable template for each cystic lesion. Stoetzer et al. [16] proposed an automatic atlas-based algorithm for the segmentation of anatomical structures. Correspondence between atlas or template images and patient images was detected using this algorithm. The structures are segmented automatically by elastic deformation of the templates to match the atlas images to a patient's images. The proposed procedure provides surgeons with information about the total volume of a cyst. However, the performance of atlas based methods would be poor in detecting maxillofacial cysts due to high variability. Rana et al. [17] developed Smartbrush tool based on region growing for automatic segmentation of mandibular odontogenic cysts and tumors. The result of segmentation using Smartbrush was compared with manual segmentation and threshold-based segmentation in terms of accuracy and time expenditure. The main drawback of region growing is that the final result depends on accurate marking of initial seed points. Aforementioned studies are limited to specific types of cysts and many challenges and issues should be solved regarding to accuracy and speed.

Identification and segmentation of jaw cysts is challenging due to several problems. First, cysts can be of various sizes and locations. In fact, a cyst segmentation algorithm has to deal with a large number of datasets in terms of variations and complications. Thus, initialization of parameters should be done carefully and effective operator interaction is substantial. Second, the intensity ranges of surrounding tissues are similar to that of cyst. In this case, conventional segmentation algorithms often generate many false positive pixels and hence poor segmentation results. Third, due to the lower contrast of CBCT images with respect to MSCT, automatic segmentation is more challenging. Design of powerful image enhancement algorithms and filtering is essential for CBCT image analysis.

In this article, a symmetry-based framework for automatic jaw cysts segmentation is developed and applied to a dataset of CBCT images. The prior knowledge about the symmetry of healthy tissues is used to segment jaw cysts and cystic like lesions. Two main steps are symmetry axis detection and non-rigid registration which should be performed accurately. For non-rigid registration, we have employed multi-resolution FFD registration. The rest of this paper is organized as follows. In Section 2, we introduce the proposed framework for cysts segmentation which consists of diffusion filtering, symmetry axis detection and removing false positives. Then, in Section 3 the experimental results are reported. In Section 4 and 5 discussion and conclusion are presented, respectively.

@&#MATERIAL AND METHODS@&#

In this section, we introduce the proposed symmetry-based framework for automated jaw cysts segmentation. The key observation underlying our approach is that normal head structure is roughly symmetric [18]: the left part and the right part can be divided by an axis of symmetry. Lesions typically disturb this symmetry. We utilize this property to design a promising algorithm to localize cysts. The proposed framework for cysts segmentation is shown in 
                     Fig. 1. In this section, we explain the dataset and the methods employed for diffusion filtering and symmetry axis detection. Afterwards, we describe the details of non-rigid registration and methods validation, thoroughly.

For the research presented in this paper, we have collected 125 sets of CBCT images suffering from various cysts, lesions and deformities. The annotation and interpretation of this dataset is done by two radiologists. The proposed framework is developed and tested using 97 CBCT sets belonging to subjects suffering from various cysts (39 radicular cyst, 36 dentigerous cyst and 22 keratocystic odontogenic tumor). In addition to 97 cases diagnosed with various cysts, remaining diseased cases in the dataset belong to other types of deformities such as cleft and impaction. The class of each cystic subject is available from each patient record. The images in the dataset contain approximately 200 slices per subject. Example images belonging to various categories can be seen in 
                        Fig. 2.

CBCT images often suffer from low contrast and several image enhancing techniques are tested to enhance the contrast of these images. One of the recent methods for CBCT image filtering is anisotropic diffusion filtering proposed by Kroon [19]. Anisotropic diffusion filtering is an iterative edge and texture preserving smoothing method, in which the local image structure is described using a structure tensor. Since it is tensor based, this method is very fast for 3D filtering in series of CBCT images. This descriptor is transformed into a diffusion tensor D. The diffusion equation is commonly written as following:
                           
                              (1)
                              
                                 
                                    
                                       
                                          ∂
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    ∇
                                    .
                                    (
                                    D
                                    ∇
                                    u
                                    )
                                    ⇒
                                    
                                       
                                          u
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ≅
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    τ
                                    (
                                    ∇
                                    .
                                    (
                                    D
                                    ∇
                                    u
                                    )
                                    )
                                    ,
                                 
                              
                           
                        where u is the image, x, y, z are pixel coordinates and t is the diffusion time. In the discrete function, 
                           τ
                         and k are time step size and number of iterations, respectively. Discretization of the divergence operator can be done through different schemes such as standard, rotation invariant and optimized. These schemes are described in [19] comprehensively and we only present optimized scheme equations here due to the best results in our application. In optimized scheme the divergence operator is written using the product rule:
                           
                              (2)
                              
                                 
                                    ∇
                                    .
                                    (
                                    D
                                    ∇
                                    u
                                    )
                                    =
                                    d
                                    i
                                    v
                                    (
                                    D
                                    )
                                    ∇
                                    u
                                    +
                                    t
                                    r
                                    a
                                    c
                                    e
                                    (
                                    D
                                    (
                                    ∇
                                    
                                       
                                          ∇
                                       
                                       T
                                    
                                    u
                                    )
                                    )
                                    .
                                 
                              
                           
                        
                     

We can obtain divergence part and Hessian of the equation as following:
                           
                              (3)
                              
                                 
                                    
                                       
                                          d
                                          i
                                          v
                                          (
                                          D
                                          )
                                          ∇
                                          u
                                          =
                                          (
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          u
                                          )
                                          (
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                11
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                12
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   z
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   13
                                                
                                             
                                          
                                          )
                                          +
                                          (
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          u
                                          )
                                          (
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                12
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                22
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   z
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   23
                                                
                                             
                                          
                                          )
                                          +
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   z
                                                
                                             
                                          
                                          u
                                          )
                                          (
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   x
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                13
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   y
                                                
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                23
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∂
                                                
                                                
                                                   z
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   33
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    t
                                    r
                                    a
                                    c
                                    e
                                    (
                                    D
                                    (
                                    ∇
                                    
                                       
                                          ∇
                                       
                                       T
                                    
                                    u
                                    )
                                    )
                                    =
                                    (
                                    
                                       
                                          ∂
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    u
                                    )
                                    
                                       
                                          D
                                       
                                       
                                          11
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          ∂
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    u
                                    )
                                    
                                       
                                          D
                                       
                                       
                                          22
                                       
                                    
                                    +
                                    (
                                    
                                       
                                          ∂
                                       
                                       
                                          z
                                          z
                                       
                                    
                                    u
                                    )
                                    
                                       
                                          D
                                       
                                       
                                          33
                                       
                                    
                                    +
                                    2
                                    (
                                    
                                       
                                          ∂
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    u
                                    )
                                    
                                       
                                          D
                                       
                                       
                                          12
                                       
                                    
                                    +
                                    2
                                    (
                                    
                                       
                                          ∂
                                       
                                       
                                          x
                                          z
                                       
                                    
                                    u
                                    )
                                    
                                       
                                          D
                                       
                                       
                                          13
                                       
                                    
                                    +
                                    2
                                    (
                                    
                                       
                                          ∂
                                       
                                       
                                          y
                                          z
                                       
                                    
                                    u
                                    )
                                    
                                       
                                          D
                                       
                                       
                                          23
                                       
                                    
                                    .
                                 
                              
                           
                        
                     


                        Eq. (3) is discretized using 
                           
                              3
                              ×
                              3
                              ×
                              3
                           
                         derivative kernels, and the Hessian of (4) with a 
                           
                              5
                              ×
                              5
                              ×
                              5
                           
                         second derivative kernel. In 2D these spatial kernels can be written as:
                           
                              (5)
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            14
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            14
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            5
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            6
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            5
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            9
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            8
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            7
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            5
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            6
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            5
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            10
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            10
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            12
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            12
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            12
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            12
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            10
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            10
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        
                     

We can find the kernel values analytically or by numerical optimization. We have applied numerical optimization as [19] because it can optimize the whole process. The results of diffusion filtering with different schemes such as standard, rotation invariant and optimized are illustrated in 
                        Fig. 3. Quantitative evaluation of different filtering methods is illustrated in 
                        Table 1. Furthermore, conventional median filter is included in this table. PSNR
                           4
                        
                        
                           4
                           Peak Signal to Noise Ratio
                         values of different filters are approximately the same. As a least squares result, PSNR is slightly biased towards over smoothed (blurry) results, i.e. an algorithm that removes not only the noise but also a part of the textures will have a good score. Structural Similarity index (SSIM) [20] is a quality reconstruction metric that takes into account the similarity of the edges (high frequency content) between the denoised image and the ideal one. To have a good SSIM measure, an algorithm needs to remove the noise while also preserving the edges of the objects. Considering SSIM criterion, optimized scheme outperforms other filters. Hence, it is the ideal filter in our application. In standard and non-negative scheme, smoothing is way overdone and important information about edges are lost. The optimized scheme gives the best enhancement in uniform regions and edges are preserved.

Symmetry detection is widely used in the field of computer vision and computer graphics because of its capability to minimize redundancy and reducing computational cost and time. Various techniques are proposed for symmetry detection in literature. We have employed the method in [21] which is based on the idea of matching symmetric pairs of feature. The core of this algorithm is based on modern feature point methods. The symmetry exhibited by each pair is evaluated by the relative location, orientation and scale of the features in the pair. Using pair-wise symmetries and a Hough-style voting space, the dominant symmetries in the image are determined. This framework provides an efficient tool for generating dense sets of feature points and matching these between images. The procedure for detecting bilateral and rotational symmetries is as following:

Let us assume a set of feature points 
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            which has the capability of detecting distinctive points. These points describe the location and orientation. Next, a feature descriptor is generated for each feature point using SIFT descriptor. To this aim, Difference of Gaussian (DoG) is calculated. Here, given a Gaussian filter 
                              
                                 G
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 k
                                 σ
                                 )
                              
                            and input image 
                              
                                 I
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           , we calculate multi-scale Difference of Gaussian as follows:
                              
                                 (6)
                                 
                                    
                                       D
                                       o
                                       G
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       )
                                       =
                                       I
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       *
                                       G
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       k
                                       σ
                                       )
                                       −
                                       I
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       *
                                       G
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       (
                                       k
                                       −
                                       1
                                       )
                                       σ
                                       )
                                       ,
                                    
                                 
                              
                           where k is the scale index and 
                              σ
                            is the standard deviation of Gaussian filter. We have set k=4 for building a three level pyramid and subsample the Gaussian filtered volume. The three level structure is inspired by biological characteristics of receptive fields of retinal ganglion cells [22,23].Then, local extrema of DoG are located and the locations of these points form candidates of interest points. The direction of these points is defined by the azimuth and elevation angles. To omit the points which are likely to produce unstable descriptors, Hessian matrix is calculated to describe the local curvature and derive a rejection point measure:
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   T
                                                   r
                                                   a
                                                   c
                                                   e
                                                   (
                                                   
                                                      H
                                                   
                                                   )
                                                   )
                                                
                                                
                                                   3
                                                
                                             
                                          
                                          
                                             D
                                             e
                                             t
                                             (
                                             
                                                H
                                             
                                             )
                                          
                                       
                                       <
                                       (
                                       2
                                       
                                          
                                             τ
                                          
                                          
                                             e
                                          
                                       
                                       +
                                       1
                                       )
                                       
                                          
                                             (
                                             
                                                2
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

We have set 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 40
                              
                            to reject points which is a less selective choice. We tried different values of 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       e
                                    
                                 
                              
                            and the position of symmetric axis is not changed. This result is confirmed in 
                           Fig. 4. Once the set of interest points are selected and the orientation of interest points has been determined, we build a grid of gradient histograms and each histogram is computed from a group of pixels. The final format of keypoint descriptors is as a grid of gradient histograms.

A set of mirrored feature descriptors is generated. The simplest way is to flip the original image about an arbitrary plane and compute the feature point descriptors for the mirrored image. We define symmetry measure for each pair of points as a combination of scale symmetry 
                              
                                 
                                    S
                                 
                                 
                                    i
                                    j
                                 
                              
                           , angular symmetry 
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       i
                                       j
                                    
                                 
                              
                            and distance weighting 
                              
                                 
                                    D
                                 
                                 
                                    i
                                    j
                                 
                              
                           :
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             S
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ,
                                    
                                 
                              
                           where scale symmetry of two SIFT features is defined as an exponential function of their scale 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 e
                                 x
                                 p
                                 (
                                 −
                                 
                                    ‖
                                    
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             s
                                          
                                          
                                             j
                                          
                                       
                                    
                                    ‖
                                 
                                 /
                                 
                                    
                                       σ
                                    
                                    
                                       s
                                    
                                 
                                 )
                              
                            and we have 
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                                 −
                                 c
                                 o
                                 s
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       θ
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                           . In our experiments, we used 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 1
                              
                            and imposed no constrains about the diameter of symmetry detection [21]. The role of distance weighting function is to reward matching pairs that are closer to the symmetry axis. In this application, we cannot give a bound for the diameter of symmetry to be detected. Hence, introducing a distance weighting is not possible.

A similarity matrix is constructed for quantifying the similarity between feature points. The Euclidean distance between the SIFT descriptors is used to measure the similarity between feature vectors. In 
                           Fig. 5, symmetric axis detection result on a typical set of CBCT images is depicted both in 2D and 3D.

One of the key components in the proposed framework is registration method. Rigid and affine registration methods find global transformation matrices, which may involve translation, rotation, scaling and skew. Global transformation is unable to consider nonlinear differences between two parts. Non-rigid registration methods which find local transformations are more suitable for this application. Hence, in this study we have utilized multi-resolution hierarchical FFD. In multi-resolution hierarchical registration method, Free Form Deformation (FFD) using a B-spline grid is employed as transformation model and optimization is done using gradient-based method. Hierarchical techniques [24,25] can speed up search strategy in registration by guiding search strategy through progressively finer resolutions. The coarse (low resolution) images are registered first. Afterwards, the registration results are used as the starting point for finer (high resolution) image registration and so on. To define Free Form Deformation with a B-spline grid, let 
                           
                              Φ
                           
                         denote a 
                           
                              
                                 
                                    n
                                 
                                 
                                    x
                                 
                              
                              ×
                              
                                 
                                    n
                                 
                                 
                                    y
                                 
                              
                           
                         mesh of control points [26]. Transformation T is written as the product of 1D cubic B-splines:
                           
                              (9)
                              
                                 
                                    T
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          0
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             n
                                             =
                                             0
                                          
                                          
                                             3
                                          
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                l
                                             
                                          
                                          (
                                          u
                                          )
                                          
                                             
                                                B
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    (
                                    v
                                    )
                                    
                                       Φ
                                    
                                    (
                                    i
                                    +
                                    1
                                    ,
                                    j
                                    +
                                    n
                                    )
                                    ,
                                 
                              
                           
                        where 
                           
                              i
                              =
                              
                                 ⌊
                                 
                                    x
                                    /
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                 
                                 ⌋
                              
                              −
                              1
                           
                        ,
                           
                              j
                              =
                              
                                 ⌊
                                 
                                    y
                                    /
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                 
                                 ⌋
                              
                              −
                              1
                           
                         and 
                           
                              u
                              =
                              x
                              /
                              
                                 
                                    n
                                 
                                 
                                    x
                                 
                              
                              −
                              
                                 ⌊
                                 
                                    x
                                    /
                                    
                                       
                                          n
                                       
                                       
                                          x
                                       
                                    
                                 
                                 ⌋
                              
                           
                        , 
                           
                              v
                              =
                              y
                              /
                              
                                 
                                    n
                                 
                                 
                                    y
                                 
                              
                              −
                              
                                 ⌊
                                 
                                    y
                                    /
                                    
                                       
                                          n
                                       
                                       
                                          y
                                       
                                    
                                 
                                 ⌋
                              
                           
                        . 
                           
                              
                                 B
                              
                              
                                 l
                              
                           
                         is the lth basis function of the B-spline. Here, keypoints which are computed using SIFT in Section 2.3, are employed as landmarks and steepest gradient decent is the optimization method.

The performance of registration can be evaluated using different measures. We have utilized many similarity measures and since the registration result is not affected by the choice of similarity measure, sum of squared difference (SSD) is used here. The distance between initialized FFD grid 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                           
                         and the fitted grid 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    f
                                 
                              
                              (
                              i
                              ,
                              j
                              )
                           
                         is minimized by the following cost function:
                           
                              (10)
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          t
                                          o
                                          t
                                          a
                                          l
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                n
                                             
                                             
                                                y
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       
                                          ‖
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             −
                                             
                                                
                                                   Φ
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ‖
                                       
                                    
                                    +
                                    
                                       
                                          C
                                       
                                       
                                          s
                                          m
                                          o
                                          o
                                          t
                                          h
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

We have added smoothness constraints to the cost function to guarantee that deformation field is smooth and invertible [27]. The term 
                           
                              
                                 C
                              
                              
                                 s
                                 m
                                 o
                                 o
                                 t
                                 h
                              
                           
                         can be formulated by several methods in the literature and one of the widely used definitions is as following:
                           
                              (11)
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          s
                                          m
                                          o
                                          o
                                          t
                                          h
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          A
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          X
                                       
                                    
                                    
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             Y
                                          
                                       
                                       
                                          
                                             |
                                             
                                                l
                                                o
                                                g
                                                (
                                                d
                                                e
                                                t
                                                (
                                                
                                                   J
                                                
                                                (
                                                x
                                                ,
                                                y
                                                )
                                                )
                                             
                                             |
                                          
                                          d
                                          x
                                          d
                                          y
                                       
                                    
                                    ,
                                 
                              
                           
                        where J is the Jacobian matrix which is first order affine approximation of free form deformation.

As it is depicted in Fig. 1, after diffusion filtering, symmetric axis is detected and each image is divided into two parts. Then, a non-rigid registration method is used to correct slight displacement of corresponding pixels of the left part and reflected copy of the right part. Analysis of intensity differences is followed by thresholding to determine the presence of asymmetric tissues. Intensity difference is used to describe the absolute intensity difference between the left part and the registered right part. After detecting abnormal region using thresholding, edge detection is used to distinguish the edge of this region and a number of constraints based on the area of connected components are enforced to omit unlikely cystic regions and keep the likely ones. In order to find optimal value for threshold value and other parameters, we plot ROC curve using different parameters. One way to estimate the optimal point is to choose the point nearest to the upper left corner. The other method for selecting optimal parameters is Youden index. Youden index maximizes the vertical distance from line of equality to the point (x, y). The x represents (1−specificity) and y represents sensitivity. In the other words, Youden index J is the point on the roc curve which is the farthest from line of equality (diagonal line). The main aim of Youden index is to maximize the difference between TPR (sensitivity) and FPR (1−specificity) and it is derived using J=max (sensitivity+specificity−1). ROC curve for various threshold values is depicted in 
                        Fig. 6. The optimal cut-off point and corresponding parameters derived by both methods are the same. We have used threshold value of 0.25 based on ROC curve analysis for the results reported in this paper. Canny algorithm is used for edge detection and all connected components (objects) that have fewer than 30 pixels are removed from the binary image. Average size of maxillofacial cysts is way bigger than 30 pixels. By removing the objects smaller than 30 pixels, we omit small possible false positives and outliers resulting from Canny edge detection. Since imaging acquisition systems are calibrated using Hounsfield unit, these parameters are applicable for various scanners.

The performance of the proposed algorithm is measured based on the quantitative analysis of the method accuracy using three metrics: (1) true positive (TP), (2) false positive (FP) and (3) false negative (FN) of detection. TP describes the fraction of the overlap between the ground-truth and the automatic segmentation. FP indicates the fraction of the healthy tissues falsely identified as cysts, and FN describes the fraction of cystic tissue that was missed during segmentation. Given two sets of M and A which represent segmented regions by the ground-truth and the proposed method respectively, aforementioned measures can be defined as follows:
                           
                              (12)
                              
                                 
                                    T
                                    P
                                    (
                                    A
                                    ,
                                    M
                                    )
                                    =
                                    
                                       
                                          |
                                          
                                             A
                                             ∩
                                             M
                                          
                                          |
                                       
                                       
                                          |
                                          M
                                          |
                                       
                                    
                                    ,
                                    F
                                    P
                                    (
                                    A
                                    ,
                                    M
                                    )
                                    =
                                    
                                       
                                          |
                                          
                                             A
                                             −
                                             M
                                          
                                          |
                                       
                                       
                                          |
                                          M
                                          |
                                       
                                    
                                    ,
                                    F
                                    N
                                    (
                                    A
                                    ,
                                    M
                                    )
                                    =
                                    
                                       
                                          |
                                          
                                             M
                                             −
                                             A
                                          
                                          |
                                       
                                       
                                          |
                                          M
                                          |
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

To evaluate segmentation performance, three similarity metrics are computed: Dice's coefficient, Jaccard index, and Hausdorff Distance. Dice's coefficient and Jaccard index measure the overlap between the segmented cystic region obtained by automatic segmentation and reference manual annotations. These two similarity measures are defined by:
                           
                              (13)
                              
                                 
                                    D
                                    (
                                    A
                                    ,
                                    M
                                    )
                                    =
                                    
                                       
                                          2
                                          
                                             |
                                             
                                                A
                                                ∩
                                                M
                                             
                                             |
                                          
                                       
                                       
                                          
                                             |
                                             A
                                             |
                                          
                                          +
                                          
                                             |
                                             M
                                             |
                                          
                                       
                                    
                                    ,
                                    
                                    J
                                    (
                                    A
                                    ,
                                    M
                                    )
                                    =
                                    
                                       
                                          |
                                          
                                             A
                                             ∩
                                             M
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             A
                                             ∪
                                             M
                                          
                                          |
                                       
                                    
                                    ,
                                 
                              
                           
                        where A and M are segmentation results obtained by automatic segmentation and manual annotation, respectively. Both measures are widely used in checking the accuracy of a segmentation method. Dice and Jaccrad metrics give a measure of overlap between manual segmentation and automatic segmentation, but the boundaries of the segmented regions may be far apart. Hausdorff Distance (HD) aims to measure the distance between the contours corresponding to different segmentations. Hausdorff Distance is the maximum distance of all possible distances between any points on a shape to the closest point on a second shape, and is given as:
                           
                              (14)
                              
                                 
                                    H
                                    D
                                    (
                                    A
                                    ,
                                    M
                                    )
                                    =
                                    m
                                    a
                                    x
                                    
                                       {
                                       
                                          m
                                          a
                                          
                                             
                                                x
                                             
                                             
                                                X
                                                ∈
                                                A
                                             
                                          
                                          
                                             {
                                             
                                                m
                                                i
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      Y
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   {
                                                   
                                                      ‖
                                                      
                                                         A
                                                         −
                                                         M
                                                      
                                                      ‖
                                                   
                                                   }
                                                
                                             
                                             }
                                          
                                          ,
                                          m
                                          a
                                          
                                             
                                                x
                                             
                                             
                                                Y
                                                ∈
                                                M
                                             
                                          
                                          
                                             {
                                             
                                                m
                                                i
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      X
                                                      ∈
                                                      A
                                                   
                                                
                                                
                                                   {
                                                   
                                                      ‖
                                                      
                                                         Y
                                                         −
                                                         X
                                                      
                                                      ‖
                                                   
                                                   }
                                                
                                             
                                             }
                                          
                                       
                                       }
                                    
                                 
                              
                           
                        
                     

Where X and Y are the coordinates of the pixels in the sets A and M, respectively, and here 
                           
                              ‖
                              
                                 .
                              
                              ‖
                           
                        represents the Euclidean distance.

@&#EXPERIMENTAL RESULTS@&#

The proposed algorithm is implemented on a MATLAB 8.1 environment, a personal computer with a P4 (3GHz) processor and a 3GB memory. Estimated time for segmenting each dataset with 200 slices by our algorithm is about 20 minutes. We asked two radiologists with at least 10 years of experience for manual segmentation which is used as ground-truth. For manual segmentation, an expert should spend at least one hour to segment 200 slices.

After diffusion filtering and symmetric axis detection, each CBCT image is divided into two parts. In order to validate symmetric axis detection, the position of automatic symmetry axis is observed and compared with manual symmetric axis detection. No error is observed in automatic symmetry axis detection. Then, hierarchical FFD is applied to correct small differences. A three-level multi-resolution pyramid is adopted to speed up the registration and increase accuracy. The maximum number of iterations is set to 200 to avoid the infinite loop while the tolerance between the previous error measure and the current is set to 0.001 as the stopping criterion. To ensure that registration is done correctly, FFD non-linear registration is implemented using ITK libraries and registration process is evaluated using quantitative criteria such as root mean square of intensity differences 
                        
                           R
                           M
                           S
                           =
                           
                              
                                 
                                    1
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           
                        
                     , where 
                        
                           
                              d
                           
                           
                              i
                           
                        
                      is the intensity difference between the reference image and deformed image. The value of RMS is decreasing during registration process and the value of 0.001 is set as the stopping criterion. In 
                     Fig. 7, registration process for a subject with dentigerous cyst is depicted.

Since the two parts are already registered through non-rigid registration, large intensity differences are expected to occur around the regions which are not symmetric. We have used intensity difference thresholding to produce a binary image that estimates the location of the asymmetric and possible cystic regions. After removing false positive, cystic region is estimated. 
                     Fig. 8 presents the result of automatic segmentation on three subjects' data. The segmented asymmetric regions are superimposed on each image.

Accuracy results associated with automatic segmentation are reported in 
                     
                     
                     Tables 2–4. For most of the experiments done, high TP is achieved. This means that a large number of cyst pixels are correctly classified. However, in some cases, the value of FP is not small which means that this technique tends to classify healthy tissues as cystic tissues.

Quantitative evaluation using similarity metrics is shown in 
                     Table 5. According to these metrics, agreement between the results obtained by automated analysis and the expert is promising.

@&#DISCUSSION@&#

As we mentioned earlier, automatic segmentation of cysts is a challenging and time-consuming task. The goal of this research was to propose a framework based on asymmetry analysis to segment cystic like lesions in CBCT images with high accuracy and efficiency. For preprocessing step, we chose diffusion filtering due to several reasons: (1) It was proposed by Kroon specifically for CBCT images. (2) It is tensor based and very fast for 3D filtering in series of CBCT images. (3) The optimized scheme is designed and discretized in a way that the edges are preserved. Edge preserving characteristic is very important for SIFT features in symmetric axis detection.

In the next step, we utilized a symmetry detection algorithm based on the idea of matching symmetric pairs of feature points. Later, these feature points are fed to non-rigid registration algorithm as landmarks. These landmarks can guide the registration process and avoid local minima.

The proposed framework for automatic segmentation is evaluated using a dataset consisting of97subjectswithvarious jaw cysts. Since the dataset is collected from several image acquisition centers, our algorithm is not tailored to a particular type of tumor or acquisition protocol. The segmented cystic region for subjects with three types of jaw cysts is shown in Fig. 8. As it can be seen in this figure, automatic segmentation results are promising. Moreover, accuracy results reported in Tables 2–4 are encouraging. For most of the experiments done, we achieved high TP. This reveals that a large number of cyst pixels are correctly classified. However, in some cases, the value of FP is not small which means that this algorithm is likely to classify healthy tissues as cystic tissues. The most effective results were obtained in radicular and dentigerous cysts. For some KCOT (keratocystic odontogenic tumor) cases, TP is lower. This happens mainly in cases without specific boundary and even radiologists and experts, find it difficult to segment the cystic region accurately.

We investigated the automatic and manual segmentation results in all available cases. It was observed that in small cysts such as the case in 
                     Fig. 9, the location of cysts is not detected correctly using automatic segmentation. This is one of the limitations of the proposed methodology. The other limitation is incapability to handle symmetric cysts that may cross the midsagittal plane such as a median palatal cyst.

Quantitative evaluation of the proposed method based on similarity indexes is shown in Table 5. The agreement between the results obtained by automated analysis and the expert is promising for dentigerous and radicular cysts. In KCOT cases, the main obstacle of perfect segmentation is the lack of specific boundary for tumoral region and some tumoral tissues are wrongly segmented as healthy tissue and vice versa.

In order to compare our proposed methodology with previous works, we implemented tumor segmentation tool called Smartbrush [16] on our dataset. This tool was proposed by Stoetzer et al. and it is based on Region growing. Region growing is a conventional segmentation algorithm and the final segmentation result depends on choosing the seed points. At first, some points inside the desired area are marked as seeds and region-growing is applied using these seed points. We tried various seed points and the best result was reported and compared with our proposed framework. Using Smartbrush, the mean Dice's coefficient of 0.75, 0.78 and 0.69 is achieved for Radicular, Dentigerous and KCOT classes, respectively. The proposed framework outperforms Smartbrush in terms of mean Dice's coefficient for all classes.ROC curves for evaluating the segmentation results using Smartbrush and the proposed method are illustrated in 
                     Fig. 10. Furthermore, we computed the area under ROC curve. This value is 0.8273 and 0.9361 for Smartbrush and the proposed method, respectively. It is known that if the area under an ROC curve is close to 1, the model performs well and if it is close to 0.5, the model is not any better than randomly guessing. By comparing the area under ROC curves, we can conclude that the proposed method outperforms Smartbrush.

The aim of the proposed framework is to detect cystic lesions in CBCT images. In order to evaluate the performance for healthy images, we randomly selected 20 healthy cases. After employing the proposed algorithm to healthy images, no area is detected as diseased tissue. By analyzing the results, we concluded that the framework is capable of handling healthy images correctly.

@&#CONCLUSION@&#

In this article we presented an automatic method which is able to segment jaw cysts in CBCT images. The proposed framework consists of several major steps: diffusion filtering, symmetry axis detection and landmark detection, non-rigid registration and removing false positives. The image enhancement step based on diffusion filtering was essential and without preprocessing and smoothing, the segmentation algorithm would fail. An efficient and robust method based on modern feature points is used for symmetry axis detection. We have utilized multi-resolution hierarchical FFD which has many advantages. It is robust in case of noise, especially when used in a multi-scale registration approach. Moreover, it is relatively fast because the number of control nodes which should be optimized is lower than the number of pixels in the image. The major disadvantage of FFD registration is computing inverse FFD which was solved by adding extra terms to the cost function. The proposed approach has been validated on 97 clinical datasets with different jaw cysts. Using the proposed framework, high TP and low FP is obtained. Furthermore, the performance of automatic segmentation is evaluated using Dice's coefficient, Jaccard index and Hausdorff distance. Based on these metrics, it can be concluded that the proposed method is effective for segmentation of various cysts.

The major limitation of this method is incapability to handle cysts and lesions without specific boundary and cases with large asymmetric variations. We should develop methods to tackle these challenges in the future works. Future works will investigate other possible methods to reduce falsely classified healthy tissues. Moreover, in cysts without specific boundary, we can combine extra information by other imaging modalities such as MRI. Image fusion methods can be helpful in these cases. Furthermore, to evaluate the generalization of the proposed method in different abnormalities segmentation, we will investigate the ability of this approach to segment cysts and tumors in other organs such as brain.

Accurate segmentation of cysts and tumors is an essential step for diagnosis and surgery planning. This task is usually done manually, however manual segmentation is tedious and time consuming. In this paper, an automatic method based on asymmetry analysis is proposed which is general enough to segment various types of jaw cysts.

Segmentation of cysts and tumors is a challenging task due to several problems. First, cysts can be of various sizes and locations. In fact, a cyst segmentation algorithm has to deal with a large number of datasets in terms of variations and complications. Second, the intensity ranges of surrounding tissues are similar to that of cyst. Thus, conventional segmentation algorithms often generate many false positive pixels and hence poor segmentation results. Third, due to the lower contrast of CBCT images with respect to Multi-slice CT, automatic segmentation is more challenging.

In this article, an automatic method based on asymmetry analysis is proposed which is general enough to segment various types of jaw cysts. The key observation underlying this approach is that normal head and face structure is roughly symmetric with respect to midsagittal plane. Cysts and tumors typically disturb this symmetry. The proposed approach consists of three main steps as follows: At first, diffusion filtering is used for preprocessing and symmetric axis is detected. Then, each image is divided into two parts. In the second stage, free form deformation (FFD)is used to correct slight displacement of corresponding pixels of the left part and a reflected copy of the right part. In the final stage, intensity differences are analyzed and a number of constraints are enforced to remove false positive regions.

This approach has been validated on 97 Cone Beam Computed Tomography (CBCT) sets containing various jaw cysts which were collected from various image acquisition centers. Validation is performed using three similarity indicators (Jaccard index, Dice's coefficient and Hausdorff distance). We achieved promising results in all of them. For most of the experiments done, we achieved high true positive (TP). We compared the proposed approach with Smartbrush tool on our dataset. Smartbrush tool is based on region growing for automatic segmentation of mandibular cysts. Based on ROC curves, we can conclude that the proposed method outperforms Smartbrush. Quantitative results of automatic segmentation show that the proposed method is more effective than one of the recent methods in the literature.

We all authors do declare that we do not have any financial and personal relationships with other people or organizations that could inappropriately influence our work.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank Dr. Momeni and Dr. Dalili Oral and Maxillofacial Radiology Center for providing and annotation of CBCT dataset, constructive discussions and valuable clinical notes. Dr. Dalili, Dr. Dehghanand Dr. Pourafgari provided major part of our dataset. Dr. Momeni and Dr. Dalili participated in manual segmentation of cysts.

@&#REFERENCES@&#

